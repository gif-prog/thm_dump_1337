<!DOCTYPE html>
<!-- saved from url=(0033)https://tryhackme.com/room/sysmon -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>TryHackMe | Sysmon</title>
<meta name="description" content="Learn how to utilize Sysmon to monitor and log your endpoints and environments.">
<meta name="og:description" content="Learn how to utilize Sysmon to monitor and log your endpoints and environments.">
<meta name="keywords" content="cyber,security,cyber security,cyber security training,coding,computer,bitcoin,hacking,hackers,hacks,hack,exploits,keylogger,learn,poc">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<meta property="og:site_name" content="TryHackMe">
<meta property="og:title" content="TryHackMe | Sysmon">
<meta property="og:image" content="https://tryhackme-images.s3.amazonaws.com/room-icons/8978e8897b612ee0be15e66be5f83803.png">
<meta property="og:url" content="https://tryhackme.com/room/sysmon">
<meta name="twitter:image" content="https://tryhackme.com/img/meta/default.png">
<meta property="og:description" content="Learn how to utilize Sysmon to monitor and log your endpoints and environments.">

<script type="text/javascript" async="" src="./TryHackMe _ Sysmon_files/pgpbhph6"></script><script src="./TryHackMe _ Sysmon_files/jquery.min.js"></script>
<script src="./TryHackMe _ Sysmon_files/popper.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Sysmon_files/boostrap431.min.css">
<script src="./TryHackMe _ Sysmon_files/bootstrap431.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Sysmon_files/animate.min.css">
<link rel="stylesheet" href="./TryHackMe _ Sysmon_files/all.css" integrity="sha384-ekOryaXPbeCpWQNxMwSWVvQ0+1VrStoPJq54shlYhR8HzQgig1v5fas6YgOqLoKz" crossorigin="anonymous">
<link rel="icon" type="image/png" href="https://assets.tryhackme.com/img/favicon.png">
<link rel="stylesheet" media="screen" href="./TryHackMe _ Sysmon_files/general-style.css">
<script src="./TryHackMe _ Sysmon_files/script.js"></script>
<script src="./TryHackMe _ Sysmon_files/validation.js"></script>

<link rel="stylesheet" type="text/css" href="./TryHackMe _ Sysmon_files/cookieconsent.min.css">
<script src="./TryHackMe _ Sysmon_files/cookieconsent.min.js"></script>
<script async="" src="./TryHackMe _ Sysmon_files/js"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-Z8D4WL3D4P');
  </script>


<script>
    window.intercomSettings = {
      api_base: "https://api-iam.intercom.io",
      app_id: "pgpbhph6"
    };
  </script>
<script>
    (function (h, o, t, j, a, r) {
      h.hj = h.hj || function () { (h.hj.q = h.hj.q || []).push(arguments) };
      h._hjSettings = { hjid: 1950941, hjsv: 6 };
      a = o.getElementsByTagName('head')[0];
      r = o.createElement('script'); r.async = 1;
      r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
      a.appendChild(r);
    })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
  </script><script async="" src="./TryHackMe _ Sysmon_files/hotjar-1950941.js"></script>
<script>
    /* Global javascript variables */

    // Used inside script.js for createRooms compelted users.
    const username = 'Silv3rsurf3r'
    const subscribed = '1'
    const level = '10'
    const intercomEnabled = 'true'
  </script>
<script>
    //add back tracking info
    const userId = "63d14e7f857ae10041bb192f"
    let tutorialComplete = false
    if ('false' == "true") {
      tutorialComplete = true
    }
    if(intercomEnabled === "true"){
      window.intercomSettings = {
        api_base: "https://api-iam.intercom.io",
        app_id: "pgpbhph6",
        user_id: userId,
        username: username,
        email: "giftonpaul@karunya.edu.in",
        created_at: Math.floor(new Date("Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)").getTime() / 1000) // Signup date as a Unix timestamp
      };
    }
    window.hj('identify', userId, {
      displayName: username,
      subscribed: "1",
      dateSignUp: "Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)",
      experience: "advanced"
    })
  </script>
<script type="application/ld+json">

   {
      "@context":"https://schema.org",
      "@type":"Organization",
      "url":"https://tryhackme.com",
      "name":"TryHackMe",
      "logo":"https://tryhackme.com/img/favicon.png",
      "description":"TryHackMe is a free online platform for learning cyber security, using hands-on exercises and labs, all through your browser!",
      "email": "support@tryhackme.com",
      "sameAs":[
         "https://www.linkedin.com/company/tryhackme",
         "https://twitter.com/realtryhackme"
      ]
   }

</script>
<script>
    console.log(`%c
      ------------------
      < Happy Hacking! >
      ------------------
              \\   ^__^
               \\  (oo)\\_______
                  (__)\\       )\\/\\
                      ||----w |
                      ||     ||`, "font-family:monospace")
  </script>
<script>
  (function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pgpbhph6';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>
<script src="./TryHackMe _ Sysmon_files/socket.io.js"></script><script>
  let socket = io.connect({
    transports: ['websocket'],
    reconnection: true,
    reconnectionDelay: 1000,
    reconnectionAttempts: 10
  })
</script><script async="" src="./TryHackMe _ Sysmon_files/modules.5957fbf26d1b525b5a12.js" charset="utf-8"></script><style type="text/css">.apexcharts-canvas {
  position: relative;
  user-select: none;
  /* cannot give overflow: hidden as it will crop tooltips which overflow outside chart area */
}


/* scrollbar is not visible by default for legend, hence forcing the visibility */
.apexcharts-canvas ::-webkit-scrollbar {
  -webkit-appearance: none;
  width: 6px;
}

.apexcharts-canvas ::-webkit-scrollbar-thumb {
  border-radius: 4px;
  background-color: rgba(0, 0, 0, .5);
  box-shadow: 0 0 1px rgba(255, 255, 255, .5);
  -webkit-box-shadow: 0 0 1px rgba(255, 255, 255, .5);
}


.apexcharts-inner {
  position: relative;
}

.apexcharts-text tspan {
  font-family: inherit;
}

.legend-mouseover-inactive {
  transition: 0.15s ease all;
  opacity: 0.20;
}

.apexcharts-series-collapsed {
  opacity: 0;
}

.apexcharts-tooltip {
  border-radius: 5px;
  box-shadow: 2px 2px 6px -4px #999;
  cursor: default;
  font-size: 14px;
  left: 62px;
  opacity: 0;
  pointer-events: none;
  position: absolute;
  top: 20px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  white-space: nowrap;
  z-index: 12;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-theme-light {
  border: 1px solid #e3e3e3;
  background: rgba(255, 255, 255, 0.96);
}

.apexcharts-tooltip.apexcharts-theme-dark {
  color: #fff;
  background: rgba(30, 30, 30, 0.8);
}

.apexcharts-tooltip * {
  font-family: inherit;
}


.apexcharts-tooltip-title {
  padding: 6px;
  font-size: 15px;
  margin-bottom: 4px;
}

.apexcharts-tooltip.apexcharts-theme-light .apexcharts-tooltip-title {
  background: #ECEFF1;
  border-bottom: 1px solid #ddd;
}

.apexcharts-tooltip.apexcharts-theme-dark .apexcharts-tooltip-title {
  background: rgba(0, 0, 0, 0.7);
  border-bottom: 1px solid #333;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  display: inline-block;
  font-weight: 600;
  margin-left: 5px;
}

.apexcharts-tooltip-text-y-label:empty,
.apexcharts-tooltip-text-y-value:empty,
.apexcharts-tooltip-text-goals-label:empty,
.apexcharts-tooltip-text-goals-value:empty,
.apexcharts-tooltip-text-z-value:empty {
  display: none;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  font-weight: 600;
}

.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-goals-group, 
.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  display: flex;
}
.apexcharts-tooltip-text-goals-label:not(:empty),
.apexcharts-tooltip-text-goals-value:not(:empty) {
  margin-top: -6px;
}

.apexcharts-tooltip-marker {
  width: 12px;
  height: 12px;
  position: relative;
  top: 0px;
  margin-right: 10px;
  border-radius: 50%;
}

.apexcharts-tooltip-series-group {
  padding: 0 10px;
  display: none;
  text-align: left;
  justify-content: left;
  align-items: center;
}

.apexcharts-tooltip-series-group.apexcharts-active .apexcharts-tooltip-marker {
  opacity: 1;
}

.apexcharts-tooltip-series-group.apexcharts-active,
.apexcharts-tooltip-series-group:last-child {
  padding-bottom: 4px;
}

.apexcharts-tooltip-series-group-hidden {
  opacity: 0;
  height: 0;
  line-height: 0;
  padding: 0 !important;
}

.apexcharts-tooltip-y-group {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-box, .apexcharts-custom-tooltip {
  padding: 4px 8px;
}

.apexcharts-tooltip-boxPlot {
  display: flex;
  flex-direction: column-reverse;
}

.apexcharts-tooltip-box>div {
  margin: 4px 0;
}

.apexcharts-tooltip-box span.value {
  font-weight: bold;
}

.apexcharts-tooltip-rangebar {
  padding: 5px 8px;
}

.apexcharts-tooltip-rangebar .category {
  font-weight: 600;
  color: #777;
}

.apexcharts-tooltip-rangebar .series-name {
  font-weight: bold;
  display: block;
  margin-bottom: 5px;
}

.apexcharts-xaxistooltip {
  opacity: 0;
  padding: 9px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
  transition: 0.15s ease all;
}

.apexcharts-xaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-xaxistooltip:after,
.apexcharts-xaxistooltip:before {
  left: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-xaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-left: -6px;
}

.apexcharts-xaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-left: -7px;
}

.apexcharts-xaxistooltip-bottom:after,
.apexcharts-xaxistooltip-bottom:before {
  bottom: 100%;
}

.apexcharts-xaxistooltip-top:after,
.apexcharts-xaxistooltip-top:before {
  top: 100%;
}

.apexcharts-xaxistooltip-bottom:after {
  border-bottom-color: #ECEFF1;
}

.apexcharts-xaxistooltip-bottom:before {
  border-bottom-color: #90A4AE;
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:after {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:before {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top:after {
  border-top-color: #ECEFF1
}

.apexcharts-xaxistooltip-top:before {
  border-top-color: #90A4AE;
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:after {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:before {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-yaxistooltip {
  opacity: 0;
  padding: 4px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
}

.apexcharts-yaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-yaxistooltip:after,
.apexcharts-yaxistooltip:before {
  top: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-yaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-top: -6px;
}

.apexcharts-yaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-top: -7px;
}

.apexcharts-yaxistooltip-left:after,
.apexcharts-yaxistooltip-left:before {
  left: 100%;
}

.apexcharts-yaxistooltip-right:after,
.apexcharts-yaxistooltip-right:before {
  right: 100%;
}

.apexcharts-yaxistooltip-left:after {
  border-left-color: #ECEFF1;
}

.apexcharts-yaxistooltip-left:before {
  border-left-color: #90A4AE;
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:after {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:before {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right:after {
  border-right-color: #ECEFF1;
}

.apexcharts-yaxistooltip-right:before {
  border-right-color: #90A4AE;
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:after {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:before {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip.apexcharts-active {
  opacity: 1;
}

.apexcharts-yaxistooltip-hidden {
  display: none;
}

.apexcharts-xcrosshairs,
.apexcharts-ycrosshairs {
  pointer-events: none;
  opacity: 0;
  transition: 0.15s ease all;
}

.apexcharts-xcrosshairs.apexcharts-active,
.apexcharts-ycrosshairs.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-ycrosshairs-hidden {
  opacity: 0;
}

.apexcharts-selection-rect {
  cursor: move;
}

.svg_select_boundingRect, .svg_select_points_rot {
  pointer-events: none;
  opacity: 0;
  visibility: hidden;
}
.apexcharts-selection-rect + g .svg_select_boundingRect,
.apexcharts-selection-rect + g .svg_select_points_rot {
  opacity: 0;
  visibility: hidden;
}

.apexcharts-selection-rect + g .svg_select_points_l,
.apexcharts-selection-rect + g .svg_select_points_r {
  cursor: ew-resize;
  opacity: 1;
  visibility: visible;
}

.svg_select_points {
  fill: #efefef;
  stroke: #333;
  rx: 2;
}

.apexcharts-svg.apexcharts-zoomable.hovering-zoom {
  cursor: crosshair
}

.apexcharts-svg.apexcharts-zoomable.hovering-pan {
  cursor: move
}

.apexcharts-zoom-icon,
.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon,
.apexcharts-reset-icon,
.apexcharts-pan-icon,
.apexcharts-selection-icon,
.apexcharts-menu-icon,
.apexcharts-toolbar-custom-icon {
  cursor: pointer;
  width: 20px;
  height: 20px;
  line-height: 24px;
  color: #6E8192;
  text-align: center;
}

.apexcharts-zoom-icon svg,
.apexcharts-zoomin-icon svg,
.apexcharts-zoomout-icon svg,
.apexcharts-reset-icon svg,
.apexcharts-menu-icon svg {
  fill: #6E8192;
}

.apexcharts-selection-icon svg {
  fill: #444;
  transform: scale(0.76)
}

.apexcharts-theme-dark .apexcharts-zoom-icon svg,
.apexcharts-theme-dark .apexcharts-zoomin-icon svg,
.apexcharts-theme-dark .apexcharts-zoomout-icon svg,
.apexcharts-theme-dark .apexcharts-reset-icon svg,
.apexcharts-theme-dark .apexcharts-pan-icon svg,
.apexcharts-theme-dark .apexcharts-selection-icon svg,
.apexcharts-theme-dark .apexcharts-menu-icon svg,
.apexcharts-theme-dark .apexcharts-toolbar-custom-icon svg {
  fill: #f3f4f5;
}

.apexcharts-canvas .apexcharts-zoom-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-selection-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-reset-zoom-icon.apexcharts-selected svg {
  fill: #008FFB;
}

.apexcharts-theme-light .apexcharts-selection-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoom-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoomin-icon:hover svg,
.apexcharts-theme-light .apexcharts-zoomout-icon:hover svg,
.apexcharts-theme-light .apexcharts-reset-icon:hover svg,
.apexcharts-theme-light .apexcharts-menu-icon:hover svg {
  fill: #333;
}

.apexcharts-selection-icon,
.apexcharts-menu-icon {
  position: relative;
}

.apexcharts-reset-icon {
  margin-left: 5px;
}

.apexcharts-zoom-icon,
.apexcharts-reset-icon,
.apexcharts-menu-icon {
  transform: scale(0.85);
}

.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon {
  transform: scale(0.7)
}

.apexcharts-zoomout-icon {
  margin-right: 3px;
}

.apexcharts-pan-icon {
  transform: scale(0.62);
  position: relative;
  left: 1px;
  top: 0px;
}

.apexcharts-pan-icon svg {
  fill: #fff;
  stroke: #6E8192;
  stroke-width: 2;
}

.apexcharts-pan-icon.apexcharts-selected svg {
  stroke: #008FFB;
}

.apexcharts-pan-icon:not(.apexcharts-selected):hover svg {
  stroke: #333;
}

.apexcharts-toolbar {
  position: absolute;
  z-index: 11;
  max-width: 176px;
  text-align: right;
  border-radius: 3px;
  padding: 0px 6px 2px 6px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.apexcharts-menu {
  background: #fff;
  position: absolute;
  top: 100%;
  border: 1px solid #ddd;
  border-radius: 3px;
  padding: 3px;
  right: 10px;
  opacity: 0;
  min-width: 110px;
  transition: 0.15s ease all;
  pointer-events: none;
}

.apexcharts-menu.apexcharts-menu-open {
  opacity: 1;
  pointer-events: all;
  transition: 0.15s ease all;
}

.apexcharts-menu-item {
  padding: 6px 7px;
  font-size: 12px;
  cursor: pointer;
}

.apexcharts-theme-light .apexcharts-menu-item:hover {
  background: #eee;
}

.apexcharts-theme-dark .apexcharts-menu {
  background: rgba(0, 0, 0, 0.7);
  color: #fff;
}

@media screen and (min-width: 768px) {
  .apexcharts-canvas:hover .apexcharts-toolbar {
    opacity: 1;
  }
}

.apexcharts-datalabel.apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-pie-label,
.apexcharts-datalabels,
.apexcharts-datalabel,
.apexcharts-datalabel-label,
.apexcharts-datalabel-value {
  cursor: default;
  pointer-events: none;
}

.apexcharts-pie-label-delay {
  opacity: 0;
  animation-name: opaque;
  animation-duration: 0.3s;
  animation-fill-mode: forwards;
  animation-timing-function: ease;
}

.apexcharts-canvas .apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-hide .apexcharts-series-points {
  opacity: 0;
}

.apexcharts-gridline,
.apexcharts-annotation-rect,
.apexcharts-tooltip .apexcharts-marker,
.apexcharts-area-series .apexcharts-area,
.apexcharts-line,
.apexcharts-zoom-rect,
.apexcharts-toolbar svg,
.apexcharts-area-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-line-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-radar-series path,
.apexcharts-radar-series polygon {
  pointer-events: none;
}


/* markers */

.apexcharts-marker {
  transition: 0.15s ease all;
}

@keyframes opaque {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}


/* Resize generated styles */

@keyframes resizeanim {
  from {
    opacity: 0;
  }
  to {
    opacity: 0;
  }
}

.resize-triggers {
  animation: 1ms resizeanim;
  visibility: hidden;
  opacity: 0;
}

.resize-triggers,
.resize-triggers>div,
.contract-trigger:before {
  content: " ";
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  overflow: hidden;
}

.resize-triggers>div {
  background: #eee;
  overflow: auto;
}

.contract-trigger:before {
  width: 200%;
  height: 200%;
}</style><style data-jss="" data-meta="MuiDialog">
@media print {
  .MuiDialog-root {
    position: absolute !important;
  }
}
.MuiDialog-scrollPaper {
  display: flex;
  align-items: center;
  justify-content: center;
}
.MuiDialog-scrollBody {
  overflow-x: hidden;
  overflow-y: auto;
  text-align: center;
}
.MuiDialog-scrollBody:after {
  width: 0;
  height: 100%;
  content: "";
  display: inline-block;
  vertical-align: middle;
}
.MuiDialog-container {
  height: 100%;
  outline: 0;
}
@media print {
  .MuiDialog-container {
    height: auto;
  }
}
.MuiDialog-paper {
  margin: 32px;
  position: relative;
  overflow-y: auto;
}
@media print {
  .MuiDialog-paper {
    box-shadow: none;
    overflow-y: visible;
  }
}
.MuiDialog-paperScrollPaper {
  display: flex;
  max-height: calc(100% - 64px);
  flex-direction: column;
}
.MuiDialog-paperScrollBody {
  display: inline-block;
  text-align: left;
  vertical-align: middle;
}
.MuiDialog-paperWidthFalse {
  max-width: calc(100% - 64px);
}
.MuiDialog-paperWidthXs {
  max-width: 444px;
}
@media (max-width:507.95px) {
  .MuiDialog-paperWidthXs.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthSm {
  max-width: 600px;
}
@media (max-width:663.95px) {
  .MuiDialog-paperWidthSm.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthMd {
  max-width: 960px;
}
@media (max-width:1023.95px) {
  .MuiDialog-paperWidthMd.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthLg {
  max-width: 1280px;
}
@media (max-width:1343.95px) {
  .MuiDialog-paperWidthLg.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthXl {
  max-width: 1920px;
}
@media (max-width:1983.95px) {
  .MuiDialog-paperWidthXl.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperFullWidth {
  width: calc(100% - 64px);
}
.MuiDialog-paperFullScreen {
  width: 100%;
  height: 100%;
  margin: 0;
  max-width: 100%;
  max-height: none;
  border-radius: 0;
}
.MuiDialog-paperFullScreen.MuiDialog-paperScrollBody {
  margin: 0;
  max-width: 100%;
}
</style><style></style></head>


<body><div role="dialog" aria-live="polite" aria-label="cookieconsent" aria-describedby="cookieconsent:desc" class="cc-window cc-floating cc-type-info cc-theme-classic cc-bottom cc-right cc-color-override-382972913 cc-invisible" style="display: none;"><!--googleoff: all--><span id="cookieconsent:desc" class="cc-message">We use cookies to ensure you get the best user experience. For more information contact us. <a aria-label="learn more about cookies" role="button" tabindex="0" class="cc-link" href="https://tryhackme.com/legal/terms-of-use" target="_blank">Read more</a></span><div class="cc-compliance"><a aria-label="dismiss cookie message" role="button" tabindex="0" class="cc-btn cc-dismiss">Got it!</a></div><!--googleon: all--></div>
<link href="./TryHackMe _ Sysmon_files/scoreboard.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Sysmon_files/introjs.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Sysmon_files/slideout.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Sysmon_files/public-rooms.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Sysmon_files/asciinema-player.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Sysmon_files/prism.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Sysmon_files/magnific-popup.css" rel="stylesheet" type="text/css"> 
<script src="./TryHackMe _ Sysmon_files/lottie-player.js"></script>

<div id="room-content">
<div id="room-content-main">
<nav class="navbar navbar-expand-md navbar-dark navbar-color-loggedin navbar-main">
<div class="container">
<button id="thm-mobile-nav-open" class="thm-nav__hamburger-btn" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Open mobile navigation">
<span class="thm-nav__hamburger-lines"></span>
</button>
<div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
<div class="navbar-brand" href="/">
<a href="https://tryhackme.com/dashboard">
<img width="115px" src="./TryHackMe _ Sysmon_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
</div>
<ul class="navbar-nav mr-auto mt-2 mt-lg-0 navbar-pagelinks">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="navbar-item-icon far fa-browser"></i>
<div class="navbar-item-text">Dashboard</div>
</a>
</li>
<li class="nav-item active" id="nav-learn">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="navbar-item-icon far fa-book-open"></i>
<div class="navbar-item-text">Learn</div>
</a>
</li>
<li class="nav-item  dropdown lite-removable">
<a id="nav-other" class="nav-link" href="https://tryhackme.com/room/sysmon#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-trophy"></i>
<div class="navbar-item-text">Compete</div>
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdown">
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/leaderboards">
<div class="dropdown-menu-icon">
<i class="fas fa-trophy"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/games/koth">
<div class="dropdown-menu-icon">
<i class="fas fa-crown"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/workspace">
<div class="dropdown-menu-icon">
<i class="fas fa-user-friends"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item dropdown">
<a data-cy="nav-other-menu-button" id="nav-other" class="nav-link" href="https://tryhackme.com/room/sysmon#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-ellipsis-h-alt"></i>
<div class="navbar-item-text">Other</div>
</a>
<div data-cy="nav-other-menu" class="dropdown-menu dropdown-menu-center large-dropdown" aria-labelledby="navbarDropdown">
<span class="dropdown-menu-arrow"></span>
<a class="dropdown-item" href="https://tryhackme.com/resources">Resources</a>
<a class="dropdown-item" href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a class="dropdown-item" href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/business">For Business</a>
<a class="dropdown-item" href="https://tryhackme.com/classrooms">For Education</a>
<a class="dropdown-item" target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
<a class="dropdown-item" href="https://tryhackme.com/glossary">Glossary</a>
</div>
</li>
</ul>
<ul class="navbar-nav navbar-right options vertical-align-custom">
<li class="nav-item" data-toggle="modal" data-target="#navConnModal">
<div id="thm-connection-status" class="thm-disconnected" style="display: flex;">
<div id="thm-connection-status-dot" class="dot-small"></div> <span id="thm-connection-status-txt" class="ml-2 size-18 text-white">Access Machines</span>
</div>
</li>
<li class="nav-item">
<div class="nav-item-streak">
<span id="streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="">
<span id="user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>
<script>
                            let usersStreak = { // Global variable, used in rooms logic
                                streakFirstAnswered: new Date('Mon Jul 10 2023 03:13:45 GMT+0100 (British Summer Time)'),
                                streakLastAnswered: new Date('Sun Jul 16 2023 18:47:44 GMT+0100 (British Summer Time)'),
                                usersTimezone: 'Asia/Kolkata',
                                streakFreeze: 1
                            };
                            setSidebarStreaks(usersStreak.streakFirstAnswered, usersStreak.streakLastAnswered, usersStreak.usersTimezone, usersStreak.streakFreeze)
                        </script>
</div>
</li>
<li class="nav-item dropdown" id="notification-navitem">
<a class="nav-link vertical-align-custom size-22 pl-0" href="https://tryhackme.com/room/sysmon#" id="notification-btn" role="button" data-toggle="dropdown">
<i id="notification-icon" class="fal fa-bell"></i>
<div id="notification-dot"></div>
</a>
<div id="nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="notification-header">Notifications</div>
<div id="nav-notifications" style="padding: 0px;">
    <div class="row notification">
      <div class="col-auto text-center"><img height="18" src="https://assets.tryhackme.com/img/icons/confetti.png"></div>
      <div class="col p-0">
        <div>Congratulations, you leveled up! You're now level 10.</div>
        <div class="size-12 faded mt-1">27th Jun 2023</div>
      </div>
    </div>
  
    <div class="row notification">
      <div class="col-auto text-center"><i class="fad fa-info-square small text-blue size-14"></i></div>
      <div class="col p-0">
        <div>A King of the Hill game you're in starts soon.  
        <a href="https://tryhackme.com/games/koth/75612">Get ready</a>!</div>
        <div class="size-12 faded mt-1">22nd Jun 2023</div>
      </div>
    </div>
  
    <div class="row notification">
      <div class="col-auto text-center"><img height="18" src="https://assets.tryhackme.com/img/icons/confetti.png"></div>
      <div class="col p-0">
        <div>Congratulations, you leveled up! You're now level 9.</div>
        <div class="size-12 faded mt-1">17th Jun 2023</div>
      </div>
    </div>
  </div>
</div>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle remove-arrow p-0" href="https://tryhackme.com/room/sysmon#" id="navbarAvatarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
<img src="./TryHackMe _ Sysmon_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarAvatarDropdown">
<a class="dropdown-item" href="https://tryhackme.com/profile">Profile</a>
<a class="dropdown-item" href="https://tryhackme.com/referrals">Refer a friend</a>
<a class="dropdown-item" href="https://tryhackme.com/badges">Badges</a>
<a class="dropdown-item" href="https://tryhackme.com/rooms">My Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/access">Access</a>
<a class="dropdown-item" href="https://tryhackme.com/feedback">Give Feedback</a>
<a class="dropdown-item" href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</div>
</div>
</nav>
<link rel="stylesheet" href="./TryHackMe _ Sysmon_files/streak-freeze.css">
<div class="modal fade modal-streak-freeze" id="unlocked-streak-freeze" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<button type="button" class="close close-streak" id="close-streak-freeze-popup" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<div class="modal-body">
<figure>
<img class="img-streak" width="400px" alt="streak freeze unlocked" src="./TryHackMe _ Sysmon_files/streak-freeze.svg">
</figure>
<h2>You've unlocked a streak freeze!</h2>
<p>With these one-time streak freezes, you can miss one day of hacking without losing your streak.</p>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Sysmon_files/streak-freeze.js"></script>
<nav id="thm-mobile-nav-menu" class="thm-mobile-nav" aria-label="Mobile secondary navigation menu.">
<header>
<a href="https://tryhackme.com/" aria-label="Go to the home page">
<img width="140" src="./TryHackMe _ Sysmon_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
<button id="thm-mobile-nav-close" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Close mobile navigation">
<i class="fal fa-times"></i>
</button>
</header>
<ul class="thm-mobile-nav-items mb-0">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="nav-title-icon far fa-browser"></i>
<div class="nav-title">Dashboard</div>
</a>
</li>
<li class="nav-item active">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="nav-title-icon far fa-book-open"></i>
<div class="nav-title">Learn</div>
</a>
</li>
<li class="nav-item ">
<a aria-expanded="false" aria-controls="mobile-nav-compete" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-compete" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-trophy"></i>
<div class="nav-title">Compete</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-compete" class="dropdown-wrapper">
<a href="https://tryhackme.com/leaderboards">
<div>
<i class="fas fa-trophy"></i>
</div>
<div>
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a href="https://tryhackme.com/games/koth">
<div>
<i class="fas fa-crown"></i>
</div>
<div>
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a href="https://tryhackme.com/workspace">
<div>
<i class="fas fa-user-friends"></i>
</div>
<div>
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item">
<a aria-expanded="false" aria-controls="mobile-nav-other" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-other" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-ellipsis-h-alt"></i>
<div class="nav-title">Other</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-other" class="dropdown-wrapper">
<a href="https://tryhackme.com/resources">Resources</a>
<a href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a href="https://tryhackme.com/business">For Business</a>
<a href="https://tryhackme.com/classrooms">For Education</a>
<a target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
</div>
</li>
<li class="nav-item text-center">
<div class="nav-item-streak">
<span id="mobile-streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="">
<span id="mobile-user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>
</div>
</li>
<li class="nav-item text-center">
<a class="nav-link size-22 d-inline-block" href="https://tryhackme.com/room/sysmon#" id="mobile-notification-btn" role="button" data-toggle="dropdown">
<i id="mobile-notification-icon" class="fal fa-bell"></i>
<div id="mobile-notification-dot"></div>
</a>
<div id="mobile-nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="mobile-notification-header">Notifications</div>
<div id="mobile-nav-notifications" style="padding: 0px;">
    <div class="row notification">
      <div class="col-auto text-center"><img height="18" src="https://assets.tryhackme.com/img/icons/confetti.png"></div>
      <div class="col p-0">
        <div>Congratulations, you leveled up! You're now level 10.</div>
        <div class="size-12 faded mt-1">27th Jun 2023</div>
      </div>
    </div>
  
    <div class="row notification">
      <div class="col-auto text-center"><i class="fad fa-info-square small text-blue size-14"></i></div>
      <div class="col p-0">
        <div>A King of the Hill game you're in starts soon.  
        <a href="https://tryhackme.com/games/koth/75612">Get ready</a>!</div>
        <div class="size-12 faded mt-1">22nd Jun 2023</div>
      </div>
    </div>
  
    <div class="row notification">
      <div class="col-auto text-center"><img height="18" src="https://assets.tryhackme.com/img/icons/confetti.png"></div>
      <div class="col p-0">
        <div>Congratulations, you leveled up! You're now level 9.</div>
        <div class="size-12 faded mt-1">17th Jun 2023</div>
      </div>
    </div>
  </div>
</div>
</li>
<li class="nav-item text-center">
<a aria-expanded="false" aria-controls="mobile-nav-auth" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-auth" class="sublinks-toggle nav-link d-inline-block">
<img src="./TryHackMe _ Sysmon_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div id="mobile-nav-auth" class="dropdown-wrapper">
<a href="https://tryhackme.com/profile">Profile</a>
<a href="https://tryhackme.com/referrals">Refer a friend</a>
<a href="https://tryhackme.com/badges">Badges</a>
<a href="https://tryhackme.com/rooms">My Rooms</a>
<a href="https://tryhackme.com/access">Access</a>
<a href="https://tryhackme.com/feedback">Give Feedback</a>
 <a href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</nav>
<script defer="" src="./TryHackMe _ Sysmon_files/mobile-nav.js"></script>
<script>
  const userSignedUpLessThanSevenDaysAgo = Math.floor(
    (new Date() - new Date('Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)')) / (1000 * 60 * 60 * 24) < 7
  );

  const userHasFirst4RoomsBadge = !!``;
  const isBeginner = `advanced` === 'complete-beginner';
</script>
<script src="./TryHackMe _ Sysmon_files/notifications.js"></script>
<script src="./TryHackMe _ Sysmon_files/streak-freeze(1).js"></script>
<div id="wrapper">
<div id="room-banner" class="shadow-light">
<img id="room-image-large" src="./TryHackMe _ Sysmon_files/852511abe0c7c201fe549b1ffa3fade4.png">
<div>
<div id="room-details">
<div class="container">
<div class="page-header">
<div class="room-header">
<div id="room-voting" class="text-center vertical-align-custom">
<div class="voting-buttons">
<i class="fas fa-thumbs-up display-block" onclick="makeVote(true)" id="vote-up" style="color: rgb(185, 185, 185);"></i>
<div class="display-block" id="vote-number">605</div>
<i class="fas fa-thumbs-down display-block" onclick="makeVote(false)" id="vote-down" style="color: rgb(185, 185, 185);"></i>
</div>
</div>
<div id="room-logo" class="vertical-align-custom">
<div id="logo"><img class="room-avatar" src="./TryHackMe _ Sysmon_files/8978e8897b612ee0be15e66be5f83803.png" onerror="replaceImg(this)"></div>
</div>
<div class="vertical-align-custom">
<div id="room-basic-data">
<div class="d-flex justify-content-between">
<h1 id="title" class="bold-head">Sysmon</h1>
<div id="room-title-options">

<div class="btn-group" id="browser-machine-options" role="group" aria-label="Start AttackBox or Kali Linux" style="display: inline-flex;">
<button id="browser-machine-start" type="button" class="btn btn-secondary"><i class="far fa-laptop"></i> Start AttackBox</button>
<div class="btn-group" id="browser-machines" role="group">
<button id="btnGroupDrop1" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
<div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
<a class="dropdown-item  preventDefault" href="https://tryhackme.com/room/sysmon#" onclick="changeMyMachine(&quot;kali-linux&quot;)">
<span class="mb-0">Use Kali Linux</span>
<div class="text-lgray size-12">Web-based Kali Machine</div>
</a>
<a class="dropdown-item preventDefault" href="https://tryhackme.com/room/sysmon#" onclick="changeMyMachine(&quot;attackbox&quot;)">
<span class="mb-0">Use AttackBox</span>
<div class="text-lgray size-12">Recommended</div>
</a>
</div>
</div>
</div>
<button id="browser-machine-split-view" type="button" class="btn btn-secondary">Show Split View</button>
<button id="cloud-details" type="button" class="btn btn-info"><i class="far fa-clouds mr-1"></i>Cloud Details</button>
<span id="awards-model-btn" data-toggle="modal" data-target="#award-modal" class="badge badge-warning ml-1 noselect">Awards</span>
<span id="room-faq-slideout" type="button" class="badge badge-info ml-1 noselect d-inline-flex" onclick="openHelpMenu()">
Help
</span>
<div class="dropright room-dropright noselect ml-1" id="room-options" style="display: inline-block;">
<span class="badge badge-secondary" data-toggle="dropdown">
<i class="fas fa-cog"></i>
</span>
<div class="dropdown-menu">
<a class="dropdown-item" href="https://tryhackme.com/api/room/manage/clone/sysmon" id="clone-room" style="display: none;"><i class="far fa-clone faded"></i> Clone Room</a>
<a class="dropdown-item preventDefault" id="writeups-simple" style="display: inline-block;"><i class="fas fa-pen-alt faded"></i> Writeups</a>
<a class="dropdown-item preventDefault" data-toggle="modal" data-target="#resetUserProgressModal"><i class="fas fa-eraser faded"></i> Reset Progress</a>
<a class="dropdown-item preventDefault" id="leave-room"><i class="fas fa-sign-out-alt faded"></i> Leave</a>
</div>
</div>
<span id="bookmark" class="badge badge-secondary badge-bookmark ">
<img class="bookmark" src="./TryHackMe _ Sysmon_files/bookmark.svg">
<span class="bookmark-popover" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="top" data-content="&lt;p class=&#39;mb-0&#39;&gt;Save room &lt;/p&gt;
" data-original-title="" title="">
</span>
</span>
</div>
</div>
<p class="mb0 faded" id="description">Learn how to utilize Sysmon to monitor and log your endpoints and environments.</p>
</div>
</div>
</div>
</div>

</div>
</div>
<div id="room-banner-stats">
<div class="creators"></div>
<div class="numbers"></div>
</div>
</div>
</div>
<div class="container main pb">
<div id="room-message"></div>
<section id="sponsor">
<i id="sponsor-close" class="fas fa-times"></i>
<div id="sponsor-data"></div>
</section>
<div id="top-panel">
<ul class="nav nav-tabs" id="task-navs">
<li class="nav-item">
<a class="nav-link  active " data-toggle="tab" href="https://tryhackme.com/room/sysmon#chart">
<i class="fas fa-chart-line icon-right"></i> Chart
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/sysmon#scoreboard">
<i class="fas fa-trophy icon-right"></i> Scoreboard
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/sysmon#chat">
<i class="fas fa-comments-alt icon-right chat-icon"></i> Discuss
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/sysmon#writeups">
<i class="fas fa-pen-alt icon-right"></i> Writeups
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/sysmon#about">
<i class="fas fa-info-circle icon-right"></i> More
</a>
</li>
</ul>
<div class="card cd-2 nav-above-con" id="room-main">
<div class="card-body">
<span id="room-tabs">
<div class="tab-content">
<div id="chart" class="tab-pane  active ">
<span id="difficulty-bar">
    <span class="room-difficulty diff-text">
      Difficulty: 
        <span class="difficulty-easy">Easy</span>
    </span></span>
<br><div id="chart-data"></div>
</div>
<div id="scoreboard" class="tab-pane fade">
<table class="table table-striped table-bordered table-condensed table-header-rotated mb-0" id="scoreboard_table">
<thead>
<tr id="scoreboard_header">
<th>Rank</th>
<th>Username</th>
<th>Total Score</th>
</tr>
</thead>
<tbody id="scoreboard_body"></tbody>
</table>
</div>
<div id="chat" class="tab-pane fade">

<div class="row">
<div class="col-sm-6 text-center">
<h3 class="mb-2">Discord</h3>
<p>Come join our <a target="_blank" href="https://discord.gg/QgC6Tdk">Discord</a> server for support or further discussions</p>
</div>
<div class="col-sm-6 text-center">
<h3 class="mb-2">Forum</h3>
<div id="forum-text">Search our <a href="https://tryhackme.com/forum">forum</a> for pre-existing threads about this room, or create your own!</div>
</div>
</div>
</div>
<div id="writeups" class="tab-pane text-center">
<div id="writeups-data">There are no writeups submitted.</div>
<button onclick="showWriteupForm(this)" type="button" class="btn btn-xs btn-secondary mt-3 mb-2">Add Writeup</button>
<div id="writeup-form">
<div class="form-row">
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-title" placeholder="Writeup Title">
</div>
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-link" placeholder="Writeup URL">
</div>
<div class="col-auto">
<button id="submit-writeup" type="submit" class="btn btn-success mb-2">Submit</button>
</div>
</div>
<p class="faded mb-0 size-14"><i class="fas fa-exclamation-triangle text-warning"></i> Writeups should have a link to TryHackMe and not include any passwords/cracked hashes/flags</p>
</div>
</div>
<div id="about" class="tab-pane text-center">
<p id="about-freeRoom"><p class="mb-0">Only subscribers can deploy virtual machines in this room! 
        Go to your <a href="https://tryhackme.com/profile">profile</a> page to subscribe (if you have not already). 21917 users are in here and this room is 908 days old.</p></p>
<p id="about-owner"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Sysmon_files/af7feb2c43a2c7d5f111b98ccbd15048.png"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme">tryhackme</a> and <img class="avatar-tiny" src="./TryHackMe _ Sysmon_files/9e946af210ae86d6fbfda480d958b3fe.gif"> 
        <a class="green-link" href="https://tryhackme.com/p/Cryillic">Cryillic</a></p></p>
</div>
</div>
</span>
</div>
</div>
</div>
<div id="room-simple-video" class="card card-body cd-2"></div>
<div class="card mt-3 mb-3 cd-2 text-center" id="instance-info">
<div class="card-header card-header-red">Active Machine Information</div>
<div class="card-body">
<div class="row vertical-align-custom">
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3" id="table-machine-ip">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
</div>
</div>
</div>
<div id="task-list">
<div id="room-task-detail" class="mb-3"><span id="progress-bar" style="display: block;"><div class="progress"><div class="progress-bar bg-secondary" role="progressbar" style="width: 5%; aria-valuemin=" 0"="" aria-valuemax="100"> 0%</div></div></span></div>
<div id="taskContent"><div class="card" id="task-1">
                    <div class="card-header task-header collapsed" data-toggle="collapse" href="#collapse1" aria-expanded="false">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 1                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Introduction
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse1" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p>Sysmon, a tool used to monitor and log events on Windows, is commonly used by enterprises as part of their monitoring and logging solutions. Part of the Windows Sysinternals package, Sysmon is similar to Windows Event Logs with further detail and granular control.</p><p style="text-align:center"><img src="./TryHackMe _ Sysmon_files/ms-securitylogostackedc-grayrgb-hero-copy-small-1.png" alt="Microsoft Security logo" style="width:50%"></p><p style="text-align:center">This room uses a modified version of the <a href="https://tryhackme.com/room/blue" target="_blank">Blue</a> and <a href="https://tryhackme.com/room/ice" target="_blank">Ice</a> boxes, as well as Sysmon logs from the Hololive network lab.</p><p style="text-align:center"><i>Before completing this room we recommend completing the <a href="https://tryhackme.com/room/windowseventlogs" target="_blank">Windows Event Log</a> room. It is also recommended to complete the Blue and Ice rooms to get an understanding of vulnerabilities present however is not required to continue.</i></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Complete the prerequisites listed above and jump into task 2.
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="1">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-2">
                    <div class="card-header task-header collapsed" data-toggle="collapse" href="#collapse2" aria-expanded="false">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 2                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Sysmon Overview
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse2" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span style="font-size:24px">Sysmon Overview&nbsp;</span></p><p><span>From the Microsoft Docs, "System Monitor (Sysmon) is a Windows system service and device driver that, once installed on a system, remains resident across system reboots to monitor and log system activity to the Windows event log. It provides detailed information about process creations, network connections, and changes to file creation time. By collecting the events it generates using Windows Event Collection or <a class="CCKLUXJA glossary-term" onclick="initPopOver(&#39;SIEM&#39;, &#39;CCKLUXJA&#39;)">SIEM</a> agents and subsequently analyzing them, you can identify malicious or anomalous activity and understand how intruders and malware operate on your network."</span></p><p><span>Sysmon gathers detailed and high-quality logs as well as event tracing that assists in identifying anomalies in your environment. Sysmon is most commonly used in conjunction with security information and event management (<a class="oZrqkEQZ glossary-term" onclick="initPopOver(&#39;SIEM&#39;, &#39;oZrqkEQZ&#39;)">SIEM</a>) system or other log parsing solutions that aggregate, filter, and visualize events.&nbsp;When installed on an endpoint, Sysmon will start early in the Windows boot process. In an ideal scenario, the events would be forwarded to a SIEM for further analysis. However, in this room, we will focus on Sysmon itself and view the events on the endpoint itself with Windows Event Viewer.</span></p><p>Events within Sysmon are stored in <code><i>Applications and Services Logs/Microsoft/Windows/Sysmon/Operational</i></code></p><p><span style="font-size:24px">Sysmon Config Overview</span></p><p>Sysmon requires a config file in order to tell the binary how to analyze the events that it is receiving. You can create your own Sysmon config or you can download a config. Here is an example of a high-quality config that works well for identifying anomalies created by SwiftOnSecurity: <a href="https://github.com/SwiftOnSecurity/sysmon-config" target="_blank">Sysmon-Config.</a>&nbsp;Sysmon includes 29 different types of Event IDs, all of which can be used within the config to specify how the events should be handled and analyzed. Below we will go over a few of the most important Event IDs and show examples of how they are used within config files.</p><p><span>When creating or modifying configuration files you will notice that a majority of rules in sysmon-config will exclude events rather than include events.&nbsp;This will help filter out normal activity in your environment that will in turn decrease the number of events and alerts you will have to manually audit or search through in a <a class="enFEixm1 glossary-term" onclick="initPopOver(&#39;SIEM&#39;, &#39;enFEixm1&#39;)">SIEM</a>. On the other hand, there are rulesets like the ION-Storm sysmon-config fork that takes a more proactive approach with it's ruleset by using a lot of include rules.&nbsp;You may have to modify configuration files to find what approach you prefer. Configuration preferences will vary depending on what SOC team so prepare to be flexible when monitoring.</span></p><p><i>Note: As there are so many Event IDs Sysmon analyzes. we will only be going over a few of the ones that we think are most important to understand.</i></p><p><span style="font-size:24px">Event ID 1: Process Creation</span></p><p><span>This event will look for any processes that have been created. You can use this to look for known suspicious processes or processes with typos that would be considered an anomaly. This event will use the CommandLine and Image <a class="yb8exxds glossary-term" onclick="initPopOver(&#39;XML&#39;, &#39;yb8exxds&#39;)">XML</a> tags.</span></p><p><code>&lt;RuleGroup name="" groupRelation="or"&gt;<br><span style="white-space:pre">	</span>&lt;ProcessCreate onmatch="exclude"&gt;<br><span style="white-space:pre">	</span>&nbsp;<span style="white-space:pre">	</span>&lt;CommandLine condition="is"&gt;C:\Windows\system32\svchost.exe -k appmodel -p -s camsvc&lt;/CommandLine&gt;<br><span style="white-space:pre">	</span>&lt;/ProcessCreate&gt;<br>&lt;/RuleGroup&gt;</code></p><p>The above code snippet is specifying the Event ID to pull from as well as what condition to look for. In this case, it is excluding the svchost.exe process from the event logs.</p><p><span style="font-size:24px">Event ID 3: Network Connection</span></p><p><span>The network connection event will look for events that occur remotely. This will include files and sources of suspicious binaries as well as opened ports. This event will use the Image and DestinationPort <a class="dDHTfJTR glossary-term" onclick="initPopOver(&#39;XML&#39;, &#39;dDHTfJTR&#39;)">XML</a> tags.&nbsp;</span></p><p><code>&lt;RuleGroup name="" groupRelation="or"&gt;<br><span style="white-space:pre">	</span>&lt;NetworkConnect onmatch="include"&gt;<br><span style="white-space:pre">	</span>&nbsp;<span style="white-space:pre">	</span>&lt;Image condition="image"&gt;nmap.exe&lt;/Image&gt;<br><span style="white-space:pre">	</span>&nbsp;<span style="white-space:pre">	</span>&lt;DestinationPort name="Alert,Metasploit" condition="is"&gt;4444&lt;/DestinationPort&gt;<br><span style="white-space:pre">	</span>&lt;/NetworkConnect&gt;<br>&lt;/RuleGroup&gt;</code></p><p><span>The above code snippet includes two ways to identify suspicious network connection activity. The first way will identify files transmitted over open ports. In this case, we are specifically looking for nmap.exe which will then be reflected within the event logs. The second method identifies open ports and specifically port 4444 which is commonly used with Metasploit. If the condition is met an event will be created and ideally trigger an alert for the <a class="4JQWLe7K glossary-term" onclick="initPopOver(&#39;SOC&#39;, &#39;4JQWLe7K&#39;)">SOC</a> to further investigate.</span></p><p><span style="font-size:24px">Event ID 7: Image Loaded</span></p><p><span>This event will look for <a class="xpULQsAq glossary-term" onclick="initPopOver(&#39;DLL&#39;, &#39;xpULQsAq&#39;)">DLL</a>s loaded by processes, which is useful when hunting for DLL Injection and DLL Hijacking attacks. It is recommended to exercise caution when using this Event ID as it causes a high system load. This event will use the Image, Signed, ImageLoaded, and Signature XML tags.&nbsp;</span></p><p><code>&lt;RuleGroup name="" groupRelation="or"&gt;<br><span style="white-space:pre">	</span>&lt;ImageLoad onmatch="include"&gt;<br><span style="white-space:pre">	</span>&nbsp;<span style="white-space:pre">	</span>&lt;ImageLoaded condition="contains"&gt;\Temp\&lt;/ImageLoaded&gt;<br><span style="white-space:pre">	</span>&lt;/ImageLoad&gt;<br>&lt;/RuleGroup&gt;<br></code><br></p><p><span>The above code snippet will look for any <a class="U0EumNkT glossary-term" onclick="initPopOver(&#39;DLL&#39;, &#39;U0EumNkT&#39;)">DLL</a>s that have been loaded within the \Temp\ directory. If a DLL is loaded within this directory it can be considered an anomaly and should be further investigateded.&nbsp;</span></p><p><span style="font-size:24px">Event ID 8: CreateRemoteThread</span></p><p><span>The CreateRemoteThread Event ID will monitor for processes injecting code into other processes.&nbsp;The CreateRemoteThread function is used for legitimate tasks and applications. However, it could be used by malware to hide malicious activity. This event will use the SourceImage, TargetImage, StartAddress, and StartFunction <a class="EPrUyV6d glossary-term" onclick="initPopOver(&#39;XML&#39;, &#39;EPrUyV6d&#39;)">XML</a> tags.</span></p><p><code>&lt;RuleGroup name="" groupRelation="or"&gt;<br><span style="white-space:pre">	</span>&lt;CreateRemoteThread onmatch="include"&gt;<br><span style="white-space:pre">	</span>&nbsp;<span style="white-space:pre">	</span>&lt;StartAddress name="Alert,Cobalt Strike"  condition="end with"&gt;0B80&lt;/StartAddress&gt;<br><span style="white-space:pre">	</span>&nbsp;<span style="white-space:pre">	</span>&lt;SourceImage condition="contains"&gt;\&lt;/SourceImage&gt;<br><span style="white-space:pre">	</span>&lt;/CreateRemoteThread&gt;<br>&lt;/RuleGroup&gt;<br></code><br></p><p>The above code snippet shows two ways of monitoring for CreateRemoteThread. The first method will look at the memory address for a specific ending condition which could be an indicator of a Cobalt Strike beacon. The second method will look for injected processes that do not have a parent process. This should be considered an anomaly and require further investigation.&nbsp;</p><p><span style="font-size:24px">Event ID 11: File Created</span></p><p><span>This event ID is will log events when files are created or overwritten the endpoint. This could be used to identify file names and signatures of files that are written to disk. This event uses TargetFilename <a class="6SDh8zfL glossary-term" onclick="initPopOver(&#39;XML&#39;, &#39;6SDh8zfL&#39;)">XML</a> tags.</span><br></p><p><code>&lt;RuleGroup name="" groupRelation="or"&gt;<br><span style="white-space:pre">	</span>&lt;FileCreate onmatch="include"&gt;<br><span style="white-space:pre">	</span>&nbsp;<span style="white-space:pre"><b>	</b></span><span style="white-space:pre;font-family:Ubuntu">&lt;TargetFilename name="Alert,Ransomware" condition="contains"&gt;HELP_TO_SAVE_FILES&lt;/TargetFilename&gt;</span><br><span style="white-space:pre">	</span>&lt;/FileCreate&gt;<br>&lt;/RuleGroup&gt;&nbsp;</code><br></p><p>The above code snippet is an example of a ransomware event monitor. This is just one example of a variety of different ways you can utilize Event ID 11.</p><p><span style="font-size:24px">Event ID 12 / 13 / 14: Registry Event</span></p><p><span>This event looks for changes or modifications to the registry. Malicious activity from the registry can include persistence and credential abuse. This event uses TargetObject <a class="swhwIyKz glossary-term" onclick="initPopOver(&#39;XML&#39;, &#39;swhwIyKz&#39;)">XML</a> tags.</span><br></p><p><code>&lt;RuleGroup name="" groupRelation="or"&gt;<br><span style="white-space:pre">	</span>&lt;RegistryEvent onmatch="include"&gt;<br><span style="white-space:pre">	</span>&nbsp;<span style="white-space:pre">	</span>&lt;TargetObject name="T1484" condition="contains"&gt;Windows\System\Scripts&lt;/TargetObject&gt;<br><span style="white-space:pre">	</span>&lt;/RegistryEvent&gt;<br>&lt;/RuleGroup&gt;</code><br></p><p>The above code snippet will look for registry objects that are in the <i>"Windows\System\Scripts"</i> directory as this is a common directory for adversaries to place scripts to establish persistence.</p><p><span style="font-size:24px">Event ID 15: FileCreateStreamHash</span></p><p><span>This event will look for any files created in an alternate data stream. This is a common technique used by adversaries to hide malware. This event uses TargetFilename <a class="LJv3YWni glossary-term" onclick="initPopOver(&#39;XML&#39;, &#39;LJv3YWni&#39;)">XML</a> tags.</span></p><p><code>&lt;RuleGroup name="" groupRelation="or"&gt;<br><span style="white-space:pre">	</span>&lt;FileCreateStreamHash onmatch="include"&gt;<br><span style="white-space:pre">	</span>&nbsp;<span style="white-space:pre">	</span>&lt;TargetFilename condition="end with"&gt;.hta&lt;/TargetFilename&gt;<br><span style="white-space:pre">	</span>&lt;/FileCreateStreamHash&gt;<br>&lt;/RuleGroup&gt;&nbsp;</code><br></p><p>The above code snippet will look for files with the .hta extension that have been placed within an alternate data stream.</p><p><span style="font-size:24px"><span>Event ID 22: <a class="hQ5oGScH glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;hQ5oGScH&#39;)">DNS</a> Event</span></span></p><p><span>This event will log all <a class="C0HMquE6 glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;C0HMquE6&#39;)">DNS</a> queries and events for analysis. The most common way to deal with these events is to exclude all trusted domains that you know will be very common "noise" in your environment. Once you get rid of the noise you can then look for DNS anomalies. This event uses QueryName XML tags.&nbsp;</span></p><p><code>&lt;RuleGroup name="" groupRelation="or"&gt;<br><span style="white-space:pre">	</span>&lt;DnsQuery onmatch="exclude"&gt;<br><span style="white-space:pre">	</span>&nbsp;<span style="white-space:pre">	</span>&lt;QueryName condition="end with"&gt;.microsoft.com&lt;/QueryName&gt;<br><span style="white-space:pre">	</span>&lt;/DnsQuery&gt;<br>&lt;/RuleGroup&gt;&nbsp;<br></code></p><p><span>The above code snippet will get exclude any <a class="o0fYHbV9 glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;o0fYHbV9&#39;)">DNS</a> events with the .microsoft.com query. This will get rid of the noise that you see within the environment.&nbsp;&nbsp;</span></p><p>There are a variety of ways and tags that you can use to customize your configuration files. We will be using the ION-Storm and SwiftOnSecurity config files for the rest of this room however feel free to use your own configuration files.&nbsp;</p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Read the above and become familiar with the Sysmon Event IDs.
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-3">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse3">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 3                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Installing and Preparing Sysmon
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-server text-lgreen" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a deployable machine"></i></span>
                        </a>
                    </div>
                    <div id="collapse3" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><div class="btn-group mb-3 ml-3 float-right">
            <button type="button" class="btn btn-success" value="5ffb0e03253b5f5084dac406" onclick="deploy(this)"><i class="fas fa-play mr-2"></i> Start Machine</button>
        </div> <p><span style="font-size:24px">Installing Sysmon</span><br></p><p><span>The installation for Sysmon is fairly straightforward and only requires downloading the binary from the Microsoft website. You can also download all of the Sysinternals tools with a <a class="iyPJoa9K glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;iyPJoa9K&#39;)">PowerShell</a> command if you wanted to rather than grabbing a single binary. It is also recommended to use a Sysmon config file along with Sysmon to get more detailed and high-quality event tracing. As an example config file we will be using the sysmon-config file from the SwiftOnSecurity GitHub repo.&nbsp;</span></p><p>You can find the Sysmon binary from the <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon" target="_blank">Microsoft Sysinternals</a> website. You can also download the <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite" target="_blank">Microsoft Sysinternal Suite</a><span> or use the below command to run a <a class="3tbi0pQG glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;3tbi0pQG&#39;)">PowerShell</a> module download and install all of the Sysinternals tools.&nbsp;</span></p><p><span><a class="TDKyRFcy glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;TDKyRFcy&#39;)">PowerShell</a> command: </span><code>Download-SysInternalsTools C:\Sysinternals</code></p><p>To fully utilize Sysmon you will also need to download a Sysmon config or create your own config. We suggest downloading the <a href="https://github.com/SwiftOnSecurity/sysmon-config" target="_blank">SwiftOnSecurity sysmon-config</a>. A Sysmon config will allow for further granular control over the logs as well as more detailed event tracing. In this room, we will be using both the SwiftOnSecurity configuration file as well as the <a href="https://github.com/ion-storm/sysmon-config/blob/develop/sysmonconfig-export.xml" target="_blank">ION-Storm config file</a>.&nbsp;</p><p><span style="font-size:24px">Starting Sysmon</span></p><p><span>To start Sysmon you will want to open a new <a class="1YJW0CKQ glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;1YJW0CKQ&#39;)">PowerShell</a> or Command Prompt as an Administrator. Then, run the below command it will execute the Sysmon binary, accept the end-user license agreement, and use SwiftOnSecurity config file.&nbsp;</span></p><p>Command Used: <code>Sysmon.exe -accepteula -i ..\Configuration\swift.xml</code></p>
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Sysmon Installation
        </div>
        <pre class="terminal-code language-powershell" tabindex="0">           <code class=" language-powershell">C:\Users\THM<span class="token operator">-</span>Analyst\Desktop\Tools\Sysmon&gt;Sysmon<span class="token punctuation">.</span>exe <span class="token operator">-</span>accepteula <span class="token operator">-</span>i <span class="token punctuation">.</span><span class="token punctuation">.</span>\Configuration\swift<span class="token punctuation">.</span>xml

System Monitor v12<span class="token punctuation">.</span>03 <span class="token operator">-</span> System activity monitor
Copyright <span class="token punctuation">(</span>C<span class="token punctuation">)</span> 2014<span class="token operator">-</span>2020 Mark Russinovich and Thomas Garnier
Sysinternals <span class="token operator">-</span> www<span class="token punctuation">.</span>sysinternals<span class="token punctuation">.</span>com

Loading configuration file with schema version 4<span class="token punctuation">.</span>10
Sysmon schema version: 4<span class="token punctuation">.</span>40
Configuration file validated<span class="token punctuation">.</span>
Sysmon installed<span class="token punctuation">.</span>
SysmonDrv installed<span class="token punctuation">.</span>
Starting SysmonDrv<span class="token punctuation">.</span>
SysmonDrv started<span class="token punctuation">.</span>
Starting Sysmon<span class="token punctuation">.</span><span class="token punctuation">.</span></code>
        </pre></div></div><p>Now that Sysmon is started with the configuration file we want to use, we can look at the Event Viewer to monitor events. The event log is located under&nbsp;<code><i>Applications and Services Logs/Microsoft/Windows/Sysmon/Operational</i></code></p><p><i>Note: At any time you can change the configuration file used by uninstalling or updating the current configuration and replacing it with a new configuration file. For more information look through the Sysmon help menu.&nbsp;</i></p><p>If installed correctly your event log should look similar to the following:</p><p style="text-align:center"><img src="https://i.imgur.com/HtS0AOx.png" alt="Windows event log viewer showing 10 logs from Sysmon" style="width:1042px"></p><p>For this room, we have already created an environment with Sysmon and configuration files for you. Deploy and use this machine for the remainder of this room.&nbsp;</p><p style="text-align:center">Machine IP: <code>MACHINE_IP</code></p><p style="text-align:center">User: <code>THM-Analyst</code></p><p style="text-align:center">Pass:&nbsp;<code>5TgcYzF84tcBSuL1Boa%dzcvf</code></p><p style="text-align:left"><span>The machine will start in a split-screen view. In case the <a class="LOHsssPy glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;LOHsssPy&#39;)">VM</a> is not visible, use the blue Show Split View button at the top-right of the page.</span><br></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <div><span style="font-size:1rem">Deploy the machine and start Sysmon.&nbsp;</span><br></div>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-4">
                    <div class="card-header task-header collapsed" data-toggle="collapse" href="#collapse4" aria-expanded="false">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 4                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Cutting out the Noise
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-download text-lblue" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a downloadable file"></i></span>
                        </a>
                    </div>
                    <div id="collapse4" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><form class="float-right" method="post" action="https://tryhackme.com/material/deploy">
                            <input type="hidden" name="roomCode" value="sysmon">
                            <input type="hidden" name="id" value="5ffa15c7b2ffe72ebef2ffb0">
                            <button type="submit" class="btn btn-primary mb-3 ml-3" value="Download">
                            <i class="fas fa-cloud-download-alt mr-2"></i> Download Task Files</button>
                        </form> <p><span style="font-size:24px">﻿Malicious Activity Overview</span></p><p><span>Since most of the normal activity or "noise" seen on a network is excluded or filtered out with Sysmon we're able to focus on meaningful events. This allows us to quickly identify and investigate suspicious activity.&nbsp;When actively monitoring a network you will want to use multiple detections and techniques simultaneously in an effort to identify threats. For this room, we will only be looking at what suspicious logs will look like with both Sysmon configs and how to optimize your hunt using only Sysmon. We will be looking at how to detect ransomware, persistence, Mimikatz, Metasploit, and Command and Control (<a class="REi2oFtQ glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;REi2oFtQ&#39;)">C2</a>) beacons.&nbsp;Obviously, this is only showcasing a small handful of events that could be triggered in an environment. The methodology will largely be the same for other threats. It really comes down to using an ample and efficient configuration file as it can do a lot of the heavy lifting for you.</span></p><p>You can either download the event logs used for this task or you can open them from the Practice directory on the provided machine.</p><p style="margin-bottom:1rem"><span style="font-size:24px">Sysmon "Best Practices"</span></p><p style="margin-bottom:1rem">Sysmon offers a fairly open and configurable platform for you to use. Generally speaking, there are a few best practices that you could implement to ensure you're operating efficiently and not missing any potential threats. A few common best practices are outlined and explained below.<br></p><ul><li style="margin-bottom:1rem">Exclude &gt; Include</li></ul><p style="margin-bottom:1rem"><span style="white-space:pre">	</span>When creating rules for your Sysmon configuration file it is typically best to prioritize excluding events rather than including events. This prevents you from accidentally missing crucial events and only seeing the events that matter the most.<br></p><ul><li style="margin-bottom:1rem">CLI gives you further control</li></ul><p style="margin-bottom:1rem"><span style="white-space:pre">	</span>As is common with most applications the CLI gives you the most control and filtering allowing for further granular control. You can use either <code>Get-WinEvent</code> or <code>wevutil.exe</code><span> to access and filter logs. As you incorporate Sysmon into your <a class="fWjmdRW3 glossary-term" onclick="initPopOver(&#39;SIEM&#39;, &#39;fWjmdRW3&#39;)">SIEM</a> or other detection solutions these tools will become less used and needed.&nbsp;</span><br></p><ul><li style="margin-bottom:1rem">Know your environment before implementation</li></ul><p style="margin-bottom:1rem"><span style="white-space:pre">	</span><span style="font-size:1rem">Knowing your environment is important when implementing any platform or tool. You should have a firm understanding of the network or environment you are working within to fully understand what is normal and what is suspicious in order to effectively craft your rules.</span></p><p style="margin-bottom:1rem"><span style="font-size:24px">Filtering Events with Event Viewer</span></p><p style="margin-bottom:1rem">Event Viewer might not the best for filtering events and out-of-the-box offers limited control over logs. The main filter you will be using with Event Viewer is by filtering the <code>EventID</code><span> and keywords. You can also choose to filter by writing <a class="aQ3YERum glossary-term" onclick="initPopOver(&#39;XML&#39;, &#39;aQ3YERum&#39;)">XML</a> but this is a tedious process that doesn't scale well.</span><br></p><p style="margin-bottom:1rem">To open the filter menu select <code>Filter Current Log</code> from the Actions menu.&nbsp;</p><p style="margin-bottom:1rem"><img src="https://i.imgur.com/deaX35W.png" alt="Screenshot of the windows event log viewer actions menu" style="width:292px"></p><p style="margin-bottom:1rem">If you have successfully opened the filter menu it should look like the menu below.</p><p style="margin-bottom:1rem"><img src="https://i.imgur.com/lJxPHBM.png" alt="screenshot of Windows event log viewer filter menu" style="width:541px"></p><p style="margin-bottom:1rem">From this menu, we can add any filters or categories that we want.</p><p style="margin-bottom:1rem"><span style="font-size:24px"><span>Filtering Events with <a class="Y78o3A3v glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;Y78o3A3v&#39;)">PowerShell</a></span></span></p><p style="margin-bottom:1rem"><span>To view and filter events with <a class="B2Qqztf5 glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;B2Qqztf5&#39;)">PowerShell</a> we will be using </span><code>Get-WinEvent</code> along with <code>XPath</code><span> queries. We can use any XPath queries that can be found in the <a class="jpBFh3bF glossary-term" onclick="initPopOver(&#39;XML&#39;, &#39;jpBFh3bF&#39;)">XML</a> view of events.&nbsp;We will be using </span><code>wevutil.exe</code>&nbsp;to view events once filtered. The command line is typically used over the Event Viewer GUI as it allows for further granular control and filtering whereas the GUI does not. For more information about using <code>Get-WinEvent </code>and <code>wevutil.exe</code> check out the <a href="https://tryhackme.com/room/windowseventlogs" target="_blank">Windows Event Log </a>room.</p><p style="margin-bottom:1rem">For this room, we will only be going over a few basic filters as the Windows Event Log room already extensively covers this topic.</p><p style="margin-bottom:1rem">Filter by Event ID: <code>*/System/EventID=&lt;ID&gt;</code></p><p style="margin-bottom:1rem"><span style="font-size:1rem"><span>Filter by <a class="xWiy6XtC glossary-term" onclick="initPopOver(&#39;XML&#39;, &#39;xWiy6XtC&#39;)">XML</a> Attribute/Name: </span></span><code>*/EventData/Data[@Name="&lt;XML Attribute/Name&gt;"]</code></p><p style="margin-bottom:1rem">Filter by Event Data: <code>*/EventData/Data=&lt;Data&gt;</code></p><p style="margin-bottom:1rem">We can put these filters together with various attributes and data to get the most control out of our logs. Look below for an example of using <code>Get-WinEvent</code> to look for network connections coming from port 4444.</p><p style="margin-bottom:1rem"><code>Get-WinEvent -Path &lt;Path to Log&gt;&nbsp;-FilterXPath '*/System/EventID=3 and */EventData/Data[@Name="DestinationPort"] and */EventData/Data=4444'</code></p><p style="margin-bottom:1rem"></p>

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Filtering Events
        </div>
        <pre class="terminal-code language-powershell" tabindex="0">           <code class=" language-powershell"><span class="token function">PS</span> C:\Users\THM<span class="token operator">-</span>Analyst&gt; <span class="token function">Get-WinEvent</span> <span class="token operator">-</span>Path C:\Users\THM<span class="token operator">-</span>Analyst\Desktop\Scenarios\Practice\Hunting_Metasploit<span class="token punctuation">.</span>evtx <span class="token operator">-</span>FilterXPath <span class="token string">'*/System/EventID=3 and */EventData/Data[@Name="DestinationPort"] and */EventData/Data=4444'</span>


   ProviderName: Microsoft<span class="token operator">-</span>Windows<span class="token operator">-</span>Sysmon

TimeCreated                     Id LevelDisplayName Message
<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>                     <span class="token operator">--</span> <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span> <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>
1<span class="token operator">/</span>5<span class="token operator">/</span>2021 2:21:32 AM              3 Information      Network connection detected:<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code>
        </pre></div></div></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Read the above and practice filtering events.
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>How many event ID 3 events are in C:\Users\THM-Analyst\Desktop\Scenarios\Practice\Filtering.evtx?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **,***" value="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span>What is the <a class="VVgmjw7h glossary-term" onclick="initPopOver(&#39;UTC&#39;, &#39;VVgmjw7h&#39;)">UTC</a> time created of the first network event in&nbsp;</span><span style="font-size:1rem">C:\Users\THM-Analyst\Desktop\Scenarios\Practice\Filtering.evtx?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ********** **:**:**.***" value="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-5">
                    <div class="card-header task-header collapsed" data-toggle="collapse" href="#collapse5" aria-expanded="false">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 5                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Hunting Metasploit
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-download text-lblue" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a downloadable file"></i></span>
                        </a>
                    </div>
                    <div id="collapse5" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><form class="float-right" method="post" action="https://tryhackme.com/material/deploy">
                            <input type="hidden" name="roomCode" value="sysmon">
                            <input type="hidden" name="id" value="5ff3d276238b1f58acb30dd8">
                            <button type="submit" class="btn btn-primary mb-3 ml-3" value="Download">
                            <i class="fas fa-cloud-download-alt mr-2"></i> Download Task Files</button>
                        </form> <p><span style="font-size:24px">Hunting Metasploit</span></p><p style="margin-bottom:1rem">Metasploit is a commonly used exploit framework for penetration testing and red team operations. Metasploit can be used to easily run exploits on a machine and connect back to a meterpreter shell. We will be hunting the meterpreter shell itself and the functionality it uses. To begin hunting we will look for network connections that originate from suspicious ports such as <code>4444</code>&nbsp;and <code>5555</code><span>. By default, Metasploit uses port 4444. If there is a connection to any IP known or unknown it should be investigated. To start an investigation you can look at packet captures from the date of the log to begin looking for further information about the adversary. We can also look for suspicious processes created. This method of hunting can be applied to other various RATs and <a class="FFGlFCxD glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;FFGlFCxD&#39;)">C2</a> beacons.</span></p><p style="margin-bottom:1rem">For more information about this technique and tools used check out <a href="https://attack.mitre.org/software/" target="_blank">MITRE ATT&amp;CK Software</a>.&nbsp;</p><p style="margin-bottom:1rem">For more information about how malware and payloads interact with the network check out the <a href="https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo" target="_blank">Malware Common Ports Spreadsheet</a>. This will be covered in further depth in the Hunting Malware task.</p><p style="margin-bottom:1rem">You can download the event logs used in this room from this task or you can open them in the Practice folder on the provided machine.</p><p style="margin-bottom:1rem"><span style="font-size:24px">Hunting Network Connections</span></p><p style="margin-bottom:1rem">We will first be looking at a modified Ion-Security configuration to detect the creation of new network connections. The code snippet below will use event ID 3 along with the destination port to identify active connections specifically connections on port <code>4444</code>&nbsp;and <code>5555</code>.&nbsp;</p><p style="margin-bottom:1rem"><code>&lt;RuleGroup name="" groupRelation="or"&gt;<br><span style="color:rgb(255, 255, 255);white-space:pre">	</span>&lt;NetworkConnect onmatch="include"&gt;<br><span style="color:rgb(255, 255, 255);white-space:pre">	</span><span style="color:rgb(255, 255, 255);white-space:pre">	</span>&lt;DestinationPort condition="is"&gt;4444&lt;/DestinationPort&gt;<br><span style="color:rgb(255, 255, 255);white-space:pre">	</span><span style="color:rgb(255, 255, 255);white-space:pre">	</span>&lt;DestinationPort condition="is"&gt;5555&lt;/DestinationPort&gt;<br><span style="color:rgb(255, 255, 255);white-space:pre">	</span>&lt;/NetworkConnect&gt;<br>&lt;/RuleGroup&gt;<br></code><br></p><p style="margin-bottom:1rem">Open <code>C:\Users\THM-Analyst\Desktop\Scenarios\Practice\Hunting_Metasploit.evtx</code> in Event Viewer to view a basic Metasploit payload being dropped onto the machine.</p><p style="margin-bottom:1rem"><img src="https://i.imgur.com/1VkrpJ3.png" alt="Screenshot of Windows event log viewer showing details of a suspicious tcp log" style="width:517px"><br></p><p style="margin-bottom:1rem">Once we identify the event it can give us some important information we can use for further investigation like the <code>ProcessID</code> and <code>Image</code>.</p><p style="margin-bottom:1rem"><span style="font-size:24px"><span>Hunting for Open Ports with <a class="j2kuEH67 glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;j2kuEH67&#39;)">PowerShell</a></span></span></p><p style="margin-bottom:1rem"><span>To hunt for open ports with <a class="juTvmZGP glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;juTvmZGP&#39;)">PowerShell</a> we will be using the PowerShell module </span><code>Get-WinEvent</code> along with <code>XPath</code> queries. We can use the same&nbsp; XPath queries that we used in the rule to filter out events from <code>NetworkConnect</code> with <code>DestinationPort</code>. The command line is typically used over the Event Viewer GUI because it can allow for further granular control and filtering that the GUI does not offer. For more information about using XPath and the command line for event viewing, check out the <a href="https://tryhackme.com/room/windowseventlogs" target="_blank">Windows Event Log</a> room by Heavenraiza.</p><p style="margin-bottom:1rem"><code>Get-WinEvent -Path &lt;Path to Log&gt; -FilterXPath '*/System/EventID=3 and */EventData/Data[@Name="DestinationPort"] and */EventData/Data=4444'</code></p>




<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">Hunting Metasploit</div>
        <pre class="terminal-code language-powershell" tabindex="0">           <code class=" language-powershell"><span class="token function">PS</span> C:\Users\THM<span class="token operator">-</span>Analyst&gt; <span class="token function">Get-WinEvent</span> <span class="token operator">-</span>Path C:\Users\THM<span class="token operator">-</span>Analyst\Desktop\Scenarios\Practice\Hunting_Metasploit<span class="token punctuation">.</span>evtx <span class="token operator">-</span>FilterXPath <span class="token string">'*/System/EventID=3 and */EventData/Data[@Name="DestinationPort"] and */EventData/Data=4444'</span>


   ProviderName: Microsoft<span class="token operator">-</span>Windows<span class="token operator">-</span>Sysmon

TimeCreated                     Id LevelDisplayName Message
<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>                     <span class="token operator">--</span> <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span> <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>
1<span class="token operator">/</span>5<span class="token operator">/</span>2021 2:21:32 AM              3 Information      Network connection detected:<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code>
        </pre></div></div>

<p style="margin-bottom:1rem"><span style="font-size:1rem">We can break this command down by its filters to see exactly what it is doing. It is first filtering by Event ID 3 which is the network connection ID. It is then filtering by the data name in this case DestinationPort as well as the specific port that we want to filter. We can adjust this syntax along with our events to get exactly what data we want in return.</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Read the above and practice hunting Metasploit with the provided event file.
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-6">
                    <div class="card-header task-header collapsed" data-toggle="collapse" href="#collapse6" aria-expanded="false">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 6                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Detecting Mimikatz
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-download text-lblue" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a downloadable file"></i></span>
                        </a>
                    </div>
                    <div id="collapse6" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><form class="float-right" method="post" action="https://tryhackme.com/material/deploy">
                            <input type="hidden" name="roomCode" value="sysmon">
                            <input type="hidden" name="id" value="5ff3e109a394d558c3391e51">
                            <button type="submit" class="btn btn-primary mb-3 ml-3" value="Download">
                            <i class="fas fa-cloud-download-alt mr-2"></i> Download Task Files</button>
                        </form> <p><span style="font-size:24px">Detecting Mimikatz Overview</span></p><p style="margin-bottom:1rem">Mimikatz is well known and commonly used to dump credentials from memory along with other Windows post-exploitation activity. Mimikatz is mainly known for dumping LSASS. We can hunt for the file created, execution of the file from an elevated process, creation of a remote thread, and processes that Mimikatz creates. Anti-Virus will typically pick up Mimikatz as the signature is very well known but it is still possible for threat actors to obfuscate or use droppers to get the file onto the device. For this hunt, we will be using a custom configuration file to minimize network noise and focus on the hunt.&nbsp;</p><p style="margin-bottom:1rem"><span>For more information about this technique and the software used check out <a class="FlODrs7d glossary-term" onclick="initPopOver(&#39;MITRE&#39;, &#39;FlODrs7d&#39;)">MITRE</a> ATTACK </span><a href="https://attack.mitre.org/techniques/T1055/" target="_blank">T1055</a> and <a href="https://attack.mitre.org/software/S0002/" target="_blank">S0002</a>.</p><p style="margin-bottom:1rem">You can download the event logs used in this room from this task or you can open them in the Practice folder on the provided machine.</p><p style="margin-bottom:1rem"><span style="font-size:24px">Detecting File Creation</span></p><p style="margin-bottom:1rem"><span>The first method of hunting for Mimikatz is just looking for files created with the name Mimikatz. This is a simple technique but can allow you to find anything that might have bypassed <a class="p7ZlJ35C glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;p7ZlJ35C&#39;)">AV</a>. Most of the time when dealing with an advanced threat you will need more advanced hunting techniques like searching for LSASS behavior but this technique can still be useful.&nbsp;</span></p><p style="margin-bottom:1rem">This is a very simple way of detecting Mimikatz activity that has bypassed anti-virus or other detection measures. But most of the time it is preferred to use other techniques like hunting for LSASS specific behavior. Below is a snippet of a config to aid in the hunt for Mimikatz.&nbsp;</p><p style="margin-bottom:1rem"><code>&lt;RuleGroup name="" groupRelation="or"&gt;<br><span style="white-space:pre">	</span>&lt;FileCreate onmatch="include"&gt;<br><span style="white-space:pre">	</span><span style="white-space:pre">	</span>&lt;TargetFileName condition="contains"&gt;mimikatz&lt;/TargetFileName&gt;<br><span style="white-space:pre">	</span>&lt;/FileCreate&gt;<br>&lt;/RuleGroup&gt;<br></code><br></p><p style="margin-bottom:1rem">As this method will not be commonly used to hunt for anomalies we will not be looking at any event logs for this specific technique.</p><p style="margin-bottom:1rem"><span style="font-size:24px">Hunting Abnormal LSASS Behavior</span></p><p style="margin-bottom:1rem">We can use the <i>ProcessAccess</i> event ID to hunt for abnormal LSASS behavior. This event along with LSASS would show potential LSASS abuse which usually connects back to Mimikatz some other kind of credential dumping tool. Look below for more detail on hunting with these techniques.</p><p style="margin-bottom:1rem">If LSASS is accessed by a process other than <i>svchost.exe</i> it should be considered suspicious behavior and should be investigated further, to aid in looking for suspicious events you can use a filter to only look for processes besides svchost.exe. Sysmon will provide us further details to help lead the investigation such as the file path the process originated from. To aid in detections we will be using a custom configuration file. Below is a snippet of the config that will aid in the hunt.</p><p style="margin-bottom:1rem"><code>&lt;RuleGroup name="" groupRelation="or"&gt;<br><span style="white-space:pre">	</span>&lt;ProcessAccess onmatch="include"&gt;<br><span style="white-space:pre">	</span>&nbsp; &nbsp; &nbsp; &nbsp;&lt;TargetImage condition="image"&gt;lsass.exe&lt;/TargetImage&gt;<br><span style="white-space:pre">	</span>&lt;/ProcessAccess&gt;<br>&lt;/RuleGroup&gt;<br></code></p><p style="margin-bottom:1rem"></p><p style="margin-bottom:1rem">Open <code>C:\Users\THM-Analyst\Desktop\Scenarios\Practice\Hunting_LSASS.evtx</code> in Event Viewer to view an attack using an obfuscated version of Mimikatz to dump credentials from memory.</p><p style="margin-bottom:1rem"></p><p style="margin-bottom:1rem"><img src="https://i.imgur.com/S0T3AHM.png" alt="screenshot of Windows event log viewer showing details of a mimikatz log"><br></p><p style="margin-bottom:1rem">We see the event that has the Mimikatz process accessed but we also see a lot of svchost.exe events? We can alter our config to exclude events with the <code>SourceImage</code>&nbsp;event coming from svhost.exe. Look below for a modified configuration rule to cut down on the noise that is present in the event logs.</p><p style="margin-bottom:1rem"><code>&lt;RuleGroup name="" groupRelation="or"&gt;<br><span style="white-space:pre">	</span>&lt;ProcessAccess onmatch="exclude"&gt;<br><span style="white-space:pre">	</span><span style="white-space:pre">	</span>&lt;SourceImage condition="image"&gt;svchost.exe&lt;/SourceImage&gt;<br><span style="white-space:pre">	</span>&lt;/ProcessAccess&gt;<br><span style="white-space:pre">	</span>&lt;ProcessAccess onmatch="include"&gt;<br><span style="white-space:pre">	</span><span style="white-space:pre">	</span>&lt;TargetImage condition="image"&gt;lsass.exe&lt;/TargetImage&gt;<br><span style="white-space:pre">	</span>&lt;/ProcessAccess&gt;<br>&lt;/RuleGroup&gt;<br></code>&nbsp;</p><p style="margin-bottom:1rem">By modifying the configuration file to include this exception we have cut down our events significantly and can focus on only the anomalies.&nbsp; This technique can be used throughout Sysmon and events to cut down on "noise" in logs.</p><p style="margin-bottom:1rem"><span style="font-size:24px"><span>Detecting LSASS Behavior with <a class="o95ozs5l glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;o95ozs5l&#39;)">PowerShell</a></span></span></p><p style="margin-bottom:1rem"><span>To detect abnormal LSASS behavior with <a class="Fr9cRHHv glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;Fr9cRHHv&#39;)">PowerShell</a> we will again be using the PowerShell module </span><code>Get-WinEvent</code> along with <code>XPath</code> queries. We can use the same XPath queries used in the rule to filter out the other processes from <code>TargetImage</code>. If we use this alongside a well-built configuration file with a precise rule it will do a lot of the heavy lifting for us and we only need to filter a small amount.</p><p style="margin-bottom:1rem"><code>Get-WinEvent -Path &lt;Path to Log&gt;&nbsp;-FilterXPath '*/System/EventID=10 and */EventData/Data[@Name="TargetImage"] and */EventData/Data="C:\Windows\system32\lsass.exe"'</code></p>

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">Hunting Mimikatz</div>
        <pre class="terminal-code language-powershell" tabindex="0">           <code class=" language-powershell">
<span class="token function">PS</span> C:\Users\THM<span class="token operator">-</span>Analyst&gt; <span class="token function">Get-WinEvent</span> <span class="token operator">-</span>Path C:\Users\THM<span class="token operator">-</span>Analyst\Desktop\Scenarios\Practice\Hunting_Mimikatz<span class="token punctuation">.</span>evtx <span class="token operator">-</span>FilterXPath <span class="token string">'*/System/EventID=10 and */EventData/Data[@Name="TargetImage"] and */EventData/Data="C:\Windows\system32\lsass.exe"'</span>

   ProviderName: Microsoft<span class="token operator">-</span>Windows<span class="token operator">-</span>Sysmon

TimeCreated                     Id LevelDisplayName Message
<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>                     <span class="token operator">--</span> <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span> <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>
1<span class="token operator">/</span>5<span class="token operator">/</span>2021 3:22:52 AM             10 Information      <span class="token keyword">Process</span> accessed:<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code>
        </pre></div></div></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Read the above and practice detecting Mimikatz with the provided evtx.</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-7">
                    <div class="card-header task-header collapsed" data-toggle="collapse" href="#collapse7" aria-expanded="false">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 7                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Hunting Malware
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-download text-lblue" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a downloadable file"></i></span>
                        </a>
                    </div>
                    <div id="collapse7" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><form class="float-right" method="post" action="https://tryhackme.com/material/deploy">
                            <input type="hidden" name="roomCode" value="sysmon">
                            <input type="hidden" name="id" value="5ff3f3b50ba6cf6bedd8b860">
                            <button type="submit" class="btn btn-primary mb-3 ml-3" value="Download">
                            <i class="fas fa-cloud-download-alt mr-2"></i> Download Task Files</button>
                        </form> <p><span>﻿</span><span style="font-size:24px">Hunting Malware Overview</span></p><p style="margin-bottom:1rem">Malware has many forms and variations with different end goals. The two types of malware that we will be focusing on are RATs and backdoors. RATs or Remote Access Trojans are used similar to any other payload to gain remote access to a machine. RATs typically come with other Anti-Virus and detection evasion techniques that make them different than other payloads like MSFVenom. A RAT typically also uses a Client-Server model and comes with an interface for easy user administration. Examples of RATs are <code>Xeexe</code> and <code>Quasar</code>. To help detect and hunt malware we will need to first identify the malware that we want to hunt or detect and identify ways that we can modify configuration files, this is known as hypothesis-based hunting. There are of course a plethora of other ways to detect and log malware however we will only be covering the basic way of detecting open back connect ports.&nbsp;</p><p style="margin-bottom:1rem">For more information about this technique and examples of malware check out <a href="https://attack.mitre.org/software/" target="_blank">MITRE ATT&amp;CK Software</a>.&nbsp;</p><p style="margin-bottom:1rem">You can download the event logs used in this room from this task or you can open them in the Practice folder on the provided machine.</p><p style="margin-bottom:1rem"><span style="font-size:24px"><span>Hunting Rats and <a class="lEyiGZDG glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;lEyiGZDG&#39;)">C2</a> Servers</span></span></p><p style="margin-bottom:1rem">The first technique we will use to hunt for malware is a similar process to hunting Metasploit. We can look through and create a configuration file to hunt and detect suspicious ports open on the endpoint. By using known suspicious ports to include in our logs we can add to our hunting methodology in which we can use logs to identify adversaries on our network then use packet captures or other detection strategies to continue the investigation. The code snippet below is from the Ion-Storm configuration file which will alert when specific ports like <code>1034</code> and <code>1604</code>&nbsp;as well as exclude common network connections like OneDrive, by excluding events we still see everything that we want without missing anything and cutting down on noise.&nbsp;</p><p style="margin-bottom:1rem">When using configuration files in a production environment you must be careful and understand exactly what is happening within the configuration file an example of this is the Ion-Storm configuration file excludes port 53 as an event. Attackers and adversaries have begun to use port 53 as part of their malware/payloads which would go undetected if you blindly used this configuration file as-is.</p><p style="margin-bottom:1rem">For more information about the ports that this configuration file alerts on check out this <a href="https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo" target="_blank">spreadsheet</a>.</p><p style="margin-bottom:1rem"><code>&lt;RuleGroup name="" groupRelation="or"&gt;<br><span style="color:rgb(255, 255, 255);white-space:pre">	</span>&lt;NetworkConnect onmatch="include"&gt;<br><span style="color:rgb(255, 255, 255);white-space:pre">	</span><span style="color:rgb(255, 255, 255);white-space:pre">	</span>&lt;DestinationPort condition="is"&gt;1034&lt;/DestinationPort&gt;<br><span style="color:rgb(255, 255, 255);white-space:pre">	</span><span style="color:rgb(255, 255, 255);white-space:pre">	</span>&lt;DestinationPort condition="is"&gt;1604&lt;/DestinationPort&gt;<br><span style="color:rgb(255, 255, 255);white-space:pre">	</span>&lt;/NetworkConnect&gt;<br><span style="color:rgb(255, 255, 255);white-space:pre">	</span>&lt;NetworkConnect onmatch="exclude"&gt;<br><span style="color:rgb(255, 255, 255);white-space:pre">	</span><span style="color:rgb(255, 255, 255);white-space:pre">	</span>&lt;Image condition="image"&gt;OneDrive.exe&lt;/Image&gt;<br><span style="color:rgb(255, 255, 255);white-space:pre">	</span>&lt;/NetworkConnect&gt;<br>&lt;/RuleGroup&gt;<br></code><br></p><p style="margin-bottom:1rem">Open <code>C:\Users\THM-Analyst\Desktop\Scenarios\Practice\Hunting_Rats.evtx</code> in Event Viewer to view a live rat being dropped onto the server.</p><p style="margin-bottom:1rem"><img src="https://i.imgur.com/h7NcexZ.png" alt="screenshot of Windows event log viewer showing details of a RAT log" style="width:535px"><br></p><p style="margin-bottom:1rem">In the above example, we are detecting a custom RAT that operates on port 8080. This is a perfect example of why you want to be careful when excluding events in order to not miss potential malicious activity.</p><p style="margin-bottom:1rem"><span style="font-size:24px"><span>Hunting for Common Back Connect Ports with <a class="zaWIof1T glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;zaWIof1T&#39;)">PowerShell</a></span></span></p><p style="margin-bottom:1rem"><span>Just like previous sections when using <a class="KFAqYize glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;KFAqYize&#39;)">PowerShell</a> we will again be using the PowerShell module </span><code>Get-WinEvent</code> along with <code>XPath</code> queries to filter our events and gain granular control over our logs. We will need to filter on the <code>NetworkConnect</code> event ID and the <code>DestinationPort</code> data attribute. If you're using a good configuration file with a reliable set of rules it will do a majority of the heavy lifting and filtering to what you want should be easy.</p><p style="margin-bottom:1rem"><code>Get-WinEvent -Path &lt;Path to Log&gt;&nbsp;-FilterXPath '*/System/EventID=3 and */EventData/Data[@Name="DestinationPort"] and */EventData/Data=&lt;Port&gt;'</code></p>

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">Hunting Connections</div>
        <pre class="terminal-code language-powershell" tabindex="0">           <code class=" language-powershell">
<span class="token function">PS</span> C:\Users\THM<span class="token operator">-</span>Analyst&gt; <span class="token function">Get-WinEvent</span> <span class="token operator">-</span>Path C:\Users\THM<span class="token operator">-</span>Analyst\Desktop\Scenarios\Practice\Hunting_Rats<span class="token punctuation">.</span>evtx <span class="token operator">-</span>FilterXPath <span class="token string">'*/System/EventID=3 and */EventData/Data[@Name="DestinationPort"] and */EventData/Data=8080'</span>

   ProviderName: Microsoft<span class="token operator">-</span>Windows<span class="token operator">-</span>Sysmon

TimeCreated                     Id LevelDisplayName Message
<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>                     <span class="token operator">--</span> <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span> <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>
1<span class="token operator">/</span>5<span class="token operator">/</span>2021 4:44:35 AM              3 Information      Network connection detected:<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
1<span class="token operator">/</span>5<span class="token operator">/</span>2021 4:44:31 AM              3 Information      Network connection detected:<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
1<span class="token operator">/</span>5<span class="token operator">/</span>2021 4:44:27 AM              3 Information      Network connection detected:<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
1<span class="token operator">/</span>5<span class="token operator">/</span>2021 4:44:24 AM              3 Information      Network connection detected:<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
1<span class="token operator">/</span>5<span class="token operator">/</span>2021 4:44:20 AM              3 Information      Network connection detected:<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code>
        </pre></div></div></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details"><span>
                                Read the Above and practice hunting rats and C2 servers with back connect ports.&nbsp;
                            </span></div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="7">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-8">
                    <div class="card-header task-header collapsed" data-toggle="collapse" href="#collapse8" aria-expanded="false">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 8                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Hunting Persistence
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-download text-lblue" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a downloadable file"></i></span>
                        </a>
                    </div>
                    <div id="collapse8" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><form class="float-right" method="post" action="https://tryhackme.com/material/deploy">
                            <input type="hidden" name="roomCode" value="sysmon">
                            <input type="hidden" name="id" value="5fe1283a8ba79e2dbb56d696">
                            <button type="submit" class="btn btn-primary mb-3 ml-3" value="Download">
                            <i class="fas fa-cloud-download-alt mr-2"></i> Download Task Files</button>
                        </form> <p><span style="font-size:24px">Persistence Overview</span></p><p><span style="font-size:1rem">Persistence is used by attackers to maintain access to a machine once it is compromised.&nbsp;</span>There is a multitude of ways for an attacker to gain persistence on a machine. We will be focusing on registry modification as well as startup scripts. We can hunt persistence with Sysmon by looking for File Creation events as well as Registry Modification events. The SwiftOnSecurity configuration file does a good job of specifically targeting persistence and techniques used. You can also filter by the Rule Names in order to get past the network noise and focus on anomalies within the event logs.&nbsp;</p><p>You can download the event logs used in this room from this task or you can open them in the Practice folder on the provided machine.</p><p><span style="font-size:24px">Hunting Startup Persistence</span><br></p><p>We will first be looking at the SwiftOnSecurity detections for a file being placed in the <code>\Startup\</code>&nbsp;or <code>\Start Menu</code><span> directories. Below is a snippet of the config that will aid in event tracing for this technique. For more information about this technique check out <a class="Yw01Kddo glossary-term" onclick="initPopOver(&#39;MITRE&#39;, &#39;Yw01Kddo&#39;)">MITRE</a> ATT&amp;CK </span><a href="https://attack.mitre.org/techniques/T1547/" target="_blank">T1547</a>.</p><p><code>&lt;RuleGroup name="" groupRelation="or"&gt;<br><span style="white-space:pre">	</span>&lt;FileCreate onmatch="include"&gt;<br><span style="white-space:pre">		</span>&lt;TargetFilename name="T1023" condition="contains"&gt;\Start Menu&lt;/TargetFilename&gt;<br><span style="white-space:pre">		</span>&lt;TargetFilename name="T1165" condition="contains"&gt;\Startup\&lt;/TargetFilename&gt;<br><span style="white-space:pre">	</span>&lt;/FileCreate&gt;<br>&lt;/RuleGroup&gt;<br></code><br></p><p>Open <code>C:\Users\THM-Analyst\Desktop\Scenarios\Practice\T1023.evtx</code>&nbsp; in Event Viewer to view a live attack on the machine that involves persistence by adding a malicious EXE into the Startup folder.</p><p><img src="https://i.imgur.com/cQNpkWR.png" alt="screenshot of Windows event log viewer showing details of a peristence log" style="width:911px"></p><p>When looking at the Event Viewer we see that persist.exe was placed in the Startup folder. Threat Actors will almost never make it this obvious but any changes to the Start Menu should be investigated. You can adjust the configuration file to be more granular and create alerts past just the <i>File Created</i> tag. We can also filter by the <code>Rule Name T1023</code></p><p><img src="https://i.imgur.com/yhRxVrU.png" alt="screenshot of the Windows event log viewer fiter log dialog" style="width:403.5px;height:409.444px"></p><p style="text-align:center"><img src="https://i.imgur.com/zipqQIF.png" alt="screenshot of Windows event log viewer showing two file creations logs" style="width:1076px"><br></p><p>Once you have identified that a suspicious binary or application has been placed in a startup location you can begin an investigation on the directory.</p><p><span style="font-size:24px">Hunting Registry Key Persistence</span><br></p><p>We will again be looking at another SwiftOnSecurity detection this time for a registry modification that adjusts that places a script inside <code>CurrentVersion\Windows\Run</code><span> and other registry locations. For more information about this technique check out <a class="mBAC5xOR glossary-term" onclick="initPopOver(&#39;MITRE&#39;, &#39;mBAC5xOR&#39;)">MITRE</a> ATT&amp;CK </span><a href="https://attack.mitre.org/techniques/T1112/" target="_blank">T1112</a>.</p><p><code>&lt;RuleGroup name="" groupRelation="or"&gt;<br><span style="white-space:pre">	</span>&lt;RegistryEvent onmatch="include"&gt;<br><span style="white-space:pre">		</span>&lt;TargetObject name="T1060,RunKey" condition="contains"&gt;CurrentVersion\Run&lt;/TargetObject&gt;<br><span style="white-space:pre">		</span>&lt;TargetObject name="T1484" condition="contains"&gt;Group Policy\Scripts&lt;/TargetObject&gt;<br><span style="white-space:pre">		</span>&lt;TargetObject name="T1060" condition="contains"&gt;CurrentVersion\Windows\Run&lt;/TargetObject&gt;<br><span style="white-space:pre">	</span>&lt;/RegistryEvent&gt;<br>&lt;/RuleGroup&gt;<br></code><br></p><p>Open <code>C:\Users\THM-Analyst\Desktop\Scenarios\Practice\T1060.evtx</code> in Event Viewer to view an attack where the registry was modified to gain persistence.</p><p><img src="https://i.imgur.com/NkvJNew.png" alt="screenshot of Windows event log viewer showing details of a regedit log" style="width:694px"><br></p><p>When looking at the event logs we see that the registry was modified and malicious.exe was added to <code>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Persistence</code><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">We also see that the exe can be found at </span><code>%windir%\System32\malicious.exe</code></p><p><span style="font-size:1rem">Just like the startup technique, we can filter by the </span><code>RuleName T1060</code><span style="font-size:1rem"> to make finding the anomaly easier. </span></p><p><span style="font-size:1rem">If we wanted to investigate this anomaly we would need to look at the registry as well as the file location itself. Below is the registry area where the malicious registry key was placed.</span></p><p style="text-align:center"><img src="https://i.imgur.com/d6hLTud.png" alt="screenshot of the Windows registry editor showing a persistence registry key" style="width:949px"><span style="font-size:1rem"><br></span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Read the above and practice hunting persistence techniques.
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="8">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-9">
                    <div class="card-header task-header collapsed" data-toggle="collapse" href="#collapse9" aria-expanded="false">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 9                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Detecting Evasion Techniques
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-download text-lblue" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a downloadable file"></i></span>
                        </a>
                    </div>
                    <div id="collapse9" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><form class="float-right" method="post" action="https://tryhackme.com/material/deploy">
                            <input type="hidden" name="roomCode" value="sysmon">
                            <input type="hidden" name="id" value="5ffa1360e355fd7fe1bbdad7">
                            <button type="submit" class="btn btn-primary mb-3 ml-3" value="Download">
                            <i class="fas fa-cloud-download-alt mr-2"></i> Download Task Files</button>
                        </form> <p><span style="font-size:24px">Evasion Techniques Overview</span></p><p>There are a number of evasion techniques used by malware authors to evade both anti-virus and detections. Some examples of evasion techniques are Alternate Data Streams, Injections, Masquerading, Packing/Compression, Recompiling, Obfuscation, Anti-Reversing Techniques. In this task, we will be focusing on Alternate Data Streams and Injections. Alternate Data Streams are used by malware to hide its files from normal inspection by saving the file in a different stream apart from <code>$DATA</code><span>. Sysmon comes with an event ID to detect newly created and accessed streams allowing us to quickly detect and hunt malware that uses ADS. Injection techniques come in many different types: Thread Hijacking, PE Injection, <a class="J1qZ1tny glossary-term" onclick="initPopOver(&#39;DLL&#39;, &#39;J1qZ1tny&#39;)">DLL</a> Injection, and more. In this room, we will be focusing on DLL Injection and backdooring DLLs. This is done by taking an already used DLL that is used by an application and overwriting or including your malicious code within the DLL.</span></p><p><span>For more information about this technique check out <a class="N3qXYtPD glossary-term" onclick="initPopOver(&#39;MITRE&#39;, &#39;N3qXYtPD&#39;)">MITRE</a> ATT&amp;CK </span><a href="https://attack.mitre.org/techniques/T1564/004/" target="_blank">T1564</a> and <a href="https://attack.mitre.org/techniques/T1055/" target="_blank">T1055</a>.</p><p>You can download the event logs used in this room from this task or you can open them in the Practice folder on the provided machine.</p><p><span style="font-size:24px">Hunting Alternate Data Streams</span></p><p>The first technique we will be looking at is hiding files using alternate data streams using Event ID 15. Event ID 15 will hash and log any NTFS Streams that are included within the Sysmon configuration file. This will allow us to hunt for malware that evades detections using ADS. To aid in hunting ADS we will be using the SwiftOnSecurity Sysmon configuration file. The code snippet below will hunt for files in the <code>Temp</code> and <code>Startup</code> folder as well as <code>.hta</code> and <code>.bat</code> extension.</p><p><code>&lt;RuleGroup name="" groupRelation="or"&gt;<br><span style="color:rgb(255, 255, 255);white-space:pre">	</span>&lt;FileCreateStreamHash onmatch="include"&gt;<br><span style="color:rgb(255, 255, 255);white-space:pre">	</span><span style="color:rgb(255, 255, 255);white-space:pre">	</span>&lt;TargetFilename condition="contains"&gt;Downloads&lt;/TargetFilename&gt;<br><span style="color:rgb(255, 255, 255);white-space:pre">	</span><span style="color:rgb(255, 255, 255);white-space:pre">	</span>&lt;TargetFilename condition="contains"&gt;Temp\7z&lt;/TargetFilename&gt;<br><span style="color:rgb(255, 255, 255);white-space:pre">	</span><span style="color:rgb(255, 255, 255);white-space:pre">	</span>&lt;TargetFilename condition="ends with"&gt;.hta&lt;/TargetFilename&gt;<br><span style="color:rgb(255, 255, 255);white-space:pre">	</span><span style="color:rgb(255, 255, 255);white-space:pre">	</span>&lt;TargetFilename condition="ends with"&gt;.bat&lt;/TargetFilename&gt;<br><span style="color:rgb(255, 255, 255);white-space:pre">	</span>&lt;/FileCreateStreamHash&gt;<br>&lt;/RuleGroup&gt;</code></p><p>Open <code>C:\Users\THM-Analyst\Desktop\Scenarios\Practice\Hunting_ADS.evtx</code> in Event Viewer to view hidden files using an alternate data stream.</p><p><img src="https://i.imgur.com/kuQrOwh.png" alt="screenshot of Windows event log viewer showing details of an alternate data stream log" style="width:646px"></p><p></p>
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">Listing Data Streams</div>
        <pre class="terminal-code language-powershell" tabindex="0">           <code class=" language-powershell">C:\\Users\\THM<span class="token operator">-</span>Threat&gt;<span class="token function">dir</span> <span class="token operator">/</span>r
 Volume in drive C has no label<span class="token punctuation">.</span>
 Volume Serial Number is C0C4<span class="token operator">-</span>7EC1

 Directory of C:\\Users\\THM<span class="token operator">-</span>Threat

10<span class="token operator">/</span>23<span class="token operator">/</span>2022  02:56 AM    &lt;<span class="token function">DIR</span>&gt;          <span class="token punctuation">.</span>
10<span class="token operator">/</span>23<span class="token operator">/</span>2022  02:56 AM    &lt;<span class="token function">DIR</span>&gt;          <span class="token punctuation">.</span><span class="token punctuation">.</span>
01<span class="token operator">/</span>02<span class="token operator">/</span>2021  12:43 AM    &lt;<span class="token function">DIR</span>&gt;          3D Objects
01<span class="token operator">/</span>02<span class="token operator">/</span>2021  12:43 AM    &lt;<span class="token function">DIR</span>&gt;          Contacts
01<span class="token operator">/</span>05<span class="token operator">/</span>2021  11:53 PM    &lt;<span class="token function">DIR</span>&gt;          Desktop
01<span class="token operator">/</span>02<span class="token operator">/</span>2021  12:43 AM    &lt;<span class="token function">DIR</span>&gt;          Documents
01<span class="token operator">/</span>10<span class="token operator">/</span>2021  12:11 AM    &lt;<span class="token function">DIR</span>&gt;          Downloads
01<span class="token operator">/</span>02<span class="token operator">/</span>2021  12:43 AM    &lt;<span class="token function">DIR</span>&gt;          Favorites
01<span class="token operator">/</span>02<span class="token operator">/</span>2021  12:43 AM    &lt;<span class="token function">DIR</span>&gt;          Links
01<span class="token operator">/</span>02<span class="token operator">/</span>2021  12:43 AM    &lt;<span class="token function">DIR</span>&gt;          Music
10<span class="token operator">/</span>23<span class="token operator">/</span>2022  02:56 AM                 0 not_malicious<span class="token punctuation">.</span>txt
                                    13 not_malicious<span class="token punctuation">.</span>txt:malicious<span class="token punctuation">.</span>txt:<span class="token variable">$DATA</span> </code>
        </pre></div></div>

<p>As you can see the event will show us the location of the file name as well as the contents of the file this will be useful if an investigation is necessary.</p><p><span style="font-size:24px">Detecting Remote Threads&nbsp;</span></p><p>Adversaries also commonly use remote threads to evade detections in combination with other techniques. Remote threads are created using the Windows API&nbsp;<code style="font-size:14px">CreateRemoteThread</code><span style="font-size:1rem">&nbsp;and can be accessed using&nbsp;</span><code style="font-size:14px">OpenThread</code><span style="font-size:1rem">&nbsp;and&nbsp;</span><code style="font-size:14px">ResumeThread</code><span style="font-size:1rem"><span>. This is used in multiple evasion techniques including <a class="JLpeoJ6J glossary-term" onclick="initPopOver(&#39;DLL&#39;, &#39;JLpeoJ6J&#39;)">DLL</a> Injection, Thread Hijacking, and Process Hollowing. We will be using the Sysmon event ID 8 from the SwiftOnSecurity configuration file. The code snippet below from the rule will exclude common remote threads without including any specific attributes this allows for a more open and precise event rule.&nbsp;</span></span></p><p><code style="font-size:14px">&lt;RuleGroup name="" groupRelation="or"&gt;<br><span style="color:rgb(255, 255, 255);white-space:pre">	</span>&lt;CreateRemoteThread onmatch="exclude"&gt;<br><span style="color:rgb(255, 255, 255);white-space:pre">	</span><span style="color:rgb(255, 255, 255);white-space:pre">	</span>&lt;SourceImage condition="is"&gt;C:\Windows\system32\svchost.exe&lt;/SourceImage&gt;<br><span style="color:rgb(255, 255, 255);white-space:pre">	</span><span style="color:rgb(255, 255, 255);white-space:pre">	</span>&lt;TargetImage condition="is"&gt;C:\Program Files (x86)\Google\Chrome\Application\chrome.exe&lt;/TargetImage&gt;<br><span style="color:rgb(255, 255, 255);white-space:pre">	</span>&lt;/CreateRemoteThread&gt;<br>&lt;/RuleGroup&gt;<br></code><span style="font-size:1rem"><br></span></p><p>Open&nbsp;<code style="font-size:14px">C:\Users\THM-Analyst\Desktop\Scenarios\Practice\Detecting_RemoteThreads.evtx</code>&nbsp;in Event Viewer to observe a Process Hollowing attack that abuses the notepad.exe process.&nbsp;</p><p><img src="https://i.imgur.com/R2cRHqa.png" alt="screenshot of Windows event log viewer showing details of a powershell session executed from notepad" style="width:638px"><br></p><p><span>As you can see in the above image powershell.exe is creating a remote thread and accessing notepad.exe. This is obviously a <a class="QjKnDD2y glossary-term" onclick="initPopOver(&#39;PoC&#39;, &#39;QjKnDD2y&#39;)">PoC</a> and could in theory execute any other kind of executable or DLL. The specific technique used in this example is called Reflective PE Injection.&nbsp;</span></p><p><span style="font-size:24px"><span>Detecting Evasion Techniques with <a class="9oEcMXgq glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;9oEcMXgq&#39;)">PowerShell</a></span></span></p><p><span>We have already gone through a majority of the syntax required to use <a class="AONoWzY2 glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;AONoWzY2&#39;)">PowerShell</a> with events. Like previous tasks, we will be using </span><code>Get-WinEvent</code> along with the <code>XPath</code> to filter and search for files that use an alternate data stream or create a remote thread. In both of the events, we will only need to filter by the <code>EventID</code> because the rule used within the configuration file is already doing a majority of the heavy lifting.&nbsp;</p><p>Detecting Remote Thread Creation</p><p>Syntax: <code>Get-WinEvent -Path &lt;Path to Log&gt; -FilterXPath '*/System/EventID=8'</code></p>

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">Detecting Remote Threads</div>
        <pre class="terminal-code language-powershell" tabindex="0">           <code class=" language-powershell">
<span class="token function">PS</span> C:\Users\THM<span class="token operator">-</span>Analyst&gt; <span class="token function">Get-WinEvent</span> <span class="token operator">-</span>Path C:\Users\THM<span class="token operator">-</span>Analyst\Desktop\Scenarios\Practice\Detecting_RemoteThreads<span class="token punctuation">.</span>evtx <span class="token operator">-</span>FilterXPath <span class="token string">'*/System/EventID=8'</span>

   ProviderName: Microsoft<span class="token operator">-</span>Windows<span class="token operator">-</span>Sysmon

TimeCreated                     Id LevelDisplayName Message
<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>                     <span class="token operator">--</span> <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span> <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>
7<span class="token operator">/</span>3<span class="token operator">/</span>2019 8:39:30 PM              8 Information      CreateRemoteThread detected:<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
7<span class="token operator">/</span>3<span class="token operator">/</span>2019 8:39:30 PM              8 Information      CreateRemoteThread detected:<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
7<span class="token operator">/</span>3<span class="token operator">/</span>2019 8:39:30 PM              8 Information      CreateRemoteThread detected:<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
7<span class="token operator">/</span>3<span class="token operator">/</span>2019 8:39:30 PM              8 Information      CreateRemoteThread detected:<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
7<span class="token operator">/</span>3<span class="token operator">/</span>2019 8:39:30 PM              8 Information      CreateRemoteThread detected:<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code>
        </pre></div></div></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Read the above and practice detecting evasion techniques
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="9">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-10">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse10" aria-expanded="true">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 10                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Practical Investigations
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-download text-lblue" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a downloadable file"></i></span>
                        </a>
                    </div>
                    <div id="collapse10" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><form class="float-right" method="post" action="https://tryhackme.com/material/deploy">
                            <input type="hidden" name="roomCode" value="sysmon">
                            <input type="hidden" name="id" value="5ffa4276a756cc1dddd59109">
                            <button type="submit" class="btn btn-primary mb-3 ml-3" value="Download">
                            <i class="fas fa-cloud-download-alt mr-2"></i> Download Task Files</button>
                        </form> <p>Event files used within this task have been sourced from the <a href="https://github.com/sbousseaden/EVTX-ATTACK-SAMPLES/tree/master" target="_blank">EVTX-ATTACK-SAMPLES</a>&nbsp;and <a href="https://github.com/jymcheong/SysmonResources" target="_blank">SysmonResources</a>&nbsp;Github repositories.</p><p>You can download the event logs used in this room from this task or you can open them in the Investigations folder on the provided machine.</p><p><span style="font-size:24px">Investigation 1 - ugh, BILL THAT'S THE WRONG USB!</span></p><p>In this investigation, your team has received reports that a malicious file was dropped onto a host by a malicious USB. They have pulled the logs suspected and have tasked you with running the investigation for it.</p><p><span style="font-size:1rem">Logs are located in </span><code>C:\Users\THM-Analyst\Desktop\Scenarios\Investigations\Investigation-1.evtx</code><span style="font-size:1rem">.</span></p><p><span style="font-size:24px">Investigation 2 - This isn't an HTML file?&nbsp;</span></p><p><span style="font-size:1rem">Another suspicious file has appeared in your logs and has managed to execute code masking itself as an HTML file, evading your anti-virus detections. Open the logs and investigate the suspicious file.&nbsp;&nbsp;</span></p><p>Logs are located in <code>C:\Users\THM-Analyst\Desktop\Scenarios\Investigations\Investigation-2.evtx</code>.</p><p><span style="font-size:24px">Investigation 3.1 - 3.2 - Where's the bouncer when you need him</span></p><p>Your team has informed you that the adversary has managed to set up persistence on your endpoints as they continue to move throughout your network. Find how the adversary managed to gain persistence using logs provided.</p><p><span style="font-size:1rem">Logs are located in&nbsp;</span><code style="font-size:14px">C:\Users\THM-Analyst\Desktop\Scenarios\Investigations\Investigation-3.1.evtx</code></p><p>and&nbsp;<code>C:\Users\THM-Analyst\Desktop\Scenarios\Investigations\Investigation-3.2.evtx</code><span style="font-size:1rem">.</span></p><p><span style="font-size:24px">Investigation 4 - Mom look! I built a botnet!</span></p><p><span>As the adversary has gained a solid foothold onto your network it has been brought to your attention that they may have been able to set up <a class="92cEi2Si glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;92cEi2Si&#39;)">C2</a> communications on some of the endpoints. Collect the logs and continue your investigation.</span></p><p><span style="font-size:1rem">Logs are located in&nbsp;</span><code style="font-size:14px">C:\Users\THM-Analyst\Desktop\Scenarios\Investigations\Investigation-4.evtx</code><span style="font-size:1rem">.</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                What is the full registry key of the USB device calling svchost.exe in Investigation 1?&nbsp;
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****************************************************************************************************************************************.***********************************" value="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What is the device name when being called by RawAccessRead in Investigation 1?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***********************" value="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What is the first exe the process executes in Investigation 1?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ********.***" value="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What is the full path of the payload in Investigation 2?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *:******************************************************* ******** *************.*******************.***" value="">
                            <input type="hidden" value="4">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What is the full path of the file the payload masked itself as in Investigation 2?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *:******************************.****" value="">
                            <input type="hidden" value="5">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What signed binary executed the payload in Investigation 2?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *:***********************.***" value="">
                            <input type="hidden" value="6">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What is the IP of the adversary in Investigation 2?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **.*.*.**" value="">
                            <input type="hidden" value="7">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What back connect port is used in Investigation 2?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****" value="">
                            <input type="hidden" value="8">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What is the IP of the suspected adversary in Investigation 3.1?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***.**.*.***" value="">
                            <input type="hidden" value="9">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What is the hostname of the affected endpoint&nbsp;<span style="font-size:1rem">in Investigation 3.1</span><span style="font-size:1rem">?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***************" value="">
                            <input type="hidden" value="10">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span>What is the hostname of the <a class="xjc10jGo glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;xjc10jGo&#39;)">C2</a> server connecting to the endpoint&nbsp;</span><span style="font-size:1rem">in Investigation 3.1</span><span style="font-size:1rem">?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ********" value="">
                            <input type="hidden" value="11">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Where in the registry was the payload stored in Investigation 3.1?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *************************************" value="">
                            <input type="hidden" value="12">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span>What <a class="0qaBHifi glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;0qaBHifi&#39;)">PowerShell</a> launch code was used to launch the payload in Investigation 3.1?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **:**************************************.************.**** ** ********* ****:************************** ******.************ **** ****** ** ****** **** *****************" value="">
                            <input type="hidden" value="13">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What is the IP of the adversary in Investigation 3.2?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***.***.***.***" value="">
                            <input type="hidden" value="14">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What is the full path of the payload location in Investigation 3.2?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *:****************:****.***" value="">
                            <input type="hidden" value="15">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What was the full command used to create the scheduled task in Investigation 3.2?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **:**************************.**** /****** /* /** ***** /** **:** /** ******* /** **:**************************************.************.*** ***** ** ****** ** ***** ******.*********::*******.*******************::********************** /* ****** * *:****************:****.*************" value="">
                            <input type="hidden" value="16">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What process was accessed by schtasks.exe that would be considered suspicious behavior in Investigation 3.2?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *****.***" value="">
                            <input type="hidden" value="17">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What is the IP of the adversary in Investigation 4?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***.**.*.***" value="">
                            <input type="hidden" value="18">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What port is the adversary operating on in Investigation 4?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **" value="">
                            <input type="hidden" value="19">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span>What <a class="NVoSMeSg glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;NVoSMeSg&#39;)">C2</a> is the adversary utilizing in Investigation 4?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ******" value="">
                            <input type="hidden" value="20">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div></div>
</div>
<div id="room-simple-details"><div class="card cd-2 text-center mt-3"><div class="card-body"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Sysmon_files/af7feb2c43a2c7d5f111b98ccbd15048.png"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme">tryhackme</a> and <img class="avatar-tiny" src="./TryHackMe _ Sysmon_files/9e946af210ae86d6fbfda480d958b3fe.gif"> 
        <a class="green-link" href="https://tryhackme.com/p/Cryillic">Cryillic</a></p><p class="mb-0">Only subscribers can deploy virtual machines in this room! 
        Go to your <a href="https://tryhackme.com/profile">profile</a> page to subscribe (if you have not already). 21917 users are in here and this room is 908 days old.</p></div></div></div>

</div>
</div>
</div>
<div id="room-content-attackbox">
<div id="room-attackbox">
<div id="attackbox-machine-instance">
<div id="room-attackbox-loading"></div>
<div id="room-attackbox-vm-view"></div>
</div>
<div id="attackbox-machine-options">
<div class="d-flex">
<a target="_blank" id="room-attackbox-url" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="View in full screen"></a>
<div onclick="extendHourWebBasedVM(null)" class="hover-pointer" id="room-attackbox-extend" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Extend machines timer"><i class="fas fa-plus"></i></div>
<div onclick="terminateWebBasedVM(null)" class="hover-pointer" id="room-attackbox-terminate" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Terminate Machine"><i class="far fa-power-off"></i></div>
<div onclick="exitViewAttackBox()" class="hover-pointer" id="room-attackbox-exitview" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Exit split view"><i class="fas fa-minus"></i></div>
<div onclick="infoAttackBox()" class="hover-pointer faded" id="room-attackbox-info" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Machine Information"><i class="fas fa-info"></i></div>
<div class="d-flex" id="room-attackbox-tabs"></div>
</div>
<div id="room-attackbox-expire-text" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Time left until your AttackBox expires"></div>
</div>
</div>
<div class="modal fade" id="attackBoxInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-light-gray">
<h5 class="modal-title m-auto">Web-Based Machine Information</h5>
</div>
<div class="modal-body">
<p>Use the web-based machine to attack other target machines you start on TryHackMe.</p>
<ul class="normalList text-gray mt-3 mb-4">
<li>Public IP: <code id="browser-machine-pubip" class="dark size-14"></code></li>
<li class="mt-1">Private IP: <code id="browser-machine-privip" class="dark size-14"></code> <span class="size-14">(Use this for your reverse shells)</span></li>
<li class="mt-1">Username: <code id="browser-username" class="dark size-14"></code></li>
<li class="mt-1">Password: <code id="browser-password" class="dark size-14"></code></li>
<li class="mt-1">Protocol: <code id="browser-protocol" class="dark size-14"></code></li>
</ul>
<hr class="hr-min">
<ul class="text-lgray mb-0">
<li class="mt-2">To copy to and from the browser-based machine, highlight the text and press <b>CTRL+SHIFT+C</b> <details><summary>or use the clipboard</summary><img src="./TryHackMe _ Sysmon_files/clipboard.gif"></details></li>
<li class="mt-2">When accessing target machines you start on TryHackMe tasks, make sure you're using the correct IP (it <b>should not be</b> the IP of your AttackBox)</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="award-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<button type="button" class="close size-30 text-lgray" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<div id="award-modal-badges"></div>
<p class="mb-0 text-lgray size-18">Complete the room to earn this badge</p>
</div>
</div>
</div>
</div>
<div class="modal fade" id="hint-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title"><i class="fal fa-lightbulb-on"></i> Question Hint</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body"></div>
</div>
</div>
</div>
<div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">...</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center"></div>
<div class="modal-footer"></div>
</div>
</div>
</div>
<link rel="stylesheet" href="./TryHackMe _ Sysmon_files/modal.css">
<div class="modal-design-green modal fade" id="roomCompleted" tabindex="-1" role="dialog" data-backdrop="static" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content" id="roomCompletedModalContent">
<div class="modal-body text-center">
<button type="button" class="close" id="closeRoomComplete" aria-label="Close">
<i class="fad fa-times-circle"></i>
</button>
<div class="icon-box">
<i class="fad fa-badge-check"></i>
</div>
<h3 class="text-accent mt-5">Congratulations</h3>
<p class="faded mt-1">You've completed the room! Share this with your friends: </p>
<h2 id="roomCompleted-share"></h2>
<div id="ticket-info"></div> 
<p class="faded mt-1" id="roomFeedbackBtn">
<small>
<button class="bg-white border-0">Leave
feedback</button>
</small>
</p>
<form method="post" action="https://tryhackme.com/feedback" id="roomFeedbackForm" class="d-none mt-3">
<input type="hidden" name="_csrf" value="56xXlxUM-A7pav4drkP2COIkGdLQkiqfLDxo">
<input type="hidden" name="roomCode" value="sysmon">
<input type="hidden" name="type" value="rooms">
<input type="hidden" name="redirect" value="json">
<div class="form-group">
<label class="mb-0" for="like">What do you like about the room?</label>
<textarea type="text" name="like" id="like" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="dislike">What don't you like about the room?</label>
<textarea type="text" name="dislike" id="dislike" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="details">Please send your suggestions, ideas and comments!</label>
<textarea id="details" type="text" name="details" class="form-control" style="padding: 5px;"></textarea>
</div>
<button type="submit" id="submitBtn" class="btn btn-success">Send Feedback</button>
</form>
<p class="mt-2 mb-0" id="formMessage"></p>
</div>
</div>
</div>
<script>
    function dismissRoomCompleteModal() {
      $('#roomCompleted').modal('hide');

      const shouldSeeReferralModal = ""
      if (shouldSeeReferralModal) {
        $('#unlockCreditModal').modal('show');

        referralModalEvent('view');
      }
    }

    document.getElementById('closeRoomComplete').addEventListener('click', dismissRoomCompleteModal)
  </script>
</div>
<script src="./TryHackMe _ Sysmon_files/roomFeedback.js"></script>
<div class="modal fade" id="roomStartAttackboxModal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static" data-keyboard="false">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title m-auto">To access this machine, you need to either</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close" style="position: absolute; right: 10px; top: 0; font-size: 30px;">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center">
<div class="row vertical-align-custom mb-0">
<div class="col-sm-5 pr-0">
<p class="size-18 bold">Use a VPN</p>
<p>Connect to our network via a VPN</p>
<a target="_blank" href="https://tryhackme.com/access"><button type="button" class="btn btn-light">See Instructions</button></a>
</div>
<div class="col-sm-2 size-24">
or
</div>
<div class="col-sm-5 pl-0">
<p class="size-18 bold">Use the AttackBox</p>
<p>Use a web-based attack machine <span class="size-12">(recommended)</span></p>
<button type="button" onclick="$(&#39;#roomStartAttackboxModal&#39;).modal(&#39;toggle&#39;); startAttackBox({startingMsg: false, tutorial: true})" class="btn btn-hgreen">Start AttackBox</button>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="expireSoon" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-warning fad fa-exclamation-triangle"></i></h1>
<h3 class="text-warning">Expiring Soon</h3>
<p class="faded mt-3 mb-0">Your machine is going to expire soon. Close this and add an hour to stop it from terminating!</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="terminatedMachine" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-danger fad fa-exclamation-triangle"></i></h1>
<h3 class="text-danger">Expired Machine</h3>
<p class="faded mt-3 mb-0">Your machine has expired and terminated.</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="machineDeployModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue text-center p-3">
<h4 class="mb-0 m-auto">How to access machines</h4>
<button type="button" class="close modal-close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center">
<p class="size-18 faded">Now you've started your machine, to access it you need to either</p>
<div class="row mb-0">
<div class="col-sm-6">
<img src="./TryHackMe _ Sysmon_files/connect_openvpn_short.png">
<p class="mt-2 mb-0 faded">Download your VPN configuration file and import it into a OpenVPN client</p>
</div>
<div class="col-sm-6">
<img src="./TryHackMe _ Sysmon_files/connect_kali_short.png">
<p class="mt-2 mb-0 faded">Control a web-based machine with everything you need, all from inside your browser</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="roomAlertModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title" id="roomAlertModalTitle"></h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body" id="roomAlertModalBody"></div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="resetUserProgressModal" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">Reset Your Progress</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<div><span class="text-danger"><i class="fas fa-exclamation-triangle"></i> Warning</span> You will keep your points but all your answers in this room will be erased.</div>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-danger" onclick="resetProgress()">Yes, please!</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="cloudEnvInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header  modal-dark-blue">
<h5 class="modal-title">Cloud Information</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<ul class="nav nav-tabs">
<li class="nav-item pr-2">
<a class="nav-link active" data-toggle="tab" href="https://tryhackme.com/room/sysmon#env-tab">Environment</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/sysmon#creds-tab">Credentials</a>
</li>
</ul>
<div class="tab-content">
<div class="tab-pane active" id="env-tab"></div>
<div class="tab-pane" id="creds-tab"></div>
</div>
</div>
<div class="modal-footer" id="cloudEnvModalFooter">
</div>
</div>
</div>
</div>
<div class="modal fade" id="setNameModal" role="dialog">
<div class="modal-dialog modal-lg modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title">Generating Your Certificate</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body container">
<div class="row">
<div class="col-6">
<h5 class="bold">Hey there, what's your name?</h5>
<p class="text-secondary">
If you want your name to appear on your certificate, please fill the field below.
</p>
<div class="form-group">
<label>Full Name </label>
<input id="modal-cert-field-name" type="text" placeholder="John Wick" class="mb-4 form-control">
<input id="modal-cert-field-email" type="hidden" value="giftonpaul@karunya.edu.in">
</div>
</div>
<div class="col-6">
<h5 class="bold">You're here incognito? It's ok!</h5>
<p class="text-secondary">If you chose skip, your username will be used instead!</p>
</div>
</div>
<div class="row">
<div class="col-6">
<button type="button" class="btn btn-success float-right" id="modal-cert-generate" onclick="gen_cert(true)" disabled="">
Generate with my full name
</button>
</div>
<div class="col-6">
<button type="button" class="btn btn-primary float-right" id="modal-cert-skip" onclick="gen_cert(false)">
Generate with my username
</button>
</div>
</div>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Sysmon_files/certificateName.js"></script>
<div class="modal fade slideout-faq" id="roomSlideoutUnstuck" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-links">
<div id="unstuck-video" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-play"></i></div>
<div class="unstuck-icon-text">Video Solution</div>
</div>
<div id="unstuck-writeups" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-pen-alt"></i></div>
<div class="unstuck-icon-text">Writeups</div>
</div>
<a id="unstuck-forum" target="_blank" class="clear-link unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-comments-alt"></i></div>
<div class="unstuck-icon-text">Forum Post</div>
</a>
<a href="https://help.tryhackme.com/en/collections/3601905-getting-started-with-tryhackme" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-books"></i></div>
<div class="unstuck-icon-text">Knowledge Base</div>
</a>
<a href="https://discord.gg/DpBZz8y" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-users"></i></div>
<div class="unstuck-icon-text">Ask Community</div>
</a>
</div>
</div>
</div>
</div>
</div>
<style>

    #navConnModal .modal-body{
        position: relative;
    }

    #nav-openvpn,
    #nav-attackbox {
        display: none;
    }

    #nav-openvpn .nav-pills .nav-link.active,
    #nav-openvpn .nav-pills .show>.nav-link {
        background-color: #ec8e3d;
        color: white;
    }
    #nav-openvpn .nav-link {
        color: #909090;
    }
    #nav-openvpn a,
    #nav-attackbox a {
        color: #ec8e3d;
    }

    #nav-openvpn code.dark {
        background-color: #7d400a;
        color: #fff;
    }

    #slideout-bk {
        display: none;
        padding: 10px 15px;
        opacity: 0.8;
        cursor: pointer;
    }

    #slideout-bk:hover {
        opacity: 1;
    }

    #slideout-conn-hideip {
        display: none;
        position: absolute;
        bottom: 8px;
        right: 8px;
        opacity: 0.7;
        cursor: pointer;
    }

    #slideout-conn-hideip:hover {
        opacity: 1;
    }

</style>
<div class="modal fade slideout-faq" id="navConnModal" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-bk" class="noselect" onclick="showSlideoutConnOptions()"><i class="far fa-arrow-left mr-2"></i> Show Connection Options</div>
<div id="slideout-conn-options">
<div id="slideout-conn-header" class="text-center">
<img class="slideout-connect-img" src="./TryHackMe _ Sysmon_files/tryhackme_connect.png">
<div id="slideout-conn-status" class="size-22">You are <span class="text-danger">disconnected</span></div>
</div>
<div class="m-3 text-center">
<p>To access target machines you need to either:</p>
<div class="row mb-3 faq-quicklinks text-left vertical-align-custom">
<div class="col-md-12 mb-3">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/sysmon#" onclick="showAttackBoxSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-laptop"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">AttackBox</div>
<p class="faded mb-0">Use a browser-based attack machine</p>
</div>
</div>
</div>
</a>
</div>
<div class="col-md-12">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/sysmon#" onclick="showVPNSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-key"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">OpenVPN</div>
<p class="faded mb-0">Connect to our network via a VPN</p>
</div>
</div>
</div>
</a>
</div>
</div>
</div>
</div>
<div id="faqCards" class="p-3">
<div id="nav-openvpn">
<div class="mb-3">
<a target="_blank" href="https://tryhackme.com/access"><i>View the dedicated OpenVPN access page for more information</i></a>
</div>
<div class="text-center">
<h4>What Operating System are you using?</h4>
<ul class="nav nav-pills mb-3 text-center" id="vpn-guide" style="display: flex; justify-content: center;">
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/sysmon#pills-windows" role="tab" aria-controls="pills-windows" aria-selected="true"><i class="fab fa-windows mr-2"></i> Windows</a>
</li>
<li class="nav-item m-3">
<a class="nav-link active" data-toggle="pill" href="https://tryhackme.com/room/sysmon#pills-linux" role="tab" aria-controls="pills-linux" aria-selected="false"><i class="fab fa-linux mr-2"></i> Linux</a>
</li>
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/sysmon#pills-macos" role="tab" aria-controls="pills-macos" aria-selected="false"><i class="fab fa-apple mr-2"></i> MacOS</a>
</li>
</ul>
<div class="tab-content text-left">
<div class="tab-pane fade" id="pills-windows" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a target="_blank" href="https://openvpn.net/client-connect-vpn-for-windows/">Download</a> the OpenVPN GUI application.</li>
<li class="mt-2">Install the OpenVPN GUI application. Then open the installer file and follow the setup wizard.</li>
<li class="mt-2">Open and run the OpenVPN GUI application as Administrator.<br><img class="mt-2 mb-3" src="./TryHackMe _ Sysmon_files/win_ran_admin.png"></li>
<li class="mt-2">The application will start running in the system tray. It's at the bottom of your screen, near the clock. Right click on the application and click <b>Import File</b>. <br><img class="mt-2 mb-3" src="./TryHackMe _ Sysmon_files/win_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Now right click on the application again, select your file and click Connect <br><img class="mt-2 mb-3" src="./TryHackMe _ Sysmon_files/win_connect.png"></li>
</ol>
</div>
<div class="tab-pane fade show active" id="pills-linux" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2">Run the following command in your terminal: <code class="dark">sudo apt install openvpn</code></li>
<li class="mt-2">Locate the full path to your VPN configuration file (normally in your ~/Downloads folder).</li>
<li class="mt-2">Use your OpenVPN file with the following command: <code class="dark">sudo openvpn /path/to/file.ovpn</code></li>
</ol>
</div>
<div class="tab-pane fade" id="pills-macos" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a href="https://openvpn.net/downloads/openvpn-connect-v2-macos.dmg">Download</a> OpenVPN for MacOS.</li>
<li class="mt-2">Install the OpenVPN GUI application, by opening the dmg file and following the setup wizard.<br><img width="250" class="mt-2 mb-3" src="./TryHackMe _ Sysmon_files/mac_installer.png"></li>
<li class="mt-2">Open and run the OpenVPN GUI application.</li>
<li class="mt-2">The application will start running and appear in your top bar. Right click on the application and click <b>Import File -&gt; Local file</b>.<br><img class="mt-2 mb-3" src="./TryHackMe _ Sysmon_files/mac_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Right click on the application again, select your file and click connect.<br><img class="mt-2 mb-3" src="./TryHackMe _ Sysmon_files/mac_connect.png"></li>
</ol>
</div>
</div>
<section class="text-left">
<a class="remove-underline" data-toggle="collapse" href="https://tryhackme.com/room/sysmon#havingProblems" role="button" aria-expanded="false" aria-controls="havingProblems">
<h5 class="mb-0 text-openvpn">Having Problems?</h5>
</a>
<div class="collapse" id="havingProblems">
<ul class="mt-2 mb-0">
<li>If you can access <a target="_blank" href="http://10.10.10.10/">10.10.10.10</a>, you're connected.</li>
<li>Downloading and getting a 404? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>Getting inline cert error? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>If you are using a virtual machine, you will need to run the VPN inside that machine.</li>
<li>Is the OpenVPN client running as root? <span class="size-14 faded">(On Windows, run OpenVPN GUI as administrator. On Linux, run with sudo)</span></li>
<li>Have you restarted your VM?</li>
<li>Is your OpenVPN up-to-date?</li>
<li>Only 1 OpenVPN connection is allowed. <span class="size-14 faded">(Run <code class="dark">ps aux | grep openvpn</code> - are there 2 VPN sessions running?)</span></li>
<li>Still having issues? Check our <a href="https://help.tryhackme.com/en/articles/6496029-openvpn-general-troubleshooting-detailed/">docs</a> out.</li>
</ul>
</div>
</section>
</div>
</div>
<div id="nav-attackbox">
<div class="text-center">
<h4>AttackBox</h4>
<p class="faded">Use your own web-based linux machine to access machines on TryHackMe</p>
</div>
<p>To start your AttackBox in the room, click the <a class="preventDefault" onclick="showAttackBoxBtnFromSlideout()" href="https://tryhackme.com/room/sysmon#">Start AttackBox</a> button. Your private machine will take 2 minutes to start.</p>
<p>Free users get 1 free AttackBox hour. <a class="hacker-green" href="https://tryhackme.com/why-subscribe">Subscribed</a> users get more powerful machines with unlimited deploys.</p>
</div>
</div>
<span id="slideout-conn-hideip" onclick="hideNavConnIP()" style="display: none;">Hide IP</span>
</div>
</div>
</div>
</div>
<script>

    const navConnVPNEl = document.querySelector('#nav-openvpn')
    const navConnAttackBoxEl = document.querySelector('#nav-attackbox')
    const navConnOptions = document.querySelector('#slideout-conn-options')

    const navConnBkBtn = document.querySelector('#slideout-bk')

    function showVPNSteps() {
        navConnOptions.style.display = 'none'
        navConnVPNEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showAttackBoxSteps() {
        navConnOptions.style.display = 'none'
        navConnAttackBoxEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showSlideoutConnOptions() {
        navConnVPNEl.style.display = 'none'
        navConnAttackBoxEl.style.display = 'none'
        navConnBkBtn.style.display = 'none'
        navConnOptions.style.display = 'block'
    }

    function showAttackBoxBtnFromSlideout() {
        $('#navConnModal').modal('toggle')
        setTimeout(function() {
            showAttackBoxBtnIntro()
        }, 100)   
    }

  </script>
</div><iframe id="_hjSafeContext_71951612" title="_hjSafeContext" tabindex="-1" aria-hidden="true" src="./TryHackMe _ Sysmon_files/saved_resource.html" style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;"></iframe>
<script src="./TryHackMe _ Sysmon_files/notify.js"></script>
<script src="./TryHackMe _ Sysmon_files/api-requests.js"></script>
<script src="./TryHackMe _ Sysmon_files/events.js"></script>
<script src="./TryHackMe _ Sysmon_files/underscore-min.js"></script>
<script src="./TryHackMe _ Sysmon_files/apexcharts.min.js"></script> 
<script src="./TryHackMe _ Sysmon_files/chart.js"></script>
<script src="./TryHackMe _ Sysmon_files/expire.js"></script>
<script src="./TryHackMe _ Sysmon_files/sockets.js"></script>
<script src="./TryHackMe _ Sysmon_files/faqSearch.js"></script>
<script src="./TryHackMe _ Sysmon_files/certificate.js"></script>
<script src="./TryHackMe _ Sysmon_files/utils.js"></script>
<script src="./TryHackMe _ Sysmon_files/roomSpecific.js"></script>
<script src="./TryHackMe _ Sysmon_files/confetti.js"></script>
<script src="./TryHackMe _ Sysmon_files/videos.js"></script>
<script src="./TryHackMe _ Sysmon_files/intro.js"></script>
<script src="./TryHackMe _ Sysmon_files/prism.js"></script>
<script src="./TryHackMe _ Sysmon_files/asciinema-player.js"></script>
<script src="./TryHackMe _ Sysmon_files/magnific-popup.min.js"></script>
<script src="./TryHackMe _ Sysmon_files/introjsLogic.js"></script>
<script src="./TryHackMe _ Sysmon_files/logic.js"></script>
<script src="./TryHackMe _ Sysmon_files/tasks.js"></script>
<script src="./TryHackMe _ Sysmon_files/connection-status.js"></script>
<script src="./TryHackMe _ Sysmon_files/glossary.js"></script>
<script src="./TryHackMe _ Sysmon_files/room-mymachine.js"></script>
<script src="./TryHackMe _ Sysmon_files/heartbeat.js" defer=""></script>
<script>

    let height
    $(window).scroll(function () { /* Function to make IP information sticky. */
      if (height == undefined || height < 30) {
        height = ($('#instance-info').offset().top)
      }
      let scroll = $(window).scrollTop()
      if (((scroll >= (height + 150))) && height > 30) {
        $("#instance-info").addClass('instance-sticky')
      } else if ((scroll <= (height))) {
        $("#instance-info").removeClass("instance-sticky")
      }
    })

    const csrfToken = "56xXlxUM-A7pav4drkP2COIkGdLQkiqfLDxo"
    $.ajaxSetup({ headers: { 'CSRF-Token': csrfToken } }) // all $.post headers include token (needs csrfProtection middleware)

    const roomCode = "sysmon"
    const simpleRoom = true 
    const events = {"tickets":false}

    let userObj = { 
      subscribed: 1,
      splitScreen: true,
      path: "blueteam",
      tutorial: {
        rooms: true,
        attackbox: true,
        staticsite: true
      },
      experiments:  JSON.parse(`{"onboardingAchievement":{},"scheduler":{"startDate":"2023-06-14T13:38:51.108Z"},"showEasyPath":true}`),
    }

    const roomSettings = {
      remAttackBoxBtn : false
    };

    const heartbeatInterval = 30;

    const cloudEnabled = false 
    let cloudObj

    initRoom()
    checkVideoTab()
    if(!simpleRoom) showChart(roomCode)

    checkRoomAwards(roomCode)

    getRoomVotes()

    displayStreakFreezeAwardedFromMemory();
    
    window.addEventListener('load', function () {
      introjsInit(roomCode)
    })

  </script>


<svg id="SvgjsSvg1001" width="2" height="0" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.dev" style="overflow: hidden; top: -100%; left: -100%; position: absolute; opacity: 0;"><defs id="SvgjsDefs1002"></defs><polyline id="SvgjsPolyline1003" points="0,0"></polyline><path id="SvgjsPath1004" d="M0 0 "></path></svg><div id="E607A5EC-1191-4ED5-8DAA-B79592DE30EB"></div><iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" aria-hidden="true" tabindex="-1" title="Intercom" src="./TryHackMe _ Sysmon_files/saved_resource(1).html"></iframe><div class="intercom-lightweight-app"><div class="intercom-lightweight-app-launcher intercom-launcher" role="button" tabindex="0" aria-label="Open Intercom Messenger" aria-live="polite"><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-open"><img src="./TryHackMe _ Sysmon_files/9e0f012f15b6fc981dde2f1f5198d728.png" alt="" class="intercom-lightweight-app-launcher-custom-icon-open"></div><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-minimize"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M18.601 8.39897C18.269 8.06702 17.7309 8.06702 17.3989 8.39897L12 13.7979L6.60099 8.39897C6.26904 8.06702 5.73086 8.06702 5.39891 8.39897C5.06696 8.73091 5.06696 9.2691 5.39891 9.60105L11.3989 15.601C11.7309 15.933 12.269 15.933 12.601 15.601L18.601 9.60105C18.9329 9.2691 18.9329 8.73091 18.601 8.39897Z" fill="white"></path>
</svg>
</div></div><style id="intercom-lightweight-app-style" type="text/css">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    0% {
      opacity: 0;
      transform: scale(0);
    }
    40% {
      opacity: 1;
    }
    100% {
      transform: scale(1);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji", Helvetica, Arial, sans-serif;
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    padding: 0 !important;
    margin: 0 !important;
    border: none;
    bottom: 20px;
    right: 20px;
    max-width: 48px;
    width: 48px;
    max-height: 48px;
    height: 48px;
    border-radius: 50%;
    background: #1C2538;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    transition: transform 167ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    box-sizing: content-box;
  }


  .intercom-lightweight-app-launcher:hover {
    transition: transform 250ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    transform: scale(1.1)
  }

  .intercom-lightweight-app-launcher:active {
    transform: scale(0.85);
    transition: transform 134ms cubic-bezier(0.45, 0, 0.2, 1);
  }


  .intercom-lightweight-app-launcher:focus {
    outline: none;

    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 48px;
    height: 48px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 24px;
    height: 24px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 44px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 24px;
    max-width: 24px;

    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: white;
    animation: intercom-lightweight-app-messenger 250ms cubic-bezier(0, 1, 1, 1);
    transform-origin: bottom right;
    
        width: 400px;
        height: calc(100% - 104px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 84px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
      

    border-radius: 16px;
  }

  .intercom-lightweight-app-messenger-header {
    height: 64px;
    border-bottom: none;
    background: #1c2538

    
  }

  .intercom-lightweight-app-messenger-footer{
    position:absolute;
    bottom:0;
    width: 100%;
    height: 80px;
    background: #fff;
    font-size: 14px;
    line-height: 21px;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0px 0px 25px rgba(0, 0, 0, 0.05);
    
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div></body></html>