<!DOCTYPE html>
<!-- saved from url=(0049)https://tryhackme.com/room/antireverseengineering -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>TryHackMe | Anti-Reverse Engineering</title>
<meta name="description" content="Learn the techniques used by malware authors to bypass detection.">
<meta name="og:description" content="Learn the techniques used by malware authors to bypass detection.">
<meta name="keywords" content="cyber,security,cyber security,cyber security training,coding,computer,bitcoin,hacking,hackers,hacks,hack,exploits,keylogger,learn,poc">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<meta property="og:site_name" content="TryHackMe">
<meta property="og:title" content="TryHackMe | Anti-Reverse Engineering">
<meta property="og:image" content="https://tryhackme-images.s3.amazonaws.com/room-icons/268bddbcaf57156efad5fd6a7ea3c621.png">
<meta property="og:url" content="https://tryhackme.com/room/antireverseengineering">
<meta name="twitter:image" content="https://tryhackme.com/img/meta/default.png">
<meta property="og:description" content="Learn the techniques used by malware authors to bypass detection.">

<script type="text/javascript" async="" src="./TryHackMe _ Anti-Reverse Engineering_files/pgpbhph6"></script><script src="./TryHackMe _ Anti-Reverse Engineering_files/jquery.min.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/popper.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Anti-Reverse Engineering_files/boostrap431.min.css">
<script src="./TryHackMe _ Anti-Reverse Engineering_files/bootstrap431.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Anti-Reverse Engineering_files/animate.min.css">
<link rel="stylesheet" href="./TryHackMe _ Anti-Reverse Engineering_files/all.css" integrity="sha384-ekOryaXPbeCpWQNxMwSWVvQ0+1VrStoPJq54shlYhR8HzQgig1v5fas6YgOqLoKz" crossorigin="anonymous">
<link rel="icon" type="image/png" href="https://assets.tryhackme.com/img/favicon.png">
<link rel="stylesheet" media="screen" href="./TryHackMe _ Anti-Reverse Engineering_files/general-style.css">
<script src="./TryHackMe _ Anti-Reverse Engineering_files/script.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/validation.js"></script>

<link rel="stylesheet" type="text/css" href="./TryHackMe _ Anti-Reverse Engineering_files/cookieconsent.min.css">
<script src="./TryHackMe _ Anti-Reverse Engineering_files/cookieconsent.min.js"></script>
<script async="" src="./TryHackMe _ Anti-Reverse Engineering_files/js"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-Z8D4WL3D4P');
  </script>


<script>
    window.intercomSettings = {
      api_base: "https://api-iam.intercom.io",
      app_id: "pgpbhph6"
    };
  </script>
<script>
    (function (h, o, t, j, a, r) {
      h.hj = h.hj || function () { (h.hj.q = h.hj.q || []).push(arguments) };
      h._hjSettings = { hjid: 1950941, hjsv: 6 };
      a = o.getElementsByTagName('head')[0];
      r = o.createElement('script'); r.async = 1;
      r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
      a.appendChild(r);
    })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
  </script><script async="" src="./TryHackMe _ Anti-Reverse Engineering_files/hotjar-1950941.js"></script>
<script>
    /* Global javascript variables */

    // Used inside script.js for createRooms compelted users.
    const username = 'Silv3rsurf3r'
    const subscribed = '1'
    const level = '10'
    const intercomEnabled = 'true'
  </script>
<script>
    //add back tracking info
    const userId = "63d14e7f857ae10041bb192f"
    let tutorialComplete = false
    if ('false' == "true") {
      tutorialComplete = true
    }
    if(intercomEnabled === "true"){
      window.intercomSettings = {
        api_base: "https://api-iam.intercom.io",
        app_id: "pgpbhph6",
        user_id: userId,
        username: username,
        email: "giftonpaul@karunya.edu.in",
        created_at: Math.floor(new Date("Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)").getTime() / 1000) // Signup date as a Unix timestamp
      };
    }
    window.hj('identify', userId, {
      displayName: username,
      subscribed: "1",
      dateSignUp: "Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)",
      experience: "advanced"
    })
  </script>
<script type="application/ld+json">

   {
      "@context":"https://schema.org",
      "@type":"Organization",
      "url":"https://tryhackme.com",
      "name":"TryHackMe",
      "logo":"https://tryhackme.com/img/favicon.png",
      "description":"TryHackMe is a free online platform for learning cyber security, using hands-on exercises and labs, all through your browser!",
      "email": "support@tryhackme.com",
      "sameAs":[
         "https://www.linkedin.com/company/tryhackme",
         "https://twitter.com/realtryhackme"
      ]
   }

</script>
<script>
    console.log(`%c
      ------------------
      < Happy Hacking! >
      ------------------
              \\   ^__^
               \\  (oo)\\_______
                  (__)\\       )\\/\\
                      ||----w |
                      ||     ||`, "font-family:monospace")
  </script>
<script>
  (function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pgpbhph6';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/socket.io.js"></script><script>
  let socket = io.connect({
    transports: ['websocket'],
    reconnection: true,
    reconnectionDelay: 1000,
    reconnectionAttempts: 10
  })
</script><script async="" src="./TryHackMe _ Anti-Reverse Engineering_files/modules.85ce248fb47f3a28349a.js" charset="utf-8"></script><style type="text/css">.apexcharts-canvas {
  position: relative;
  user-select: none;
  /* cannot give overflow: hidden as it will crop tooltips which overflow outside chart area */
}


/* scrollbar is not visible by default for legend, hence forcing the visibility */
.apexcharts-canvas ::-webkit-scrollbar {
  -webkit-appearance: none;
  width: 6px;
}

.apexcharts-canvas ::-webkit-scrollbar-thumb {
  border-radius: 4px;
  background-color: rgba(0, 0, 0, .5);
  box-shadow: 0 0 1px rgba(255, 255, 255, .5);
  -webkit-box-shadow: 0 0 1px rgba(255, 255, 255, .5);
}


.apexcharts-inner {
  position: relative;
}

.apexcharts-text tspan {
  font-family: inherit;
}

.legend-mouseover-inactive {
  transition: 0.15s ease all;
  opacity: 0.20;
}

.apexcharts-series-collapsed {
  opacity: 0;
}

.apexcharts-tooltip {
  border-radius: 5px;
  box-shadow: 2px 2px 6px -4px #999;
  cursor: default;
  font-size: 14px;
  left: 62px;
  opacity: 0;
  pointer-events: none;
  position: absolute;
  top: 20px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  white-space: nowrap;
  z-index: 12;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-theme-light {
  border: 1px solid #e3e3e3;
  background: rgba(255, 255, 255, 0.96);
}

.apexcharts-tooltip.apexcharts-theme-dark {
  color: #fff;
  background: rgba(30, 30, 30, 0.8);
}

.apexcharts-tooltip * {
  font-family: inherit;
}


.apexcharts-tooltip-title {
  padding: 6px;
  font-size: 15px;
  margin-bottom: 4px;
}

.apexcharts-tooltip.apexcharts-theme-light .apexcharts-tooltip-title {
  background: #ECEFF1;
  border-bottom: 1px solid #ddd;
}

.apexcharts-tooltip.apexcharts-theme-dark .apexcharts-tooltip-title {
  background: rgba(0, 0, 0, 0.7);
  border-bottom: 1px solid #333;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  display: inline-block;
  font-weight: 600;
  margin-left: 5px;
}

.apexcharts-tooltip-text-y-label:empty,
.apexcharts-tooltip-text-y-value:empty,
.apexcharts-tooltip-text-goals-label:empty,
.apexcharts-tooltip-text-goals-value:empty,
.apexcharts-tooltip-text-z-value:empty {
  display: none;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  font-weight: 600;
}

.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-goals-group, 
.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  display: flex;
}
.apexcharts-tooltip-text-goals-label:not(:empty),
.apexcharts-tooltip-text-goals-value:not(:empty) {
  margin-top: -6px;
}

.apexcharts-tooltip-marker {
  width: 12px;
  height: 12px;
  position: relative;
  top: 0px;
  margin-right: 10px;
  border-radius: 50%;
}

.apexcharts-tooltip-series-group {
  padding: 0 10px;
  display: none;
  text-align: left;
  justify-content: left;
  align-items: center;
}

.apexcharts-tooltip-series-group.apexcharts-active .apexcharts-tooltip-marker {
  opacity: 1;
}

.apexcharts-tooltip-series-group.apexcharts-active,
.apexcharts-tooltip-series-group:last-child {
  padding-bottom: 4px;
}

.apexcharts-tooltip-series-group-hidden {
  opacity: 0;
  height: 0;
  line-height: 0;
  padding: 0 !important;
}

.apexcharts-tooltip-y-group {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-box, .apexcharts-custom-tooltip {
  padding: 4px 8px;
}

.apexcharts-tooltip-boxPlot {
  display: flex;
  flex-direction: column-reverse;
}

.apexcharts-tooltip-box>div {
  margin: 4px 0;
}

.apexcharts-tooltip-box span.value {
  font-weight: bold;
}

.apexcharts-tooltip-rangebar {
  padding: 5px 8px;
}

.apexcharts-tooltip-rangebar .category {
  font-weight: 600;
  color: #777;
}

.apexcharts-tooltip-rangebar .series-name {
  font-weight: bold;
  display: block;
  margin-bottom: 5px;
}

.apexcharts-xaxistooltip {
  opacity: 0;
  padding: 9px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
  transition: 0.15s ease all;
}

.apexcharts-xaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-xaxistooltip:after,
.apexcharts-xaxistooltip:before {
  left: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-xaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-left: -6px;
}

.apexcharts-xaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-left: -7px;
}

.apexcharts-xaxistooltip-bottom:after,
.apexcharts-xaxistooltip-bottom:before {
  bottom: 100%;
}

.apexcharts-xaxistooltip-top:after,
.apexcharts-xaxistooltip-top:before {
  top: 100%;
}

.apexcharts-xaxistooltip-bottom:after {
  border-bottom-color: #ECEFF1;
}

.apexcharts-xaxistooltip-bottom:before {
  border-bottom-color: #90A4AE;
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:after {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:before {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top:after {
  border-top-color: #ECEFF1
}

.apexcharts-xaxistooltip-top:before {
  border-top-color: #90A4AE;
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:after {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:before {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-yaxistooltip {
  opacity: 0;
  padding: 4px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
}

.apexcharts-yaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-yaxistooltip:after,
.apexcharts-yaxistooltip:before {
  top: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-yaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-top: -6px;
}

.apexcharts-yaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-top: -7px;
}

.apexcharts-yaxistooltip-left:after,
.apexcharts-yaxistooltip-left:before {
  left: 100%;
}

.apexcharts-yaxistooltip-right:after,
.apexcharts-yaxistooltip-right:before {
  right: 100%;
}

.apexcharts-yaxistooltip-left:after {
  border-left-color: #ECEFF1;
}

.apexcharts-yaxistooltip-left:before {
  border-left-color: #90A4AE;
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:after {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:before {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right:after {
  border-right-color: #ECEFF1;
}

.apexcharts-yaxistooltip-right:before {
  border-right-color: #90A4AE;
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:after {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:before {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip.apexcharts-active {
  opacity: 1;
}

.apexcharts-yaxistooltip-hidden {
  display: none;
}

.apexcharts-xcrosshairs,
.apexcharts-ycrosshairs {
  pointer-events: none;
  opacity: 0;
  transition: 0.15s ease all;
}

.apexcharts-xcrosshairs.apexcharts-active,
.apexcharts-ycrosshairs.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-ycrosshairs-hidden {
  opacity: 0;
}

.apexcharts-selection-rect {
  cursor: move;
}

.svg_select_boundingRect, .svg_select_points_rot {
  pointer-events: none;
  opacity: 0;
  visibility: hidden;
}
.apexcharts-selection-rect + g .svg_select_boundingRect,
.apexcharts-selection-rect + g .svg_select_points_rot {
  opacity: 0;
  visibility: hidden;
}

.apexcharts-selection-rect + g .svg_select_points_l,
.apexcharts-selection-rect + g .svg_select_points_r {
  cursor: ew-resize;
  opacity: 1;
  visibility: visible;
}

.svg_select_points {
  fill: #efefef;
  stroke: #333;
  rx: 2;
}

.apexcharts-svg.apexcharts-zoomable.hovering-zoom {
  cursor: crosshair
}

.apexcharts-svg.apexcharts-zoomable.hovering-pan {
  cursor: move
}

.apexcharts-zoom-icon,
.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon,
.apexcharts-reset-icon,
.apexcharts-pan-icon,
.apexcharts-selection-icon,
.apexcharts-menu-icon,
.apexcharts-toolbar-custom-icon {
  cursor: pointer;
  width: 20px;
  height: 20px;
  line-height: 24px;
  color: #6E8192;
  text-align: center;
}

.apexcharts-zoom-icon svg,
.apexcharts-zoomin-icon svg,
.apexcharts-zoomout-icon svg,
.apexcharts-reset-icon svg,
.apexcharts-menu-icon svg {
  fill: #6E8192;
}

.apexcharts-selection-icon svg {
  fill: #444;
  transform: scale(0.76)
}

.apexcharts-theme-dark .apexcharts-zoom-icon svg,
.apexcharts-theme-dark .apexcharts-zoomin-icon svg,
.apexcharts-theme-dark .apexcharts-zoomout-icon svg,
.apexcharts-theme-dark .apexcharts-reset-icon svg,
.apexcharts-theme-dark .apexcharts-pan-icon svg,
.apexcharts-theme-dark .apexcharts-selection-icon svg,
.apexcharts-theme-dark .apexcharts-menu-icon svg,
.apexcharts-theme-dark .apexcharts-toolbar-custom-icon svg {
  fill: #f3f4f5;
}

.apexcharts-canvas .apexcharts-zoom-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-selection-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-reset-zoom-icon.apexcharts-selected svg {
  fill: #008FFB;
}

.apexcharts-theme-light .apexcharts-selection-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoom-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoomin-icon:hover svg,
.apexcharts-theme-light .apexcharts-zoomout-icon:hover svg,
.apexcharts-theme-light .apexcharts-reset-icon:hover svg,
.apexcharts-theme-light .apexcharts-menu-icon:hover svg {
  fill: #333;
}

.apexcharts-selection-icon,
.apexcharts-menu-icon {
  position: relative;
}

.apexcharts-reset-icon {
  margin-left: 5px;
}

.apexcharts-zoom-icon,
.apexcharts-reset-icon,
.apexcharts-menu-icon {
  transform: scale(0.85);
}

.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon {
  transform: scale(0.7)
}

.apexcharts-zoomout-icon {
  margin-right: 3px;
}

.apexcharts-pan-icon {
  transform: scale(0.62);
  position: relative;
  left: 1px;
  top: 0px;
}

.apexcharts-pan-icon svg {
  fill: #fff;
  stroke: #6E8192;
  stroke-width: 2;
}

.apexcharts-pan-icon.apexcharts-selected svg {
  stroke: #008FFB;
}

.apexcharts-pan-icon:not(.apexcharts-selected):hover svg {
  stroke: #333;
}

.apexcharts-toolbar {
  position: absolute;
  z-index: 11;
  max-width: 176px;
  text-align: right;
  border-radius: 3px;
  padding: 0px 6px 2px 6px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.apexcharts-menu {
  background: #fff;
  position: absolute;
  top: 100%;
  border: 1px solid #ddd;
  border-radius: 3px;
  padding: 3px;
  right: 10px;
  opacity: 0;
  min-width: 110px;
  transition: 0.15s ease all;
  pointer-events: none;
}

.apexcharts-menu.apexcharts-menu-open {
  opacity: 1;
  pointer-events: all;
  transition: 0.15s ease all;
}

.apexcharts-menu-item {
  padding: 6px 7px;
  font-size: 12px;
  cursor: pointer;
}

.apexcharts-theme-light .apexcharts-menu-item:hover {
  background: #eee;
}

.apexcharts-theme-dark .apexcharts-menu {
  background: rgba(0, 0, 0, 0.7);
  color: #fff;
}

@media screen and (min-width: 768px) {
  .apexcharts-canvas:hover .apexcharts-toolbar {
    opacity: 1;
  }
}

.apexcharts-datalabel.apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-pie-label,
.apexcharts-datalabels,
.apexcharts-datalabel,
.apexcharts-datalabel-label,
.apexcharts-datalabel-value {
  cursor: default;
  pointer-events: none;
}

.apexcharts-pie-label-delay {
  opacity: 0;
  animation-name: opaque;
  animation-duration: 0.3s;
  animation-fill-mode: forwards;
  animation-timing-function: ease;
}

.apexcharts-canvas .apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-hide .apexcharts-series-points {
  opacity: 0;
}

.apexcharts-gridline,
.apexcharts-annotation-rect,
.apexcharts-tooltip .apexcharts-marker,
.apexcharts-area-series .apexcharts-area,
.apexcharts-line,
.apexcharts-zoom-rect,
.apexcharts-toolbar svg,
.apexcharts-area-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-line-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-radar-series path,
.apexcharts-radar-series polygon {
  pointer-events: none;
}


/* markers */

.apexcharts-marker {
  transition: 0.15s ease all;
}

@keyframes opaque {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}


/* Resize generated styles */

@keyframes resizeanim {
  from {
    opacity: 0;
  }
  to {
    opacity: 0;
  }
}

.resize-triggers {
  animation: 1ms resizeanim;
  visibility: hidden;
  opacity: 0;
}

.resize-triggers,
.resize-triggers>div,
.contract-trigger:before {
  content: " ";
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  overflow: hidden;
}

.resize-triggers>div {
  background: #eee;
  overflow: auto;
}

.contract-trigger:before {
  width: 200%;
  height: 200%;
}</style><style data-jss="" data-meta="MuiDialog">
@media print {
  .MuiDialog-root {
    position: absolute !important;
  }
}
.MuiDialog-scrollPaper {
  display: flex;
  align-items: center;
  justify-content: center;
}
.MuiDialog-scrollBody {
  overflow-x: hidden;
  overflow-y: auto;
  text-align: center;
}
.MuiDialog-scrollBody:after {
  width: 0;
  height: 100%;
  content: "";
  display: inline-block;
  vertical-align: middle;
}
.MuiDialog-container {
  height: 100%;
  outline: 0;
}
@media print {
  .MuiDialog-container {
    height: auto;
  }
}
.MuiDialog-paper {
  margin: 32px;
  position: relative;
  overflow-y: auto;
}
@media print {
  .MuiDialog-paper {
    box-shadow: none;
    overflow-y: visible;
  }
}
.MuiDialog-paperScrollPaper {
  display: flex;
  max-height: calc(100% - 64px);
  flex-direction: column;
}
.MuiDialog-paperScrollBody {
  display: inline-block;
  text-align: left;
  vertical-align: middle;
}
.MuiDialog-paperWidthFalse {
  max-width: calc(100% - 64px);
}
.MuiDialog-paperWidthXs {
  max-width: 444px;
}
@media (max-width:507.95px) {
  .MuiDialog-paperWidthXs.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthSm {
  max-width: 600px;
}
@media (max-width:663.95px) {
  .MuiDialog-paperWidthSm.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthMd {
  max-width: 960px;
}
@media (max-width:1023.95px) {
  .MuiDialog-paperWidthMd.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthLg {
  max-width: 1280px;
}
@media (max-width:1343.95px) {
  .MuiDialog-paperWidthLg.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthXl {
  max-width: 1920px;
}
@media (max-width:1983.95px) {
  .MuiDialog-paperWidthXl.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperFullWidth {
  width: calc(100% - 64px);
}
.MuiDialog-paperFullScreen {
  width: 100%;
  height: 100%;
  margin: 0;
  max-width: 100%;
  max-height: none;
  border-radius: 0;
}
.MuiDialog-paperFullScreen.MuiDialog-paperScrollBody {
  margin: 0;
  max-width: 100%;
}
</style><style></style></head>


<body><div role="dialog" aria-live="polite" aria-label="cookieconsent" aria-describedby="cookieconsent:desc" class="cc-window cc-floating cc-type-info cc-theme-classic cc-bottom cc-right cc-color-override-382972913 cc-invisible" style="display: none;"><!--googleoff: all--><span id="cookieconsent:desc" class="cc-message">We use cookies to ensure you get the best user experience. For more information contact us. <a aria-label="learn more about cookies" role="button" tabindex="0" class="cc-link" href="https://tryhackme.com/legal/terms-of-use" target="_blank">Read more</a></span><div class="cc-compliance"><a aria-label="dismiss cookie message" role="button" tabindex="0" class="cc-btn cc-dismiss">Got it!</a></div><!--googleon: all--></div>
<link href="./TryHackMe _ Anti-Reverse Engineering_files/scoreboard.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Anti-Reverse Engineering_files/introjs.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Anti-Reverse Engineering_files/slideout.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Anti-Reverse Engineering_files/public-rooms.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Anti-Reverse Engineering_files/asciinema-player.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Anti-Reverse Engineering_files/prism.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Anti-Reverse Engineering_files/magnific-popup.css" rel="stylesheet" type="text/css"> 
<script src="./TryHackMe _ Anti-Reverse Engineering_files/lottie-player.js"></script>

<div id="room-content">
<div id="room-content-main">
<nav class="navbar navbar-expand-md navbar-dark navbar-color-loggedin navbar-main">
<div class="container">
<button id="thm-mobile-nav-open" class="thm-nav__hamburger-btn" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Open mobile navigation">
<span class="thm-nav__hamburger-lines"></span>
</button>
<div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
<div class="navbar-brand" href="/">
<a href="https://tryhackme.com/dashboard">
<img width="115px" src="./TryHackMe _ Anti-Reverse Engineering_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
</div>
<ul class="navbar-nav mr-auto mt-2 mt-lg-0 navbar-pagelinks">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="navbar-item-icon far fa-browser"></i>
<div class="navbar-item-text">Dashboard</div>
</a>
</li>
<li class="nav-item active" id="nav-learn">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="navbar-item-icon far fa-book-open"></i>
<div class="navbar-item-text">Learn</div>
</a>
</li>
<li class="nav-item  dropdown lite-removable">
<a id="nav-other" class="nav-link" href="https://tryhackme.com/room/antireverseengineering#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-trophy"></i>
<div class="navbar-item-text">Compete</div>
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdown">
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/leaderboards">
<div class="dropdown-menu-icon">
<i class="fas fa-trophy"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/games/koth">
<div class="dropdown-menu-icon">
<i class="fas fa-crown"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/workspace">
<div class="dropdown-menu-icon">
<i class="fas fa-user-friends"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item dropdown">
<a data-cy="nav-other-menu-button" id="nav-other" class="nav-link" href="https://tryhackme.com/room/antireverseengineering#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-ellipsis-h-alt"></i>
<div class="navbar-item-text">Other</div>
</a>
<div data-cy="nav-other-menu" class="dropdown-menu dropdown-menu-center large-dropdown" aria-labelledby="navbarDropdown">
<span class="dropdown-menu-arrow"></span>
<a class="dropdown-item" href="https://tryhackme.com/resources">Resources</a>
<a class="dropdown-item" href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a class="dropdown-item" href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/business">For Business</a>
<a class="dropdown-item" href="https://tryhackme.com/classrooms">For Education</a>
<a class="dropdown-item" target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
<a class="dropdown-item" href="https://tryhackme.com/glossary">Glossary</a>
</div>
</li>
</ul>
<ul class="navbar-nav navbar-right options vertical-align-custom">
<li class="nav-item" data-toggle="modal" data-target="#navConnModal">
<div id="thm-connection-status" class="thm-disconnected" style="display: flex;">
<div id="thm-connection-status-dot" class="dot-small"></div> <span id="thm-connection-status-txt" class="ml-2 size-18 text-white">Access Machines</span>
</div>
</li>
<li class="nav-item">
<div class="nav-item-streak">
<span id="streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="">
<span id="user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>
<script>
                            let usersStreak = { // Global variable, used in rooms logic
                                streakFirstAnswered: new Date('Mon Jul 10 2023 03:13:45 GMT+0100 (British Summer Time)'),
                                streakLastAnswered: new Date('Sun Jul 16 2023 18:47:44 GMT+0100 (British Summer Time)'),
                                usersTimezone: 'Asia/Kolkata',
                                streakFreeze: 1
                            };
                            setSidebarStreaks(usersStreak.streakFirstAnswered, usersStreak.streakLastAnswered, usersStreak.usersTimezone, usersStreak.streakFreeze)
                        </script>
</div>
</li>
<li class="nav-item dropdown" id="notification-navitem">
<a class="nav-link vertical-align-custom size-22 pl-0" href="https://tryhackme.com/room/antireverseengineering#" id="notification-btn" role="button" data-toggle="dropdown">
<i id="notification-icon" class="fal fa-bell"></i>
<div id="notification-dot"></div>
</a>
<div id="nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="notification-header">Notifications</div>
<div id="nav-notifications">
<div class="text-center mt-2 mb-2"><i>Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle remove-arrow p-0" href="https://tryhackme.com/room/antireverseengineering#" id="navbarAvatarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
<img src="./TryHackMe _ Anti-Reverse Engineering_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarAvatarDropdown">
<a class="dropdown-item" href="https://tryhackme.com/profile">Profile</a>
<a class="dropdown-item" href="https://tryhackme.com/referrals">Refer a friend</a>
<a class="dropdown-item" href="https://tryhackme.com/badges">Badges</a>
<a class="dropdown-item" href="https://tryhackme.com/rooms">My Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/access">Access</a>
<a class="dropdown-item" href="https://tryhackme.com/feedback">Give Feedback</a>
<a class="dropdown-item" href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</div>
</div>
</nav>
<link rel="stylesheet" href="./TryHackMe _ Anti-Reverse Engineering_files/streak-freeze.css">
<div class="modal fade modal-streak-freeze" id="unlocked-streak-freeze" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<button type="button" class="close close-streak" id="close-streak-freeze-popup" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<div class="modal-body">
<figure>
<img class="img-streak" width="400px" alt="streak freeze unlocked" src="./TryHackMe _ Anti-Reverse Engineering_files/streak-freeze.svg">
</figure>
<h2>You've unlocked a streak freeze!</h2>
<p>With these one-time streak freezes, you can miss one day of hacking without losing your streak.</p>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/streak-freeze.js"></script>
<nav id="thm-mobile-nav-menu" class="thm-mobile-nav" aria-label="Mobile secondary navigation menu.">
<header>
<a href="https://tryhackme.com/" aria-label="Go to the home page">
<img width="140" src="./TryHackMe _ Anti-Reverse Engineering_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
<button id="thm-mobile-nav-close" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Close mobile navigation">
<i class="fal fa-times"></i>
</button>
</header>
<ul class="thm-mobile-nav-items mb-0">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="nav-title-icon far fa-browser"></i>
<div class="nav-title">Dashboard</div>
</a>
</li>
<li class="nav-item active">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="nav-title-icon far fa-book-open"></i>
<div class="nav-title">Learn</div>
</a>
</li>
<li class="nav-item ">
<a aria-expanded="false" aria-controls="mobile-nav-compete" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-compete" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-trophy"></i>
<div class="nav-title">Compete</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-compete" class="dropdown-wrapper">
<a href="https://tryhackme.com/leaderboards">
<div>
<i class="fas fa-trophy"></i>
</div>
<div>
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a href="https://tryhackme.com/games/koth">
<div>
<i class="fas fa-crown"></i>
</div>
<div>
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a href="https://tryhackme.com/workspace">
<div>
<i class="fas fa-user-friends"></i>
</div>
<div>
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item">
<a aria-expanded="false" aria-controls="mobile-nav-other" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-other" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-ellipsis-h-alt"></i>
<div class="nav-title">Other</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-other" class="dropdown-wrapper">
<a href="https://tryhackme.com/resources">Resources</a>
<a href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a href="https://tryhackme.com/business">For Business</a>
<a href="https://tryhackme.com/classrooms">For Education</a>
<a target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
</div>
</li>
<li class="nav-item text-center">
<div class="nav-item-streak">
<span id="mobile-streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="">
<span id="mobile-user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>
</div>
</li>
<li class="nav-item text-center">
<a class="nav-link size-22 d-inline-block" href="https://tryhackme.com/room/antireverseengineering#" id="mobile-notification-btn" role="button" data-toggle="dropdown">
<i id="mobile-notification-icon" class="fal fa-bell"></i>
<div id="mobile-notification-dot"></div>
</a>
<div id="mobile-nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="mobile-notification-header">Notifications</div>
<div id="mobile-nav-notifications">
<div class="text-center mt-2 mb-2"><i>Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item text-center">
<a aria-expanded="false" aria-controls="mobile-nav-auth" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-auth" class="sublinks-toggle nav-link d-inline-block">
<img src="./TryHackMe _ Anti-Reverse Engineering_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div id="mobile-nav-auth" class="dropdown-wrapper">
<a href="https://tryhackme.com/profile">Profile</a>
<a href="https://tryhackme.com/referrals">Refer a friend</a>
<a href="https://tryhackme.com/badges">Badges</a>
<a href="https://tryhackme.com/rooms">My Rooms</a>
<a href="https://tryhackme.com/access">Access</a>
<a href="https://tryhackme.com/feedback">Give Feedback</a>
<a href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</nav>
<script defer="" src="./TryHackMe _ Anti-Reverse Engineering_files/mobile-nav.js"></script>
<script>
  const userSignedUpLessThanSevenDaysAgo = Math.floor(
    (new Date() - new Date('Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)')) / (1000 * 60 * 60 * 24) < 7
  );

  const userHasFirst4RoomsBadge = !!``;
  const isBeginner = `advanced` === 'complete-beginner';
</script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/notifications.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/streak-freeze(1).js"></script>
<div id="wrapper">
<div id="room-banner" class="shadow-light">
<img id="room-image-large" src="./TryHackMe _ Anti-Reverse Engineering_files/dissecting_pe_headers.png">
<div>
<div id="room-details">
<div class="container">
<div class="page-header">
<div class="room-header">
<div id="room-voting" class="text-center vertical-align-custom">
<div class="voting-buttons">
<i class="fas fa-thumbs-up display-block" onclick="makeVote(true)" id="vote-up" style="color: rgb(185, 185, 185);"></i>
<div class="display-block" id="vote-number">73</div>
<i class="fas fa-thumbs-down display-block" onclick="makeVote(false)" id="vote-down" style="color: rgb(185, 185, 185);"></i>
</div>
</div>
<div id="room-logo" class="vertical-align-custom">
<div id="logo"><img class="room-avatar" src="./TryHackMe _ Anti-Reverse Engineering_files/268bddbcaf57156efad5fd6a7ea3c621.png" onerror="replaceImg(this)"></div>
</div>
<div class="vertical-align-custom">
<div id="room-basic-data">
<div class="d-flex justify-content-between">
<h1 id="title" class="bold-head">Anti-Reverse Engineering</h1>
<div id="room-title-options">

<div class="btn-group" id="browser-machine-options" role="group" aria-label="Start AttackBox or Kali Linux" style="display: inline-flex;">
<button id="browser-machine-start" type="button" class="btn btn-secondary"><i class="far fa-laptop"></i> Start AttackBox</button>
<div class="btn-group" id="browser-machines" role="group">
<button id="btnGroupDrop1" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
<div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
<a class="dropdown-item  preventDefault" href="https://tryhackme.com/room/antireverseengineering#" onclick="changeMyMachine(&quot;kali-linux&quot;)">
<span class="mb-0">Use Kali Linux</span>
<div class="text-lgray size-12">Web-based Kali Machine</div>
</a>
<a class="dropdown-item preventDefault" href="https://tryhackme.com/room/antireverseengineering#" onclick="changeMyMachine(&quot;attackbox&quot;)">
<span class="mb-0">Use AttackBox</span>
<div class="text-lgray size-12">Recommended</div>
</a>
</div>
</div>
</div>
<button id="browser-machine-split-view" type="button" class="btn btn-secondary">Show Split View</button>
<button id="cloud-details" type="button" class="btn btn-info"><i class="far fa-clouds mr-1"></i>Cloud Details</button>
<span id="awards-model-btn" data-toggle="modal" data-target="#award-modal" class="badge badge-warning ml-1 noselect">Awards</span>
<span id="room-faq-slideout" type="button" class="badge badge-info ml-1 noselect d-inline-flex" onclick="openHelpMenu()">
Help
</span>
<div class="dropright room-dropright noselect ml-1" id="room-options" style="display: inline-block;">
<span class="badge badge-secondary" data-toggle="dropdown">
<i class="fas fa-cog"></i>
</span>
<div class="dropdown-menu">
<a class="dropdown-item" href="https://tryhackme.com/api/room/manage/clone/antireverseengineering" id="clone-room" style="display: none;"><i class="far fa-clone faded"></i> Clone Room</a>
<a class="dropdown-item preventDefault" id="writeups-simple" style="display: inline-block;"><i class="fas fa-pen-alt faded"></i> Writeups</a>
<a class="dropdown-item preventDefault" data-toggle="modal" data-target="#resetUserProgressModal"><i class="fas fa-eraser faded"></i> Reset Progress</a>
<a class="dropdown-item preventDefault" id="leave-room"><i class="fas fa-sign-out-alt faded"></i> Leave</a>
</div>
</div>
<span id="bookmark" class="badge badge-secondary badge-bookmark ">
<img class="bookmark" src="./TryHackMe _ Anti-Reverse Engineering_files/bookmark.svg">
<span class="bookmark-popover" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="top" data-content="&lt;p class=&#39;mb-0&#39;&gt;Save room &lt;/p&gt;
" data-original-title="" title="">
</span>
</span>
</div>
</div>
<p class="mb0 faded" id="description">Learn the techniques used by malware authors to bypass detection.</p>
</div>
</div>
</div>
</div>

</div>
</div>
<div id="room-banner-stats">
<div class="creators"></div>
<div class="numbers"></div>
</div>
</div>
</div>
<div class="container main pb">
<div id="room-message"></div>
<section id="sponsor">
<i id="sponsor-close" class="fas fa-times"></i>
<div id="sponsor-data"></div>
</section>
<div id="top-panel">
<ul class="nav nav-tabs" id="task-navs">
<li class="nav-item">
<a class="nav-link  active " data-toggle="tab" href="https://tryhackme.com/room/antireverseengineering#chart">
<i class="fas fa-chart-line icon-right"></i> Chart
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/antireverseengineering#scoreboard">
<i class="fas fa-trophy icon-right"></i> Scoreboard
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/antireverseengineering#chat">
<i class="fas fa-comments-alt icon-right chat-icon"></i> Discuss
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/antireverseengineering#writeups">
<i class="fas fa-pen-alt icon-right"></i> Writeups
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/antireverseengineering#about">
<i class="fas fa-info-circle icon-right"></i> More
</a>
</li>
</ul>
<div class="card cd-2 nav-above-con" id="room-main">
<div class="card-body">
<span id="room-tabs">
<div class="tab-content">
<div id="chart" class="tab-pane  active ">
<span id="difficulty-bar">
    <span class="room-difficulty diff-text">
      Difficulty: 
        <span class="difficulty-medium">Medium</span>
    </span></span>
<br><div id="chart-data"></div>
</div>
<div id="scoreboard" class="tab-pane fade">
<table class="table table-striped table-bordered table-condensed table-header-rotated mb-0" id="scoreboard_table">
<thead>
<tr id="scoreboard_header">
<th>Rank</th>
<th>Username</th>
<th>Total Score</th>
</tr>
</thead>
<tbody id="scoreboard_body"></tbody>
</table>
</div>
<div id="chat" class="tab-pane fade">

<div class="row">
<div class="col-sm-6 text-center">
<h3 class="mb-2">Discord</h3>
<p>Come join our <a target="_blank" href="https://discord.gg/QgC6Tdk">Discord</a> server for support or further discussions</p>
</div>
<div class="col-sm-6 text-center">
<h3 class="mb-2">Forum</h3>
<div id="forum-text">Read or post on the dedicated forum <a href="https://tryhackme.com/forum/thread/6488847104b3d33d3993272d">post</a></div>
</div>
</div>
</div>
<div id="writeups" class="tab-pane text-center">
<div id="writeups-data">There are no writeups submitted.</div>
<button onclick="showWriteupForm(this)" type="button" class="btn btn-xs btn-secondary mt-3 mb-2">Add Writeup</button>
<div id="writeup-form">
<div class="form-row">
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-title" placeholder="Writeup Title">
</div>
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-link" placeholder="Writeup URL">
</div>
<div class="col-auto">
<button id="submit-writeup" type="submit" class="btn btn-success mb-2">Submit</button>
</div>
</div>
<p class="faded mb-0 size-14"><i class="fas fa-exclamation-triangle text-warning"></i> Writeups should have a link to TryHackMe and not include any passwords/cracked hashes/flags</p>
</div>
</div>
<div id="about" class="tab-pane text-center">
<p id="about-freeRoom"><p class="mb-0">Only subscribers can deploy virtual machines in this room! 
        Go to your <a href="https://tryhackme.com/profile">profile</a> page to subscribe (if you have not already). 885 users are in here and this room is 34 days old.</p></p>
<p id="about-owner"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Anti-Reverse Engineering_files/af7feb2c43a2c7d5f111b98ccbd15048.png"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme">tryhackme</a> and <img class="avatar-tiny" src="./TryHackMe _ Anti-Reverse Engineering_files/26286532ed37cf8b7b375905f4306110.png"> 
        <a class="green-link" href="https://tryhackme.com/p/arebel">arebel</a></p></p>
</div>
</div>
</span>
</div>
</div>
</div>
<div id="room-simple-video" class="card card-body cd-2"></div>
<div class="card mt-3 mb-3 cd-2 text-center" id="instance-info">
<div class="card-header card-header-red">Active Machine Information</div>
<div class="card-body">
<div class="row vertical-align-custom">
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3" id="table-machine-ip">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
</div>
</div>
</div>
<div id="task-list">
<div id="room-task-detail" class="mb-3"><span id="progress-bar" style="display: block;"><div class="progress"><div class="progress-bar bg-secondary" role="progressbar" style="width: 5%; aria-valuemin=" 0"="" aria-valuemax="100"> 0%</div></div></span></div>
<div id="taskContent"><div class="card" id="task-1">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse1">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 1                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Introduction
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-server text-lgreen" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a deployable machine"></i></span>
                        </a>
                    </div>
                    <div id="collapse1" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><div class="btn-group mb-3 ml-3 float-right">
            <button type="button" class="btn btn-success" value="6448147b9d8ff90042b0c7d5" onclick="deploy(this)"><i class="fas fa-play mr-2"></i> Start Machine</button>
        </div> <p><span>﻿</span><img src="./TryHackMe _ Anti-Reverse Engineering_files/ef5e6dc86b83c0ceac8e9c3c233a73a4.png" alt="cycle-continues" style="float:left;width:25%" class="note-float-left"><span style="font-size:1rem">Malware authors are constantly looking for ways to evade detection and analysis to maintain the effectiveness of their malware. At the same time, security professionals are working to develop new methods and tools for detecting and mitigating the threat posed by malware. This ongoing "arms race" can lead to the development of increasingly sophisticated and effective malware defences as both sides seek to stay ahead of their counterparts.</span></p><div><div>Reverse engineering is the process of studying a technology product, software, or hardware to learn how it works and extract its functionality or design information.&nbsp;<span style="font-size:1rem">In cybersecurity, reverse engineering is used to understand how malware works, extract indicators of compromise (IOCs), and develop adequate detections, protections, and countermeasures.</span></div><div><br></div><div>As a response, malware authors are motivated to protect their malware from analysts. They use anti-reverse engineering techniques to make malware more challenging to analyze, so it can continue propagating and infecting more systems before security measures are implemented.</div><div><br></div><div>This constant back and forth between malware analysts and authors can be aptly described as an "arms race". Malware authors develop new and sophisticated techniques to avoid detection and analysis, and security professionals respond by developing new methods and tools to detect and mitigate the threat posed by malware. As each side grows new techniques, the other responds with even more advanced ones, creating a cycle of escalation.</div><div><br></div><div>In this room, we will explore some of the various anti-reverse engineering techniques malware uses. These include:</div><ul><li><span><a class="NXpdbKG4 glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;NXpdbKG4&#39;)">VM</a> Detection</span></li><li>Obfuscation using Packers</li><li>Anti-Debugging</li></ul><p>Many more techniques exist, but we will focus on these three for this room.</p></div><div><span style="font-size:24px">Learning Objectives</span></div><ul><li>Learn why malware authors use anti-reverse engineering techniques</li><li>Learn about different anti-reverse engineering techniques</li><li>Learn the techniques on how to circumvent anti-reverse engineering using various tools</li><li>Learn how anti-reverse engineering techniques are implemented by reading the source code</li></ul><div><span style="font-size:24px">Room prerequisites</span></div><ul><li>Familiarity with&nbsp;<a href="https://tryhackme.com/room/basicdynamicanalysis" target="_blank">Basic</a> and <a href="https://tryhackme.com/room/advanceddynamicanalysis" target="_blank">Advanced</a> Dynamic Analysis (How to use a debugger, read assembly code, and patching)</li><li>Basic knowledge of Assembly (What registers are, etc.)</li><li>Basic understanding of C programming concepts (Conditions, program flow, etc.)</li></ul><h2><span style="font-size:24px">Connecting to the machine</span></h2><div><span style="font-size:1rem"><span>Start the virtual machine in split-screen view by clicking on the green "Start Machine" button on the upper right section of this task. If the <a class="hXnTnPbb glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;hXnTnPbb&#39;)">VM</a> is not visible, use the blue "Show Split View" button at the top-right of the page. Alternatively, you can connect to the VM using the credentials below via "Remote Desktop".</span></span></div><div style="display:flex;justify-content:center">
	<div style="width:450px;display:flex;align-items:center;background-color:rgb(230, 230, 230);border-radius:8px;box-shadow:5px 5px 5px;padding:20px;margin-bottom:15px;--darkreader-inline-bgcolor:#26292b">
		<img src="./TryHackMe _ Anti-Reverse Engineering_files/be629720b11a294819516c1d4e738c92.png" alt="THM key" style="max-height:120px">
		<span style="text-align:left;padding-left:20px;font-size:20px;width:100%">
		<table style="width:100%;border-spacing:4px;border-collapse:separate">
			<tbody><tr><td style="width:110px"><b>Username </b></td><td style="background-color:white;border-radius:5px;padding:4px;--darkreader-inline-bgcolor:#181a1b">Administrator</td></tr>
			<tr><td><b>Password </b></td><td style="background-color:white;border-radius:5px;padding:4px;--darkreader-inline-bgcolor:#181a1b">Passw0rd!</td></tr>
<tr><td><b>IP </b></td><td style="background-color:white;border-radius:5px;padding:4px;--darkreader-inline-bgcolor:#181a1b">MACHINE_IP</td></tr>
		</tbody></table>
		</span>
	</div>
</div></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Let's go!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="1">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-2">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse2">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 2                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Anti-Debugging (Overview)
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse2" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <div><img src="./TryHackMe _ Anti-Reverse Engineering_files/a7df376a927f5fa720f1b37a096184b3.png" alt="Malware! Oh no!" style="width:50%;display:block;margin-left:auto;margin-right:auto"><span style="font-size:1rem"><br></span></div><div><span style="font-size:1rem">Debugging is the process of examining software to understand its inner workings and identify potential vulnerabilities or issues. Debugging involves software tools called debuggers that allow analysts to step through the code and monitor its execution.&nbsp;</span><br></div><div><br></div><div>Here are the commonly used debuggers for malware analysis nowadays:</div><ul><li>x64dbg</li><li>Ollydbg</li><li>Ida Pro</li><li>Ghidra</li></ul><div><span style="font-size:24px">Anti-Debugging techniques</span></div><div>Malware authors use anti-debugging measures to make it difficult for analysts to use debugging tools to analyze the malware's behaviour.</div><div><span style="font-size:1rem"><br></span></div><div><span style="font-size:1rem">Some of the most common anti-debugging measures include, but are not limited to:</span></div><div><span style="font-size:1rem"><br></span></div><table class="table table-bordered"><tbody><tr><td><span style="font-weight:bolder;text-align:left">Checking for the presence of debuggers</span><br></td><td><span style="text-align:left">Malware code looks for processes or files associated with debugging tools or hardware-based techniques, such as detecting hardware breakpoints. For example, a common anti-debugging technique uses the Windows API function&nbsp;</span><code style="font-size:14px;text-align:left">IsDebuggerPresent</code><span style="text-align:left">&nbsp;to check if a debugger is running. You can see this in action in the&nbsp;</span><a href="https://tryhackme.com/room/advanceddynamicanalysis" target="_blank">Advanced Dynamic Analysis room</a><span style="text-align:left">.</span><br></td></tr><tr><td><span style="font-weight:bolder;text-align:left">Tampering with debug registers</span><br></td><td><span style="text-align:left">Malware may try to modify or corrupt debug logs, which debuggers use to control the execution of code. This prevents the debugger from functioning correctly.</span><br></td></tr><tr><td><span style="font-weight:bolder;text-align:left">Using self-modifying code</span><br></td><td><span style="text-align:left">This is a sophisticated technique where malware modifies itself while running, making it difficult for a debugger to follow the code flow.</span><br></td></tr></tbody></table><div><br></div><p>In the next task, we will showcase an anti-debugging technique that uses the Windows system API function called SuspendThread.&nbsp;</p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                What is the name of the Windows API function used in a common anti-debugging technique that detects if a debugger is running?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *****************" value="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-3">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse3">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 3                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Anti-Debugging using Suspend Thread
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse3" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <div><span>﻿</span><span style="font-size:1rem"><a href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-suspendthread" target="_blank">Suspend Thread</a> is a Windows API function that is used to pause the execution of a thread in a running process. This function has legitimate uses but can also be called from within a malware process to suspend any threads attempting to debug or analyze it. What better way to thwart debugging than not making the debugger work at all?</span><br></div><div><br></div><div>We have created a simple program that does the above technique. You can try and run it to see how it behaves.</div><div><br></div><ol><li>Run the x32dbg tool from the Desktop. Open the <code>suspend-thread.exe</code> file from the <code>C:\Malware\</code> directory.</li><li><span style="font-size:1rem">Press </span><code>F9</code><span style="font-size:1rem"> twice to continue the execution of the malware.</span><br></li><li>Notice that x64dbg will now become unresponsive. You can confirm the suspended process by opening Task Manager.</li></ol><div><img src="./TryHackMe _ Anti-Reverse Engineering_files/6e78f4aab8de049609c41c5588f70124.png" style="border:1px solid;--darkreader-inline-border-top:initial;--darkreader-inline-border-right:initial;--darkreader-inline-border-bottom:initial;--darkreader-inline-border-left:initial" alt="Task Manager 1"><br></div><div><br></div><div><i>(To completely terminate x64dbg, right click on it and select "End Task").</i></div><div><br></div><div>The code snippet below shows how the malware works under the hood:</div><div><br></div>

<div style="border-radius:15px;border:1px solid rgb(2, 12, 84);background-color:rgba(191, 191, 191, 0.8);width:80%;margin:0px auto 20px;padding:15px;--darkreader-inline-border-top:#7e7567;--darkreader-inline-border-right:#7e7567;--darkreader-inline-border-bottom:#7e7567;--darkreader-inline-border-left:#7e7567;--darkreader-inline-bgcolor:rgba(60, 65, 68, 0.8)">
<details>
<summary>See code snippet</summary>
<div style="text-align:center">
<pre class=" language-c" tabindex="0"><code class=" language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;windows.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;wchar.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;tlhelp32.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>

DWORD g_dwDebuggerProcessId <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

BOOL CALLBACK <span class="token function">EnumWindowsProc</span><span class="token punctuation">(</span>HWND hwnd<span class="token punctuation">,</span> LPARAM dwProcessId<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    DWORD dwWindowProcessId<span class="token punctuation">;</span>
    <span class="token function">GetWindowThreadProcessId</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>dwWindowProcessId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>dwProcessId <span class="token operator">==</span> dwWindowProcessId<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
		<span class="token keyword">int</span> windowTitleSize <span class="token operator">=</span> <span class="token function">GetWindowTextLengthW</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span> windowTitleSize <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token class-name">wchar_t</span><span class="token operator">*</span> windowTitle <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">wchar_t</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>windowTitleSize <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token class-name">wchar_t</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
        <span class="token function">GetWindowTextW</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> windowTitle<span class="token punctuation">,</span> windowTitleSize <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">wcsstr</span><span class="token punctuation">(</span>windowTitle<span class="token punctuation">,</span> L<span class="token string">"dbg"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">||</span>
			<span class="token function">wcsstr</span><span class="token punctuation">(</span>windowTitle<span class="token punctuation">,</span> L<span class="token string">"debugger"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
            g_dwDebuggerProcessId <span class="token operator">=</span> dwProcessId<span class="token punctuation">;</span>
			<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
 
       <span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

DWORD <span class="token function">IsDebuggerProcess</span><span class="token punctuation">(</span>DWORD dwProcessId<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">EnumWindows</span><span class="token punctuation">(</span>EnumWindowsProc<span class="token punctuation">,</span> <span class="token punctuation">(</span>LPARAM<span class="token punctuation">)</span>dwProcessId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> g_dwDebuggerProcessId <span class="token operator">==</span> dwProcessId<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

DWORD <span class="token function">SuspendDebuggerThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	HANDLE hSnapshot <span class="token operator">=</span> <span class="token function">CreateToolhelp32Snapshot</span><span class="token punctuation">(</span>TH32CS_SNAPTHREAD<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>hSnapshot <span class="token operator">==</span> INVALID_HANDLE_VALUE<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Failed to create snapshot\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    THREADENTRY32 te32<span class="token punctuation">;</span>
    te32<span class="token punctuation">.</span>dwSize <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>THREADENTRY32<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">Thread32First</span><span class="token punctuation">(</span>hSnapshot<span class="token punctuation">,</span> <span class="token operator">&amp;</span>te32<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Failed to get first thread\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">CloseHandle</span><span class="token punctuation">(</span>hSnapshot<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">do</span>
	<span class="token punctuation">{</span>
        HANDLE hThread <span class="token operator">=</span> <span class="token function">OpenThread</span><span class="token punctuation">(</span>THREAD_QUERY_INFORMATION <span class="token operator">|</span> THREAD_SUSPEND_RESUME<span class="token punctuation">,</span> FALSE<span class="token punctuation">,</span> te32<span class="token punctuation">.</span>th32ThreadID<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>hThread <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
            DWORD dwProcessId <span class="token operator">=</span> <span class="token function">GetProcessIdOfThread</span><span class="token punctuation">(</span>hThread<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">IsDebuggerProcess</span><span class="token punctuation">(</span>dwProcessId<span class="token punctuation">)</span> <span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Debugger found with pid %i! Suspending!\n"</span><span class="token punctuation">,</span> dwProcessId<span class="token punctuation">)</span><span class="token punctuation">;</span>
				DWORD result <span class="token operator">=</span> <span class="token function">SuspendThread</span><span class="token punctuation">(</span>hThread<span class="token punctuation">)</span><span class="token punctuation">;</span>
 				<span class="token keyword">if</span> <span class="token punctuation">(</span> result <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span>
				<span class="token punctuation">{</span>
					<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Last error: %i\n"</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
            <span class="token function">CloseHandle</span><span class="token punctuation">(</span>hThread<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">Thread32Next</span><span class="token punctuation">(</span>hSnapshot<span class="token punctuation">,</span> <span class="token operator">&amp;</span>te32<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">CloseHandle</span><span class="token punctuation">(</span>hSnapshot<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">SuspendDebuggerThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Continuing malicious operation..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<br></div>
</details>
</div>

<div><span style="font-size:1rem">If you don't want to be bothered with reading the source code, here is a short explanation of the steps used by this technique:</span><br></div><div><br></div><ol><li>The malware goes through all threads in the Windows system.</li><li>For each thread, it calls <code>EnumWindow</code> to go through each window displayed on the screen.</li><li>If the name of the window has the strings <code>debugger</code>,&nbsp;<code>dbg</code>, or <code>debug</code>, then the malware knows that a debugger is running.</li><li>If a debugger is present, the malware calls, which suspends the threads of the debugger, making it crash.</li><li>The malware proceeds with its malicious purpose.</li></ol><p>As you can see, this method can effectively stop an analyst from continuing with the investigation. Fortunately, we have a way of dealing with this.</p><div><span style="font-size:24px">Patching</span></div><div>Patching is one of the most critical skills required of an analyst. The Advanced Dynamic Analysis room has already covered this skill, but we'll have a quick review here.</div><div><br></div><div>In this exercise, we want to patch the function SuspendThread so that our debugger won't get suspended.</div><div><br></div><div><ul><li>Open x32dbg by double-clicking on its icon from the Desktop.</li><li>Press the <code>F3</code> key to show the "Open" dialogue window. Look for our sample file called <code>suspend-thread.exe</code> in the <code>C:\Malware\</code>&nbsp;directory.</li><li>Press the <code>F9</code> key once to jump execution to the EntryPoint, as shown below:</li></ul><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/71685df3111c0b1789fd7efe893c71c6.png" style="border:1px solid;--darkreader-inline-border-top:initial;--darkreader-inline-border-right:initial;--darkreader-inline-border-bottom:initial;--darkreader-inline-border-left:initial" alt="Patching 1"><br></p><ul><li>Right-click anywhere on the main screen, highlight "Search for &gt; Current Module", then select "Intermodular calls".</li><li>On the search field at the bottom, type "SuspendThread". This will filter the list in the main window showing us one entry. Double-click on this entry.</li></ul><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/b8346843b287e15dc4403778a3a0a9b0.png" alt="Patching 2"><br></p><ul><li>You are now on the part of the code that calls the SuspendThread API. To skip this function, right-click on the Suspendthread line and select Binary &gt; Fill with NOPs. Don't change anything here, and press "OK".</li></ul><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/cbebefac61a8e9768eb6bd112efb5822.png" alt="Patching 3"><br></p><ul><li>You will see that memory locations <code>0004011AB</code> up to <code>004011B0</code> are now all set to the <code>90</code> hex value or&nbsp;<code>nop</code>&nbsp;(No Operation). If execution reaches this instruction, it will do nothing and proceed with the following line.&nbsp;</li><li>Press <code>F9</code> to continue execution, and we'll see that debugging continues at the very end without crashing our debugger. Note that while the console prints out lines that say "Debugger found with PID XXXX! Suspending!", it's not doing anything because we've skipped the function that does the suspending.</li></ul><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/2adb65eb552a957b2d52c88edd672cf3.png" alt="Patching 4"><br></p></div><div>Now, this is great. However,&nbsp; if you try debugging again, you'll discover it will start crashing again. This is because our patches are reset and are now gone. To avoid re-applying patches in the future, we can export and import our patches for future use.</div><div><br></div><div><span style="font-size:24px">Exporting and Importing Patches</span><br></div><div><br></div><div>Stop debugging by pressing <code>Alt+F2</code> and go through the patching steps in the previous section again, but do not do the last step.&nbsp;</div><div><br></div><ul><li>Once the patches you want are in place, on the top bar, go to "View &gt; Patch file..." to open the "Patch" dialogue window.</li><li>A list of our patches will appear on the right panel. You can see there are six entries. This refers to the six memory locations that we have set to NOPs.</li></ul><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/b7d66b0ffae51d6ba9992e587067cead.png" alt="Patching 5"><br></p><ul><li>Click on the "Export" button. On the next dialogue window, click "Yes" to continue. Save this file to a location of your choice.</li><li>Stop the debugger by pressing <code>Alt+F2</code>.</li></ul><p>Debug the file again. Because debugging has restarted, our previous patches have now been erased. We can restore it by importing the file we made a while ago.</p><ul><li>Go to the patches dialogue window again to "View &gt; Patch file...".</li><li>But this time, press the "Import" button and select the file we saved.</li></ul><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/5b3a92ac38ce313efd141f1fddb35572.png" alt="Patching 6" style="width:80%"><br></p><ul><li>Once imported, close the window and press <code>F9</code> again to continue execution. You'll notice that the previous patches are now re-applied.</li></ul><div>Exporting and importing patches are very helpful in reverse engineering programs as it allows you to save your work to save the hassle of doing them all over again.</div><div><br></div><div>In the next task, we'll examine another anti-reverse engineering technique and other ways to circumvent them.</div></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                What is the Windows API function that enumerates windows on the screen so the malware can check the window name?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***********" value="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What is the hex value of a nop instruction?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **" value="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What is the instruction found at memory location 004011CB?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *** ***,*" value="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-4">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse4">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 4                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> VM Detection (Overview)
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse4" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <div><img src="./TryHackMe _ Anti-Reverse Engineering_files/674d949572c1ed79812310fc208eb7f1.png" alt="Malware sandbox" style="width:25%;float:right" class="note-float-right">Virtual Machines (VMs) are software platforms that simulate a computer environment inside another computer system. These are useful in reverse engineering because they provide a cost-effective, controlled, and isolated environment for monitoring and analyzing suspicious software or malware. VMs also allow for the creation of snapshots and checkpoints that can be used to restore the system to a previous state, which helps test different scenarios and maintain a history of the analysis process.</div><div><br></div><div><span>When malware identifies that it is running on a <a class="WvHYxvle glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;WvHYxvle&#39;)">VM</a>, it may decide to respond differently; for example, it may change its behaviour by:</span></div><ul><li>Executing only a minimal subset of its functionality</li><li>Self-destructing by deleting itself or overwriting parts of its code&nbsp;</li><li>Cause damage to the system by deleting or encrypting files; or</li><li>Not run at all</li></ul><div>All of the above behaviours aim to reveal less information, making it harder for the analyst to progress.</div><div><br></div><div><span style="font-size:24px">Detection Techniques</span><br></div><div><span style="font-size:1rem">Malware can employ various techniques to detect and evade analysis in virtual machine environments. Some of them are listed below:</span></div><div><span style="font-size:1rem"><br></span></div><div><span style="font-size:1rem"><br></span></div><table class="table table-bordered"><tbody><tr><td><span style="font-weight:bolder;text-align:left">Checking running processes</span><br></td><td><span style="font-size:1rem;text-align:left">VMs have easily identifiable processes; for example, VMWare runs a process called&nbsp;</span><code style="font-size:14px;text-align:left">vmtools</code><span style="font-size:1rem;text-align:left">, while VirtualBox has&nbsp;</span><code style="font-size:14px;text-align:left">vboxservice</code><span style="font-size:1rem;text-align:left">. Malware can use the&nbsp;<a href="https://learn.microsoft.com/en-us/windows/win32/api/psapi/nf-psapi-enumprocesses" target="_blank">EnumProcess</a>&nbsp;Windows API to list all the processes running on the machine and look for the presence of these tools.</span><br></td></tr><tr><td><span style="font-weight:bolder;text-align:left">Checking installed software</span><br></td><td><span style="text-align:left">Malware can look in the Windows Registry for a list of installed software under the&nbsp;</span><code style="font-size:14px;text-align:left">SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall</code><span style="text-align:left">&nbsp;Registry key. From here, it can check for installed programs like debuggers, decompilers, forensics tools, etc.</span><br></td></tr><tr><td><span style="font-weight:bolder;text-align:left">Network fingerprinting</span><br></td><td><span style="text-align:left"><span>Malware can look for specific <a class="e35rWS6v glossary-term" onclick="initPopOver(&#39;MAC&#39;, &#39;e35rWS6v&#39;)">MAC</a> and network addresses unique to VMs. For example, VMs autogenerate MAC addresses that start with any of the following numbers:&nbsp;</span></span><code style="font-size:14px;text-align:left">00-05-69</code><span style="text-align:left">,&nbsp;</span><code style="font-size:14px;text-align:left">00-0c-29</code><span style="text-align:left">,&nbsp;</span><code style="font-size:14px;text-align:left">00-1c-14</code><span style="text-align:left">&nbsp;or&nbsp;</span><code style="font-size:14px;text-align:left">00-50-56</code><span style="text-align:left"><span>. These numbers are unique and are specifically assigned to a <a class="CnnP7Fci glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;CnnP7Fci&#39;)">VM</a> vendor called the OUI (Organizationally Unique Identifier).</span></span><br></td></tr><tr><td><span style="font-weight:bolder;text-align:left">Checking machine resources</span><br></td><td><span style="text-align:left">Malware can look at a machine's resources like RAM and CPU Utilization percentages. For example, a machine with RAM amounting to less than 8GB can indicate a virtual machine, as they are typically not assigned a significant amount.</span><br></td></tr><tr><td><span style="font-weight:bolder;text-align:left">Detecting peripherals</span><br></td><td><span style="text-align:left">Some malware checks for connected printers because this is rarely configured properly on VMs, sometimes not even configured at all.</span><br></td></tr><tr><td><span style="font-weight:bolder;text-align:left">Checking for domain membership</span><br></td><td><span style="text-align:left">Corporate networks are a usual target for malware. An easy way to determine this is by checking if the current machine is part of an Active Directory domain. This can quickly be done without the use of API calls by checking the&nbsp;</span><code style="font-size:14px;text-align:left">LoggonServer</code><span style="text-align:left">&nbsp;and&nbsp;</span><code style="font-size:14px;text-align:left">ComputerName</code><span style="text-align:left">&nbsp;environment variables.</span><br></td></tr><tr><td><span style="font-weight:bolder;text-align:left">Timing-based attacks</span><br></td><td><span style="text-align:left">Malware can measure the time it takes to execute specific instructions or access particular machine resources. For example, some instructions can be faster on a physical machine compared to a virtual machine.</span><br></td></tr></tbody></table><p>Many techniques mentioned above are not foolproof, so it is not uncommon to see malware use a combination of one or more to ensure a higher chance of correct identification.</p><p><span style="font-size:24px">Anti-VM Detection</span></p><p><span>To prevent malware from using some of the techniques above, we can apply several changes to the system that will remove <a class="sd0T7gDt glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;sd0T7gDt&#39;)">VM</a>-related artefacts making the VM look less like a VM. F</span><span style="font-size:1rem"><span>or example, we can remove or modify the Registry entries that malware checks for installed programs to hide our debuggers, change the <a class="boXcK3LE glossary-term" onclick="initPopOver(&#39;MAC&#39;, &#39;boXcK3LE&#39;)">MAC</a> addresses, or configure the VM to appear connected to a printer.</span></span></p><p>But you can see how tedious this becomes. With the myriad of options available to malware, it would be challenging to cover all of them.</p><p><span style="font-size:1rem">Some researchers have made scripts&nbsp; (See </span><a href="https://github.com/d4rksystem/VMwareCloak" target="_blank">VMwareCloak</a><span style="font-size:1rem"> and </span><a href="https://github.com/d4rksystem/VBoxCloak" target="_blank">VBoxCloak</a><span style="font-size:1rem">) to help automate this process. Despite this, even if all the known techniques are addressed, minor architectural checks can still be made by malware, as you will see in the next task.</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                What is the name of the identifiable process used by malware to check if the machine is running inside VirtualBox?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***********" value="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What is the OUI automatically assigned specifically to VMware?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **:**:**" value="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Using Task Manager, what process indicates that the machine for this room is an Amazon EC2 Virtual Machine?<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****************.***" value="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-5">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse5">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 5                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> VM Detection by Checking the Temperature
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse5" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <div><span>Here is an example of a <a class="tDgV72Vb glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;tDgV72Vb&#39;)">VM</a> detection technique that checks the machine's temperature provided by the hardware.</span></div><div><br></div><div><code>Win32_TemperatureProbe</code><span>&nbsp;is a Windows Management Instrumentation (<a class="ShSyzjxO glossary-term" onclick="initPopOver(&#39;WMI&#39;, &#39;ShSyzjxO&#39;)">WMI</a>) class that contains real-time temperature readings from the hardware through the SMBIOS (System Management BIOS) data structure. In a virtualized environment, the value returned is </span><code>Not Supported</code>, which is what malware looks for.</div><div><br></div><div><i><b>Note:</b>&nbsp;<code style="font-size:14px">Win32_TemperatureProbe</code><span style="font-size:1rem">&nbsp;may also return&nbsp;</span></i><i><code style="font-size:14px">Not Supported</code><span style="font-size:1rem">&nbsp;even on physical machines if the hardware doesn't support this SMBIOS feature. This makes it unreliable but valuable when used with other techniques mentioned in the previous task.</span></i></div><div><br></div><div><span>We have provided a working program demonstrating this technique in the <a class="PXFd9cgS glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;PXFd9cgS&#39;)">VM</a> attached to this room. Look for the </span><code>vm-detection.exe</code> file in the <code>C:\Malware\</code>&nbsp;directory and execute it. You will see the result immediately.</div><div><br></div><div>Upon execution, a message window will appear:</div><div><br></div><div><img src="./TryHackMe _ Anti-Reverse Engineering_files/b6e37b8777df01ca2c1e7c0cafb814dc.png" style="border:1px solid" alt="VM Detected"><br></div><div><span style="font-size:1rem"><br></span></div><div><span style="font-size:1rem"><span>As you can see, the malware sensed it was running in a <a class="RVM6mRqZ glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;RVM6mRqZ&#39;)">VM</a>. It modified its behaviour by continuing a non-malicious activity to throw off analysts snooping around.</span></span></div><div><br></div><div>Below is the code snippet for this particular program:</div><div><br></div><div>
<div style="border-radius:15px;border:1px solid rgb(2, 12, 84);background-color:rgba(191, 191, 191, 0.8);width:80%;margin:0px auto 20px;padding:15px;--darkreader-inline-border-top:#7e7567;--darkreader-inline-border-right:#7e7567;--darkreader-inline-border-bottom:#7e7567;--darkreader-inline-border-left:#7e7567;--darkreader-inline-bgcolor:rgba(60, 65, 68, 0.8)">
<details>
<summary>See code snippet</summary>
<div style="text-align:center">
<pre class=" language-c" tabindex="0"><code class=" language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;windows.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;wbemidl.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;combaseapi.h&gt;</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression"><span class="token function">comment</span><span class="token punctuation">(</span>lib<span class="token punctuation">,</span> </span><span class="token string">"wbemuuid.lib"</span><span class="token expression"><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression"><span class="token function">comment</span><span class="token punctuation">(</span>lib<span class="token punctuation">,</span> </span><span class="token string">"user32.lib"</span><span class="token expression"><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression"><span class="token function">comment</span><span class="token punctuation">(</span>lib<span class="token punctuation">,</span> </span><span class="token string">"ole32.lib"</span><span class="token expression"><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression"><span class="token function">comment</span><span class="token punctuation">(</span>lib<span class="token punctuation">,</span> </span><span class="token string">"oleaut32.lib"</span><span class="token expression"><span class="token punctuation">)</span></span></span>

BOOL <span class="token function">hasThermalZoneTemp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">hasThermalZoneTemp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">"Proceeding with non-malicious activities..."</span><span class="token punctuation">,</span> <span class="token string">"VM Detected"</span> <span class="token punctuation">,</span> MB_OK<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">"Proceeding with malicious activities..."</span><span class="token punctuation">,</span> <span class="token string">"Starting malware"</span><span class="token punctuation">,</span> MB_OK<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

BOOL <span class="token function">hasThermalZoneTemp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	IWbemLocator<span class="token operator">*</span> pLoc <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	IWbemServices<span class="token operator">*</span> pSvc <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	IEnumWbemClassObject<span class="token operator">*</span> pEnumerator <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	IWbemClassObject<span class="token operator">*</span> pclsObj <span class="token operator">=</span> <span class="token punctuation">(</span>IWbemClassObject<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>IWbemClassObject<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	ULONG uReturn <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	HRESULT hr <span class="token operator">=</span> <span class="token function">CoInitializeEx</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> COINIT_MULTITHREADED<span class="token punctuation">)</span><span class="token punctuation">;</span>
	hr <span class="token operator">=</span> <span class="token function">CoInitializeSecurity</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>	<span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>	RPC_C_AUTHN_LEVEL_DEFAULT<span class="token punctuation">,</span> RPC_C_IMP_LEVEL_IMPERSONATE<span class="token punctuation">,</span>	<span class="token constant">NULL</span><span class="token punctuation">,</span> EOAC_NONE<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	hr <span class="token operator">=</span> <span class="token function">CoCreateInstance</span><span class="token punctuation">(</span>CLSID_WbemLocator<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> CLSCTX_INPROC_SERVER<span class="token punctuation">,</span> IID_IWbemLocator<span class="token punctuation">,</span> <span class="token punctuation">(</span>LPVOID<span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>pLoc<span class="token punctuation">)</span><span class="token punctuation">;</span>
	hr <span class="token operator">=</span> pLoc<span class="token operator">-&gt;</span><span class="token function">ConnectServer</span><span class="token punctuation">(</span>L<span class="token string">"root\\wmi"</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>	<span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>pSvc<span class="token punctuation">)</span><span class="token punctuation">;</span>
	hr <span class="token operator">=</span> <span class="token function">CoSetProxyBlanket</span><span class="token punctuation">(</span>pSvc<span class="token punctuation">,</span> RPC_C_AUTHN_WINNT<span class="token punctuation">,</span>	RPC_C_AUTHZ_NONE<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>	RPC_C_AUTHN_LEVEL_CALL<span class="token punctuation">,</span>	RPC_C_IMP_LEVEL_IMPERSONATE<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> EOAC_NONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	hr <span class="token operator">=</span> pSvc<span class="token operator">-&gt;</span><span class="token function">ExecQuery</span><span class="token punctuation">(</span>L<span class="token string">"WQL"</span><span class="token punctuation">,</span> L<span class="token string">"SELECT * FROM MSAcpi_ThermalZoneTemperature"</span><span class="token punctuation">,</span> WBEM_FLAG_FORWARD_ONLY <span class="token operator">|</span> WBEM_FLAG_RETURN_IMMEDIATELY<span class="token punctuation">,</span>	<span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>pEnumerator<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span>pEnumerator<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		hr <span class="token operator">=</span> pEnumerator<span class="token operator">-&gt;</span><span class="token function">Next</span><span class="token punctuation">(</span>WBEM_INFINITE<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>pclsObj<span class="token punctuation">,</span> <span class="token operator">&amp;</span>uReturn<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>uReturn <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		VARIANT vtProp<span class="token punctuation">;</span>

		hr <span class="token operator">=</span> pclsObj<span class="token operator">-&gt;</span><span class="token function">Get</span><span class="token punctuation">(</span>L<span class="token string">"CurrentTemperature"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>vtProp<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">SUCCEEDED</span><span class="token punctuation">(</span>hr<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Thermal Zone Temperature: %d\n"</span><span class="token punctuation">,</span> vtProp<span class="token punctuation">.</span>intVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token function">VariantClear</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>vtProp<span class="token punctuation">)</span><span class="token punctuation">;</span>
		pclsObj<span class="token operator">-&gt;</span><span class="token function">Release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	pEnumerator<span class="token operator">-&gt;</span><span class="token function">Release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	pSvc<span class="token operator">-&gt;</span><span class="token function">Release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	pLoc<span class="token operator">-&gt;</span><span class="token function">Release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token function">CoUninitialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<br></div>
</details>
</div>
<div>You can try compiling and running this code on your physical machine to see how it changes its behaviour <i>(No actual malicious execution is in the provided code so it is safe to run)</i>.&nbsp;<span style="font-size:1rem"><span>The output below shows how the malware behaves when run from a physical machine. The malware receives the correct temperature reading from the <a class="ud0yyv3p glossary-term" onclick="initPopOver(&#39;WMI&#39;, &#39;ud0yyv3p&#39;)">WMI</a> class and proceeds with its execution.</span></span></div><div><span style="font-size:1rem"><br></span></div><div><img src="./TryHackMe _ Anti-Reverse Engineering_files/d2d4144a78e51098656f8bee711c2e07.png" style="border:1px solid;--darkreader-inline-border-top:initial;--darkreader-inline-border-right:initial;--darkreader-inline-border-bottom:initial;--darkreader-inline-border-left:initial" alt="Malware did not detect a VM."></div><div><br></div></div><div><span style="font-size:24px">Preventing Temperature Checking</span></div><div>As mentioned in the previous task, architectural checks like checking the temperature can be challenging to prevent. Fortunately for us, there are still ways around this. For example, we've learned in<span style="font-size:1rem">&nbsp;the last task</span><span style="font-size:1rem">&nbsp;that we can patch a function with </span><code>nops</code><span style="font-size:1rem"> to prevent it from executing. We can do the same thing here, but for the sake of giving you more tools to help you with reverse engineering, we'll be covering two other approaches:</span></div><div><span style="font-size:1rem"><br></span></div><div><span style="font-size:1rem"> </span></div><ul><li><span style="font-size:1rem">Manipulating memory directly</span></li><li><span style="font-size:1rem">Changing the execution flow with EIP</span></li></ul><div>Here are the steps:</div><div><br></div><ul><li>Open <code>x32dbg.exe</code> by double-clicking on the desktop icon</li><li>Go to File &gt; Open, then look for the <code>vm-detection.exe</code> file in the <code>C:\Malware\</code> directory.</li><li>Press <code>F9</code>&nbsp;to start running the program in the debugger. Debugging will halt at the code marked as the "EntryPoint".&nbsp;</li></ul><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/7eb0c75da85be89bb998192fdbe44f2e.png" alt="Temperature check 1"></p><ul><li>Press <code>Ctrl+G</code> on your keyboard to bring up the "Enter expression to follow..." pop-up window. Enter the value <code>004010E0</code><span style="font-size:14px;background-color:rgb(35, 38, 39);--darkreader-inline-bgcolor:#1c1e1f"></span>&nbsp;and press "OK". This will take you to the memory address.&nbsp;<code>0x004010E0</code>.</li><li>Press <code>F2</code> to set up a breakpoint at this memory location, then press <code>F9</code> once to halt execution here.</li><li>Right now, we are at the memory location <code>0x004010E0</code>. The block of instructions from this location up until <code>0x004010F8</code><span style="font-size:1rem">&nbsp;corresponds to this part of our C code snippet:&nbsp;</span><code>hr = pEnumerator-&gt;Next(WBEM_INFINITE, 1, &amp;pclsObj, &amp;uReturn);</code><span style="font-size:1rem">. To help you visualize this, I've added comments on the right side of the screenshot below to highlight the values passed to the function.</span></li></ul><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/f1a91972e5981af51a4d668eb5f8ebe8.png" alt="Temperature check 2" style="width:100%"></p><ul><li><span>As previously discussed, this function will fail because we run the program in a <a class="YGyKI61X glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;YGyKI61X&#39;)">VM</a>. After executing, the function will write the value </span><code>0</code> to the memory location <code>[ebp-18]</code>&nbsp;(the one marked with&nbsp;<code>uReturn</code>&nbsp;in the screenshot above).</li><li>Press <code>F8</code> a few times to step through the code until you reach the memory location <code>004010FD</code>. Here, we can see that the value of <code>[ebp-18] </code>(or uReturn) is being compared to zero. This corresponds to this part in the C code:&nbsp;<code>if (uReturn == 0)</code>.</li><li>Since we want this "if" condition to evaluate to <code>False</code>, what we can do is edit the memory location pointed to by&nbsp;<code>[ebp-18]</code> so that it will contain the value <code>1</code> instead of <code>0</code>.</li><li>To do this, right-click on the line that has <code>[ebp-18]</code>, click on "Follow in dump", then select <code>[ebp-18]</code>.</li></ul><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/2cc9fdf14ec8de8ec6a062ad5ce3c407.png" alt="Temperature check 3"><br></p><ul><li>You will see at the bottom of the screen, at the "Dump 1" window tab, that our current memory location is <code>0019FF08</code>. This memory location contains the value for <code>[ebp-18]</code> or uReturn.</li></ul><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/aa0b40abe6a1292372402b5acac4a6ab.png" alt="Temperature check 4"><br></p><ul><li>Double-click on the rightmost <code>00</code> value. This will open up a "Modify Value" window. Enter the value <code>01</code> in the expression field and press the "OK" button. The result should look like this:</li></ul><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/85d660f1c29076c8694f52a1d5c9577d.png" alt="Temperature check 5"><br></p><ul><li>Turn your attention back to the main window (CPU tab) and press <code>F8</code> a few times. You'll notice that the code will not exit anymore as it skips the execution from <code>00401101</code> to <code>0040110A</code>.</li></ul><p>What you've done is that you've manipulated the bits of a memory location directly to influence the flow of the program. This method is helpful in many other ways, like for example, you could change the value that will be passed to a function before you execute that function.</p><p>However, the program will now crash if you continue running the program. The program was supposed to exit at the previous function, but we've introduced a bug since we intentionally skipped this. Don't worry; this always happens when messing around in the debugger. So for us to continue to investigate, there is one other method we can use that would allow us to jump around and continue.</p><ul><li>Let us say we want to skip everything and jump to this part of the code right here:&nbsp;			<code>printf("Thermal Zone Temperature: %d\n", vtProp.intVal);</code>. In the assembly code, this would be the instructions <code>00401130</code> to&nbsp;<code>00401139</code>, as shown below:</li></ul><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/29a840731a46e38105443fcdafb9ac64.png" alt="Temperature check 6"><br></p><p>The great thing about debuggers is that we can change every value related to the program; we can change the values in the memory locations, the values on the stack, and even the values of the registers.&nbsp;<span style="font-size:1rem">The </span><code>EIP</code><span style="font-size:1rem"> register is the register that holds the memory address that tells the debugger what next instruction to execute next. And yes, this can be edited!</span></p><ul><li>Continue from the last step. On the "Registers" panel on the right of your screen, look for the one that says <code>EIP</code>. Right-click on the value and select "Modify Value".</li></ul><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/1e0f7ae461f297eb5a48a25b46941518.png" alt="Temperature check 7"><br></p><ul><li>Enter <code>00401134</code> as the new value and press OK.</li><li>Now when we press <code>F8</code> to step through the code, you'll notice that we'll jump directly to that instruction. Notice how the <code>EIP</code> marker now points to the location we wanted.</li></ul><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/23b17f01fc2ed7906308b2fa782f9742.png" alt="Temperature check 8"><br></p><ul><li>Pressing <code>F9</code> again would continue running the program, resulting in the output below:</li></ul><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/e916e886923e9fc1569760f5924bb0d1.png" alt="Temperature check 9"><br></p><p><span style="font-size:1rem"><span>Good job! With the above steps, you successfully prevented the malware from detecting that it is running on a <a class="7pkfqvHZ glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;7pkfqvHZ&#39;)">VM</a>. You can confirm this by also checking the Command Prompt output. </span></span></p><p><span style="font-size:1rem">These simple techniques will be helpful in going through the code and influencing the program flow.</span><br></p><p><span style="font-size:1rem">But we can't celebrate just yet, for there are other things malware can do to prevent you from discovering more of its capabilities, like the use of Obfuscation and Packers, which is discussed in the next task.</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                In the C code snippet, what is the full WQL query used to get the temperature from the&nbsp;Win32_TemperatureProbe class?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****** * **** *****************************" value="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What register holds the memory address that tells the debugger what instruction to execute next?<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***" value="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Before uReturn is compared to zero, what is the memory location pointed to by [ebp-4]</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ********" value="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-6">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse6">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 6                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Packers (Overview)
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse6" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <div>Obfuscation is a technique that aims to intentionally obscure data and code so that it is harder to understand or analyze.&nbsp;</div><div><br></div><div>The most common obfuscation techniques used by malware authors include:</div><ul><li><b>Using encoding techniques</b> - This involves encoding data (i.e. command line strings, domain names, etc.) using popular encoding techniques like <code>XOR</code> or <code>Base64</code>. You may have seen a Base64 encoded strings that look like this&nbsp;<code>VGhpcyBpcyBhbiBCQVNFNjQgZW5jb2RlZCBzdHJpbmcu==</code>.</li><li><b>Using encryption techniques</b> - This involves encrypting data such as communications to a command and control server, file formats, and network traffic. The most common types used are symmetric key and public key encryption.</li><li><b>Code obfuscation</b> - This involves various techniques such as manipulating the code to alter its syntax and structure, renaming functions, or splitting code across multiple files or code segments.</li></ul><div>There's much to discuss with obfuscation, but we won't delve deep into them in this room. In this task, we want to talk about the wide use of Packers in malware nowadays, a technique that can also be considered to fall under obfuscation.</div><div><br></div><div><span style="font-size:24px">Packers</span></div><div><img src="./TryHackMe _ Anti-Reverse Engineering_files/718629e08cb56b91b63546abcd971642.png" alt="Malware Containment" style="width:25%;float:right" class="note-float-right">Packers are tools that compress and encrypt executable files. It compresses the target executable and embeds it within a new executable file that serves as a wrapper or container. This dramatically reduces the size of the file, making it ideal for easy distribution and installation. Also, some packers offer additional features, such as code obfuscation, runtime packing, and anti-debugging techniques. And it is because of these features that made Packers a popular tool for malware authors.</div><div><br></div><div>There are a lot of Packers available. Each has a unique approach and algorithm for packing.&nbsp;<span style="font-size:1rem">Here is a list of some that were seen used in the wild:</span></div><ul><li><a href="https://www.alternate-tools.com/pages/c_exepacker.php?lang=ENG" target="_blank">Alternate EXE Packer</a></li><li><a href="http://www.aspack.com/" target="_blank">ASPack</a><span style="font-size:1rem">&nbsp;</span></li><li><span style="font-size:1rem"><a href="https://unprotect.it/technique/exestealth/" target="_blank">ExeStealth</a></span></li><li><span style="font-size:1rem"><a href="https://github.com/akuafif/hXOR-Packer" target="_blank">hXOR-Packer</a></span></li><li><span style="font-size:1rem"><a href="https://github.com/nelfo/Milfuscator" target="_blank">Milfuscator</a></span></li><li><a href="https://www.autohotkey.com/mpress/mpress_web.htm" target="_blank">MPress</a></li><li><a href="https://www.pelock.com/products/pelock" target="_blank">PELock</a></li><li><a href="https://www.oreans.com/Themida.php" target="_blank">Themida</a></li><li><a href="https://upx.github.io/" target="_blank">UPX: the Ultimate Packer for eXecutables</a></li><li><a href="https://vmpsoft.com/" target="_blank">VMProtect</a></li></ul><p>It is essential to state that not all packed programs are malicious. Packers are also used by legitimate software to protect their programs, like for protecting their intellectual property from theft. For example, the Packer tool "Themida" is&nbsp;<span style="font-size:1rem">widely used to prevent video game cheating.</span></p><div>Because Packers encrypts and obfuscates a program, it would be impossible to know the malware's capabilities without running it. Because of this, we cannot reliably depend on static analysis and signature-based detection techniques to determine its capabilities. The only information we could glean from a malware sample at this state is the Packer tool used. This can still be a good starting point for an investigation, which we will see in the next task.</div></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                What is the decoded string of the base64 encoded string "VGhpcyBpcyBhIEJBU0U2NCBlbmNvZGVkIHN0cmluZy4="?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **** ** * ****** ******* ******." value="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-7">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse7">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 7                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Identifying and Unpacking
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse7" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <div><span style="font-size:1rem">The first step in dealing with packed malware is identifying the Packer used. Thankfully, there are tools that we can use for this.&nbsp;</span><span style="font-size:1rem"><span>The most accessible tools are DetectItEasy (DIE) and PEStudio, which are already included in the <a class="H1QqEYNT glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;H1QqEYNT&#39;)">VM</a> attached to this room.&nbsp;</span></span><span style="font-size:1rem">You will also find a packed sample program titled </span><code>packed.exe</code><span style="font-size:1rem"> under the </span><code>C:\Malware\</code><span style="font-size:1rem"> directory that we can use to test these tools on.</span></div><div><br></div><div>DetectItEasy is a tool that uses a collection of signatures of known packers to identify the one used on the selected file.&nbsp;</div><div><br></div><ol><li>Right-click on the <code>packed.exe</code> executable file and select "Detect it easy (DIE)".</li><li>If DetectItEasy can identify the used Packer, it will display its "best guess" under this section.</li></ol><div><img src="./TryHackMe _ Anti-Reverse Engineering_files/6d02e03daa39dd2f16a0c23d90eebbff.png" alt="Detecting Packers 1" style="width:75%"><br></div><div><br></div><ol><li><span style="font-size:1rem">You can also click on the "Entropy" button on the right side of the screen to open the "Entropy" window.</span></li><li><span style="font-size:1rem"><span>The Entropy window looks and determines how much <a class="h2M9HbGe glossary-term" onclick="initPopOver(&#39;entropy&#39;, &#39;h2M9HbGe&#39;)">entropy</a> each section has. And as you can see, it has been determined that "Section 1" is "packed".</span></span></li></ol><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/f3346a37c9d378847700cd44e390cbd9.png" alt="Detecting Packers 2" style="width:75%"><span style="font-size:1rem"><br></span></p><p><span style="font-size:1rem"><span>Entropy measures the level of disorder or uncertainty in a system. Packed malware tends to have high <a class="PxzFfjWV glossary-term" onclick="initPopOver(&#39;entropy&#39;, &#39;PxzFfjWV&#39;)">entropy</a> due to the randomness of the packing process.</span></span></p><div><span style="font-size:1rem">Another tool is PEStudio which lists information on PE files. This is important because there are specific Packers that will still leave clues.</span><br></div><div><span style="font-size:1rem"><br></span></div><ol><li>From the Desktop, double-click on the "pestudio" icon.</li><li>Go through the menus, "File &gt; Open", and open the <code>packed.exe</code>.</li><li>In the list of items on the left panel window, click on "sections (self-modifying)".</li></ol><p></p><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/d20925acce3a1b107e34b4fd2d2ee92d.png" style="width:50%" alt="left panel"><br></p><p>Usually, the section names of a standard PE file are <code>.text</code>, <code>.data</code> and <code>.rsrc</code>. But in the output above, we can see that this is the section names have been changed. The strings <code>UPX0</code>, <code>UPX1</code>, and <code>UPX2</code>&nbsp;are one of those identifiable pieces of information that Packers like UPX leave behind. Not all Packers change this value, but usually, this is the most accessible first place to look.</p><div>Because different Packer tools use various methodologies in packing executables, sometimes tools like DetectItEasy could not identify all types of Packers.</div><div><span style="font-size:1rem"><br></span></div><div><span style="font-size:24px">Automated Unpacking</span></div><div><div><span style="font-size:1rem">Once the Packer for a packed malware is identified, it is possible to use an unpacker to get back the original file. Some are readily available, like in the case of UPX, where you can use the same packing program for unpacking. For other commercial tools like Themida, you may have to rely on unpacker scripts made by 3rd parties.</span><br></div></div><div><br></div><div>Here is a short list of scripts that you could use for specific Unpacker tools:</div><ul><li><a href="https://github.com/Hendi48/Magicmida" target="_blank">Themida</a></li><li><a href="https://github.com/ThomasThelen/OllyDbg-Scripts/blob/master/Enigma/Enigma%20Protector%201.90%20-%203.xx%20Alternativ%20Unpacker%20v1.0.txt" target="_blank">Enigma Protector</a></li><li><a href="https://github.com/avast/retdec/blob/master/src/unpackertool/plugins/mpress/mpress.cpp" target="_blank">Mpress unpacker</a></li></ul><p>If you chance upon malware packed with an obscure tool or modified to thwart available scripts, things might be more difficult.<br></p><div>Thankfully, there are services like <a href="https://www.unpac.me/" target="_blank">unpac.me</a>&nbsp;where you can upload a sample. It will try to identify and unpack the malware for you using custom unpacking and artefact extraction processes.&nbsp;<span style="font-size:1rem">While this service is excellent, it can still fail.</span></div><div><br></div><div><span style="font-size:24px">Manual Unpacking and Dumping</span></div><div>Ultimately, the best way to unpack malware is to execute it.</div><div><br></div><div>When a packed malware is executed, the wrapper or container code performs decryption and deobfuscation. Once fully unpacked, the malware can proceed with its true intentions. At this point, the Packer is useless, and we can thoroughly analyze the malware by debugging it while it's in memory using a debugger.</div><div><br></div><div>We can also dump this unpacked version as a separate executable.&nbsp;</div><div><br></div><ul><li>Open the <code>packed.exe</code> using x32dbg.</li><li>Press CTRL+G to open the "Enter expression to follow..." window, input <code>004172D4</code>&nbsp;then press "OK".</li><li>You will now be taken to the memory location <code>004172D4</code><span style="font-size:16px">. This memory location is before the entry point to the legitimate part of the program.&nbsp;</span></li><li><span style="font-size:16px">Press "F2" to set a breakpoint here, then press "F9" twice to move execution to this location.</span></li></ul><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/3bf415b3c23b1f71a6320b8ff439e8fc.png" style="width:75%" alt="breakpoint 1"><span style="font-size:16px"><br></span></p><ul><li>Finally, press "F7" to jmp to the memory location <code>00401262</code>. This location is the starting location of this legitimate program that the Packer goes to once it's fully unpacked.&nbsp;</li></ul><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/435c7f14ddc5442500aa15d99d2dfe0e.png" style="width:75%" alt="breakpoint 2"><i><span style="font-size:16px"><br></span></i></p><p>By now, you may be curious about the memory locations <code>004172D4</code> and <code>00401262</code>, and their relevance to what we are doing. When this UPX-packed malware is executed and the execution location reaches <code>004172D4</code>, it indicates that the legitimate part of the program has already been successfully unpacked and is now copied in memory at <code>00401262</code>. As outlined in the next steps, we can now begin dumping from this location.</p><p><i><b>Note: </b>Other packers have different approaches to unpacking the legitimate part of the program, so the steps above would not work on them.<br></i></p><ul><li><span style="font-size:16px">To start dumping, go to the top bar menu and click "Plugins &gt; Scylla".</span></li><li><span style="font-size:16px"><span>Scylla is a tool that can dump process memory to disk and fix and rebuild the Import Address Table (IAT). We'll use this to dump the unpacked legitimate part of the program to memory and fix it so it will have the updated memory locations from its <a class="fzzJhguE glossary-term" onclick="initPopOver(&#39;DLL&#39;, &#39;fzzJhguE&#39;)">DLL</a> imports.</span></span></li><li><span style="font-size:16px">Once the Scylla plugin window is open, click the "Dump" button.</span></li></ul><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/141c6d6bd351e89ffa441e858054553a.png" alt="Unpacking 1"><span style="font-size:1rem"><br></span></p><ul><li><span style="font-size:1rem">Save this dumped version to the exact location as the original file.</span></li><li>If you try to run this dumped version, an error will appear. This is because we have not fixed the import address table yet.</li></ul><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/d2d9936cf695ce355da8f072cde99766.png" style="border:1px solid;--darkreader-inline-border-top:initial;--darkreader-inline-border-right:initial;--darkreader-inline-border-bottom:initial;--darkreader-inline-border-left:initial" alt="Unpacking 2"><br></p><ul><li>Back in the Scylla plugin window, and click the "IAT Autosearch" button to start. This scans the memory of the process to locate the import address table. </li><li>If a pop-up window asks if you want to use the IAT Search Advanced result, select "No". Then press "OK".</li></ul><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/560c2e4aee60ce13e565270af77bf7b2.png" style="border:1px solid;--darkreader-inline-border-top:initial;--darkreader-inline-border-right:initial;--darkreader-inline-border-bottom:initial;--darkreader-inline-border-left:initial" alt="Unpacking 3"><br></p><ul><li>At this point, the appropriate values related to the IAT are now computed. We can now click on the "Get Imports" button to update the Imports list section.</li></ul><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/cfaeea5adbfbebf4b779c240a155810e.png" alt="Unpacking 4"><br></p><ul><li>This list will show all DLLs that are used by the program. The list is short because the program is simple. An actual malware will have a longer list.</li><li><span>Sometimes, Scylla will find invalid entries; this is marked with the&nbsp; "X" icon next to it. These are safe to delete because the list already covers every <a class="Q3HUpJuF glossary-term" onclick="initPopOver(&#39;DLL&#39;, &#39;Q3HUpJuF&#39;)">DLL</a> that the program uses. To delete these, go through each invalid entry, right-click, and select "Cut thunk". Once deleted, you should be left with valid entries with check mark icons.</span></li><li>Click on the "Fix Dump" button, and select the previously generated dump file you created a few steps ago.</li><li><span style="font-size:1rem">A new file will be created in the same directory as the dumped file with the string "_SCY" appended to its filename. If you execute this, the program will now work correctly.</span><br></li></ul><p><span style="font-size:1rem">You can confirm if unpacking was successful by inspecting the generated SCY file using DetectItEasy or PEStudio. Here's the output of DetectItEasy; you'll notice that it does not detect the Packer anymore:</span></p><p><img src="./TryHackMe _ Anti-Reverse Engineering_files/4600cdd205e3dbd31c691b0b5769eafc.png" alt="Unpacking 5" style="width:75%"><br></p><div>With the malware unpacked, you can now continue investigating the malware. However, don't be fooled into thinking that unpacking packed malware is easy. UPX is the most basic packer tool and the easiest to unpack. Other Packers will be more difficult, primarily if it employs other anti-reverse engineering techniques.</div></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>According to DetectItEasy, what is the version of the Microsoft Linker used for linking packed.exe?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **.**" value="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="7">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span>According to pestudio, what is the <a class="XBnl4zFv glossary-term" onclick="initPopOver(&#39;entropy&#39;, &#39;XBnl4zFv&#39;)">entropy</a> of the UPX2 section of packed.exe?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *.***" value="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="7">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-8">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse8">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 8                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Conclusion
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse8" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <div><span style="font-size:1rem">In this room, we learned about the different anti-reverse engineering techniques used by malware today. However, it is crucial to recognize that this topic is expansive, and we've only scratched the surface of what could be explored. Still, we hope this has given you an idea about the techniques and inspired you to explore more.</span></div><div><br></div><div>In this room, we learned the following:</div><ul><li>Why malware authors use anti-reverse engineering techniques</li><li>About different anti-reverse engineering techniques</li><li>The methods on how to circumvent anti-reverse engineering using various tools</li><li>How anti-reverse engineering techniques are implemented by reading the source code</li></ul></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                The arms race continues...
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="8">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div></div>
</div>
<div id="room-simple-details"><div class="card cd-2 text-center mt-3"><div class="card-body"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Anti-Reverse Engineering_files/af7feb2c43a2c7d5f111b98ccbd15048.png"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme">tryhackme</a> and <img class="avatar-tiny" src="./TryHackMe _ Anti-Reverse Engineering_files/26286532ed37cf8b7b375905f4306110.png"> 
        <a class="green-link" href="https://tryhackme.com/p/arebel">arebel</a></p><p class="mb-0">Only subscribers can deploy virtual machines in this room! 
        Go to your <a href="https://tryhackme.com/profile">profile</a> page to subscribe (if you have not already). 885 users are in here and this room is 34 days old.</p></div></div></div>

</div>
</div>
</div>
<div id="room-content-attackbox">
<div id="room-attackbox">
<div id="attackbox-machine-instance">
<div id="room-attackbox-loading"></div>
<div id="room-attackbox-vm-view"></div>
</div>
<div id="attackbox-machine-options">
<div class="d-flex">
<a target="_blank" id="room-attackbox-url" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="View in full screen"></a>
<div onclick="extendHourWebBasedVM(null)" class="hover-pointer" id="room-attackbox-extend" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Extend machines timer"><i class="fas fa-plus"></i></div>
<div onclick="terminateWebBasedVM(null)" class="hover-pointer" id="room-attackbox-terminate" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Terminate Machine"><i class="far fa-power-off"></i></div>
<div onclick="exitViewAttackBox()" class="hover-pointer" id="room-attackbox-exitview" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Exit split view"><i class="fas fa-minus"></i></div>
<div onclick="infoAttackBox()" class="hover-pointer faded" id="room-attackbox-info" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Machine Information"><i class="fas fa-info"></i></div>
<div class="d-flex" id="room-attackbox-tabs"></div>
</div>
<div id="room-attackbox-expire-text" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Time left until your AttackBox expires"></div>
</div>
</div>
<div class="modal fade" id="attackBoxInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-light-gray">
<h5 class="modal-title m-auto">Web-Based Machine Information</h5>
</div>
<div class="modal-body">
<p>Use the web-based machine to attack other target machines you start on TryHackMe.</p>
<ul class="normalList text-gray mt-3 mb-4">
<li>Public IP: <code id="browser-machine-pubip" class="dark size-14"></code></li>
<li class="mt-1">Private IP: <code id="browser-machine-privip" class="dark size-14"></code> <span class="size-14">(Use this for your reverse shells)</span></li>
<li class="mt-1">Username: <code id="browser-username" class="dark size-14"></code></li>
<li class="mt-1">Password: <code id="browser-password" class="dark size-14"></code></li>
<li class="mt-1">Protocol: <code id="browser-protocol" class="dark size-14"></code></li>
</ul>
<hr class="hr-min">
<ul class="text-lgray mb-0">
<li class="mt-2">To copy to and from the browser-based machine, highlight the text and press <b>CTRL+SHIFT+C</b> <details><summary>or use the clipboard</summary><img src="./TryHackMe _ Anti-Reverse Engineering_files/clipboard.gif"></details></li>
<li class="mt-2">When accessing target machines you start on TryHackMe tasks, make sure you're using the correct IP (it <b>should not be</b> the IP of your AttackBox)</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="award-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<button type="button" class="close size-30 text-lgray" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<div id="award-modal-badges"></div>
<p class="mb-0 text-lgray size-18">Complete the room to earn this badge</p>
</div>
</div>
</div>
</div>
<div class="modal fade" id="hint-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title"><i class="fal fa-lightbulb-on"></i> Question Hint</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body"></div>
</div>
</div>
</div>
<div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">...</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center"></div>
<div class="modal-footer"></div>
</div>
</div>
</div>
<link rel="stylesheet" href="./TryHackMe _ Anti-Reverse Engineering_files/modal.css">
<div class="modal-design-green modal fade" id="roomCompleted" tabindex="-1" role="dialog" data-backdrop="static" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content" id="roomCompletedModalContent">
<div class="modal-body text-center">
<button type="button" class="close" id="closeRoomComplete" aria-label="Close">
<i class="fad fa-times-circle"></i>
</button>
<div class="icon-box">
<i class="fad fa-badge-check"></i>
</div>
<h3 class="text-accent mt-5">Congratulations</h3>
<p class="faded mt-1">You've completed the room! Share this with your friends: </p>
<h2 id="roomCompleted-share"></h2>
<div id="ticket-info"></div> 
<p class="faded mt-1" id="roomFeedbackBtn">
<small>
<button class="bg-white border-0">Leave
feedback</button>
</small>
</p>
<form method="post" action="https://tryhackme.com/feedback" id="roomFeedbackForm" class="d-none mt-3">
<input type="hidden" name="_csrf" value="qLVxUIuc-c5vyoODNjd5htvmb-GsYH_lRW9s">
<input type="hidden" name="roomCode" value="antireverseengineering">
<input type="hidden" name="type" value="rooms">
<input type="hidden" name="redirect" value="json">
<div class="form-group">
<label class="mb-0" for="like">What do you like about the room?</label>
<textarea type="text" name="like" id="like" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="dislike">What don't you like about the room?</label>
<textarea type="text" name="dislike" id="dislike" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="details">Please send your suggestions, ideas and comments!</label>
<textarea id="details" type="text" name="details" class="form-control" style="padding: 5px;"></textarea>
</div>
<button type="submit" id="submitBtn" class="btn btn-success">Send Feedback</button>
</form>
<p class="mt-2 mb-0" id="formMessage"></p>
</div>
</div>
</div>
<script>
    function dismissRoomCompleteModal() {
      $('#roomCompleted').modal('hide');

      const shouldSeeReferralModal = ""
      if (shouldSeeReferralModal) {
        $('#unlockCreditModal').modal('show');

        referralModalEvent('view');
      }
    }

    document.getElementById('closeRoomComplete').addEventListener('click', dismissRoomCompleteModal)
  </script>
</div>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/roomFeedback.js"></script>
<div class="modal fade" id="roomStartAttackboxModal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static" data-keyboard="false">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title m-auto">To access this machine, you need to either</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close" style="position: absolute; right: 10px; top: 0; font-size: 30px;">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center">
<div class="row vertical-align-custom mb-0">
<div class="col-sm-5 pr-0">
<p class="size-18 bold">Use a VPN</p>
<p>Connect to our network via a VPN</p>
<a target="_blank" href="https://tryhackme.com/access"><button type="button" class="btn btn-light">See Instructions</button></a>
</div>
<div class="col-sm-2 size-24">
or
</div>
<div class="col-sm-5 pl-0">
<p class="size-18 bold">Use the AttackBox</p>
<p>Use a web-based attack machine <span class="size-12">(recommended)</span></p>
<button type="button" onclick="$(&#39;#roomStartAttackboxModal&#39;).modal(&#39;toggle&#39;); startAttackBox({startingMsg: false, tutorial: true})" class="btn btn-hgreen">Start AttackBox</button>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="expireSoon" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-warning fad fa-exclamation-triangle"></i></h1>
<h3 class="text-warning">Expiring Soon</h3>
<p class="faded mt-3 mb-0">Your machine is going to expire soon. Close this and add an hour to stop it from terminating!</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="terminatedMachine" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-danger fad fa-exclamation-triangle"></i></h1>
<h3 class="text-danger">Expired Machine</h3>
<p class="faded mt-3 mb-0">Your machine has expired and terminated.</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="machineDeployModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue text-center p-3">
<h4 class="mb-0 m-auto">How to access machines</h4>
<button type="button" class="close modal-close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center">
<p class="size-18 faded">Now you've started your machine, to access it you need to either</p>
<div class="row mb-0">
<div class="col-sm-6">
<img src="./TryHackMe _ Anti-Reverse Engineering_files/connect_openvpn_short.png">
<p class="mt-2 mb-0 faded">Download your VPN configuration file and import it into a OpenVPN client</p>
</div>
<div class="col-sm-6">
<img src="./TryHackMe _ Anti-Reverse Engineering_files/connect_kali_short.png">
<p class="mt-2 mb-0 faded">Control a web-based machine with everything you need, all from inside your browser</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="roomAlertModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title" id="roomAlertModalTitle"></h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body" id="roomAlertModalBody"></div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="resetUserProgressModal" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">Reset Your Progress</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<div><span class="text-danger"><i class="fas fa-exclamation-triangle"></i> Warning</span> You will keep your points but all your answers in this room will be erased.</div>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-danger" onclick="resetProgress()">Yes, please!</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="cloudEnvInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header  modal-dark-blue">
<h5 class="modal-title">Cloud Information</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<ul class="nav nav-tabs">
<li class="nav-item pr-2">
<a class="nav-link active" data-toggle="tab" href="https://tryhackme.com/room/antireverseengineering#env-tab">Environment</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/antireverseengineering#creds-tab">Credentials</a>
</li>
</ul>
<div class="tab-content">
<div class="tab-pane active" id="env-tab"></div>
<div class="tab-pane" id="creds-tab"></div>
</div>
</div>
<div class="modal-footer" id="cloudEnvModalFooter">
</div>
</div>
</div>
</div>
<div class="modal fade" id="setNameModal" role="dialog">
<div class="modal-dialog modal-lg modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title">Generating Your Certificate</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body container">
<div class="row">
<div class="col-6">
<h5 class="bold">Hey there, what's your name?</h5>
<p class="text-secondary">
If you want your name to appear on your certificate, please fill the field below.
</p>
<div class="form-group">
<label>Full Name </label>
<input id="modal-cert-field-name" type="text" placeholder="John Wick" class="mb-4 form-control">
<input id="modal-cert-field-email" type="hidden" value="giftonpaul@karunya.edu.in">
</div>
</div>
<div class="col-6">
<h5 class="bold">You're here incognito? It's ok!</h5>
<p class="text-secondary">If you chose skip, your username will be used instead!</p>
</div>
</div>
<div class="row">
<div class="col-6">
<button type="button" class="btn btn-success float-right" id="modal-cert-generate" onclick="gen_cert(true)" disabled="">
Generate with my full name
</button>
</div>
<div class="col-6">
<button type="button" class="btn btn-primary float-right" id="modal-cert-skip" onclick="gen_cert(false)">
Generate with my username
</button>
</div>
</div>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/certificateName.js"></script>
<div class="modal fade slideout-faq" id="roomSlideoutUnstuck" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-links">
<div id="unstuck-video" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-play"></i></div>
<div class="unstuck-icon-text">Video Solution</div>
</div>
<div id="unstuck-writeups" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-pen-alt"></i></div>
<div class="unstuck-icon-text">Writeups</div>
</div>
<a id="unstuck-forum" target="_blank" class="clear-link unstuck-group" href="https://tryhackme.com/forum/thread/6488847104b3d33d3993272d">
<div class="unstuck-icon"><i class="fas fa-comments-alt"></i></div>
<div class="unstuck-icon-text">Forum Post</div>
</a>
<a href="https://help.tryhackme.com/en/collections/3601905-getting-started-with-tryhackme" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-books"></i></div>
<div class="unstuck-icon-text">Knowledge Base</div>
</a>
<a href="https://discord.gg/DpBZz8y" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-users"></i></div>
<div class="unstuck-icon-text">Ask Community</div>
</a>
</div>
</div>
</div>
</div>
</div>
<style>

    #navConnModal .modal-body{
        position: relative;
    }

    #nav-openvpn,
    #nav-attackbox {
        display: none;
    }

    #nav-openvpn .nav-pills .nav-link.active,
    #nav-openvpn .nav-pills .show>.nav-link {
        background-color: #ec8e3d;
        color: white;
    }
    #nav-openvpn .nav-link {
        color: #909090;
    }
    #nav-openvpn a,
    #nav-attackbox a {
        color: #ec8e3d;
    }

    #nav-openvpn code.dark {
        background-color: #7d400a;
        color: #fff;
    }

    #slideout-bk {
        display: none;
        padding: 10px 15px;
        opacity: 0.8;
        cursor: pointer;
    }

    #slideout-bk:hover {
        opacity: 1;
    }

    #slideout-conn-hideip {
        display: none;
        position: absolute;
        bottom: 8px;
        right: 8px;
        opacity: 0.7;
        cursor: pointer;
    }

    #slideout-conn-hideip:hover {
        opacity: 1;
    }

</style>
<div class="modal fade slideout-faq" id="navConnModal" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-bk" class="noselect" onclick="showSlideoutConnOptions()"><i class="far fa-arrow-left mr-2"></i> Show Connection Options</div>
<div id="slideout-conn-options">
<div id="slideout-conn-header" class="text-center">
<img class="slideout-connect-img" src="./TryHackMe _ Anti-Reverse Engineering_files/tryhackme_connect.png">
<div id="slideout-conn-status" class="size-22">You are <span class="text-danger">disconnected</span></div>
</div>
<div class="m-3 text-center">
<p>To access target machines you need to either:</p>
<div class="row mb-3 faq-quicklinks text-left vertical-align-custom">
<div class="col-md-12 mb-3">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/antireverseengineering#" onclick="showAttackBoxSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-laptop"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">AttackBox</div>
<p class="faded mb-0">Use a browser-based attack machine</p>
</div>
</div>
</div>
</a>
</div>
<div class="col-md-12">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/antireverseengineering#" onclick="showVPNSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-key"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">OpenVPN</div>
<p class="faded mb-0">Connect to our network via a VPN</p>
</div>
</div>
</div>
</a>
</div>
</div>
</div>
</div>
<div id="faqCards" class="p-3">
<div id="nav-openvpn">
<div class="mb-3">
<a target="_blank" href="https://tryhackme.com/access"><i>View the dedicated OpenVPN access page for more information</i></a>
</div>
<div class="text-center">
<h4>What Operating System are you using?</h4>
<ul class="nav nav-pills mb-3 text-center" id="vpn-guide" style="display: flex; justify-content: center;">
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/antireverseengineering#pills-windows" role="tab" aria-controls="pills-windows" aria-selected="true"><i class="fab fa-windows mr-2"></i> Windows</a>
</li>
<li class="nav-item m-3">
<a class="nav-link active" data-toggle="pill" href="https://tryhackme.com/room/antireverseengineering#pills-linux" role="tab" aria-controls="pills-linux" aria-selected="false"><i class="fab fa-linux mr-2"></i> Linux</a>
</li>
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/antireverseengineering#pills-macos" role="tab" aria-controls="pills-macos" aria-selected="false"><i class="fab fa-apple mr-2"></i> MacOS</a>
</li>
</ul>
<div class="tab-content text-left">
<div class="tab-pane fade" id="pills-windows" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a target="_blank" href="https://openvpn.net/client-connect-vpn-for-windows/">Download</a> the OpenVPN GUI application.</li>
<li class="mt-2">Install the OpenVPN GUI application. Then open the installer file and follow the setup wizard.</li>
<li class="mt-2">Open and run the OpenVPN GUI application as Administrator.<br><img class="mt-2 mb-3" src="./TryHackMe _ Anti-Reverse Engineering_files/win_ran_admin.png"></li>
<li class="mt-2">The application will start running in the system tray. It's at the bottom of your screen, near the clock. Right click on the application and click <b>Import File</b>. <br><img class="mt-2 mb-3" src="./TryHackMe _ Anti-Reverse Engineering_files/win_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Now right click on the application again, select your file and click Connect <br><img class="mt-2 mb-3" src="./TryHackMe _ Anti-Reverse Engineering_files/win_connect.png"></li>
</ol>
</div>
<div class="tab-pane fade show active" id="pills-linux" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2">Run the following command in your terminal: <code class="dark">sudo apt install openvpn</code></li>
<li class="mt-2">Locate the full path to your VPN configuration file (normally in your ~/Downloads folder).</li>
<li class="mt-2">Use your OpenVPN file with the following command: <code class="dark">sudo openvpn /path/to/file.ovpn</code></li>
</ol>
</div>
<div class="tab-pane fade" id="pills-macos" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a href="https://openvpn.net/downloads/openvpn-connect-v2-macos.dmg">Download</a> OpenVPN for MacOS.</li>
<li class="mt-2">Install the OpenVPN GUI application, by opening the dmg file and following the setup wizard.<br><img width="250" class="mt-2 mb-3" src="./TryHackMe _ Anti-Reverse Engineering_files/mac_installer.png"></li>
<li class="mt-2">Open and run the OpenVPN GUI application.</li>
<li class="mt-2">The application will start running and appear in your top bar. Right click on the application and click <b>Import File -&gt; Local file</b>.<br><img class="mt-2 mb-3" src="./TryHackMe _ Anti-Reverse Engineering_files/mac_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Right click on the application again, select your file and click connect.<br><img class="mt-2 mb-3" src="./TryHackMe _ Anti-Reverse Engineering_files/mac_connect.png"></li>
</ol>
</div>
</div>
<section class="text-left">
<a class="remove-underline" data-toggle="collapse" href="https://tryhackme.com/room/antireverseengineering#havingProblems" role="button" aria-expanded="false" aria-controls="havingProblems">
<h5 class="mb-0 text-openvpn">Having Problems?</h5>
</a>
<div class="collapse" id="havingProblems">
<ul class="mt-2 mb-0">
<li>If you can access <a target="_blank" href="http://10.10.10.10/">10.10.10.10</a>, you're connected.</li>
<li>Downloading and getting a 404? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>Getting inline cert error? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>If you are using a virtual machine, you will need to run the VPN inside that machine.</li>
<li>Is the OpenVPN client running as root? <span class="size-14 faded">(On Windows, run OpenVPN GUI as administrator. On Linux, run with sudo)</span></li>
<li>Have you restarted your VM?</li>
<li>Is your OpenVPN up-to-date?</li>
<li>Only 1 OpenVPN connection is allowed. <span class="size-14 faded">(Run <code class="dark">ps aux | grep openvpn</code> - are there 2 VPN sessions running?)</span></li>
<li>Still having issues? Check our <a href="https://help.tryhackme.com/en/articles/6496029-openvpn-general-troubleshooting-detailed/">docs</a> out.</li>
</ul>
</div>
</section>
</div>
</div>
<div id="nav-attackbox">
<div class="text-center">
<h4>AttackBox</h4>
<p class="faded">Use your own web-based linux machine to access machines on TryHackMe</p>
</div>
<p>To start your AttackBox in the room, click the <a class="preventDefault" onclick="showAttackBoxBtnFromSlideout()" href="https://tryhackme.com/room/antireverseengineering#">Start AttackBox</a> button. Your private machine will take 2 minutes to start.</p>
<p>Free users get 1 free AttackBox hour. <a class="hacker-green" href="https://tryhackme.com/why-subscribe">Subscribed</a> users get more powerful machines with unlimited deploys.</p>
</div>
</div>
<span id="slideout-conn-hideip" onclick="hideNavConnIP()" style="display: none;">Hide IP</span>
</div>
</div>
</div>
</div>
<script>

    const navConnVPNEl = document.querySelector('#nav-openvpn')
    const navConnAttackBoxEl = document.querySelector('#nav-attackbox')
    const navConnOptions = document.querySelector('#slideout-conn-options')

    const navConnBkBtn = document.querySelector('#slideout-bk')

    function showVPNSteps() {
        navConnOptions.style.display = 'none'
        navConnVPNEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showAttackBoxSteps() {
        navConnOptions.style.display = 'none'
        navConnAttackBoxEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showSlideoutConnOptions() {
        navConnVPNEl.style.display = 'none'
        navConnAttackBoxEl.style.display = 'none'
        navConnBkBtn.style.display = 'none'
        navConnOptions.style.display = 'block'
    }

    function showAttackBoxBtnFromSlideout() {
        $('#navConnModal').modal('toggle')
        setTimeout(function() {
            showAttackBoxBtnIntro()
        }, 100)   
    }

  </script>
</div><iframe id="_hjSafeContext_52303152" title="_hjSafeContext" tabindex="-1" aria-hidden="true" src="./TryHackMe _ Anti-Reverse Engineering_files/saved_resource.html" style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;"></iframe>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/notify.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/api-requests.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/events.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/underscore-min.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/apexcharts.min.js"></script> 
<script src="./TryHackMe _ Anti-Reverse Engineering_files/chart.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/expire.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/sockets.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/faqSearch.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/certificate.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/utils.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/roomSpecific.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/confetti.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/videos.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/intro.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/prism.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/asciinema-player.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/magnific-popup.min.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/introjsLogic.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/logic.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/tasks.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/connection-status.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/glossary.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/room-mymachine.js"></script>
<script src="./TryHackMe _ Anti-Reverse Engineering_files/heartbeat.js" defer=""></script>
<script>

    let height
    $(window).scroll(function () { /* Function to make IP information sticky. */
      if (height == undefined || height < 30) {
        height = ($('#instance-info').offset().top)
      }
      let scroll = $(window).scrollTop()
      if (((scroll >= (height + 150))) && height > 30) {
        $("#instance-info").addClass('instance-sticky')
      } else if ((scroll <= (height))) {
        $("#instance-info").removeClass("instance-sticky")
      }
    })

    const csrfToken = "qLVxUIuc-c5vyoODNjd5htvmb-GsYH_lRW9s"
    $.ajaxSetup({ headers: { 'CSRF-Token': csrfToken } }) // all $.post headers include token (needs csrfProtection middleware)

    const roomCode = "antireverseengineering"
    const simpleRoom = true 
    const events = {"tickets":false}

    let userObj = { 
      subscribed: 1,
      splitScreen: false,
      path: "pentesting",
      tutorial: {
        rooms: true,
        attackbox: true,
        staticsite: true
      },
      experiments:  JSON.parse(`{"onboardingAchievement":{},"scheduler":{"startDate":"2023-06-14T13:38:51.108Z"},"showEasyPath":true}`),
    }

    const roomSettings = {
      remAttackBoxBtn : false
    };

    const heartbeatInterval = 30;

    const cloudEnabled = false 
    let cloudObj

    initRoom()
    checkVideoTab()
    if(!simpleRoom) showChart(roomCode)

    checkRoomAwards(roomCode)

    getRoomVotes()

    displayStreakFreezeAwardedFromMemory();
    
    window.addEventListener('load', function () {
      introjsInit(roomCode)
    })

  </script>


<svg id="SvgjsSvg1001" width="2" height="0" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.dev" style="overflow: hidden; top: -100%; left: -100%; position: absolute; opacity: 0;"><defs id="SvgjsDefs1002"></defs><polyline id="SvgjsPolyline1003" points="0,0"></polyline><path id="SvgjsPath1004" d="M0 0 "></path></svg><div id="8A699029-C319-2DA7-D2F1-2C6DF6AADB02"></div><iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" aria-hidden="true" tabindex="-1" title="Intercom" src="./TryHackMe _ Anti-Reverse Engineering_files/saved_resource(1).html"></iframe><div class="intercom-lightweight-app"><div class="intercom-lightweight-app-launcher intercom-launcher" role="button" tabindex="0" aria-label="Open Intercom Messenger" aria-live="polite"><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-open"><img src="./TryHackMe _ Anti-Reverse Engineering_files/9e0f012f15b6fc981dde2f1f5198d728.png" alt="" class="intercom-lightweight-app-launcher-custom-icon-open"></div><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-minimize"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M18.601 8.39897C18.269 8.06702 17.7309 8.06702 17.3989 8.39897L12 13.7979L6.60099 8.39897C6.26904 8.06702 5.73086 8.06702 5.39891 8.39897C5.06696 8.73091 5.06696 9.2691 5.39891 9.60105L11.3989 15.601C11.7309 15.933 12.269 15.933 12.601 15.601L18.601 9.60105C18.9329 9.2691 18.9329 8.73091 18.601 8.39897Z" fill="white"></path>
</svg>
</div></div><style id="intercom-lightweight-app-style" type="text/css">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    0% {
      opacity: 0;
      transform: scale(0);
    }
    40% {
      opacity: 1;
    }
    100% {
      transform: scale(1);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji", Helvetica, Arial, sans-serif;
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    padding: 0 !important;
    margin: 0 !important;
    border: none;
    bottom: 20px;
    right: 20px;
    max-width: 48px;
    width: 48px;
    max-height: 48px;
    height: 48px;
    border-radius: 50%;
    background: #1C2538;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    transition: transform 167ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    box-sizing: content-box;
  }


  .intercom-lightweight-app-launcher:hover {
    transition: transform 250ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    transform: scale(1.1)
  }

  .intercom-lightweight-app-launcher:active {
    transform: scale(0.85);
    transition: transform 134ms cubic-bezier(0.45, 0, 0.2, 1);
  }


  .intercom-lightweight-app-launcher:focus {
    outline: none;

    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 48px;
    height: 48px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 24px;
    height: 24px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 44px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 24px;
    max-width: 24px;

    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: white;
    animation: intercom-lightweight-app-messenger 250ms cubic-bezier(0, 1, 1, 1);
    transform-origin: bottom right;
    
        width: 400px;
        height: calc(100% - 104px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 84px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
      

    border-radius: 16px;
  }

  .intercom-lightweight-app-messenger-header {
    height: 64px;
    border-bottom: none;
    background: #1c2538

    
  }

  .intercom-lightweight-app-messenger-footer{
    position:absolute;
    bottom:0;
    width: 100%;
    height: 80px;
    background: #fff;
    font-size: 14px;
    line-height: 21px;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0px 0px 25px rgba(0, 0, 0, 0.05);
    
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div></body></html>