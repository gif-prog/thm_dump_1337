<!DOCTYPE html>
<!-- saved from url=(0032)https://tryhackme.com/room/snort -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>TryHackMe | Snort</title>
<meta name="description" content="Learn how to use Snort to detect real-time threats, analyse recorded traffic files and identify anomalies.">
<meta name="og:description" content="Learn how to use Snort to detect real-time threats, analyse recorded traffic files and identify anomalies.">
<meta name="keywords" content="cyber,security,cyber security,cyber security training,coding,computer,bitcoin,hacking,hackers,hacks,hack,exploits,keylogger,learn,poc">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<meta property="og:site_name" content="TryHackMe">
<meta property="og:title" content="TryHackMe | Snort">
<meta property="og:image" content="https://tryhackme-images.s3.amazonaws.com/room-icons/232979a675e1dd0f567ea004d1996e84.png">
<meta property="og:url" content="https://tryhackme.com/room/snort">
<meta name="twitter:image" content="https://tryhackme.com/img/meta/default.png">
<meta property="og:description" content="Learn how to use Snort to detect real-time threats, analyse recorded traffic files and identify anomalies.">

<script type="text/javascript" async="" src="./TryHackMe _ Snort_files/pgpbhph6"></script><script src="./TryHackMe _ Snort_files/jquery.min.js"></script>
<script src="./TryHackMe _ Snort_files/popper.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Snort_files/boostrap431.min.css">
<script src="./TryHackMe _ Snort_files/bootstrap431.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Snort_files/animate.min.css">
<link rel="stylesheet" href="./TryHackMe _ Snort_files/all.css" integrity="sha384-ekOryaXPbeCpWQNxMwSWVvQ0+1VrStoPJq54shlYhR8HzQgig1v5fas6YgOqLoKz" crossorigin="anonymous">
<link rel="icon" type="image/png" href="https://assets.tryhackme.com/img/favicon.png">
<link rel="stylesheet" media="screen" href="./TryHackMe _ Snort_files/general-style.css">
<script src="./TryHackMe _ Snort_files/script.js"></script>
<script src="./TryHackMe _ Snort_files/validation.js"></script>

<link rel="stylesheet" type="text/css" href="./TryHackMe _ Snort_files/cookieconsent.min.css">
<script src="./TryHackMe _ Snort_files/cookieconsent.min.js"></script>
<script async="" src="./TryHackMe _ Snort_files/js"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-Z8D4WL3D4P');
  </script>


<script>
    window.intercomSettings = {
      api_base: "https://api-iam.intercom.io",
      app_id: "pgpbhph6"
    };
  </script>
<script>
    (function (h, o, t, j, a, r) {
      h.hj = h.hj || function () { (h.hj.q = h.hj.q || []).push(arguments) };
      h._hjSettings = { hjid: 1950941, hjsv: 6 };
      a = o.getElementsByTagName('head')[0];
      r = o.createElement('script'); r.async = 1;
      r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
      a.appendChild(r);
    })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
  </script><script async="" src="./TryHackMe _ Snort_files/hotjar-1950941.js"></script>
<script>
    /* Global javascript variables */

    // Used inside script.js for createRooms compelted users.
    const username = 'Silv3rsurf3r'
    const subscribed = '1'
    const level = '10'
    const intercomEnabled = 'true'
  </script>
<script>
    //add back tracking info
    const userId = "63d14e7f857ae10041bb192f"
    let tutorialComplete = false
    if ('false' == "true") {
      tutorialComplete = true
    }
    if(intercomEnabled === "true"){
      window.intercomSettings = {
        api_base: "https://api-iam.intercom.io",
        app_id: "pgpbhph6",
        user_id: userId,
        username: username,
        email: "giftonpaul@karunya.edu.in",
        created_at: Math.floor(new Date("Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)").getTime() / 1000) // Signup date as a Unix timestamp
      };
    }
    window.hj('identify', userId, {
      displayName: username,
      subscribed: "1",
      dateSignUp: "Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)",
      experience: "advanced"
    })
  </script>
<script type="application/ld+json">

   {
      "@context":"https://schema.org",
      "@type":"Organization",
      "url":"https://tryhackme.com",
      "name":"TryHackMe",
      "logo":"https://tryhackme.com/img/favicon.png",
      "description":"TryHackMe is a free online platform for learning cyber security, using hands-on exercises and labs, all through your browser!",
      "email": "support@tryhackme.com",
      "sameAs":[
         "https://www.linkedin.com/company/tryhackme",
         "https://twitter.com/realtryhackme"
      ]
   }

</script>
<script>
    console.log(`%c
      ------------------
      < Happy Hacking! >
      ------------------
              \\   ^__^
               \\  (oo)\\_______
                  (__)\\       )\\/\\
                      ||----w |
                      ||     ||`, "font-family:monospace")
  </script>
<script>
  (function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pgpbhph6';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>
<script src="./TryHackMe _ Snort_files/socket.io.js"></script><script>
  let socket = io.connect({
    transports: ['websocket'],
    reconnection: true,
    reconnectionDelay: 1000,
    reconnectionAttempts: 10
  })
</script><style type="text/css">.apexcharts-canvas {
  position: relative;
  user-select: none;
  /* cannot give overflow: hidden as it will crop tooltips which overflow outside chart area */
}


/* scrollbar is not visible by default for legend, hence forcing the visibility */
.apexcharts-canvas ::-webkit-scrollbar {
  -webkit-appearance: none;
  width: 6px;
}

.apexcharts-canvas ::-webkit-scrollbar-thumb {
  border-radius: 4px;
  background-color: rgba(0, 0, 0, .5);
  box-shadow: 0 0 1px rgba(255, 255, 255, .5);
  -webkit-box-shadow: 0 0 1px rgba(255, 255, 255, .5);
}


.apexcharts-inner {
  position: relative;
}

.apexcharts-text tspan {
  font-family: inherit;
}

.legend-mouseover-inactive {
  transition: 0.15s ease all;
  opacity: 0.20;
}

.apexcharts-series-collapsed {
  opacity: 0;
}

.apexcharts-tooltip {
  border-radius: 5px;
  box-shadow: 2px 2px 6px -4px #999;
  cursor: default;
  font-size: 14px;
  left: 62px;
  opacity: 0;
  pointer-events: none;
  position: absolute;
  top: 20px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  white-space: nowrap;
  z-index: 12;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-theme-light {
  border: 1px solid #e3e3e3;
  background: rgba(255, 255, 255, 0.96);
}

.apexcharts-tooltip.apexcharts-theme-dark {
  color: #fff;
  background: rgba(30, 30, 30, 0.8);
}

.apexcharts-tooltip * {
  font-family: inherit;
}


.apexcharts-tooltip-title {
  padding: 6px;
  font-size: 15px;
  margin-bottom: 4px;
}

.apexcharts-tooltip.apexcharts-theme-light .apexcharts-tooltip-title {
  background: #ECEFF1;
  border-bottom: 1px solid #ddd;
}

.apexcharts-tooltip.apexcharts-theme-dark .apexcharts-tooltip-title {
  background: rgba(0, 0, 0, 0.7);
  border-bottom: 1px solid #333;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  display: inline-block;
  font-weight: 600;
  margin-left: 5px;
}

.apexcharts-tooltip-text-y-label:empty,
.apexcharts-tooltip-text-y-value:empty,
.apexcharts-tooltip-text-goals-label:empty,
.apexcharts-tooltip-text-goals-value:empty,
.apexcharts-tooltip-text-z-value:empty {
  display: none;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  font-weight: 600;
}

.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-goals-group, 
.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  display: flex;
}
.apexcharts-tooltip-text-goals-label:not(:empty),
.apexcharts-tooltip-text-goals-value:not(:empty) {
  margin-top: -6px;
}

.apexcharts-tooltip-marker {
  width: 12px;
  height: 12px;
  position: relative;
  top: 0px;
  margin-right: 10px;
  border-radius: 50%;
}

.apexcharts-tooltip-series-group {
  padding: 0 10px;
  display: none;
  text-align: left;
  justify-content: left;
  align-items: center;
}

.apexcharts-tooltip-series-group.apexcharts-active .apexcharts-tooltip-marker {
  opacity: 1;
}

.apexcharts-tooltip-series-group.apexcharts-active,
.apexcharts-tooltip-series-group:last-child {
  padding-bottom: 4px;
}

.apexcharts-tooltip-series-group-hidden {
  opacity: 0;
  height: 0;
  line-height: 0;
  padding: 0 !important;
}

.apexcharts-tooltip-y-group {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-box, .apexcharts-custom-tooltip {
  padding: 4px 8px;
}

.apexcharts-tooltip-boxPlot {
  display: flex;
  flex-direction: column-reverse;
}

.apexcharts-tooltip-box>div {
  margin: 4px 0;
}

.apexcharts-tooltip-box span.value {
  font-weight: bold;
}

.apexcharts-tooltip-rangebar {
  padding: 5px 8px;
}

.apexcharts-tooltip-rangebar .category {
  font-weight: 600;
  color: #777;
}

.apexcharts-tooltip-rangebar .series-name {
  font-weight: bold;
  display: block;
  margin-bottom: 5px;
}

.apexcharts-xaxistooltip {
  opacity: 0;
  padding: 9px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
  transition: 0.15s ease all;
}

.apexcharts-xaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-xaxistooltip:after,
.apexcharts-xaxistooltip:before {
  left: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-xaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-left: -6px;
}

.apexcharts-xaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-left: -7px;
}

.apexcharts-xaxistooltip-bottom:after,
.apexcharts-xaxistooltip-bottom:before {
  bottom: 100%;
}

.apexcharts-xaxistooltip-top:after,
.apexcharts-xaxistooltip-top:before {
  top: 100%;
}

.apexcharts-xaxistooltip-bottom:after {
  border-bottom-color: #ECEFF1;
}

.apexcharts-xaxistooltip-bottom:before {
  border-bottom-color: #90A4AE;
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:after {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:before {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top:after {
  border-top-color: #ECEFF1
}

.apexcharts-xaxistooltip-top:before {
  border-top-color: #90A4AE;
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:after {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:before {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-yaxistooltip {
  opacity: 0;
  padding: 4px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
}

.apexcharts-yaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-yaxistooltip:after,
.apexcharts-yaxistooltip:before {
  top: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-yaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-top: -6px;
}

.apexcharts-yaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-top: -7px;
}

.apexcharts-yaxistooltip-left:after,
.apexcharts-yaxistooltip-left:before {
  left: 100%;
}

.apexcharts-yaxistooltip-right:after,
.apexcharts-yaxistooltip-right:before {
  right: 100%;
}

.apexcharts-yaxistooltip-left:after {
  border-left-color: #ECEFF1;
}

.apexcharts-yaxistooltip-left:before {
  border-left-color: #90A4AE;
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:after {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:before {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right:after {
  border-right-color: #ECEFF1;
}

.apexcharts-yaxistooltip-right:before {
  border-right-color: #90A4AE;
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:after {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:before {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip.apexcharts-active {
  opacity: 1;
}

.apexcharts-yaxistooltip-hidden {
  display: none;
}

.apexcharts-xcrosshairs,
.apexcharts-ycrosshairs {
  pointer-events: none;
  opacity: 0;
  transition: 0.15s ease all;
}

.apexcharts-xcrosshairs.apexcharts-active,
.apexcharts-ycrosshairs.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-ycrosshairs-hidden {
  opacity: 0;
}

.apexcharts-selection-rect {
  cursor: move;
}

.svg_select_boundingRect, .svg_select_points_rot {
  pointer-events: none;
  opacity: 0;
  visibility: hidden;
}
.apexcharts-selection-rect + g .svg_select_boundingRect,
.apexcharts-selection-rect + g .svg_select_points_rot {
  opacity: 0;
  visibility: hidden;
}

.apexcharts-selection-rect + g .svg_select_points_l,
.apexcharts-selection-rect + g .svg_select_points_r {
  cursor: ew-resize;
  opacity: 1;
  visibility: visible;
}

.svg_select_points {
  fill: #efefef;
  stroke: #333;
  rx: 2;
}

.apexcharts-svg.apexcharts-zoomable.hovering-zoom {
  cursor: crosshair
}

.apexcharts-svg.apexcharts-zoomable.hovering-pan {
  cursor: move
}

.apexcharts-zoom-icon,
.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon,
.apexcharts-reset-icon,
.apexcharts-pan-icon,
.apexcharts-selection-icon,
.apexcharts-menu-icon,
.apexcharts-toolbar-custom-icon {
  cursor: pointer;
  width: 20px;
  height: 20px;
  line-height: 24px;
  color: #6E8192;
  text-align: center;
}

.apexcharts-zoom-icon svg,
.apexcharts-zoomin-icon svg,
.apexcharts-zoomout-icon svg,
.apexcharts-reset-icon svg,
.apexcharts-menu-icon svg {
  fill: #6E8192;
}

.apexcharts-selection-icon svg {
  fill: #444;
  transform: scale(0.76)
}

.apexcharts-theme-dark .apexcharts-zoom-icon svg,
.apexcharts-theme-dark .apexcharts-zoomin-icon svg,
.apexcharts-theme-dark .apexcharts-zoomout-icon svg,
.apexcharts-theme-dark .apexcharts-reset-icon svg,
.apexcharts-theme-dark .apexcharts-pan-icon svg,
.apexcharts-theme-dark .apexcharts-selection-icon svg,
.apexcharts-theme-dark .apexcharts-menu-icon svg,
.apexcharts-theme-dark .apexcharts-toolbar-custom-icon svg {
  fill: #f3f4f5;
}

.apexcharts-canvas .apexcharts-zoom-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-selection-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-reset-zoom-icon.apexcharts-selected svg {
  fill: #008FFB;
}

.apexcharts-theme-light .apexcharts-selection-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoom-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoomin-icon:hover svg,
.apexcharts-theme-light .apexcharts-zoomout-icon:hover svg,
.apexcharts-theme-light .apexcharts-reset-icon:hover svg,
.apexcharts-theme-light .apexcharts-menu-icon:hover svg {
  fill: #333;
}

.apexcharts-selection-icon,
.apexcharts-menu-icon {
  position: relative;
}

.apexcharts-reset-icon {
  margin-left: 5px;
}

.apexcharts-zoom-icon,
.apexcharts-reset-icon,
.apexcharts-menu-icon {
  transform: scale(0.85);
}

.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon {
  transform: scale(0.7)
}

.apexcharts-zoomout-icon {
  margin-right: 3px;
}

.apexcharts-pan-icon {
  transform: scale(0.62);
  position: relative;
  left: 1px;
  top: 0px;
}

.apexcharts-pan-icon svg {
  fill: #fff;
  stroke: #6E8192;
  stroke-width: 2;
}

.apexcharts-pan-icon.apexcharts-selected svg {
  stroke: #008FFB;
}

.apexcharts-pan-icon:not(.apexcharts-selected):hover svg {
  stroke: #333;
}

.apexcharts-toolbar {
  position: absolute;
  z-index: 11;
  max-width: 176px;
  text-align: right;
  border-radius: 3px;
  padding: 0px 6px 2px 6px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.apexcharts-menu {
  background: #fff;
  position: absolute;
  top: 100%;
  border: 1px solid #ddd;
  border-radius: 3px;
  padding: 3px;
  right: 10px;
  opacity: 0;
  min-width: 110px;
  transition: 0.15s ease all;
  pointer-events: none;
}

.apexcharts-menu.apexcharts-menu-open {
  opacity: 1;
  pointer-events: all;
  transition: 0.15s ease all;
}

.apexcharts-menu-item {
  padding: 6px 7px;
  font-size: 12px;
  cursor: pointer;
}

.apexcharts-theme-light .apexcharts-menu-item:hover {
  background: #eee;
}

.apexcharts-theme-dark .apexcharts-menu {
  background: rgba(0, 0, 0, 0.7);
  color: #fff;
}

@media screen and (min-width: 768px) {
  .apexcharts-canvas:hover .apexcharts-toolbar {
    opacity: 1;
  }
}

.apexcharts-datalabel.apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-pie-label,
.apexcharts-datalabels,
.apexcharts-datalabel,
.apexcharts-datalabel-label,
.apexcharts-datalabel-value {
  cursor: default;
  pointer-events: none;
}

.apexcharts-pie-label-delay {
  opacity: 0;
  animation-name: opaque;
  animation-duration: 0.3s;
  animation-fill-mode: forwards;
  animation-timing-function: ease;
}

.apexcharts-canvas .apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-hide .apexcharts-series-points {
  opacity: 0;
}

.apexcharts-gridline,
.apexcharts-annotation-rect,
.apexcharts-tooltip .apexcharts-marker,
.apexcharts-area-series .apexcharts-area,
.apexcharts-line,
.apexcharts-zoom-rect,
.apexcharts-toolbar svg,
.apexcharts-area-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-line-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-radar-series path,
.apexcharts-radar-series polygon {
  pointer-events: none;
}


/* markers */

.apexcharts-marker {
  transition: 0.15s ease all;
}

@keyframes opaque {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}


/* Resize generated styles */

@keyframes resizeanim {
  from {
    opacity: 0;
  }
  to {
    opacity: 0;
  }
}

.resize-triggers {
  animation: 1ms resizeanim;
  visibility: hidden;
  opacity: 0;
}

.resize-triggers,
.resize-triggers>div,
.contract-trigger:before {
  content: " ";
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  overflow: hidden;
}

.resize-triggers>div {
  background: #eee;
  overflow: auto;
}

.contract-trigger:before {
  width: 200%;
  height: 200%;
}</style><style data-jss="" data-meta="MuiDialog">
@media print {
  .MuiDialog-root {
    position: absolute !important;
  }
}
.MuiDialog-scrollPaper {
  display: flex;
  align-items: center;
  justify-content: center;
}
.MuiDialog-scrollBody {
  overflow-x: hidden;
  overflow-y: auto;
  text-align: center;
}
.MuiDialog-scrollBody:after {
  width: 0;
  height: 100%;
  content: "";
  display: inline-block;
  vertical-align: middle;
}
.MuiDialog-container {
  height: 100%;
  outline: 0;
}
@media print {
  .MuiDialog-container {
    height: auto;
  }
}
.MuiDialog-paper {
  margin: 32px;
  position: relative;
  overflow-y: auto;
}
@media print {
  .MuiDialog-paper {
    box-shadow: none;
    overflow-y: visible;
  }
}
.MuiDialog-paperScrollPaper {
  display: flex;
  max-height: calc(100% - 64px);
  flex-direction: column;
}
.MuiDialog-paperScrollBody {
  display: inline-block;
  text-align: left;
  vertical-align: middle;
}
.MuiDialog-paperWidthFalse {
  max-width: calc(100% - 64px);
}
.MuiDialog-paperWidthXs {
  max-width: 444px;
}
@media (max-width:507.95px) {
  .MuiDialog-paperWidthXs.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthSm {
  max-width: 600px;
}
@media (max-width:663.95px) {
  .MuiDialog-paperWidthSm.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthMd {
  max-width: 960px;
}
@media (max-width:1023.95px) {
  .MuiDialog-paperWidthMd.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthLg {
  max-width: 1280px;
}
@media (max-width:1343.95px) {
  .MuiDialog-paperWidthLg.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthXl {
  max-width: 1920px;
}
@media (max-width:1983.95px) {
  .MuiDialog-paperWidthXl.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperFullWidth {
  width: calc(100% - 64px);
}
.MuiDialog-paperFullScreen {
  width: 100%;
  height: 100%;
  margin: 0;
  max-width: 100%;
  max-height: none;
  border-radius: 0;
}
.MuiDialog-paperFullScreen.MuiDialog-paperScrollBody {
  margin: 0;
  max-width: 100%;
}
</style><script async="" src="./TryHackMe _ Snort_files/modules.5957fbf26d1b525b5a12.js" charset="utf-8"></script><meta http-equiv="origin-trial" content="AymqwRC7u88Y4JPvfIF2F37QKylC04248hLCdJAsh8xgOfe/dVJPV3XS3wLFca1ZMVOtnBfVjaCMTVudWM//5g4AAAB7eyJvcmlnaW4iOiJodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1RoaXJkUGFydHkiOnRydWV9"><style></style></head>


<body><div role="dialog" aria-live="polite" aria-label="cookieconsent" aria-describedby="cookieconsent:desc" class="cc-window cc-floating cc-type-info cc-theme-classic cc-bottom cc-right cc-color-override-382972913 cc-invisible" style="display: none;"><!--googleoff: all--><span id="cookieconsent:desc" class="cc-message">We use cookies to ensure you get the best user experience. For more information contact us. <a aria-label="learn more about cookies" role="button" tabindex="0" class="cc-link" href="https://tryhackme.com/legal/terms-of-use" target="_blank">Read more</a></span><div class="cc-compliance"><a aria-label="dismiss cookie message" role="button" tabindex="0" class="cc-btn cc-dismiss">Got it!</a></div><!--googleon: all--></div>
<link href="./TryHackMe _ Snort_files/scoreboard.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Snort_files/introjs.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Snort_files/slideout.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Snort_files/public-rooms.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Snort_files/asciinema-player.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Snort_files/prism.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Snort_files/magnific-popup.css" rel="stylesheet" type="text/css"> 
<script src="./TryHackMe _ Snort_files/lottie-player.js"></script>

<div id="room-content">
<div id="room-content-main">
<nav class="navbar navbar-expand-md navbar-dark navbar-color-loggedin navbar-main">
<div class="container">
<button id="thm-mobile-nav-open" class="thm-nav__hamburger-btn" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Open mobile navigation">
<span class="thm-nav__hamburger-lines"></span>
</button>
<div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
<div class="navbar-brand" href="/">
<a href="https://tryhackme.com/dashboard">
<img width="115px" src="./TryHackMe _ Snort_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
</div>
<ul class="navbar-nav mr-auto mt-2 mt-lg-0 navbar-pagelinks">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="navbar-item-icon far fa-browser"></i>
<div class="navbar-item-text">Dashboard</div>
</a>
</li>
<li class="nav-item active" id="nav-learn">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="navbar-item-icon far fa-book-open"></i>
<div class="navbar-item-text">Learn</div>
</a>
</li>
<li class="nav-item  dropdown lite-removable">
<a id="nav-other" class="nav-link" href="https://tryhackme.com/room/snort#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-trophy"></i>
<div class="navbar-item-text">Compete</div>
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdown">
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/leaderboards">
<div class="dropdown-menu-icon">
<i class="fas fa-trophy"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/games/koth">
<div class="dropdown-menu-icon">
<i class="fas fa-crown"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/workspace">
<div class="dropdown-menu-icon">
<i class="fas fa-user-friends"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item dropdown">
<a data-cy="nav-other-menu-button" id="nav-other" class="nav-link" href="https://tryhackme.com/room/snort#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-ellipsis-h-alt"></i>
<div class="navbar-item-text">Other</div>
</a>
<div data-cy="nav-other-menu" class="dropdown-menu dropdown-menu-center large-dropdown" aria-labelledby="navbarDropdown">
<span class="dropdown-menu-arrow"></span>
<a class="dropdown-item" href="https://tryhackme.com/resources">Resources</a>
<a class="dropdown-item" href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a class="dropdown-item" href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/business">For Business</a>
<a class="dropdown-item" href="https://tryhackme.com/classrooms">For Education</a>
<a class="dropdown-item" target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
<a class="dropdown-item" href="https://tryhackme.com/glossary">Glossary</a>
</div>
</li>
</ul>
<ul class="navbar-nav navbar-right options vertical-align-custom">
<li class="nav-item" data-toggle="modal" data-target="#navConnModal">
<div id="thm-connection-status" class="thm-unconnected">
<div id="thm-connection-status-dot" class="dot-small"></div> <span id="thm-connection-status-txt" class="ml-2 size-18 text-white"></span>
</div>
</li>
<li class="nav-item">
<div class="nav-item-streak">
<span id="streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="">
<span id="user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>
<script>
                            let usersStreak = { // Global variable, used in rooms logic
                                streakFirstAnswered: new Date('Mon Jul 10 2023 03:13:45 GMT+0100 (British Summer Time)'),
                                streakLastAnswered: new Date('Sun Jul 16 2023 18:47:44 GMT+0100 (British Summer Time)'),
                                usersTimezone: 'Asia/Kolkata',
                                streakFreeze: 1
                            };
                            setSidebarStreaks(usersStreak.streakFirstAnswered, usersStreak.streakLastAnswered, usersStreak.usersTimezone, usersStreak.streakFreeze)
                        </script>
</div>
</li>
<li class="nav-item dropdown" id="notification-navitem">
<a class="nav-link vertical-align-custom size-22 pl-0" href="https://tryhackme.com/room/snort#" id="notification-btn" role="button" data-toggle="dropdown">
<i id="notification-icon" class="fal fa-bell"></i>
<div id="notification-dot"></div>
</a>
<div id="nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="notification-header">Notifications</div>
<div id="nav-notifications">
<div class="text-center mt-2 mb-2"><i>Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle remove-arrow p-0" href="https://tryhackme.com/room/snort#" id="navbarAvatarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
<img src="./TryHackMe _ Snort_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarAvatarDropdown">
<a class="dropdown-item" href="https://tryhackme.com/profile">Profile</a>
<a class="dropdown-item" href="https://tryhackme.com/referrals">Refer a friend</a>
<a class="dropdown-item" href="https://tryhackme.com/badges">Badges</a>
<a class="dropdown-item" href="https://tryhackme.com/rooms">My Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/access">Access</a>
<a class="dropdown-item" href="https://tryhackme.com/feedback">Give Feedback</a>
<a class="dropdown-item" href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</div>
</div>
</nav>
<link rel="stylesheet" href="./TryHackMe _ Snort_files/streak-freeze.css">
<div class="modal fade modal-streak-freeze" id="unlocked-streak-freeze" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<button type="button" class="close close-streak" id="close-streak-freeze-popup" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<div class="modal-body">
<figure>
<img class="img-streak" width="400px" alt="streak freeze unlocked" src="./TryHackMe _ Snort_files/streak-freeze.svg">
</figure>
<h2>You've unlocked a streak freeze!</h2>
<p>With these one-time streak freezes, you can miss one day of hacking without losing your streak.</p>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Snort_files/streak-freeze.js"></script>
<nav id="thm-mobile-nav-menu" class="thm-mobile-nav" aria-label="Mobile secondary navigation menu.">
<header>
<a href="https://tryhackme.com/" aria-label="Go to the home page">
<img width="140" src="./TryHackMe _ Snort_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
<button id="thm-mobile-nav-close" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Close mobile navigation">
<i class="fal fa-times"></i>
</button>
</header>
<ul class="thm-mobile-nav-items mb-0">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="nav-title-icon far fa-browser"></i>
<div class="nav-title">Dashboard</div>
</a>
</li>
<li class="nav-item active">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="nav-title-icon far fa-book-open"></i>
<div class="nav-title">Learn</div>
</a>
</li>
<li class="nav-item ">
<a aria-expanded="false" aria-controls="mobile-nav-compete" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-compete" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-trophy"></i>
<div class="nav-title">Compete</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-compete" class="dropdown-wrapper">
<a href="https://tryhackme.com/leaderboards">
<div>
<i class="fas fa-trophy"></i>
</div>
<div>
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a href="https://tryhackme.com/games/koth">
<div>
<i class="fas fa-crown"></i>
</div>
<div>
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a href="https://tryhackme.com/workspace">
<div>
<i class="fas fa-user-friends"></i>
</div>
<div>
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item">
<a aria-expanded="false" aria-controls="mobile-nav-other" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-other" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-ellipsis-h-alt"></i>
<div class="nav-title">Other</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-other" class="dropdown-wrapper">
<a href="https://tryhackme.com/resources">Resources</a>
<a href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a href="https://tryhackme.com/business">For Business</a>
<a href="https://tryhackme.com/classrooms">For Education</a>
<a target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
</div>
</li>
<li class="nav-item text-center">
<div class="nav-item-streak">
<span id="mobile-streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="">
<span id="mobile-user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>
</div>
</li>
<li class="nav-item text-center">
<a class="nav-link size-22 d-inline-block" href="https://tryhackme.com/room/snort#" id="mobile-notification-btn" role="button" data-toggle="dropdown">
<i id="mobile-notification-icon" class="fal fa-bell"></i>
<div id="mobile-notification-dot"></div>
</a>
<div id="mobile-nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="mobile-notification-header">Notifications</div>
<div id="mobile-nav-notifications">
<div class="text-center mt-2 mb-2"><i>Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item text-center">
<a aria-expanded="false" aria-controls="mobile-nav-auth" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-auth" class="sublinks-toggle nav-link d-inline-block">
<img src="./TryHackMe _ Snort_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div id="mobile-nav-auth" class="dropdown-wrapper">
<a href="https://tryhackme.com/profile">Profile</a>
<a href="https://tryhackme.com/referrals">Refer a friend</a>
<a href="https://tryhackme.com/badges">Badges</a>
<a href="https://tryhackme.com/rooms">My Rooms</a>
<a href="https://tryhackme.com/access">Access</a>
<a href="https://tryhackme.com/feedback">Give Feedback</a>
<a href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</nav>
<script defer="" src="./TryHackMe _ Snort_files/mobile-nav.js"></script>
<script>
  const userSignedUpLessThanSevenDaysAgo = Math.floor(
    (new Date() - new Date('Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)')) / (1000 * 60 * 60 * 24) < 7
  );

  const userHasFirst4RoomsBadge = !!``;
  const isBeginner = `advanced` === 'complete-beginner';
</script>
<script src="./TryHackMe _ Snort_files/notifications.js"></script>
<script src="./TryHackMe _ Snort_files/streak-freeze(1).js"></script>
<div id="wrapper">
<div id="room-banner" class="shadow-light">
<img id="room-image-large" src="./TryHackMe _ Snort_files/71089b73a13ae82ecbb7e5af8bc42c9f.png">
<div>
<div id="room-details">
<div class="container">
<div class="page-header">
<div class="room-header">
<div id="room-voting" class="text-center vertical-align-custom">
<div class="voting-buttons">
<i class="fas fa-thumbs-up display-block" onclick="makeVote(true)" id="vote-up" style="color: rgb(185, 185, 185);"></i>
<div class="display-block" id="vote-number">667</div>
<i class="fas fa-thumbs-down display-block" onclick="makeVote(false)" id="vote-down" style="color: rgb(185, 185, 185);"></i>
</div>
</div>
<div id="room-logo" class="vertical-align-custom">
<div id="logo"><img class="room-avatar" src="./TryHackMe _ Snort_files/232979a675e1dd0f567ea004d1996e84.png" onerror="replaceImg(this)"></div>
</div>
<div class="vertical-align-custom">
<div id="room-basic-data">
<div class="d-flex justify-content-between">
<h1 id="title" class="bold-head">Snort</h1>
<div id="room-title-options">

<div class="btn-group" id="browser-machine-options" role="group" aria-label="Start AttackBox or Kali Linux" style="display: none;">
<button id="browser-machine-start" type="button" class="btn btn-secondary"><i class="far fa-laptop"></i> Start AttackBox</button>
<div class="btn-group" id="browser-machines" role="group">
<button id="btnGroupDrop1" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
<div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
<a class="dropdown-item  preventDefault" href="https://tryhackme.com/room/snort#" onclick="changeMyMachine(&quot;kali-linux&quot;)">
<span class="mb-0">Use Kali Linux</span>
<div class="text-lgray size-12">Web-based Kali Machine</div>
</a>
<a class="dropdown-item preventDefault" href="https://tryhackme.com/room/snort#" onclick="changeMyMachine(&quot;attackbox&quot;)">
<span class="mb-0">Use AttackBox</span>
<div class="text-lgray size-12">Recommended</div>
</a>
</div>
</div>
</div>
<button id="browser-machine-split-view" type="button" class="btn btn-secondary">Show Split View</button>
<button id="cloud-details" type="button" class="btn btn-info"><i class="far fa-clouds mr-1"></i>Cloud Details</button>
<span id="awards-model-btn" data-toggle="modal" data-target="#award-modal" class="badge badge-warning ml-1 noselect">Awards</span>
<span id="room-faq-slideout" type="button" class="badge badge-info ml-1 noselect d-inline-flex" onclick="openHelpMenu()">
Help
</span>
<div class="dropright room-dropright noselect ml-1" id="room-options" style="display: inline-block;">
<span class="badge badge-secondary" data-toggle="dropdown">
<i class="fas fa-cog"></i>
</span>
<div class="dropdown-menu">
<a class="dropdown-item" href="https://tryhackme.com/api/room/manage/clone/snort" id="clone-room" style="display: none;"><i class="far fa-clone faded"></i> Clone Room</a>
<a class="dropdown-item preventDefault" id="writeups-simple" style="display: inline-block;"><i class="fas fa-pen-alt faded"></i> Writeups</a>
<a class="dropdown-item preventDefault" data-toggle="modal" data-target="#resetUserProgressModal"><i class="fas fa-eraser faded"></i> Reset Progress</a>
<a class="dropdown-item preventDefault" id="leave-room"><i class="fas fa-sign-out-alt faded"></i> Leave</a>
</div>
</div>
<span id="bookmark" class="badge badge-secondary badge-bookmark ">
<img class="bookmark" src="./TryHackMe _ Snort_files/bookmark.svg">
<span class="bookmark-popover" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="top" data-content="&lt;p class=&#39;mb-0&#39;&gt;Save room &lt;/p&gt;
" data-original-title="" title="">
</span>
</span>
</div>
</div>
<p class="mb0 faded" id="description">Learn how to use Snort to detect real-time threats, analyse recorded traffic files and identify anomalies.</p>
</div>
</div>
</div>
</div>

</div>
</div>
<div id="room-banner-stats">
<div class="creators"></div>
<div class="numbers"></div>
</div>
</div>
</div>
<div class="container main pb">
<div id="room-message"></div>
<section id="sponsor">
<i id="sponsor-close" class="fas fa-times"></i>
<div id="sponsor-data"></div>
</section>
<div id="top-panel">
<ul class="nav nav-tabs" id="task-navs">
<li class="nav-item">
<a class="nav-link  active " data-toggle="tab" href="https://tryhackme.com/room/snort#chart">
<i class="fas fa-chart-line icon-right"></i> Chart
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/snort#scoreboard">
<i class="fas fa-trophy icon-right"></i> Scoreboard
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/snort#chat">
<i class="fas fa-comments-alt icon-right chat-icon"></i> Discuss
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/snort#writeups">
<i class="fas fa-pen-alt icon-right"></i> Writeups
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/snort#about">
<i class="fas fa-info-circle icon-right"></i> More
</a>
</li>
</ul>
<div class="card cd-2 nav-above-con" id="room-main">
<div class="card-body">
<span id="room-tabs">
<div class="tab-content">
<div id="chart" class="tab-pane  active ">
<span id="difficulty-bar">
    <span class="room-difficulty diff-text">
      Difficulty: 
        <span class="difficulty-medium">Medium</span>
    </span></span>
<br><div id="chart-data"></div>
</div>
<div id="scoreboard" class="tab-pane fade">
<table class="table table-striped table-bordered table-condensed table-header-rotated mb-0" id="scoreboard_table">
<thead>
<tr id="scoreboard_header">
<th>Rank</th>
<th>Username</th>
<th>Total Score</th>
</tr>
</thead>
<tbody id="scoreboard_body"></tbody>
</table>
</div>
<div id="chat" class="tab-pane fade">

<div class="row">
<div class="col-sm-6 text-center">
<h3 class="mb-2">Discord</h3>
<p>Come join our <a target="_blank" href="https://discord.gg/QgC6Tdk">Discord</a> server for support or further discussions</p>
</div>
<div class="col-sm-6 text-center">
<h3 class="mb-2">Forum</h3>
<div id="forum-text">Read or post on the dedicated forum <a href="https://tryhackme.com/forum/thread/622fdb56b420100a71b8b471">post</a></div>
</div>
</div>
</div>
<div id="writeups" class="tab-pane text-center">
<div id="writeups-data">There are no writeups submitted.</div>
<button onclick="showWriteupForm(this)" type="button" class="btn btn-xs btn-secondary mt-3 mb-2">Add Writeup</button>
<div id="writeup-form">
<div class="form-row">
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-title" placeholder="Writeup Title">
</div>
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-link" placeholder="Writeup URL">
</div>
<div class="col-auto">
<button id="submit-writeup" type="submit" class="btn btn-success mb-2">Submit</button>
</div>
</div>
<p class="faded mb-0 size-14"><i class="fas fa-exclamation-triangle text-warning"></i> Writeups should have a link to TryHackMe and not include any passwords/cracked hashes/flags</p>
</div>
</div>
<div id="about" class="tab-pane text-center">
<p id="about-freeRoom"><p class="mb-0">This is a <b>free</b> room, which means anyone can deploy virtual machines in the room 
        (without being subscribed)! 24598 users are in here and this room is 490 days old.</p></p>
<p id="about-owner"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Snort_files/af7feb2c43a2c7d5f111b98ccbd15048.png"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme">tryhackme</a> and <img class="avatar-tiny" src="./TryHackMe _ Snort_files/1a02ec129689db6aef26e1cc16fb6d93.jpg"> 
        <a class="green-link" href="https://tryhackme.com/p/ujohn">ujohn</a></p></p>
</div>
</div>
</span>
</div>
</div>
</div>
<div id="room-simple-video" class="card card-body cd-2"></div>
<div class="card mt-3 mb-3 cd-2 text-center" id="instance-info">
<div class="card-header card-header-red">Active Machine Information</div>
<div class="card-body">
<div class="row vertical-align-custom">
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3" id="table-machine-ip">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
</div>
</div>
</div>
<div id="task-list">
<div id="room-task-detail" class="mb-3"><span id="progress-bar" style="display: block;"><div class="progress"><div class="progress-bar bg-success" role="progressbar" style="width: 82%; aria-valuemin=" 0"="" aria-valuemax="100"> 82%</div></div></span></div>
<div id="taskContent"><div class="card" id="task-1">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse1" aria-expanded="true">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 1                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Introduction
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse1" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="text-align:center"><img src="./TryHackMe _ Snort_files/60826e7b180c71b4778e555d9dc6a9da.png" style="width:25%">﻿<br></p><p style="text-align:justify;line-height:1.5"></p><div style="text-align:left"><span style="font-size:1rem"><span>This room expects you to be familiar with basic <a class="8OFWOB6X glossary-term" onclick="initPopOver(&#39;Linux&#39;, &#39;8OFWOB6X&#39;)">Linux</a> command-line functionalities like general system navigation and Network fundamentals (ports, protocols and traffic data). The room aims to encourage you to start working with Snort to analyse live and captured traffic.</span></span></div><div style="text-align:justify"><br></div><div style="text-align:left"><span style="font-size:1rem;text-align:justify">Before joining this room, we suggest completing the&nbsp;</span><a href="https://tryhackme.com/module/network-fundamentals" target="_blank">'Network Fundamentals'</a><span style="text-align:justify"><span>&nbsp;module. If you have general knowledge of network basics and <a class="RFLaIRWp glossary-term" onclick="initPopOver(&#39;Linux&#39;, &#39;RFLaIRWp&#39;)">Linux</a> fundamentals, you will be ready to begin!&nbsp;</span></span><span style="font-size:1rem;text-align:justify"><span>If you feel you need assistance in the <a class="dJESEFf1 glossary-term" onclick="initPopOver(&#39;Linux&#39;, &#39;dJESEFf1&#39;)">Linux</a> command line, you can always&nbsp;</span></span><span style="font-size:1rem;text-align:justify">refer to our "Linux Fundamentals" rooms&nbsp;</span><span style="font-size:1rem;text-align:justify">(here&nbsp;</span><a href="https://tryhackme.com/room/linuxfundamentalspart1" target="_blank">1</a><span style="font-size:1rem">&nbsp;</span><a href="https://tryhackme.com/room/linuxfundamentalspart2" target="_blank">2</a><span style="font-size:1rem">&nbsp;</span><a href="https://tryhackme.com/room/linuxfundamentalspart3" target="_blank">3</a><span style="font-size:1rem;text-align:justify">)</span><span style="font-size:1rem;text-align:justify">;&nbsp;</span></div><div style="text-align:justify"><br></div><div style="text-align:left"><span style="text-align:justify;font-size:1rem">SNORT is an </span><b style="text-align:justify;font-size:1rem">open-source, rule-based</b><span style="text-align:justify;font-size:1rem"> Network Intrusion Detection and Prevention System </span><b style="text-align:justify;font-size:1rem">(NIDS/NIPS)</b><span style="text-align:justify;font-size:1rem">. It was developed and still maintained by Martin Roesch, open-source contributors, and the Cisco Talos team.&nbsp;</span></div><div style="text-align:justify"><br></div><span style="font-size:1rem"><div style="text-align:justify"><span style="font-size:1rem"><b><a href="https://www.snort.org/" target="_blank">The official description</a>:</b> <i>"</i></span><i><span>Snort is the foremost Open Source Intrusion Prevention System (<a class="bi3FOiPy glossary-term" onclick="initPopOver(&#39;IPS&#39;, &#39;bi3FOiPy&#39;)">IPS</a>) in the world. Snort IPS uses a series of rules that help define malicious network activity and uses those rules to find packets that match against them and generate alerts for users.</span></i><i>"</i></div></span></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Read the task above.
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="1">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-2">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse2">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 2                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Interactive Material and VM
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-server text-lgreen" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a deployable machine"></i></span>
                        </a>
                    </div>
                    <div id="collapse2" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><div class="btn-group mb-3 ml-3 float-right">
            <button type="button" class="btn btn-success" value="61fd91d3f8b20f0062103570" onclick="deploy(this)"><i class="fas fa-play mr-2"></i> Start Machine</button>
        </div> <p style="text-align:center"><img src="./TryHackMe _ Snort_files/b54bb4e24653ebafd82160900eb454d7.png" style="width:50%"></p><p><span style="text-align:justify;font-size:1rem"><b><span style="font-size:24px">Interactive material and e</span></b></span><span style="text-align:justify;font-size:24px"><b>xercise setup</b></span></p><p>Deploy the machine attached to this task; it will be visible in the&nbsp;<span style="font-weight:bolder">split-screen</span>&nbsp;view once it is ready.&nbsp;<span style="font-size:1rem">If you don't see a virtual machine load, click the&nbsp;</span><span style="font-size:1rem;font-weight:bolder">Show Split View</span><span style="font-size:1rem">&nbsp;button.</span></p><p><img src="./TryHackMe _ Snort_files/10c9518e2e58a272687b31f0f4bc1cbc.png" style="width:100%"><br></p>
<p><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">Once the machine had fully started, you will see a folder named "</span><strong>Task-Exercises</strong><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">" on the Desktop. Each exercise has an individual folder and files; use them accordingly to the questions.</span></p><p><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">Everything you need is located under the "</span><strong>Task-Exercises</strong><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">" folder.</span><br></p><p><span style="text-align:justify">There are two sub-folders available;</span></p><ul><li><span style="text-align:justify">Config-Sample<b> -&nbsp;</b></span>Sample configuration and rule files. These files are provided to show what the configuration files look like. Installed Snort instance doesn't use them, so feel free to practice and modify them. Snort's original base files are located under&nbsp;<strong>/etc/snort&nbsp;</strong><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">folder.</span></li><li><span style="text-align:justify">Exercise-Files<b> -&nbsp;</b></span>There are separate folders for each task. Each folder contains pcap, log and rule files ready to play with.</li></ul><p></p><p><img src="./TryHackMe _ Snort_files/56e7b4aff9791dd79f280b9e18350499.png"><span style="font-size:1rem;font-weight:bolder;text-align:justify"><br></span></p><p></p>
<p style="text-align:justify"><span style="font-size:1rem">&nbsp;</span></p><p style="text-align:justify"><span style="font-size:1rem;text-align:left;font-weight:bolder"><span style="font-size:24px">Traffic Generator</span></span><span style="font-size:1rem"><br></span></p><p style="text-align:justify"><span style="background:transparent;font-size:1rem;text-align:left;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">The machine is offline, but there is a script&nbsp;</span><span style="background:transparent;font-size:1rem;text-align:left;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">(</span><span style="background:transparent;font-size:1rem;text-align:left;font-weight:bolder;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">traffic-generator.sh</span><span style="background:transparent;font-size:1rem;text-align:left;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">)</span><span style="background:transparent;font-size:1rem;text-align:left;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">&nbsp;for you to generate traffic to your snort interface</span><span style="background:transparent;font-size:1rem;text-align:left;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">. You will use this script to trigger traffic to the snort interface. Once you run the script, it will ask you to choose the exercise type and then automatically open another terminal to show you the output of the selected action.</span></p><p style="text-align:justify"><b style="background-color:transparent;text-align:left;font-size:1rem">Note that each traffic is designed for a specific exercise. Make sure you start the snort instance and wait until to end of the script execution. Don't stop the traffic flood unless you choose the wrong exercise.&nbsp;</b></p><p style="text-align:justify"><span style="font-size:1rem">Run the&nbsp;<span style="font-weight:bolder">"traffic generator.sh"</span>&nbsp;file by executing it as sudo.&nbsp;</span><br></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">executing the traffic generator script</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> ./traffic-generator.sh</span></span></code></pre></div></div><p></p><p></p><p>General desktop overview. Traffic generator script in action.</p><p><img src="./TryHackMe _ Snort_files/a1f0fbcda5c475ae78da0dbd96267892.png"><br></p><p></p><p><span style="font-size:1rem;text-align:justify">Once you choose an action, the menu disappears and opens a terminal instance to show you the output of the action.</span></p><p><img src="./TryHackMe _ Snort_files/5550256e1a64efe83b33535f84147ec4.png" style="width:100%"><br></p><p></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <div><span style="font-size:1rem;text-align:justify">Navigate to the&nbsp;</span><span style="font-size:1rem;text-align:justify">Task-Exercises</span><span style="font-size:1rem;text-align:justify"> folder and r</span><span style="font-size:1rem;text-align:justify">un the command "</span><span style="font-size:1rem;text-align:justify">./.easy.sh</span><span style="font-size:1rem;text-align:justify">" and write the output</span><span style="font-size:1rem;text-align:justify"><br></span></div>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *** *****" value="Too Easy!" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-3">
                    <div class="card-header task-header collapsed" data-toggle="collapse" href="#collapse3" aria-expanded="false">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 3                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Introduction to IDS/IPS
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse3" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="text-align:center"><img src="./TryHackMe _ Snort_files/31b95ee3f9f1f1ab86887a011f12edcb.png" style="width:50%"><br></p><p style="text-align:justify">Before diving into Snort and analysing traffic, let's have a brief overview of what an&nbsp;<span style="font-size:1rem"><span>Intrusion Detection System (<a class="sdLXAA4z glossary-term" onclick="initPopOver(&#39;IDS&#39;, &#39;sdLXAA4z&#39;)">IDS</a>) and&nbsp;</span></span><span style="font-size:1rem">Intrusion Prevention System (IPS)&nbsp;</span><span style="font-size:1rem">is. It is possible to configure your network infrastructure and use both of them, but before starting to use any of them, let's learn the differences.</span><br><br><span style="font-size:24px"><b><span>Intrusion Detection System (<a class="QsO7CDyW glossary-term" onclick="initPopOver(&#39;IDS&#39;, &#39;QsO7CDyW&#39;)">IDS</a>)</span></b></span></p><p><span style="text-align:justify"><span><a class="DpUSIqnd glossary-term" onclick="initPopOver(&#39;IDS&#39;, &#39;DpUSIqnd&#39;)">IDS</a> is a passive monitoring solution for detecting possible malicious activities/patterns, abnormal incidents, and policy violations. It is responsible for generating alerts for each suspicious event.&nbsp;</span></span></p><p><span style="text-align:justify"><span style="font-weight:bolder"><span>There are two main types of <a class="tdlq6In6 glossary-term" onclick="initPopOver(&#39;IDS&#39;, &#39;tdlq6In6&#39;)">IDS</a> systems;</span></span></span></p><ul><li><span style="font-weight:bolder;font-size:1rem;text-align:justify"><span>Network Intrusion Detection System (<a class="LaHLdSzl glossary-term" onclick="initPopOver(&#39;NIDS&#39;, &#39;LaHLdSzl&#39;)">NIDS</a>) -&nbsp;</span></span><span><a class="0y7vPjx5 glossary-term" onclick="initPopOver(&#39;NIDS&#39;, &#39;0y7vPjx5&#39;)">NIDS</a> monitors the traffic flow from various areas of the network. The aim is to investigate the traffic on the entire subnet. If a signature is identified,&nbsp;</span><span style="text-align:justify;font-size:1rem;font-weight:bolder">an alert is created</span><span style="text-align:justify;font-size:1rem">.</span></li><li style="text-align:justify"><span style="font-size:1rem"><span style="font-weight:bolder"><span>Host-based Intrusion Detection System (<a class="j52UE3gp glossary-term" onclick="initPopOver(&#39;HIDS&#39;, &#39;j52UE3gp&#39;)">HIDS</a>) -&nbsp;</span></span></span><span><a class="f4WLQgQ1 glossary-term" onclick="initPopOver(&#39;HIDS&#39;, &#39;f4WLQgQ1&#39;)">HIDS</a> monitors the traffic flow from a single endpoint device.&nbsp;</span><span style="text-align:left;font-size:1rem">The aim is to investigate the traffic on a particular device. If a signature is identified,&nbsp;<span style="font-weight:bolder">an alert is created.</span></span></li></ul><span style="font-weight:bolder;text-align:justify"><div style="text-align:left"><span style="font-weight:bolder"><br><span style="font-size:24px"><span>Intrusion Prevention System (<a class="oMgQfaKM glossary-term" onclick="initPopOver(&#39;IPS&#39;, &#39;oMgQfaKM&#39;)">IPS</a>)</span></span></span></div></span><p></p><p><span style="text-align:justify;font-size:1rem"><span><a class="Kz3qCQfF glossary-term" onclick="initPopOver(&#39;IPS&#39;, &#39;Kz3qCQfF&#39;)">IPS</a> is an active protecting solution for preventing possible malicious activities/patterns, abnormal incidents, and policy violations. It is responsible for stopping/preventing/terminating the suspicious event as soon as the detection is performed.</span></span></p><p><span style="font-size:1rem;text-align:justify">&nbsp;</span><span style="text-align:justify"><b><span>There are four main types of <a class="AqCgVSVV glossary-term" onclick="initPopOver(&#39;IPS&#39;, &#39;AqCgVSVV&#39;)">IPS</a> systems;</span></b></span></p><ul><li><span style="text-align:justify"><span style="font-size:1rem;font-weight:bolder"><span>Network Intrusion Prevention System (<a class="wX8LbTFK glossary-term" onclick="initPopOver(&#39;NIPS&#39;, &#39;wX8LbTFK&#39;)">NIPS</a>) -&nbsp;</span></span></span><span><a class="KhW0Hj1T glossary-term" onclick="initPopOver(&#39;NIPS&#39;, &#39;KhW0Hj1T&#39;)">NIPS</a> monitors the traffic flow from various areas of the network. The aim is to protect the traffic on the entire subnet. If a signature is identified,</span><span style="text-align:justify;font-size:1rem;font-weight:bolder">&nbsp;the connection is terminated</span><span style="text-align:justify;font-size:1rem">.</span></li><li style="text-align:justify"><span style="font-size:1rem;font-weight:bolder"><span>Behaviour-based Intrusion Prevention System (Network Behaviour Analysis - <a class="EJaSw5uV glossary-term" onclick="initPopOver(&#39;NBA&#39;, &#39;EJaSw5uV&#39;)">NBA</a>) -&nbsp;</span></span>Behaviour-based systems monitor the traffic flow from various areas of the network. The aim is to protect the traffic on the entire subnet. If a signature is identified,&nbsp;<strong>the connection is terminated.</strong></li></ul><p style="text-align:justify"><span>Network Behaviour Analysis System works similar to <a class="M4PYQEjk glossary-term" onclick="initPopOver(&#39;NIPS&#39;, &#39;M4PYQEjk&#39;)">NIPS</a>. The difference between NIPS and Behaviour-based is; behaviour based systems require a training period (also known as "baselining") to learn the normal traffic and differentiate the malicious traffic and threats. This model provides more efficient results against new threats.</span><br></p><p style="text-align:justify">The system is trained to know the "normal" to detect "abnormal". The training period is crucial to avoid any false positives. In case of any security breach during the training period, the results will be highly problematic. Another critical point is to ensure that the system is well trained to recognise benign activities.&nbsp;<br></p><ul><li><span style="text-align:justify"><span style="font-size:1rem;font-weight:bolder"><span>Wireless Intrusion Prevention System (<a class="blBaK81E glossary-term" onclick="initPopOver(&#39;WIPS&#39;, &#39;blBaK81E&#39;)">WIPS</a>) -&nbsp;</span></span></span><span><a class="5DF6MAzi glossary-term" onclick="initPopOver(&#39;WIPS&#39;, &#39;5DF6MAzi&#39;)">WIPS</a> monitors the traffic flow from of wireless network. The aim is to protect the wireless traffic and stop possible attacks launched from there. If a signature is identified,&nbsp;</span><span style="text-align:justify;font-size:1rem;font-weight:bolder">the connection is terminated</span><span style="text-align:justify;font-size:1rem">.</span></li><li><span style="text-align:justify"><span style="font-size:1rem;font-weight:bolder"><span>Host-based Intrusion Prevention System (<a class="PFoGV9qx glossary-term" onclick="initPopOver(&#39;HIPS&#39;, &#39;PFoGV9qx&#39;)">HIPS</a>) -&nbsp;</span></span></span><span><a class="RUHCfo05 glossary-term" onclick="initPopOver(&#39;HIPS&#39;, &#39;RUHCfo05&#39;)">HIPS</a> actively protects the traffic flow from a single endpoint device. The aim is to investigate the traffic on a particular device. If a signature is identified,&nbsp;</span><strong>the connection is terminated.</strong></li></ul><p style="text-align:justify"><span><a class="AyKjjqbg glossary-term" onclick="initPopOver(&#39;HIPS&#39;, &#39;AyKjjqbg&#39;)">HIPS</a> working mechanism is similar to HIDS. The difference between them is that&nbsp;</span><b><span>while <a class="GWonQGuE glossary-term" onclick="initPopOver(&#39;HIDS&#39;, &#39;GWonQGuE&#39;)">HIDS</a> creates alerts for threats,</span></b> <b><span><a class="hf4yhndd glossary-term" onclick="initPopOver(&#39;HIPS&#39;, &#39;hf4yhndd&#39;)">HIPS</a> stops the threats by terminating the connection.</span><br></b></p><p><span style="font-size:1rem;font-weight:bolder;text-align:justify"><span style="font-size:18px"><br><span style="font-size:24px">Detection/Prevention Techniques</span></span></span></p><p><span style="text-align:justify"><span>There are three main detection and prevention techniques used in <a class="WNVZb95i glossary-term" onclick="initPopOver(&#39;IDS&#39;, &#39;WNVZb95i&#39;)">IDS</a> and IPS solutions;</span></span></p><table class="table table-bordered"><tbody><tr><td><b>Technique</b></td><td><b>Approach</b></td></tr><tr><td><p><span style="text-align:justify"><span style="font-weight:bolder">Signature-Based</span></span></p></td><td style="text-align:left">This technique relies on rules that identify the specific patterns of the known malicious behaviour. This model helps detect known threats.&nbsp;<br></td></tr><tr><td><p><span style="text-align:justify"><span style="font-weight:bolder">Behaviour-Based</span></span></p></td><td style="text-align:left">This technique identifies new threats with new patterns that pass through signatures. The model compares the known/normal with unknown/abnormal behaviours. This model helps detect previously unknown or new threats.<br></td></tr><tr><td><b>Policy-Based</b></td><td style="text-align:justify">This technique compares detected activities with system configuration and security policies. This model helps detect policy violations.<br></td></tr></tbody></table><p></p><p style="text-align:justify"><span style="font-size:1rem;font-weight:bolder"><span style="font-size:18px"><br><span style="font-size:24px">Summary</span></span></span><br></p><p style="text-align:justify"><b>Phew! </b><span>That was a long ride and lots of information. Let's summarise the overall functions of the <a class="vTZZPgbz glossary-term" onclick="initPopOver(&#39;IDS&#39;, &#39;vTZZPgbz&#39;)">IDS</a> and IPS in a nutshell.</span></p><ul><li style="text-align:justify"><b><span><a class="N5WsBrOr glossary-term" onclick="initPopOver(&#39;IDS&#39;, &#39;N5WsBrOr&#39;)">IDS</a> </span></b>can identify threats but require user assistance to stop them.</li><li style="text-align:justify"><b><span><a class="ZoM3F2Ht glossary-term" onclick="initPopOver(&#39;IPS&#39;, &#39;ZoM3F2Ht&#39;)">IPS</a> </span></b>can identify and block the threats with less user assistance at the detection time.<br></li></ul>

<p style="text-align:justify"><b><span style="font-size:1rem;text-align:left"><br>Now let's talk about Snort.&nbsp;</span><span style="font-size:1rem;text-align:left"><a href="https://www.snort.org/" target="_blank">Here is the rest of the official description</a> of the snort;</span></b></p><p style="text-align:justify"><i>"</i><i><span style="font-size:1rem">Snort can be deployed inline to stop these packets, as well. Snort has three primary uses: As a packet sniffer like tcpdump, as a packet logger — which is useful for network traffic debugging, or it can be used as a full-blown network intrusion prevention system. Snort can be downloaded and configured for personal and business use alike.</span><span style="font-size:1rem">"</span></i><span style="font-size:1rem;text-align:left"><br></span></p><p style="text-align:justify">SNORT is an&nbsp;<span style="font-weight:bolder">open-source</span>,&nbsp;<span style="font-weight:bolder">rule-based</span>&nbsp;Network Intrusion Detection and Prevention System&nbsp;<span style="font-weight:bolder">(NIDS/NIPS)</span>. It was developed and still maintained by Martin Roesch, open-source contributors, and the Cisco Talos team.&nbsp;</p><p style="text-align:justify"><span style="font-size:1rem;font-weight:bolder">Capabilities of Snort;</span><br></p><ul><li style="text-align:justify">Live traffic analysis</li><li style="text-align:justify">Attack and probe detection</li><li style="text-align:justify">Packet logging</li><li style="text-align:justify">Protocol analysis</li><li style="text-align:justify">Real-time alerting</li><li style="text-align:justify">Modules &amp; plugins</li><li style="text-align:justify">Pre-processors</li><li style="text-align:justify">Cross-platform support! (<a class="nfMM1ZAT glossary-term">Linux</a>&nbsp;&amp; Windows)</li></ul><p style="text-align:justify"><span style="font-size:1rem"><span style="font-weight:bolder">Snort has three main use models;</span></span><br></p><ul><li style="text-align:justify"><span style="font-size:1rem"><span style="font-weight:bolder">Sniffer Mode -&nbsp;</span></span>Read IP packets and prompt them in the console application.</li><li style="text-align:justify"><span style="font-size:1rem"><span style="font-weight:bolder">Packet Logger Mode -&nbsp;</span></span>Log all IP packets (inbound and outbound) that visit the network.</li><li style="text-align:justify"><span style="font-weight:bold;font-size:1rem"><span><a class="2mVLYDMU glossary-term" onclick="initPopOver(&#39;NIDS&#39;, &#39;2mVLYDMU&#39;)">NIDS</a> (</span></span><span style="font-weight:bolder">Network Intrusion Detection System</span><span style="font-weight:bolder;font-size:1rem"><span>)&nbsp; and <a class="PiYTUHAl glossary-term" onclick="initPopOver(&#39;NIPS&#39;, &#39;PiYTUHAl&#39;)">NIPS</a> (</span><span style="font-weight:bolder">Network Intrusion Prevention System</span><span style="font-size:1rem;font-weight:bolder">)&nbsp;</span>Modes -&nbsp;</span>Log/drop the packets that are deemed as&nbsp;<span style="font-size:1rem">malicious</span><span style="font-size:1rem">&nbsp;according to the user-defined rules.</span></li></ul></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Which snort mode can help you stop the threats on a local machine?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****" value="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Which snort mode can help you detect threats on a local network?<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****" value="NIDS" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Which snort mode can help you detect the threats on a local machine?<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****" value="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Which snort mode can help you stop the threats on a local network?<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****" value="">
                            <input type="hidden" value="4">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span>Which snort mode works similar to <a class="doDAluNz glossary-term" onclick="initPopOver(&#39;NIPS&#39;, &#39;doDAluNz&#39;)">NIPS</a> mode?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***" value="">
                            <input type="hidden" value="5">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span>According to the official description of the snort, what kind of <a class="0xNzp99P glossary-term" onclick="initPopOver(&#39;NIPS&#39;, &#39;0xNzp99P&#39;)">NIPS</a> is it?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **********" value="">
                            <input type="hidden" value="6">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span><a class="vJfM63ki glossary-term" onclick="initPopOver(&#39;NBA&#39;, &#39;vJfM63ki&#39;)">NBA</a> training period is also known as ...</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **********" value="">
                            <input type="hidden" value="7">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-4">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse4">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 4                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> First Interaction with Snort
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse4" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="text-align:left"><span style="font-size:1rem;text-align:justify"><span style="font-weight:bolder;font-size:24px">The First Interaction with Snort</span></span></p><p style="text-align:left"><span style="font-size:1rem;text-align:justify">First, let's verify snort is installed.&nbsp;</span><span style="text-align:justify;font-size:1rem">The following command will show you the instance version.</span></p>


<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            version check
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">snort -V</span></span>

<span class="token output">   ,,_     -*&gt; Snort! &lt;*-
  o"  )~   Version 2.9.7.0 GRE (Build XXXXXX) 
   ''''    By Martin Roesch &amp; The Snort Team: http://www.snort.org/contact#team
           Copyright (C) 2014 Cisco and/or its affiliates. All rights reserved.
           Copyright (C) 1998-2013 Sourcefire, Inc., et al.
           Using libpcap version 1.9.1 (with TPACKET_V3)
           Using PCRE version: 8.39 2016-06-14
           Using ZLIB version: 1.2.11</span></code>
        </pre>
    </div>
</div>

<p style="text-align:justify"><span style="text-align:left;font-size:1rem"><br></span></p><p style="text-align:justify"><span style="font-weight:bolder;text-align:left">Before getting your hands dirty, we should ensure our configuration file is valid.</span><span style="text-align:left;font-size:1rem"><br></span></p><p style="text-align:justify"><span style="text-align:left;font-size:1rem">Here <b>"-T"</b> is used for testing configuration, and <b>"-c"</b> is identifying the configuration file<b> (snort.conf)</b>.<br></span><span style="font-size:1rem;text-align:left">Note that it is possible to use an additional configuration file by pointing it with <b>"-c"</b>.&nbsp;</span></p>

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            configuration check
        </div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> snort -c /etc/snort/snort.conf -T </span></span>

<span class="token output">        --== Initializing Snort ==--
Initializing Output Plugins!
Initializing Preprocessors!
Initializing Plug-ins!
... [Output truncated]
        --== Initialization Complete ==--

   ,,_     -*&gt; Snort! &lt;*-
  o"  )~   Version 2.9.7.0 GRE (Build XXXX) 
   ''''    By Martin Roesch &amp; The Snort Team: http://www.snort.org/contact#team
           Copyright (C) 2014 Cisco and/or its affiliates. All rights reserved.
           Copyright (C) 1998-2013 Sourcefire, Inc., et al.
           Using libpcap version 1.9.1 (with TPACKET_V3)
           Using PCRE version: 8.39 2016-06-14
           Using ZLIB version: 1.2.11

           Rules Engine: SF_SNORT_DETECTION_ENGINE  Version 2.4  
           Preprocessor Object: SF_GTP  Version 1.1  
           Preprocessor Object: SF_SIP  Version 1.1  
           Preprocessor Object: SF_SSH  Version 1.1  
           Preprocessor Object: SF_SMTP  Version 1.1  
           Preprocessor Object: SF_POP  Version 1.0  
           Preprocessor Object: SF_DCERPC2  Version 1.0  
           Preprocessor Object: SF_IMAP  Version 1.0  
           Preprocessor Object: SF_DNP3  Version 1.1  
           Preprocessor Object: SF_SSLPP  Version 1.1  
           Preprocessor Object: SF_MODBUS  Version 1.1  
           Preprocessor Object: SF_SDF  Version 1.1  
           Preprocessor Object: SF_REPUTATION  Version 1.1  
           Preprocessor Object: SF_DNS  Version 1.1  
           Preprocessor Object: SF_FTPTELNET  Version 1.2  
... [Output truncated]
Snort successfully validated the configuration!
Snort exiting</span></code>
        </pre>
    </div>
</div>



<p style="text-align:justify"><span style="font-size:1rem;text-align:left"><br></span><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Once we use a configuration file, snort got much more power! The configuration file is an all-in-one management file of the snort. Rules, plugins, detection mechanisms, default actions and output settings are identified here. It is possible to have multiple configuration files for different purposes and cases&nbsp;</span>but can only use one at runtime<span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">.</span><br></p><p style="text-align:justify">Note that<span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">&nbsp;every time you start the Snort, it will automatically show the default banner and initial information about your setup. You can prevent this by using the "</span><strong>-q"&nbsp;</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">parameter.</span><br></p><table class="table table-bordered"><tbody><tr><td><b>Parameter</b></td><td><b>Description</b></td></tr><tr><td><b>-V / --version</b></td><td style="text-align:left">This parameter provides information about your instance version.</td></tr><tr><td><b>-c</b></td><td style="text-align:left">Identifying&nbsp;the configuration file</td></tr><tr><td><b>-T</b></td><td style="text-align:left">Snort's self-test parameter, you can test your setup with this parameter.</td></tr><tr><td>-<b>q</b></td><td style="text-align:left">Quiet mode prevents snort from displaying the default banner and initial information about your setup.</td></tr></tbody></table><p style="text-align:justify"><span style="font-size:1rem;text-align:left">That was an easy one; let's continue exploring snort modes!</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <div></div><div><p><span style="font-size:1rem">Run the Snort instance and check the build number.</span><br></p></div>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***" value="149" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="font-size:1rem">Test the current instance with "</span><b style="font-size:1rem">/etc/snort/snort.conf</b><span style="font-size:1rem">" file and check how many rules are loaded with the current build.</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****" value="4151" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="font-size:1rem">Test the current instance with "</span><b style="font-size:1rem">/etc/snort/snortv2.conf</b><span style="font-size:1rem">" file and check how many rules are loaded with the current build.</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *" value="1" disabled="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-5">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse5">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 5                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Operation Mode 1: Sniffer Mode
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse5" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="text-align:center"><img src="./TryHackMe _ Snort_files/2aa652d7bd97f99e25dbe7bf173d5c41.png" style="width:50%"><br></p><p><b><span style="font-size:24px">Let's run Snort in Sniffer Mode</span></b></p><p style="text-align:justify"><span style="font-size:1rem">Like tcpdump, Snort has various flags capable of viewing various data about the packet it is ingesting.</span><br></p><p>Sniffer mode parameters are explained in the table below;</p><table class="table table-bordered"><tbody><tr><td><b>Parameter</b></td><td><b>Description</b></td></tr><tr><td><b>-v</b></td><td style="text-align:left">Verbose. Display the TCP/IP output in the console.</td></tr><tr><td><b>-d</b></td><td style="text-align:left">Display the packet data (payload).<br></td></tr><tr><td><b>-e</b></td><td style="text-align:left">Display the link-layer&nbsp;(TCP/IP/UDP/ICMP)&nbsp;headers.&nbsp;<br></td></tr><tr><td>-<b>X</b></td><td style="text-align:left">Display the full packet details in HEX.</td></tr><tr><td>-<b>i</b></td><td style="text-align:left">This parameter helps to define a specific network interface to listen/sniff. Once you have multiple interfaces, you can choose a specific interface to sniff.&nbsp;</td></tr></tbody></table><p><span style="text-align:justify;font-size:1rem"><br>Let's start using each parameter and see the difference between them. Snort needs active traffic on your interface, so we need to generate traffic to see Snort in action.</span><br></p><p style="text-align:justify">To do this, use <b>the traffic-generator</b> script (find this in the Task-Exercise folder)<br></p><p><span style="text-align:justify;font-size:1rem;font-weight:bolder"><span style="font-size:18px"><br><span style="font-size:24px">Sniffing with parameter "-i"</span></span></span><br></p><p>Start the Snort instance in <b>verbose mode (-v)</b> and <b>use the interface (-i)</b> "eth0"; <code>sudo snort -v-i eth0</code></p><p><span style="text-align:center;font-size:1rem">In case you have only one interface, Snort uses it by default. The above example demonstrates to sniff on the interface named "eth0".&nbsp;</span><span style="font-size:1rem;text-align:center">Once you simulate the parameter -v, you will notice it will automatically use the "eth0" interface and prompt it.</span></p>
<p><span style="text-align:justify"><b><span style="font-size:18px"><br><span style="font-size:24px">Sniffing with parameter "-v"</span></span></b></span><br></p><p>Start the Snort instance in <b>verbose mode (-v)</b>; <code>sudo snort -v</code></p><p><span style="text-align:justify">Now run the&nbsp;</span><span style="text-align:justify">traffic-generator script as sudo and&nbsp;</span><span style="font-size:1rem"><span style="text-align:justify">start <b>ICMP/HTTP traffic</b></span></span><span style="text-align:justify;font-size:1rem">.&nbsp;</span><span style="text-align:justify;font-size:1rem">Once the traffic is generated, snort will start showing the&nbsp; packets in verbosity mode as follows;</span></p>

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            sniffing with -v</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> snort -v</span></span>
<span class="token output">                             
Running in packet dump mode

        --== Initializing Snort ==--
...
Commencing packet processing (pid=64)
12/01-20:10:13.846653 192.168.175.129:34316 -&gt; 192.168.175.2:53
UDP TTL:64 TOS:0x0 ID:23826 IpLen:20 DgmLen:64 DF
Len: 36
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

12/01-20:10:13.846794 192.168.175.129:38655 -&gt; 192.168.175.2:53
UDP TTL:64 TOS:0x0 ID:23827 IpLen:20 DgmLen:64 DF
Len: 36
===============================================================================
Snort exiting</span></code>
        </pre>
    </div>
</div>

<p><span style="font-size:1rem;text-align:justify"><b><br></b></span><span style="font-size:1rem">As you can see in the given output, verbosity mode provides tcpdump like output information. Once we interrupt the sniffing with CTRL+C, it stops and summarises the sniffed packets.<br></span></p>


<p><span style="text-align:justify"><span style="font-weight:bolder"><span style="font-size:18px"><br><span style="font-size:24px">Sniffing with parameter "-d"</span></span></span></span><br></p><p>Start the Snort instance in <b>dumping packet data mode (-d)</b>; <code>sudo snort -d</code></p><p><span style="text-align:justify">Now run the&nbsp;</span><span style="text-align:justify">traffic-generator script&nbsp;<span style="font-weight:bolder">as sudo</span>&nbsp;and&nbsp;</span><span style="font-size:1rem"><span style="text-align:justify">start&nbsp;<span style="font-weight:bolder">ICMP/HTTP traffic</span></span></span><span style="font-size:1rem;text-align:justify">.&nbsp;</span><span style="text-align:justify;font-size:1rem">Once the traffic is generated, snort will start showing the&nbsp; packets in verbosity mode as follows;</span></p><p></p>

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            sniffing with -d</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> snort -d</span></span>
<span class="token output">                             
Running in packet dump mode

        --== Initializing Snort ==--
...
Commencing packet processing (pid=67)

12/01-20:45:42.068675 192.168.175.129:37820 -&gt; 192.168.175.2:53
UDP TTL:64 TOS:0x0 ID:53099 IpLen:20 DgmLen:56 DF
Len: 28
99 A5 01 00 00 01 00 00 00 00 00 00 06 67 6F 6F  .............goo
67 6C 65 03 63 6F 6D 00 00 1C 00 01              gle.com.....

=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

WARNING: No preprocessors configured for policy 0.
12/01-20:45:42.070742 192.168.175.2:53 -&gt; 192.168.175.129:44947
UDP TTL:128 TOS:0x0 ID:63307 IpLen:20 DgmLen:72
Len: 44
FE 64 81 80 00 01 00 01 00 00 00 00 06 67 6F 6F  .d...........goo
67 6C 65 03 63 6F 6D 00 00 01 00 01 C0 0C 00 01  gle.com.........
00 01 00 00 00 05 00 04 D8 3A CE CE              .........:..

=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+</span></code>
        </pre>
    </div>
</div>


<p></p><p><span style="font-size:1rem;text-align:justify"><span style="font-weight:bolder"><br></span></span><span style="font-size:1rem">As you can see in the given output, packet data payload mode covers the verbose mode and provides more data.<br></span></p><p><span style="font-size:1rem;text-align:justify;font-weight:bolder"><span style="font-size:18px"><br><span style="font-size:24px">Sniffing with parameter "-de"</span></span></span><br></p><p><span style="font-size:1rem">Start the Snort instance in <b>dump (-d)</b> and <b>link-layer header grabbing (-e)</b> mode; </span><code>snort -d -e</code></p><p><span style="text-align:justify">Now run the&nbsp;</span><span style="text-align:justify">traffic-generator script&nbsp;<span style="font-weight:bolder">as sudo</span>&nbsp;and&nbsp;</span><span style="font-size:1rem"><span style="text-align:justify">start&nbsp;<span style="font-weight:bolder">ICMP/HTTP traffic</span></span></span><span style="font-size:1rem;text-align:justify">.&nbsp;</span><span style="text-align:justify;font-size:1rem">Once the traffic is generated, snort will start showing the&nbsp; packets in verbosity mode as follows;</span></p><p></p><p></p>

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            sniffing with -de</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> snort -de</span></span>
<span class="token output"><span>                             
Running in packet dump mode

        --== Initializing Snort ==--
...
Commencing packet processing (pid=70)
12/01-20:55:26.958773 00:0C:29:A5:B7:A2 -&gt; 00:50:56:E1:9B:9D type:0x800 len:0x46
192.168.175.129:47395 -&gt; 192.168.175.2:53 UDP TTL:64 TOS:0x0 ID:64294 IpLen:20 DgmLen:56 DF
Len: 28
6D 9C 01 00 00 01 00 00 00 00 00 00 06 67 6F 6F  m............goo
67 6C 65 03 63 6F 6D 00 00 01 00 01              gle.com.....

=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

WARNING: No preprocessors configured for policy 0.
12/01-20:55:26.965226 00:50:56:E1:9B:9D -&gt; 00:0C:29:A5:B7:A2 type:0x800 len:0x56
192.168.175.2:53 -&gt; 192.168.175.129:47395 UDP TTL:128 TOS:0x0 ID:63346 IpLen:20 DgmLen:72
Len: 44
6D 9C 81 80 00 01 00 01 00 00 00 00 06 67 6F 6F  m............goo
67 6C 65 03 63 6F 6D 00 00 01 00 01 C0 0C 00 01  gle.com.........
00 01 00 00 00 05 00 04 D8 3A D6 8E              .........:..</span></span></code>
        </pre>
    </div>
</div>


<p></p><p><span style="text-align:justify;font-size:1rem;font-weight:bolder"><span style="font-size:18px"><br><span style="font-size:24px">Sniffing with parameter "-X"</span></span></span><br></p><p></p><p>Start the Snort instance in<b> full packet dump mode (-X)</b>; <code>sudo snort -X</code></p><p><span style="text-align:justify">Now run the&nbsp;</span><span style="text-align:justify">traffic-generator script&nbsp;<span style="font-weight:bolder">as sudo</span>&nbsp;and&nbsp;</span><span style="font-size:1rem"><span style="text-align:justify">start&nbsp;<span style="font-weight:bolder">ICMP/HTTP traffic</span></span></span><span style="font-size:1rem;text-align:justify">.&nbsp;</span><span style="text-align:justify;font-size:1rem">Once the traffic is generated, snort will start showing the&nbsp; packets in verbosity mode as follows;</span></p><p></p>

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            sniffing with -X</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> snort -X</span></span>
<span class="token output">                             
Running in packet dump mode

        --== Initializing Snort ==--
...
Commencing packet processing (pid=76)
WARNING: No preprocessors configured for policy 0.
12/01-21:07:56.806121 192.168.175.1:58626 -&gt; 239.255.255.250:1900
UDP TTL:1 TOS:0x0 ID:48861 IpLen:20 DgmLen:196
Len: 168
0x0000: 01 00 5E 7F FF FA 00 50 56 C0 00 08 08 00 45 00  ..^....PV.....E.
0x0010: 00 C4 BE DD 00 00 01 11 9A A7 C0 A8 AF 01 EF FF  ................
0x0020: FF FA E5 02 07 6C 00 B0 85 AE 4D 2D 53 45 41 52  .....l....M-SEAR
0x0030: 43 48 20 2A 20 48 54 54 50 2F 31 2E 31 0D 0A 48  CH * HTTP/1.1..H
0x0040: 4F 53 54 3A 20 32 33 39 2E 32 35 35 2E 32 35 35  OST: 239.255.255
0x0050: 2E 32 35 30 3A 31 39 30 30 0D 0A 4D 41 4E 3A 20  .250:1900..MAN: 
0x0060: 22 73 73 64 70 3A 64 69 73 63 6F 76 65 72 22 0D  "ssdp:discover".
0x0070: 0A 4D 58 3A 20 31 0D 0A 53 54 3A 20 75 72 6E 3A  .MX: 1..ST: urn:
0x0080: 64 69 61 6C 2D 6D 75 6C 74 69 73 63 72 65 65 6E  dial-multiscreen
0x0090: 2D 6F 72 67 3A 73 65 72 76 69 63 65 3A 64 69 61  -org:service:dia
0x00A0: 6C 3A 31 0D 0A 55 53 45 52 2D 41 47 45 4E 54 3A  l:1..USER-AGENT:
0x00B0: 20 43 68 72 6F 6D 69 75 6D 2F 39 35 2E 30 2E 34   Chromium/95.0.4
0x00C0: 36 33 38 2E 36 39 20 57 69 6E 64 6F 77 73 0D 0A  638.69 Windows..
0x00D0: 0D 0A                                            ..

=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

WARNING: No preprocessors configured for policy 0.
12/01-21:07:57.624205 216.58.214.142 -&gt; 192.168.175.129
ICMP TTL:128 TOS:0x0 ID:63394 IpLen:20 DgmLen:84
Type:0  Code:0  ID:15  Seq:1  ECHO REPLY
0x0000: 00 0C 29 A5 B7 A2 00 50 56 E1 9B 9D 08 00 45 00  ..)....PV.....E.
0x0010: 00 54 F7 A2 00 00 80 01 24 13 D8 3A D6 8E C0 A8  .T......$..:....
0x0020: AF 81 00 00 BE B6 00 0F 00 01 2D E4 A7 61 00 00  ..........-..a..
0x0030: 00 00 A4 20 09 00 00 00 00 00 10 11 12 13 14 15  ... ............
0x0040: 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25  .......... !"#$%
0x0050: 26 27 28 29 2A 2B 2C 2D 2E 2F 30 31 32 33 34 35  &amp;'()*+,-./012345
0x0060: 36 37                                            67

=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+</span></code>
        </pre>
    </div>
</div>


<p></p><p><span style="font-size:1rem;text-align:justify"><b><br>Note that you can use the parameters both in combined and separated form as follows;</b></span><br></p><ul><li><span style="text-align:justify;font-size:1rem"><b>snort -v</b></span></li><li><span style="text-align:justify;font-size:1rem"><b>snort -vd</b></span></li><li><span style="text-align:justify;font-size:1rem"><b>snort -de</b></span></li><li><span style="text-align:justify;font-size:1rem"><b>snort -v -d -e</b></span></li><li style="text-align:justify"><b>snort -X</b></li></ul><p><span style="text-align:justify;font-size:1rem"><b>Make sure you understand and practice each parameter with different types of traffic and discover your favourite combination.</b></span></p><p></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                You can practice the parameter combinations by using the traffic-generator script.
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-6">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse6">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 6                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Operation Mode 2: Packet Logger Mode
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse6" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p></p><p style="text-align:center"><img src="./TryHackMe _ Snort_files/26fa01dc0feb0adc2fda2ce474befe15.png" style="width:50%"><br></p><p><span style="font-size:1rem;font-weight:bolder"><span style="font-size:24px">Let's run Snort in Logger Mode</span></span><br></p><p>You can use Snort as a sniffer and log the sniffed packets via logger mode. You only need to use the packet logger mode parameters, and Snort does the rest to accomplish this.</p><p>Packet logger parameters are explained in the table below;</p><table class="table table-bordered" style="width:1075.56px"><tbody><tr><td><b>Parameter</b></td><td><b>Description</b></td></tr><tr><td><span style="font-weight:bolder">-l</span></td><td><p style="text-align:left">Logger mode, target <b>log and alert </b>output directory. Default output folder is <b>/var/log/snort</b></p><p style="text-align:left">The default action is to dump as tcpdump format in <b>/var/log/snort</b></p></td></tr><tr><td><b>-K ASCII</b></td><td style="text-align:left">Log packets in ASCII format.</td></tr><tr><td><span style="font-weight:bolder">-r</span></td><td style="text-align:left">Reading option, read the dumped logs in Snort.<br></td></tr><tr><td><b>-n</b></td><td style="text-align:left">Specify the number of packets that will process/read. Snort will stop after reading the specified number of packets.</td></tr></tbody></table><p style="text-align:justify">Let's start using each parameter and see the difference between them. Snort needs active traffic on your interface, so we need to generate traffic to see Snort in action.<br></p><span style="font-size:18px"><b><br><span style="font-size:24px">Logfile Ownership</span></b></span><p></p><p></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span>Before generating logs and investigating them, we must remember the <a class="MuemueVp glossary-term" onclick="initPopOver(&#39;Linux&#39;, &#39;MuemueVp&#39;)">Linux</a> file ownership and permissions. No need to deep dive into user types and permissions. The fundamental file ownership rule;</span></span><strong>&nbsp;whoever creates a file becomes the owner of the corresponding file</strong><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">.</span><br></p><p></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Snort needs superuser (root) rights to sniff the traffic, so once you run the snort with the "sudo" command, the "root" account will own the generated log files. Therefore you will need "root" rights to investigate the log files. There are two different approaches to investigate the generated log files;<br><br></span></p><ul><li style="text-align:justify">Elevation of privileges<b> -&nbsp;</b>You can elevate your privileges to examine the files. You can use the "sudo" command to execute your command as a superuser with the following command <code>sudo command</code>. You can also elevate the session privileges and switch to the superuser account to examine the generated log files with the following command: <code>sudo su</code></li></ul><ul><li style="text-align:justify">Changing the ownership of files/directories - You can also change the ownership of the file/folder to read it as your user: <code>sudo chown username file</code> or <code>sudo chown username -R directory</code> The "-R" parameter helps recursively process the files and directories.</li></ul><p style="text-align:justify"></p><p><span style="text-align:justify"><span style="font-weight:bolder"><span style="font-size:18px"><br><span style="font-size:24px">Logging with parameter "-l"</span></span></span></span><br></p><p>First, start the Snort instance in packet logger mode; <code>sudo snort -dev -l .</code></p><p><span style="text-align:justify">Now start ICMP/HTTP traffic with the traffic-generator script.</span><br></p><p><span style="text-align:justify">Once the traffic is generated, Snort will start showing the packets and log them in the target directory. Y</span><span style="text-align:justify;font-size:1rem">ou can configure the default output directory in snort.config file. However, you can use the "-l" parameter to set a target directory. Identifying the default log directory is useful for continuous monitoring operations, and the "-l" parameter is much more useful for testing purposes.</span></p><p><span style="text-align:justify">The </span><code>-l .</code><span style="text-align:justify">&nbsp;part of the command creates the logs in the current directory. You will need to use this option to have the logs for each exercise in their folder.<br></span><span style="text-align:justify"><br></span></p>

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            logging with -l</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> snort -dev -l <span class="token builtin class-name">.</span></span></span>
<span class="token output"><span>                             
Running in packet logging mode

        --== Initializing Snort ==--
Initializing Output Plugins!
Log directory = /var/log/snort
pcap DAQ configured to passive.
Acquiring network traffic from "ens33".
Decoding Ethernet

        --== Initialization Complete ==--
...
Commencing packet processing (pid=2679)
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.</span></span></code>
        </pre>
    </div>
</div><div class="terminal-container"><span style="font-size:1rem;font-weight:700;text-align:justify"><br></span></div><div class="terminal-container"><span style="font-size:1rem">Now, let's check the generated log file.&nbsp;</span><b>Note that the log file names will be different in your case.</b><br></div>
<br>
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            checking the log file</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">ls</span> <span class="token builtin class-name">.</span></span></span>
<span class="token output">                             
snort.log.1638459842</span></code>
        </pre>
    </div>
</div>As you can see, it is a single all-in-one log file. It is a binary/tcpdump format log.&nbsp;<span style="font-size:1rem">This is what it looks like in the folder view.</span><p></p><p><img src="./TryHackMe _ Snort_files/157fbfefd174cf32af1de4b2e1d09721.png"></p><p><span style="text-align:justify"><span style="font-weight:bolder"><span style="font-size:18px"><br><span style="font-size:24px">Logging with parameter "-K ASCII"</span></span></span></span><br></p><p>Start the Snort instance in packet logger mode; <code>sudo snort -dev -K ASCII</code></p><p><span style="text-align:justify">Now run the&nbsp;</span><span style="text-align:justify">traffic-generator script&nbsp;as sudo&nbsp;and&nbsp;</span><span style="font-size:1rem"><span style="text-align:justify">start&nbsp;<span style="font-weight:bolder">ICMP/HTTP traffic</span></span></span><span style="font-size:1rem;text-align:justify">.&nbsp;</span><span style="text-align:justify;font-size:1rem">Once the traffic is generated, Snort will start showing the&nbsp; packets in verbosity mode as follows;</span></p><p>

</p><div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">logging with -K ASCII</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> snort -dev -K ASCII -l <span class="token builtin class-name">.</span></span></span>
<span class="token output"><span>                             
Running in packet logging mode

        --== Initializing Snort ==--
Initializing Output Plugins!
Log directory = /var/log/snort
pcap DAQ configured to passive.
Acquiring network traffic from "ens33".
Decoding Ethernet

        --== Initialization Complete ==--
...
Commencing packet processing (pid=2679)
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.</span></span></code>
        </pre>
    </div>
</div>

<p></p><p><span style="font-size:1rem">Now, let's check the generated log file.</span><br></p><div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">Checking the log file</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">ls</span> <span class="token builtin class-name">.</span></span></span>
<span class="token output">                             
142.250.187.110  192.168.175.129  snort.log.1638459842</span></code>
        </pre>
    </div>
</div><div class="terminal-container">This is what it looks like in the folder view.<br></div><div class="terminal-container"><br></div><div class="terminal-container"><img src="./TryHackMe _ Snort_files/ffaf2f3d78769c857afa18a87712dd90.png"><br></div><div class="terminal-container"><span style="font-size:1rem">The logs created with "-K ASCII" parameter is entirely different. There are two folders with IP address names. Let's look into them.</span><br></div>


<br>
<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            checking the log file</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">ls</span> ./192.168.175.129/</span></span>
<span class="token output">                             
ICMP_ECHO  UDP:36648-53  UDP:40757-53  UDP:47404-53  UDP:50624-123</span></code>
        </pre>
    </div>
</div>
<p></p><p><span style="font-size:1rem">Once we look closer at the created folders, we can see that the logs are in ASCII</span><span style="font-size:1rem">&nbsp;and categorised format, so it is possible to read them without using a Snort instance.</span><br></p><p>This is what it looks like in the folder view.<br></p><p><img src="./TryHackMe _ Snort_files/d0ea7902efe8cdae918e26fa70068358.png"></p><p>In a nutshell, ASCII mode provides multiple files in human-readable format, so it is possible to read the logs easily by using a text editor. By contrast with ASCII format, binary format is not human-readable and requires analysis using Snort or an application like tcpdump.</p><p>Let's compare the ASCII format with the binary format by opening both of them in a text editor.&nbsp;<span style="font-size:1rem">The difference between the binary log file and the ASCII log file is shown below.&nbsp;</span><span style="font-size:1rem">(Left side: binary format. Right side: ASCII format).</span></p><p><img src="./TryHackMe _ Snort_files/5e8487745a7ee4d3d33e67c2967ebaba.png" style="width:100%"><br></p><p></p><p><span style="text-align:justify"><span style="font-weight:bolder"><span style="font-size:18px"><br><span style="font-size:24px">Reading generated logs with parameter "-r"</span></span></span></span><br></p><p>Start the Snort instance in packet reader mode; <code>sudo snort -r</code></p>
<p></p><div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top"><span style="font-size:1rem">reading log files with -r</span><br></div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> snort -r snort.log.1638459842</span></span>
<span class="token output"><span>                             
Running in packet dump mode

        --== Initializing Snort ==--
Initializing Output Plugins!
pcap DAQ configured to read-file.
Acquiring network traffic from "snort.log.1638459842".

        --== Initialization Complete ==--
...
Commencing packet processing (pid=3012)
WARNING: No preprocessors configured for policy 0.
12/02-07:44:03.123225 192.168.175.129 -&gt; 142.250.187.110
ICMP TTL:64 TOS:0x0 ID:41900 IpLen:20 DgmLen:84 DF
Type:8  Code:0  ID:1   Seq:49  ECHO
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
WARNING: No preprocessors configured for policy 0.
12/02-07:44:26.169620 192.168.175.129 -&gt; 142.250.187.110
ICMP TTL:64 TOS:0x0 ID:44765 IpLen:20 DgmLen:84 DF
Type:8  Code:0  ID:1   Seq:72  ECHO
===============================================================================
Packet I/O Totals:
   Received:           51
   Analyzed:           51 (100.000%)
    Dropped:            0 (  0.000%)
   Filtered:            0 (  0.000%)
Outstanding:            0 (  0.000%)
   Injected:            0
===============================================================================
Breakdown by protocol (includes rebuilt packets):
...
      Total:           51
===============================================================================
Snort exiting</span></span></code>
        </pre>
    </div>
</div>
<br><p><span style="text-align:justify"><b>Note that</b>&nbsp;Snort can read and handle the binary like output (tcpdump and Wireshark also can handle this log format). However, if you create logs with "-K ASCII" parameter, Snort will not read them.&nbsp;</span>As you can see in the above output, Snort read and displayed the log file just like in the sniffer mode.</p><p>Opening log file with tcpdump.<span style="text-align:justify"><br></span></p>
<br>

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">Opening the log file with tcpdump</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> tcpdump -r snort.log.1638459842 -ntc <span class="token number">10</span></span></span>
<span class="token output"><span>                             
reading from file snort.log.1638459842, link-type EN10MB (Ethernet)
IP 192.168.175.129 &gt; 142.250.187.110: ICMP echo request, id 1, seq 49, length 64
IP 142.250.187.110 &gt; 192.168.175.129: ICMP echo reply, id 1, seq 49, length 64
IP 192.168.175.129 &gt; 142.250.187.110: ICMP echo request, id 1, seq 50, length 64
IP 142.250.187.110 &gt; 192.168.175.129: ICMP echo reply, id 1, seq 50, length 64
IP 192.168.175.129 &gt; 142.250.187.110: ICMP echo request, id 1, seq 51, length 64
IP 142.250.187.110 &gt; 192.168.175.129: ICMP echo reply, id 1, seq 51, length 64
IP 192.168.175.129 &gt; 142.250.187.110: ICMP echo request, id 1, seq 52, length 64
IP 142.250.187.110 &gt; 192.168.175.129: ICMP echo reply, id 1, seq 52, length 64
IP 192.168.175.1.63096 &gt; 239.255.255.250.1900: UDP, length 173
IP 192.168.175.129 &gt; 142.250.187.110: ICMP echo request, id 1, seq 53, length 64</span></span></code>
        </pre>
    </div>
</div>
<p></p><p><span style="font-size:1rem">Opening log file with Wireshark.<br></span></p><p>

</p><p><img src="./TryHackMe _ Snort_files/a4bd8447760481cd2f6f9762a9620a50.png"></p><p><span style="font-weight:700;text-align:justify">"-r" parameter also allows users to filter the binary log files.&nbsp;</span><b>You can filter the processed log to see specific packets with the "-r" parameter and Berkeley Packet Filters (BPF).&nbsp;</b></p>

<ul><li><code style="font-size:14px">sudo snort -r logname.log -X</code></li><li><code>sudo snort -r logname.log icmp</code><span style="text-align:justify"></span></li><li><code>sudo snort -r logname.log tcp</code></li><li><code>sudo snort -r logname.log 'udp and port 53'</code><span style="text-align:justify"></span></li></ul><p style="text-align:justify"><span style="text-align:left">The output will be the same as the above, but only packets with the chosen protocol will be shown.&nbsp;</span><span style="font-size:16px">Additionally, you can specify the number of processes with the parameter "-n". <b>The following command will process only the first 10 packets:</b><br><br>&nbsp;</span><code>snort -dvr logname.log -n 10</code></p><p style="text-align:justify"><span>Please use the following resources to understand how the <a class="60FgHlYG glossary-term" onclick="initPopOver(&#39;BPF&#39;, &#39;60FgHlYG&#39;)">BPF</a> works and its use.</span><br></p><ul><li><a href="https://en.wikipedia.org/wiki/Berkeley_Packet_Filter" target="_blank">https://en.wikipedia.org/wiki/Berkeley_Packet_Filter</a></li><li><a href="https://biot.com/capstats/bpf.html" target="_blank">https://biot.com/capstats/bpf.html</a></li><li><a href="https://www.tcpdump.org/manpages/tcpdump.1.html" target="_blank">https://www.tcpdump.org/manpages/tcpdump.1.html</a></li></ul><p></p><p><b><span style="text-align:justify"><span style="font-size:16px">Now, use the attached&nbsp;</span><a class="MaTh8tUD glossary-term"><span style="font-size:16px">VM</span></a><span style="font-size:16px">&nbsp;and n</span></span><span style="text-align:justify;font-size:16px">avigate to the&nbsp;</span><span style="font-size:16px">Task-Exercises/Exercise-Files/TASK-6 folder to answer the questions!</span></b></p><p></p><p></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="font-size:1rem;text-align:justify">Investigate the traffic with the default configuration file&nbsp;</span><span style="font-size:1rem;text-align:justify;font-weight:bolder">with ASCII mode.</span><br></p><div><p></p><p style="margin-bottom:0px"><code style="font-size:14px">sudo snort -dev -K ASCII -l .</code></p></div><div><span style="font-size:1rem">E</span><span style="font-size:1rem">xecute the traffic generator script and choose&nbsp;<span style="font-weight:bolder">"TASK-6 Exercise"</span>. Wait until the traffic ends, then stop the Snort instance. Now analyse the output summary and answer the question.</span></div><div><div><p></p><p style="margin-bottom:0px"><code style="font-size:14px">sudo ./traffic-generator.sh</code></p></div><div><span style="font-size:1rem;text-align:justify">Now, y</span><span style="font-size:1rem">ou should have the logs in the current directory. Navigate to folder "</span><span style="font-weight:bolder">145.254.160.237</span><span style="font-size:1rem">". What is the source port used to connect port 53?</span></div></div>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****" value="3009" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <div><div><p>Use&nbsp;<span style="font-weight:bolder">snort.log.1640048004</span>&nbsp;<span style="font-size:1rem;font-weight:700;text-align:justify"><br></span></p><p><span style="font-size:1rem">Read the snort.log file with Snort; what is the IP ID of the 10th packet?</span></p><p><code>snort -r snort.log.1640048004 -n 10</code></p></div></div>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *****" value="49313" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p style="text-align:left">Read the "<b>snort.log.1640048004"</b>&nbsp;file with Snort; what is the referer of the 4th packet?<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****://***.********.***/***********.****" value="http://www.ethereal.com/development.html" disabled="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Read the "<b>snort.log.1640048004"&nbsp;</b>file with Snort; what is the Ack number of the 8th packet?<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **********" value="0x38AFFFF3" disabled="">
                            <input type="hidden" value="4">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Read the "<b>snort.log.1640048004"</b> file with Snort; what is the number of the <b>"TCP port 80"</b> packets?<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **" value="41" disabled="">
                            <input type="hidden" value="5">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-7">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse7">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 7                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Operation Mode 3: IDS/IPS
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse7" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="text-align:center"><img src="./TryHackMe _ Snort_files/2282ecc098a0492a08c27c03afdb6149.png" style="width:50%"><br></p><p><span>﻿</span><span style="font-size:24px;font-weight:bolder">Snort in IDS/IPS Mode</span></p><p><span style="font-size:1rem">Capabilities of Snort are not limited to sniffing and logging the traffic. IDS/IPS mode helps you manage the traffic according to user-defined rules.</span></p><p><b>Note that</b> (N)IDS/IPS mode depends on the rules and configuration.&nbsp;<b>TASK-10</b>&nbsp;summarises the essential paths, files and variables. Also, <b>TASK-3 </b>covers configuration testing. Here, we need to understand the operating logic first, and then we will be going into rules in <b>TASK-9</b>.<br></p><p><span style="font-weight:bolder"><span style="font-size:18px"><br><span style="font-size:24px">Let's run Snort in IDS/IPS Mode</span></span></span><br></p><p><span><a class="70PO3vEP glossary-term" onclick="initPopOver(&#39;NIDS&#39;, &#39;70PO3vEP&#39;)">NIDS</a> mode parameters are explained in the table below;</span></p><table class="table table-bordered" style="width:1075.56px"><tbody><tr><td><b>Parameter</b></td><td><b>Description</b></td></tr><tr><td><span style="font-weight:bolder">-c</span></td><td><p style="text-align:left">Defining the configuration file.</p></td></tr><tr><td><span style="font-weight:bolder">-T</span></td><td style="text-align:left">Testing the configuration file.</td></tr><tr><td><b>-N</b></td><td style="text-align:left">Disable logging.<br></td></tr><tr><td><b>-D</b></td><td style="text-align:left">Background mode.<br></td></tr><tr><td><b>-A</b></td><td><p style="text-align:left">Alert modes;<br></p><div style="text-align:left"><b style="font-size:1rem">full: </b><span style="font-size:1rem">Full alert mode, providing all possible information about the alert. This one also is the default mode; once you use -A and don't specify any mode, snort uses this mode.</span></div><p></p><p style="text-align:left"><b>fast:&nbsp; </b>Fast mode shows the alert message, timestamp, source and destination IP, along with port numbers.</p><p style="text-align:left"><span style="font-weight:bolder">console: </span>Provides fast style alerts on the console screen.</p><p style="text-align:left"><b>cmg: </b>CMG style,<b>&nbsp;</b><span style="text-align:center;font-size:1rem">basic header details with payload in hex and text format.</span></p><p style="text-align:left"><b>none: </b>Disabling alerting.</p></td></tr></tbody></table><p><span style="text-align:justify;font-size:1rem"><br>Let's start using each parameter and see the difference between them. Snort needs active traffic on your interface, so we need to generate traffic to see Snort in action.&nbsp;</span><span style="font-size:1rem;text-align:justify">To do this, use&nbsp;</span><span style="font-size:1rem;font-weight:bolder;text-align:justify">the traffic-generator</span><span style="font-size:1rem;text-align:justify">&nbsp;script&nbsp;</span><span style="text-align:justify;font-size:1rem">and sniff the traffic.&nbsp;</span></p><p style="text-align:justify"><b style="font-size:1rem">Once you start running IDS/IPS mode,</b><span style="font-size:1rem"> you need to use rules. As we mentioned earlier, we will use a pre-defined ICMP rule as an example. The defined rule will only generate alerts in any direction of ICMP packet activity.</span></p><p style="text-align:justify"><code>alert icmp&nbsp;any&nbsp;any &lt;&gt; any any&nbsp;&nbsp;(msg:
"ICMP Packet Found"; sid: 100001; rev:1;)</code><span style="font-size:1rem"><br></span></p><p style="text-align:justify"><span style="font-size:1rem"> </span></p><p style="text-align:justify">This rule is located in&nbsp;<span style="font-weight:bolder">"/etc/snort/rules/local.rules"</span>.<span style="font-size:1rem"><br></span></p><p style="text-align:justify">Remember, in this module, we will focus only on the operating modes. The rules are covered in TASK9&amp;10. <b>Snort will create an "alert" file if the traffic flow triggers an alert.&nbsp;</b><b style="font-size:1rem">One last note; </b><span style="font-size:1rem">once you start running IPS/IDS mode, the sniffing and logging mode will be semi-passive. However, you can activate the functions using the parameters discussed in previous tasks. </span><b style="font-size:1rem">(-i, -v, -d, -e, -X, -l, -K ASCII)&nbsp;</b><span style="font-size:1rem">If you don't remember the purpose of these commands,&nbsp;</span><span style="font-size:1rem;font-weight:bolder">please revisit TASK4</span><span style="font-size:1rem">.</span></p><p><span style="font-size:18px;font-weight:700"><br><span style="font-size:24px">IDS/IPS</span></span><span style="text-align:justify"><span style="font-weight:bolder"><span style="font-size:24px">&nbsp;mode with parameter "-c and -T"</span></span></span><br></p><p>Start the Snort instance and test the configuration file.&nbsp;<code>sudo snort -c /etc/snort/snort.conf -T</code><span style="text-align:justify;font-size:1rem">&nbsp; This command will check your configuration file and prompt it if there is any misconfiguratioın in your current setting.&nbsp;</span><span style="text-align:justify;font-size:1rem">You should be familiar with this command if you covered TASK3. If you don't remember the output of this command, </span><b style="text-align:justify;font-size:1rem">please revisit TASK4</b><span style="text-align:justify;font-size:1rem">.</span></p><p><span style="font-size:18px;font-weight:700"><br><span style="font-size:24px">IDS/IPS</span></span><span style="font-size:1rem;text-align:justify;font-weight:bolder"><span style="font-size:24px">&nbsp;mode with parameter "-N"</span></span></p><p>Start the Snort instance and disable logging by running the following command: <code>sudo snort -c /etc/snort/snort.conf -N</code></p><p><span style="text-align:justify">Now run the&nbsp;</span><span style="text-align:justify">traffic-generator script&nbsp;<span style="font-weight:bolder">as sudo</span>&nbsp;and&nbsp;</span><span style="font-size:1rem"><span style="text-align:justify">start&nbsp;<span style="font-weight:bolder">ICMP/HTTP traffic</span></span></span><span style="font-size:1rem;text-align:justify">.&nbsp;</span><span style="text-align:justify;font-size:1rem">This command will disable logging mode. The rest of the other functions will still be available (if activated).</span></p>
<p style="text-align:justify">The command-line output will provide the information requested with the parameters. So, if you activate&nbsp;<span style="font-weight:bolder">verbosity (-v)</span>&nbsp;or&nbsp;<span style="font-weight:bolder">full packet dump (-X)</span>&nbsp;you will still have the output in the console, but there will be no logs in the log folder.<br></p><p><span style="font-size:18px;font-weight:700"><br><span style="font-size:24px">IDS/IPS</span></span><span style="font-size:24px;font-weight:700;text-align:justify">&nbsp;mode with parameter "-D"</span><br></p><p>Start the Snort instance in background mode with the following command: <code>sudo snort -c /etc/snort/snort.conf -D</code></p><p><span style="text-align:justify">Now run the&nbsp;</span><span style="text-align:justify">traffic-generator script&nbsp;<span style="font-weight:bolder">as sudo</span>&nbsp;and&nbsp;</span><span style="font-size:1rem"><span style="text-align:justify">start&nbsp;<span style="font-weight:bolder">ICMP/HTTP traffic</span></span></span><span style="font-size:1rem;text-align:justify">.&nbsp;</span><span style="font-size:1rem;text-align:justify">Once the traffic is generated, snort will start processing the packets and accomplish the given task with additional parameters.</span></p><div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            running in background mode</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> snort -c /etc/snort/snort.conf -D</span></span>

<span class="token output">Spawning daemon child...
My daemon child 2898 lives...
Daemon parent exiting (0)</span></code>
        </pre>
    </div>
</div>


<span style="text-align:justify">The command-line output will provide the information requested with the parameters. So, if you activate <b>verbosity (-v)</b> or <b>full packet dump (-X)</b> with <b>packet logger mode (-l)</b> you will still have the logs in the logs folder, but there will be no output in the console.</span><p></p><p><span style="font-size:1rem;text-align:justify">Once you start the background mode and want to check the corresponding process, you can easily use the "ps" command as shown below;</span></p>

    <div class="terminal-content">
        <div class="terminal-top">
            running in background mode</div>
        <pre class="terminal-code language-markup" tabindex="0">           <code class=" language-markup">user@ubuntu$ ps -ef | grep snort

root        2898    1706  0 05:53 ?        00:00:00 snort -c /etc/snort/snort.conf -D</code></pre>
    </div>


<p>If you want to stop the daemon, you can easily use the "kill" command to stop the process.</p>

    <div class="terminal-content">
        <div class="terminal-top">
            running in background mode</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">kill</span> -9 <span class="token number">2898</span></span></span>
</code>
        </pre>
    </div>

<span style="text-align:justify"><span style="font-weight:bolder">Note that</span>&nbsp;daemon mode is mainly used to automate the Snort. This parameter is mainly used in scripts to start the Snort service in the background. It is not recommended to use this mode unless you have a working knowledge of Snort and stable configuration.<br></span><p><span style="font-size:18px;font-weight:700"><br><span style="font-size:24px">IDS/IPS</span></span><span style="font-size:24px;font-weight:700;text-align:justify">&nbsp;mode with parameter "-A"</span><br></p><p><b style="font-size:1rem;text-align:justify">Remember that there are several alert modes available in snort;</b><br></p><ul><li style="text-align:justify"><span style="font-size:1rem;font-weight:bolder;text-align:left">console:&nbsp;</span><span style="font-size:1rem;text-align:left">Provides fast style alerts on the console screen.</span></li><li style="text-align:justify"><span style="font-weight:bolder;font-size:1rem;text-align:left">cmg:&nbsp;</span><span style="font-size:1rem;text-align:left">Provides basic header details with payload in hex and text format.</span></li><li style="text-align:justify"><span style="font-size:1rem;text-align:left"><b>full:&nbsp;</b></span><span style="font-size:1rem">Full alert mode, providing all possible information about the alert.</span><br></li><li style="text-align:justify"><b style="text-align:left;font-size:1rem">fast:&nbsp;</b>Fast mode, shows the alert message, timestamp, source and destination ıp along with port numbers.</li><li style="text-align:justify"><b style="font-size:1rem;text-align:left">none: </b><span style="font-size:1rem;text-align:left">Disabling alerting.</span><br></li></ul><p>In this section, only the <b>"console"</b> and<b> "cmg"</b> parameters provide alert information in the console. It is impossible to identify the difference between the rest of the alert modes via terminal. Differences can be identified by looking at generated logs.&nbsp;</p><p><span style="font-size:1rem;text-align:justify">At the end of this section,&nbsp;</span><span style="text-align:justify"><span style="font-size:1rem">we will compare the "full", "fast" and "none" modes. </span>Remember that these parameters don't provide console output, so we will continue to identify the differences through log formats.<br></span></p><p><span style="font-size:18px;font-weight:700"><br><span style="font-size:24px">IDS/IPS</span></span><span style="font-size:24px;font-weight:700;text-align:justify">&nbsp;mode with parameter "-A console"</span></p><p>Console mode provides fast style alerts on the console screen.&nbsp;<span style="font-size:1rem">Start the Snort instance in </span><b style="font-size:1rem">console&nbsp;</b><span style="font-size:1rem;font-weight:bolder">alert mode (-A console ) with the following command </span><code>sudo snort -c /etc/snort/snort.conf -A console</code></p><p><span style="text-align:justify">Now run the&nbsp;</span><span style="text-align:justify">traffic-generator script&nbsp;<span style="font-weight:bolder">as sudo</span>&nbsp;and&nbsp;</span><span style="font-size:1rem"><span style="text-align:justify">start&nbsp;<span style="font-weight:bolder">ICMP/HTTP traffic</span></span></span><span style="font-size:1rem;text-align:justify">.&nbsp;</span><span style="text-align:justify;font-size:1rem">Once the traffic is generated, snort will start generating alerts according to provided ruleset defined in the configuration file.&nbsp;</span></p>

    <div class="terminal-content">
        <div class="terminal-top">
            running in console alert mode</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> snort -c /etc/snort/snort.conf -A console</span></span>
<span class="token output"><span>Running in <a class="WPOml9uo glossary-term" onclick="initPopOver(&#39;IDS&#39;, &#39;WPOml9uo&#39;)">IDS</a> mode

        --== Initializing Snort ==--
Initializing Output Plugins!
Initializing Preprocessors!
Initializing Plug-ins!
Parsing Rules file "/etc/snort/snort.conf"
...
Commencing packet processing (pid=3743)
12/12-02:08:27.577495  [**] [1:366:7] ICMP PING *NIX [**] [Classification: Misc activity] [Priority: 3] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
12/12-02:08:27.577495  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
12/12-02:08:27.577495  [**] [1:384:5] ICMP PING [**] [Classification: Misc activity] [Priority: 3] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
12/12-02:08:27.609719  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -&gt; 192.168.175.129
^C*** Caught Int-Signal
12/12-02:08:29.595898  [**] [1:366:7] ICMP PING *NIX [**] [Classification: Misc activity] [Priority: 3] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
12/12-02:08:29.595898  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
12/12-02:08:29.595898  [**] [1:384:5] ICMP PING [**] [Classification: Misc activity] [Priority: 3] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
===============================================================================
Run time for packet processing was 26.25844 seconds
Snort processed 88 packets.
</span></span></code>
        </pre></div>
<p><span style="font-size:18px;font-weight:700"><br><span style="font-size:24px">IDS/IPS</span></span><span style="text-align:justify"><span style="font-weight:bolder"><span style="font-size:24px">&nbsp;mode with parameter "-A cmg"</span></span></span></p><p>Cmg mode provides basic header details with payload in hex and text format.&nbsp;<span style="font-size:1rem">Start the Snort instance in&nbsp;</span><span style="font-size:1rem;font-weight:bolder">cmg&nbsp;</span><span style="font-size:1rem;font-weight:bolder">alert mode (-A cmg ) with the following command </span><code>sudo snort -c /etc/snort/snort.conf -A cmg</code></p><p><span style="text-align:justify">Now run the&nbsp;</span><span style="text-align:justify">traffic-generator script&nbsp;<span style="font-weight:bolder">as sudo</span>&nbsp;and&nbsp;</span><span style="font-size:1rem"><span style="text-align:justify">start&nbsp;<span style="font-weight:bolder">ICMP/HTTP traffic</span></span></span><span style="font-size:1rem;text-align:justify">.&nbsp;</span><span style="text-align:justify;font-size:1rem">Once the traffic is generated, snort will start generating alerts according to provided ruleset defined in the configuration file.&nbsp;</span></p>
    <div class="terminal-content">
        <div class="terminal-top">
            running in cmg alert mode</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> snort -c /etc/snort/snort.conf -A cmg</span></span>
<span class="token output"><span>Running in <a class="oyydI48X glossary-term" onclick="initPopOver(&#39;IDS&#39;, &#39;oyydI48X&#39;)">IDS</a> mode

        --== Initializing Snort ==--
Initializing Output Plugins!
Initializing Preprocessors!
Initializing Plug-ins!
Parsing Rules file "/etc/snort/snort.conf"
...
Commencing packet processing (pid=3743)
12/12-02:23:56.944351  [**] [1:366:7] ICMP PING *NIX [**] [Classification: Misc activity] [Priority: 3] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
12/12-02:23:56.944351 00:0C:29:A5:B7:A2 -&gt; 00:50:56:E1:9B:9D type:0x800 len:0x62
192.168.175.129 -&gt; 142.250.187.110 ICMP TTL:64 TOS:0x0 ID:10393 IpLen:20 DgmLen:84 DF
Type:8  Code:0  ID:4   Seq:1  ECHO
BC CD B5 61 00 00 00 00 CE 68 0E 00 00 00 00 00  ...a.....h......
10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F  ................
20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F   !"#$%&amp;'()*+,-./
30 31 32 33 34 35 36 37                          01234567

=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
</span></span></code>
        </pre>
    </div>
<p></p><p><span style="font-size:1rem"><b>Let's compare the console and cmg outputs</b> before moving on to other alarm types. As you can see in the given outputs above, <b>console mode </b>provides basic header and rule information. <b>Cmg mode </b>provides full packet details along with rule information.&nbsp;<br></span></p><p></p><p>
</p><p><span style="font-size:18px;font-weight:700"><br><span style="font-size:24px">IDS/IPS</span></span><span style="text-align:justify"><span style="font-weight:bolder"><span style="font-size:24px">&nbsp;mode with parameter "-A fast"</span></span></span></p><p style="text-align:justify">Fast mode provides alert messages, timestamps, and source and destination IP addresses.<span style="text-align:justify">&nbsp;<b>Remember, there is no console output in this mode.&nbsp;</b></span><span style="font-size:1rem;text-align:left">Start the Snort instance in&nbsp;</span><span style="font-size:1rem;text-align:left;font-weight:bolder">fast&nbsp;</span><span style="font-size:1rem;text-align:left;font-weight:bolder">alert mode (-A fast ) with the following command </span><code style="text-align:left">sudo snort -c /etc/snort/snort.conf -A fast</code></p><p><span style="text-align:justify">Now run the&nbsp;</span><span style="text-align:justify">traffic-generator script&nbsp;<span style="font-weight:bolder">as sudo</span>&nbsp;and&nbsp;</span><span style="font-size:1rem"><span style="text-align:justify">start&nbsp;<span style="font-weight:bolder">ICMP/HTTP traffic</span></span></span><span style="font-size:1rem;text-align:justify">.&nbsp;</span><span style="text-align:justify;font-size:1rem">Once the traffic is generated, snort will start generating alerts according to provided ruleset defined in the configuration file.&nbsp;</span></p>


    <div class="terminal-content">
        <div class="terminal-top">
            running in fast alert mode</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> snort -c /etc/snort/snort.conf -A fast</span></span>
<span class="token output"><span>Running in <a class="QhbAtfRr glossary-term" onclick="initPopOver(&#39;IDS&#39;, &#39;QhbAtfRr&#39;)">IDS</a> mode

        --== Initializing Snort ==--
Initializing Output Plugins!
Initializing Preprocessors!
Initializing Plug-ins!
Parsing Rules file "/etc/snort/snort.conf"
...
Commencing packet processing (pid=3743)
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
</span></span></code>
        </pre>
    </div>

<p></p><p>Let's check the alarm file;<br></p><p><img src="./TryHackMe _ Snort_files/c66d9e4fb20937682ee367346a1d0f4b.png"><br></p><p>As you can see in the given picture above, fast style alerts contain summary information on the action like direction and alert header.<br></p><p><span style="font-size:18px;font-weight:700"><br><span style="font-size:24px">IDS/IPS</span></span><span style="text-align:justify"><span style="font-weight:bolder"><span style="font-size:24px">&nbsp;mode with parameter "-A full"</span></span></span><span style="font-size:1rem;text-align:justify"><br></span></p><p><span style="text-align:justify">Full alert mode provides all possible information about the alert.&nbsp;</span><span style="text-align:justify;font-size:1rem"><b>Remember, there is no console output in this mode.&nbsp;</b></span><span style="font-size:1rem">Start the Snort instance in&nbsp;</span><span style="font-size:1rem;font-weight:bolder">full&nbsp;</span><span style="font-size:1rem;font-weight:bolder">alert mode (-A full ) with the following command </span><code>sudo snort -c /etc/snort/snort.conf -A full</code></p><p><span style="text-align:justify">Now run the&nbsp;</span><span style="text-align:justify">traffic-generator script&nbsp;<span style="font-weight:bolder">as sudo</span>&nbsp;and&nbsp;</span><span style="font-size:1rem"><span style="text-align:justify">start&nbsp;<span style="font-weight:bolder">ICMP/HTTP traffic</span></span></span><span style="font-size:1rem;text-align:justify">.&nbsp;</span><span style="text-align:justify;font-size:1rem">Once the traffic is generated, snort will start generating alerts according to provided ruleset defined in the configuration file.&nbsp;</span></p><p>
    </p><div class="terminal-content">
        <div class="terminal-top">
            running in full alert mode</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> snort -c /etc/snort/snort.conf -A full</span></span>
<span class="token output"><span>Running in <a class="1RrMr8ta glossary-term" onclick="initPopOver(&#39;IDS&#39;, &#39;1RrMr8ta&#39;)">IDS</a> mode

        --== Initializing Snort ==--
Initializing Output Plugins!
Initializing Preprocessors!
Initializing Plug-ins!
Parsing Rules file "/etc/snort/snort.conf"
...
Commencing packet processing (pid=3744)
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
</span></span></code>
        </pre>
    </div>

<p><span style="font-size:1rem">Let's check the alarm file;</span><br></p>
<p><img src="./TryHackMe _ Snort_files/cba862ab1b89fe31fe0ac1c356fde8fa.png"><br></p><p><span style="font-weight:bolder;text-align:justify;font-size:1rem">&nbsp;</span>As you can see in the given picture above, full style alerts contain all possible information on the action.<br></p><p><span style="font-size:18px;font-weight:700"><br><span style="font-size:24px">IDS/IPS</span></span><span style="text-align:justify"><span style="font-weight:bolder"><span style="font-size:24px">&nbsp;mode with parameter "-A none"</span></span></span><span style="font-size:1rem;text-align:justify"><br></span></p><p style="text-align:justify">Disable alerting. This&nbsp;<span style="font-size:1rem">mode doesn't create the alert file. However, it still logs the traffic and creates a log file in binary dump format.&nbsp;</span><span style="font-weight:bolder;font-size:1rem">Remember, there is no console output in this mode.&nbsp;</span><span style="font-size:1rem;text-align:left">Start the Snort instance in&nbsp;</span><span style="font-size:1rem;text-align:left;font-weight:bolder">none&nbsp;</span><span style="font-size:1rem;text-align:left;font-weight:bolder">alert mode (-A none) with the following command </span><code style="text-align:left">sudo snort -c /etc/snort/snort.conf -A none</code></p><p><span style="font-size:1rem;text-align:justify">Now run the&nbsp;</span><span style="font-size:1rem;text-align:justify">traffic-generator script&nbsp;<span style="font-weight:bolder">as sudo</span>&nbsp;and&nbsp;</span><span style="font-size:1rem"><span style="text-align:justify">start&nbsp;<span style="font-weight:bolder">ICMP/HTTP traffic</span></span></span><span style="font-size:1rem;text-align:justify">.&nbsp;</span><span style="text-align:justify;font-size:1rem">Once the traffic is generated, snort will start generating alerts according to provided ruleset defined in the configuration file.&nbsp;</span></p><p>
    </p><div class="terminal-content">
        <div class="terminal-top">
            running in none alert mode</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> snort -c /etc/snort/snort.conf -A none</span></span>
<span class="token output"><span>Running in <a class="KAfAIVR9 glossary-term" onclick="initPopOver(&#39;IDS&#39;, &#39;KAfAIVR9&#39;)">IDS</a> mode

        --== Initializing Snort ==--
Initializing Output Plugins!
Initializing Preprocessors!
Initializing Plug-ins!
Parsing Rules file "/etc/snort/snort.conf"
...
Commencing packet processing (pid=3745)
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
</span></span></code>
        </pre>
    </div>

<p>As you can see in the picture below, there is no alert file. Snort only generated the log file.</p><p><img src="./TryHackMe _ Snort_files/50306d75ae941b5a02ac787d265fb149.png"><br></p><p><span style="font-size:18px;font-weight:700"><br><span style="font-size:24px">IDS/IPS</span></span><span style="text-align:justify"><span style="font-weight:bolder"><span style="font-size:24px">&nbsp;mode: "Using rule file without configuration file"</span></span></span></p><p>It is possible to run the Snort only with rules without a configuration file. Running the Snort in this mode will help you test the user-created rules. However, this mode will provide less performance.</p>

<div class="terminal-content">
        <div class="terminal-top">
            running without configuration file</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> snort -c /etc/snort/rules/local.rules -A console</span></span>
<span class="token output"><span>Running in <a class="WHDMfUUI glossary-term" onclick="initPopOver(&#39;IDS&#39;, &#39;WHDMfUUI&#39;)">IDS</a> mode

12/12-12:13:29.167955  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
12/12-12:13:29.200543  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -&gt; 192.168.175.129
12/12-12:13:30.169785  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
12/12-12:13:30.201470  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -&gt; 192.168.175.129
12/12-12:13:31.172101  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
^C*** Caught Int-Signal
</span></span></code>
        </pre>
    </div>

<p></p><p><span style="font-size:18px;font-weight:700"><br><span style="font-size:24px"><span><a class="RXvUbBzx glossary-term" onclick="initPopOver(&#39;IPS&#39;, &#39;RXvUbBzx&#39;)">IPS</a></span></span></span><span style="text-align:justify"><span style="font-weight:bolder"><span style="font-size:24px">&nbsp;mode and dropping packets</span></span></span></p><p><span>Snort <a class="oaD9nXo6 glossary-term" onclick="initPopOver(&#39;IPS&#39;, &#39;oaD9nXo6&#39;)">IPS</a> mode activated with&nbsp;</span><span style="font-weight:bolder">-Q --daq afpacket</span>&nbsp;parameters. You can also activate this mode by editing snort.conf file. However, you don't need to edit snort.conf file in the scope of this room. Review the bonus task or snort manual for further information on daq and advanced configuration settings:&nbsp;<code>-Q --daq afpacket</code></p><p><span>Activate the Data Acquisition (<a class="B6W0gr4u glossary-term" onclick="initPopOver(&#39;DAQ&#39;, &#39;B6W0gr4u&#39;)">DAQ</a>) modules and use the afpacket module to use snort as an IPS:&nbsp;</span><code>-i eth0:eth1</code></p><p><span>Identifying interfaces note that Snort <a class="muAUVYKs glossary-term" onclick="initPopOver(&#39;IPS&#39;, &#39;muAUVYKs&#39;)">IPS</a> require at least two interfaces to work.&nbsp;</span><span style="font-size:1rem;text-align:justify">Now run the&nbsp;</span><span style="font-size:1rem;text-align:justify">traffic-generator script&nbsp;<span style="font-weight:bolder">as sudo</span>&nbsp;and&nbsp;</span><span style="font-size:1rem"><span style="text-align:justify">start&nbsp;<span style="font-weight:bolder">ICMP/HTTP traffic</span></span></span><span style="font-size:1rem;text-align:justify">.</span></p>



<div class="terminal-content">
        <div class="terminal-top"><span>
            running IPS mode</span></div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> snort -c /etc/snort/snort.conf -q -Q --daq afpacket -i eth0:eth1 -A console</span></span>
<span class="token output"><span>Running in <a class="utTxglL0 glossary-term" onclick="initPopOver(&#39;IPS&#39;, &#39;utTxglL0&#39;)">IPS</a> mode

12/18-07:40:01.527100  [Drop] [**] [1:1000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.131 -&gt; 192.168.175.2
12/18-07:40:01.552811  [Drop] [**] [1:1000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 172.217.169.142 -&gt; 192.168.1.18
12/18-07:40:01.566232  [Drop] [**] [1:1000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.131 -&gt; 192.168.175.2
12/18-07:40:02.517903  [Drop] [**] [1:1000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.1.18 -&gt; 172.217.169.142
12/18-07:40:02.550844  [Drop] [**] [1:1000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 172.217.169.142 -&gt; 192.168.1.18
^C*** Caught Int-Signal
</span></span></code>
        </pre>
    </div>

        <p style="text-align:left">As you can see in the picture above, Snort blocked the packets this time.<b style="font-size:1rem">&nbsp;We used the same rule with a different action (drop/reject).</b><span style="font-size:1rem"> Remember, for the scope of this task; our point is the operating mode, not the rule.</span></p><p></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <div><p><span style="text-align:justify;font-size:1rem">Investigate the traffic with the default configuration file.</span><br></p><p></p><p><code style="font-size:14px">sudo snort -c /etc/snort/snort.conf -A full -l .</code></p></div><div><span style="font-size:1rem">E</span><span style="font-size:1rem">xecute the traffic generator script and choose <b>"TASK-7 Exercise"</b>. Wait until the traffic stops, then stop the Snort instance. Now analyse the output summary and answer the question.</span></div><div><div><p></p><p><code style="font-size:14px">sudo ./traffic-generator.sh</code></p></div><div><span style="font-size:1rem"><span>What is the number of the detected <a class="iMKRmCaq glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;iMKRmCaq&#39;)">HTTP</a> GET methods?</span></span><br></div></div>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *" value="2" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="7">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>You can practice the rest of the parameters by using the traffic-generator script.</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="7">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-8">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse8">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 8                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Operation Mode 4: PCAP Investigation
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse8" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="text-align:center"><img src="./TryHackMe _ Snort_files/55ae20f9994d9721d7bb290e524e93a2.png" style="width:50%"></p><p></p><p style="text-align:center"><br></p><p><span style="font-weight:bolder"><span style="font-size:24px">Let's investigate PCAPs with Snort</span></span></p><p><span>Capabilities of Snort are not limited to sniffing, logging and detecting/preventing the threats. <a class="34r4FxNJ glossary-term" onclick="initPopOver(&#39;PCAP&#39;, &#39;34r4FxNJ&#39;)">PCAP</a> read/investigate mode helps you work with pcap files.&nbsp;</span><span style="font-size:1rem">Once you have a pcap file and process it with Snort, you will receive default traffic statistics with alerts depending on your ruleset.</span></p><p><span style="text-align:justify;font-size:1rem">Reading a pcap without using any additional parameters we discussed before will only overview the packets and provide statistics about the file. In most cases, this is not very handy. We are investigating the pcap with Snort to benefit from the rules and speed up our investigation process by using the known patterns of threats.&nbsp;</span></p><p><span style="font-size:1rem;font-weight:bolder">Note that</span><span style="text-align:justify;font-size:1rem">&nbsp;we are pretty close to starting to create rules. Therefore, you need to grasp the working mechanism of the Snort, learn the discussed parameters and begin combining the parameters for different purposes.<br></span></p><p><span><a class="bDrVFP1x glossary-term" onclick="initPopOver(&#39;PCAP&#39;, &#39;bDrVFP1x&#39;)">PCAP</a> mode parameters are explained in the table below;</span><br></p><table class="table table-bordered"><tbody><tr><td><b>Parameter</b></td><td><b>Description</b></td></tr><tr><td><b>-r / --pcap-single=</b></td><td style="text-align:left">Read a single pcap</td></tr><tr><td><b>--pcap-list=""</b></td><td style="text-align:left">Read pcaps provided in command (space separated).</td></tr><tr><td><b>--pcap-show</b></td><td style="text-align:left">Show pcap name on console during processing.</td></tr></tbody></table><p></p><p><span style="text-align:justify;font-weight:bolder"><span style="font-size:18px"><br><span style="font-size:24px"><span>Investigating single <a class="B4cTOVVf glossary-term" onclick="initPopOver(&#39;PCAP&#39;, &#39;B4cTOVVf&#39;)">PCAP</a> with parameter "-r"</span></span></span></span></p><p><span style="font-size:1rem;text-align:justify">For test purposes, you can still test the default reading option with pcap by using the following command </span><code>snort -r icmp-test.pcap</code></p><p><span style="font-size:1rem">Let's investigate the pcap with our configuration file and see what will happen.&nbsp;</span><code>sudo snort -c /etc/snort/snort.conf -q -r icmp-test.pcap -A console -n 10</code></p><p>If you don't remember the purpose of the parameters in the given command, please revisit previous tasks and come back again!</p>


    <div class="terminal-content">
        <div class="terminal-top">
            investigating single pcap file</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> snort -c /etc/snort/snort.conf -q -r icmp-test.pcap -A console -n <span class="token number">10</span></span></span>

<span class="token output">12/12-12:13:29.167955  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
12/12-12:13:29.200543  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -&gt; 192.168.175.129
12/12-12:13:30.169785  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
12/12-12:13:30.201470  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -&gt; 192.168.175.129
12/12-12:13:31.172101  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
12/12-12:13:31.204104  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -&gt; 192.168.175.129
12/12-12:13:32.174106  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
12/12-12:13:32.208683  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -&gt; 192.168.175.129
12/12-12:13:33.176920  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
12/12-12:13:33.208359  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -&gt; 192.168.175.129
</span></code>
        </pre>
    </div>

<p><span style="text-align:justify">Our ICMP rule got a hit!&nbsp;</span>As you can see in the given output, snort identified the traffic and prompted the alerts according to our ruleset.<br></p><p><span style="text-align:justify;font-weight:bolder"><span style="font-size:18px"><br><span style="font-size:24px">Investigating multiple PCAPs with parameter "--pcap-list"</span></span></span><br></p><p><span style="font-size:1rem">Let's investigate multiple pcaps with our configuration file and see what will happen.&nbsp;</span><code>sudo snort -c /etc/snort/snort.conf -q --pcap-list="icmp-test.pcap http2.pcap" -A console -n 10</code></p>



    <div class="terminal-content">
        <div class="terminal-top">
            investigating multiple pcap files</div>
        <pre class="terminal-code language-markup" tabindex="0">           <code class=" language-markup">user@ubuntu$ sudo snort -c /etc/snort/snort.conf -q --pcap-list="icmp-test.pcap http2.pcap" -A console

12/12-12:13:29.167955  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
12/12-12:13:29.200543  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -&gt; 192.168.175.129
12/12-12:13:30.169785  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
12/12-12:13:30.201470  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -&gt; 192.168.175.129
12/12-12:13:31.172101  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
...
12/12-12:13:31.204104  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -&gt; 192.168.175.129
12/12-12:13:32.174106  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
12/12-12:13:32.208683  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -&gt; 192.168.175.129
12/12-12:13:33.176920  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
12/12-12:13:33.208359  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -&gt; 192.168.175.129
</code>
        </pre>
    </div>


<p><span style="text-align:justify">Our ICMP rule got a hit!&nbsp;</span>As you can see in the given output, snort identified the traffic and prompted the alerts according to our ruleset.</p><p><b>Here is one point to notice:</b> we've processed two pcaps, and there are lots of alerts, so it is impossible to match the alerts with provided pcaps without snort's help. We need to separate the pcap process to identify the source of the alerts.<br></p>
<p></p><p><span style="text-align:justify;font-weight:bolder"><span style="font-size:18px"><br><span style="font-size:24px">Investigating multiple PCAPs with parameter "--pcap-show"</span></span></span><br></p><p style="text-align:left">Let's investigate multiple pcaps, distinguish each one, and see what will happen.&nbsp;<code>sudo snort -c /etc/snort/snort.conf -q --pcap-list="icmp-test.pcap http2.pcap" -A console --pcap-show</code></p><p>

    </p><div class="terminal-content">
        <div class="terminal-top">
            investigating multiple pcap files wth pcap info</div>
        <pre class="terminal-code language-markup" tabindex="0">           <code class=" language-markup">user@ubuntu$ sudo snort -c /etc/snort/snort.conf -q --pcap-list="icmp-test.pcap http2.pcap" -A console --pcap-show 

Reading network traffic from "icmp-test.pcap" with snaplen = 1514
12/12-12:13:29.167955  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
12/12-12:13:29.200543  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -&gt; 192.168.175.129
12/12-12:13:30.169785  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
...

Reading network traffic from "http2.pcap" with snaplen = 1514
12/12-12:13:35.213176  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -&gt; 192.168.175.129
12/12-12:13:36.182950  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 192.168.175.129 -&gt; 142.250.187.110
12/12-12:13:38.223470  [**] [1:10000001:0] ICMP Packet found [**] [Priority: 0] {ICMP} 142.250.187.110 -&gt; 192.168.175.129
...</code></pre>
    </div>


<span style="text-align:justify">Our ICMP rule got a hit!&nbsp;</span>As you can see in the given output, snort identified the traffic, distinguished each pcap file and prompted the alerts according to our ruleset.<p></p><p></p><p><span style="text-align:justify"><span style="font-size:16px">Now, use the attached&nbsp;</span><a class="MaTh8tUD glossary-term"><span style="font-size:16px">VM</span></a><span style="font-size:16px">&nbsp;and&nbsp;</span></span><span style="text-align:justify;font-size:16px">navigate to the Task-Exercises/Exercise-Files/TASK-8 folder to answer the questions!</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <div><p><span style="text-align:justify;font-size:1rem">Investigate the <b>mx-1.pcap</b> file with the default configuration file.</span><br></p><p></p><p><code style="font-size:14px">sudo snort -c /etc/snort/snort.conf -A full -l . -r mx-1.pcap</code></p></div><div><span style="text-align:justify">What is the number of the generated alerts?</span></div>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***" value="170" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="8">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="text-align:justify">Keep reading the output.&nbsp;</span><span style="font-size:1rem">How many&nbsp;TCP Segments are Queued?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **" value="18" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="8">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="text-align:justify">Keep reading the output.</span><span style="font-size:1rem">How many "HTTP response headers" were extracted?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *" value="3" disabled="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="8">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <div><p><span style="text-align:justify;font-size:1rem">Investigate the&nbsp;<span style="font-weight:bolder">mx-1.pcap</span>&nbsp;file <b>with the second</b> configuration file.</span><br></p><p></p><p><code style="font-size:14px">sudo snort -c /etc/snort/snortv2.conf -A full -l . -r mx-1.pcap</code></p></div><div><span style="text-align:justify">What is the number of the generated alerts?</span></div>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **" value="68" disabled="">
                            <input type="hidden" value="4">
                            <input type="hidden" value="8">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <div><p><span style="text-align:justify;font-size:1rem">Investigate the <b>mx-2.pcap</b> file with the default configuration file.</span><br></p><p></p><p><code style="font-size:14px">sudo snort -c /etc/snort/snort.conf -A full -l . -r mx-2.pcap</code></p></div><div><span style="text-align:justify">What is the number of the generated alerts?</span></div>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***" value="340" disabled="">
                            <input type="hidden" value="5">
                            <input type="hidden" value="8">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="font-size:1rem;text-align:justify">Keep reading the output.&nbsp;</span><span style="font-size:1rem;text-align:justify"><span>What is the number of the detected <a class="FzWS0CH9 glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;FzWS0CH9&#39;)">TCP</a> packets?</span></span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **" value="82" disabled="">
                            <input type="hidden" value="6">
                            <input type="hidden" value="8">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <div><div><p><span style="font-size:1rem;text-align:justify">Investigate the&nbsp;<span style="font-weight:bolder">mx-2.pcap and mx-3.pcap</span>&nbsp;files with the default configuration file.</span><br></p></div><p></p><p><code style="font-size:14px">sudo snort -c /etc/snort/snort.conf -A full -l . --pcap-list="mx-2.pcap mx-3.pcap"</code></p></div><div><span style="text-align:justify">What is the number of the generated alerts?</span></div>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****" value="1020" disabled="">
                            <input type="hidden" value="7">
                            <input type="hidden" value="8">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-9">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse9">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 9                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Snort Rule Structure
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse9" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="text-align:center"><img src="./TryHackMe _ Snort_files/b151b052e476bc7047d3e3cd298b3c83.png" style="width:50%"><br></p><p><b><span style="font-size:24px">Let's Learn Snort Rules!</span></b></p><p>Understanding the Snort rule format is essential for any blue and purple teamer.&nbsp; The primary structure of the snort rule is shown below;</p><p><img src="./TryHackMe _ Snort_files/58234314551a2962ad5617cb22591a2b.png" style="width:100%"><br></p><p style="text-align:justify"></p><p style="text-align:justify"><span style="background:transparent;font-size:1rem;text-align:left;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt"><span>Each rule should have a type of action, protocol, source and destination IP, source and destination port and an option. Remember, Snort is in passive mode by default. So most of the time, you will use Snort as an <a class="H2GuV3Le glossary-term" onclick="initPopOver(&#39;IDS&#39;, &#39;H2GuV3Le&#39;)">IDS</a>. You will need to start&nbsp;</span></span><strong><span>"inline mode" to turn on <a class="SH4mpEpr glossary-term" onclick="initPopOver(&#39;IPS&#39;, &#39;SH4mpEpr&#39;)">IPS</a> mode.</span></strong><span style="background:transparent;font-size:1rem;text-align:left;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">&nbsp;But before you start playing with inline mode, you should be familiar with Snort features and rules.</span><br></p><p style="text-align:justify"><span style="background:transparent;font-size:1rem;text-align:left;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt"><span style="color:rgb(33, 37, 41);font-size:1rem;text-align:justify">The Snort rule structure is easy to understand but difficult to produce. You should be familiar with rule options and related details to create efficient rules.&nbsp;</span></span><span style="text-align:left">It is recommended to practice Snort rules and option details for different use cases.</span></p><p style="text-align:justify"><span style="background:transparent;text-align:left;margin-top:0pt;margin-bottom:0pt">We will cover the basic rule structure in this room and help you take a step into snort rules.<span style="color:rgb(33, 37, 41);font-size:1rem;text-align:justify">&nbsp;You can always advance your rule creation skills with different rule options by practising different use cases and studying rule option details in depth. We will focus on two actions;&nbsp;<b>"alert"</b><span>&nbsp; for <a class="TUzwC3tD glossary-term" onclick="initPopOver(&#39;IDS&#39;, &#39;TUzwC3tD&#39;)">IDS</a> mode and </span><b>"reject" </b><span>for <a class="vLwqCAUJ glossary-term" onclick="initPopOver(&#39;IPS&#39;, &#39;vLwqCAUJ&#39;)">IPS</a> mode.</span></span></span></p><p style="text-align:justify"><span style="background-color:transparent;font-size:1rem">Rules cannot be processed without a header. Rule options are "optional" parts.&nbsp;</span><span style="background-color:transparent;text-align:left;font-size:1rem">However, it is almost impossible to detect sophisticated attacks without using the rule options.</span></p><table class="table table-bordered"><tbody><tr><td>Action<br></td><td><p style="text-align:left">There are several actions for rules. Make sure you understand the functionality and test it before creating rules for live systems. The most common actions are listed below.</p><ul><li style="text-align:left">alert: Generate an alert and log the packet.</li><li style="text-align:left">log: Log the packet.</li><li style="text-align:left">drop: Block and log the packet.</li><li style="text-align:left">reject: Block the packet, log it and terminate the packet session.&nbsp;</li></ul></td></tr><tr><td>Protocol<br></td><td><p style="text-align:left">Protocol parameter identifies the type of the protocol that filtered for the rule.</p><p style="text-align:left"><span>Note that Snort2 supports only four protocols filters in the rules (IP, <a class="MX6MS61Q glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;MX6MS61Q&#39;)">TCP</a>, UDP and ICMP). However, you can detect the application flows using port numbers and options. For instance, if you want to detect FTP traffic, you cannot use the FTP keyword in the protocol field but filter the FTP traffic by investigating TCP traffic on port 21.</span><br></p></td></tr></tbody></table><p></p><p style="text-align:justify"><br></p><p style="text-align:justify"><span style="font-size:24px"><b>IP and Port Numbers</b></span></p><p style="text-align:justify"><span style="font-size:1rem">These parameters identify the source and destination IP addresses and associated port numbers filtered for the rule.</span></p><table class="table table-bordered"><tbody><tr><td>IP Filtering</td><td><div style="text-align:left"><span style="font-size:1rem">alert icmp 192.168.1.56 any &lt;&gt; any any&nbsp; (msg: "ICMP Packet Found"; sid: 100001; rev:1;)</span></div><div style="text-align:left"><span style="font-size:1rem">This rule will create alerts for each ICMP packet originating from the 192.168.1.56 IP address.</span></div></td></tr><tr><td>Filter an IP range<br></td><td><div style="text-align:left"><span style="font-size:1rem">alert icmp 192.168.1.0/24 any &lt;&gt; any any&nbsp; (msg: "ICMP Packet Found"; sid: 100001; rev:1;)</span></div><div style="text-align:left"><span style="font-size:1rem">This rule will create alerts for each ICMP packet originating from the 192.168.1.0/24 subnet.</span></div></td></tr><tr><td>Filter multiple IP ranges<br></td><td><div style="text-align:left"><span style="font-size:1rem">alert icmp [192.168.1.0/24, 10.1.1.0/24] any &lt;&gt; any any&nbsp; (msg: "ICMP Packet Found"; sid: 100001; rev:1;)</span></div><div style="text-align:left"><span style="font-size:1rem">This rule will create alerts for each ICMP packet originating from the 192.168.1.0/24 and 10.1.1.0/24 subnets.</span></div></td></tr><tr><td>Exclude IP addresses/ranges<br></td><td><div style="text-align:left"><span style="font-size:1rem">"negation operator" is used for excluding specific addresses and ports. Negation operator is indicated with "!"</span></div><div style="text-align:left"><span style="font-size:1rem">alert icmp !192.168.1.0/24 any &lt;&gt; any any&nbsp; (msg: "ICMP Packet Found"; sid: 100001; rev:1;)</span></div><div style="text-align:left"><span style="font-size:1rem">This rule will create alerts for each ICMP packet not originating from the 192.168.1.0/24 subnet.</span></div></td></tr><tr><td>Port Filtering</td><td><div style="text-align:left"><span style="font-size:1rem">alert tcp !192.168.1.0/24 21 &lt;&gt; any any&nbsp; (msg: "ICMP Packet Found"; sid: 100001; rev:1;)</span></div><div style="text-align:left"><span style="font-size:1rem"><span>This rule will create alerts for each <a class="X8eSH7eV glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;X8eSH7eV&#39;)">TCP</a> packet originating from port 21.</span></span></div></td></tr><tr><td>Exclude a specific port<br></td><td><div style="text-align:left"><span style="font-size:1rem">alert tcp !192.168.1.0/24 !21 &lt;&gt; any any&nbsp; (msg: "ICMP Packet Found"; sid: 100001; rev:1;)</span></div><div style="text-align:left"><span style="font-size:1rem"><span>This rule will create alerts for each <a class="iHTRFVnx glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;iHTRFVnx&#39;)">TCP</a> packet not originating from port 21.</span></span></div></td></tr><tr><td>Filter a port range (Type 1)<br></td><td><div style="text-align:left"><span style="font-size:1rem">alert tcp !192.168.1.0/24 1:1024 &lt;&gt; any any&nbsp; (msg: "ICMP Packet Found"; sid: 100001; rev:1;)</span></div><div style="text-align:left"><span style="font-size:1rem"><span>This rule will create alerts for each <a class="qyw9Xna5 glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;qyw9Xna5&#39;)">TCP</a> packet originating from ports between 1-1024.</span></span></div></td></tr><tr><td>Filter a port range (Type 2)<br></td><td><div style="text-align:left"><span style="font-size:1rem">alert icmp any :1024 &lt;&gt; any any&nbsp; (msg: "ICMP Packet Found"; sid: 100001; rev:1;)</span></div><div style="text-align:left"><span style="font-size:1rem"><span>This rule will create alerts for each <a class="OVmfFRyy glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;OVmfFRyy&#39;)">TCP</a> packet originating from ports less than or equal to 1024.</span></span></div></td></tr><tr><td>Filter a port range (Type 3)<br></td><td><div style="text-align:left"><span style="font-size:1rem">alert icmp any 1024: &lt;&gt; any any (msg: "ICMP Packet Found"; sid: 100001; rev:1;)</span></div><div style="text-align:left"><span style="font-size:1rem"><span>This rule will create alerts for each <a class="2EanQInn glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;2EanQInn&#39;)">TCP</a> packet originating from a source port higher than or equal to 1024.</span></span></div></td></tr><tr><td>Filter a port range (Type 4)<br></td><td><div style="text-align:left"><span style="font-size:1rem">alert icmp any 80,1024: &lt;&gt; any any (msg: "ICMP Packet Found"; sid: 100001; rev:1;)</span></div><div style="text-align:left"><span style="font-size:1rem"><span>This rule will create alerts for each <a class="RqfjQxIj glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;RqfjQxIj&#39;)">TCP</a> packet originating from a source port 80 and higher than or equal to 1024.</span></span></div></td></tr></tbody></table><p style="text-align:justify"><br></p><p style="text-align:justify"><span style="font-size:24px">Direction</span></p><p style="text-align:justify">The direction operator indicates the traffic flow to be filtered by Snort. The left side of the rule shows the source, and the right side shows the destination.</p><ul><li style="text-align:justify"><b>-&gt;</b> Source to destination flow.</li><li style="text-align:justify"><b>&lt;&gt;</b> Bidirectional flow</li></ul><p style="text-align:justify"><span style="font-size:1rem;text-align:left;font-weight:bolder">Note that</span><span style="font-weight:700">&nbsp;there is no "&lt;-" operator in Snort.</span></p><p style="text-align:justify"><img src="./TryHackMe _ Snort_files/9f7624fafc763e0c7c4e3bd70451367b.png"><span style="font-weight:700"><br></span></p><p style="text-align:justify"><span style="background:transparent;text-align:left;margin-top:0pt;margin-bottom:0pt"></span></p><p style="text-align:justify"><span style="background-color:transparent;text-align:left;font-size:1rem"><span style="font-weight:bolder"><span style="font-size:18px"><br><span style="font-size:24px">There are three main rule options in Snort;</span></span></span></span><br></p><ul><li style="text-align:justify"><span style="background:transparent;text-align:left;margin-top:0pt;margin-bottom:0pt"><span style="font-weight:bolder">General Rule Options -&nbsp;</span></span>Fundamental rule options for Snort.&nbsp;</li><li style="text-align:justify"><span style="background:transparent;text-align:left;margin-top:0pt;margin-bottom:0pt"><span style="font-weight:bolder">Payload Rule Options -&nbsp;</span></span>Rule options that help to investigate the payload data. These options are helpful to detect specific payload patterns.</li><li style="text-align:justify"><span style="background:transparent;text-align:left;margin-top:0pt;margin-bottom:0pt"><span style="font-weight:bolder">Non-Payload Rule Options -&nbsp;</span></span>Rule options that focus on non-payload data. These options will help create specific patterns and identify network issues.</li></ul><p style="text-align:justify"><span style="font-size:18px"><b><br><span style="font-size:24px">General Rule Options</span></b></span></p><table class="table table-bordered"><tbody><tr><td>Msg</td><td style="text-align:left">The message field is a basic prompt and quick identifier of the rule. Once the rule is triggered, the message filed will appear in the console or log. Usually, the message part is a one-liner that summarises the event.<br></td></tr><tr><td>Sid<br></td><td><p style="text-align:justify"><span style="font-size:1rem">Snort rule IDs (SID) come with a pre-defined scope, and each rule must have a SID in a proper format. There are three different scopes for SIDs shown below.</span></p><ul style="text-align:left"><li style="text-align:justify"><span style="font-weight:bolder">&lt;100:</span>&nbsp;Reserved rules</li><li style="text-align:justify"><span style="font-weight:bolder">100-999,999:</span>&nbsp;Rules came with the build.</li><li style="text-align:justify"><span style="font-weight:bolder">&gt;=1,000,000:</span>&nbsp;Rules created by user.</li></ul><p style="text-align:justify"><span style="font-size:1rem">Briefly, the rules we will create should have sid greater than 100.000.000. Another important point is; SIDs should not overlap, and each id must be unique.&nbsp;</span></p></td></tr><tr><td>Reference<br></td><td style="text-align:left"><span>Each rule can have additional information or reference to explain the purpose of the rule or threat pattern. That could be a Common Vulnerabilities and Exposures (<a class="uf73Yhrx glossary-term" onclick="initPopOver(&#39;CVE&#39;, &#39;uf73Yhrx&#39;)">CVE</a>) id or external information. Having references for the rules will always help analysts during the alert and incident investigation.</span><br></td></tr><tr><td>Rev<br></td><td><p style="text-align:left">Snort rules can be modified and updated for performance and efficiency issues. Rev option help analysts to have the revision information of each rule. Therefore, it will be easy to understand rule improvements. Each rule has its unique rev number, and there is no auto-backup feature on the rule history. Analysts should keep the rule history themselves. Rev option is only an indicator of how many times the rule had revisions.</p><p style="text-align:left"><span style="font-size:1rem;text-align:justify">alert icmp any&nbsp;any &lt;&gt; any&nbsp;any</span><span style="font-size:1rem;text-align:justify"><span style="font-weight:bolder">&nbsp;</span>(msg: "ICMP Packet Found"; sid: 100001; reference:cve,CVE-XXXX;&nbsp;<span style="font-weight:bolder">rev:1</span>;)</span><br></p></td></tr></tbody></table><p style="text-align:justify"><br></p><p style="text-align:justify"><span style="font-size:18px"><span style="font-weight:bolder;font-size:24px">Payload Detection Rule Options</span></span></p><table class="table table-bordered"><tbody><tr><td>Content<br></td><td><p style="text-align:left">Payload data. It matches specific payload data by ASCII, HEX or both. It is possible to use this option multiple times in a single rule. However, the more you create specific pattern match features, the more it takes time to investigate a packet.</p><p style="text-align:left"><span>Following rules will create an alert for each <a class="KadSCDyT glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;KadSCDyT&#39;)">HTTP</a> packet containing the keyword "GET". This rule option is case sensitive!</span></p><ul style="text-align:left"><li style="text-align:left">ASCII mode -&nbsp;alert tcp any&nbsp;any &lt;&gt; any 80&nbsp;<span style="font-size:1rem">&nbsp;(msg: "GET Request Found";&nbsp;</span><span style="font-size:1rem">content:"GET";</span><span style="font-size:1rem">&nbsp;sid: 100001; rev:1;)</span></li><li style="text-align:left">HEX mode -&nbsp;alert tcp any&nbsp;any &lt;&gt; any 80&nbsp;<span style="font-size:1rem">&nbsp;(msg: "GET Request Found";&nbsp;</span><span style="font-size:1rem">content:"|47 45 54|"</span><span style="font-size:1rem">;</span><span style="font-size:1rem">&nbsp;sid: 100001; rev:1;)</span></li></ul></td></tr><tr><td>Nocase<br></td><td><div style="text-align:left"><span style="font-size:1rem">Disabling case sensitivity. Used for enhancing the content searches.</span></div><div style="text-align:left"><span style="font-size:1rem">alert tcp any any &lt;&gt; any 80&nbsp; (msg: "GET Request Found"; content:"GET"; nocase; sid: 100001; rev:1;)</span></div></td></tr><tr><td>Fast_pattern<br></td><td><p style="text-align:left">Prioritise content search to speed up the payload search operation. By default, Snort uses the biggest content and evaluates it against the rules. "fast_pattern" option helps you select the initial packet match with the specific value for further investigation. This option always works case insensitive and can be used once per rule. Note that this option is required when using multiple "content" options.&nbsp;</p><p style="text-align:left">The following rule has two content options, and the fast_pattern option tells to snort to use the first content option (in this case, "GET") for the initial packet match.<br></p><p style="text-align:left">alert tcp any any &lt;&gt; any 80&nbsp; (msg: "GET Request Found"; content:"GET"; fast_pattern; content:"www";&nbsp; sid:100001; rev:1;)</p></td></tr></tbody></table><p style="text-align:justify"><br></p><p style="text-align:justify"><span style="font-size:18px"><span style="font-weight:bolder"><span style="font-size:24px">Non-Payload Detection Rule Options</span></span></span></p><p style="text-align:justify">There are rule options that focus on non-payload data. These options will help create specific patterns and identify network issues.</p><table class="table table-bordered"><tbody><tr><td>ID</td><td><div style="text-align:left"><span style="font-size:1rem">Filtering the IP id field.</span></div><div style="text-align:left"><span style="font-size:1rem">alert tcp any any &lt;&gt; any any (msg: "ID TEST"; id:123456; sid: 100001; rev:1;)</span></div></td></tr><tr><td>Flags<br></td><td><p style="text-align:left"><span>Filtering the <a class="cQSy659q glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;cQSy659q&#39;)">TCP</a> flags.</span></p><ul style="text-align:left"><li style="text-align:left">F - FIN</li><li style="text-align:left">S - SYN</li><li style="text-align:left">R - RST</li><li style="text-align:left">P - PSH</li><li style="text-align:left">A - ACK</li><li style="text-align:left"><span style="font-size:1rem">U - URG</span></li></ul><p style="text-align:justify"><span style="font-size:1rem"></span></p><p style="text-align:left">alert tcp any any &lt;&gt; any any (msg: "FLAG TEST"; flags:S;&nbsp; sid: 100001; rev:1;)</p></td></tr><tr><td>Dsize<br></td><td><p style="text-align:left">Filtering the packet payload size.</p><ul><li style="text-align:left">dsize:min&lt;&gt;max;</li><li style="text-align:left">dsize:&gt;100</li><li style="text-align:left">dsize:&lt;100</li></ul><p style="text-align:left">alert ip any any &lt;&gt; any any (msg: "SEQ TEST"; dsize:100&lt;&gt;300;&nbsp; sid: 100001; rev:1;)</p></td></tr><tr><td>Sameip<br></td><td><div style="text-align:left"><span style="font-size:1rem">Filtering the source and destination IP addresses for duplication.</span></div><div style="text-align:left"><span style="font-size:1rem">alert ip any any &lt;&gt; any any (msg: "SAME-IP TEST";&nbsp; sameip; sid: 100001; rev:1;)</span></div></td></tr></tbody></table><p></p><p style="text-align:justify">Remember, once you create a rule, it is a local rule and should be in your "local.rules" file. This file is located under "/etc/snort/rules/local.rules".&nbsp;<span style="font-size:1rem">A quick reminder on how to edit your local rules is shown below.</span></p><span style="font-size:16px">
</span><div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            modifying the local rules</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> gedit /etc/snort/rules/local.rules </span></span>
</code>
        </pre>
    </div>
</div><span style="font-size:16px">
</span><br><p style="text-align:justify"><span style="font-size:1rem"><span style="font-size:16px">That is your "</span>local.rules<span style="font-size:16px">" file.</span></span></p><p style="text-align:justify"><img src="./TryHackMe _ Snort_files/ce53598c877a0a4c1494223d7b19f466.png"><span style="font-size:1rem"><br></span></p><p style="text-align:justify"><span style="font-size:1rem">Note that there are some default rules activated with snort instance. These rules are deactivated to manage your rules and improve your exercise experience. For further information, please refer to the&nbsp;TASK-10&nbsp;or <a href="http://manual-snort-org.s3-website-us-east-1.amazonaws.com/" target="_blank">Snort manual</a>.</span><br></p><p style="text-align:justify">By this point, we covered the primary structure of the Snort rules. Understanding and practicing the fundamentals is suggested before creating advanced rules and using additional options.</p><p style="text-align:justify"><span style="font-size:1rem">Wow! We have covered the fundamentals of the Snort rules!&nbsp; &nbsp;</span><span style="text-align:left"><span>Now, use the attached <a class="83T8QlUx glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;83T8QlUx&#39;)">VM</a> and navigate to the&nbsp;Task-Exercises/Exercise-Files/TASK-9 folder to answer the questions!&nbsp;</span></span><span style="font-size:1rem">Note that you can use the following command to create the logs in the c</span><b style="font-size:1rem">urrent directory: <code>-l .</code></b></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="font-size:1rem;text-align:justify">Use <b>"</b></span><span style="font-size:1rem"><b>task9.pcap".</b></span><span style="font-size:1rem;text-align:justify"><b><br></b></span></p><p><span style="text-align:justify;font-size:1rem">Write a rule to filter&nbsp;</span><b style="text-align:justify;font-size:1rem">IP ID "35369"</b><span style="text-align:justify;font-size:1rem"> and run it against the given pcap file.&nbsp;</span><span style="font-size:1rem;text-align:justify">What is the request name of the detected packet?&nbsp;</span><code>snort -c local.rules -A full -l . -r task9.pcap</code></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ********* *******" value="TIMESTAMP REQUEST" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="9">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="font-size:1rem;text-align:justify">Create a rule to filter&nbsp;</span><span style="font-size:1rem;font-weight:bolder;text-align:justify">packets with Syn flag</span><span style="font-size:1rem;text-align:justify">&nbsp;and run it against the given pcap file.&nbsp;</span><span style="font-size:1rem;text-align:justify">What is the number of detected packets?</span><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *" value="1" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="9">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="text-align:justify">Clear the previous log and alarm files and d</span><span style="font-size:1rem;text-align:justify">eactivate/comment out the old rule.</span></p><p><span style="font-size:1rem;text-align:justify">Write a rule to filter&nbsp;</span><span style="font-size:1rem;font-weight:bolder;text-align:justify">packets with Push-Ack flags</span><span style="font-size:1rem;text-align:justify">&nbsp;and run it against the given pcap file.&nbsp;</span><span style="font-size:1rem;text-align:justify">What is the number of detected packets?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***" value="216" disabled="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="9">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="text-align:justify">Clear the previous log and alarm files and d</span><span style="font-size:1rem;text-align:justify">eactivate/comment out the old rule.</span></p><p><span style="font-size:1rem;text-align:justify">Create a rule to filter&nbsp;</span><span style="font-size:1rem;font-weight:bolder;text-align:justify">packets with the same source and destination IP&nbsp;</span><span style="font-size:1rem;text-align:justify">and run it against the given pcap file.&nbsp;</span><span style="font-size:1rem;text-align:justify">What is the number of detected packets?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **" value="10" disabled="">
                            <input type="hidden" value="4">
                            <input type="hidden" value="9">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="text-align:justify">Case Example -&nbsp;</span><span style="font-size:1rem;text-align:justify">An analyst modified an existing rule successfully.&nbsp;</span><span style="font-size:1rem;text-align:justify">Which rule option must the analyst change after the implementation?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***" value="rev" disabled="">
                            <input type="hidden" value="5">
                            <input type="hidden" value="9">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-10">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse10">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 10                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Snort2 Operation Logic: Points to Remember
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse10" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="text-align:justify"><span>﻿</span><span style="font-size:1rem"><b><span style="font-size:24px">P</span></b></span><span style="font-size:24px;font-weight:bolder">oints to Remember</span></p><p style="text-align:justify"><span style="font-size:1rem"><b>Main&nbsp;</b></span><span style="font-size:1rem;font-weight:bolder">Components of Snort</span></p><ul><li style="text-align:justify"><b style="font-size:1rem">Packet Decoder -&nbsp;</b>Packet collector component of Snort. It collects and prepares the packets for pre-processing.&nbsp;</li><li style="text-align:justify"><b style="font-size:1rem">Pre-processors -&nbsp;</b>A component that arranges and modifies the packets for the detection engine.</li><li style="text-align:justify"><b style="font-size:1rem">Detection Engine -&nbsp;</b>The primary component that process, dissect and analyse the packets by applying the rules.&nbsp;</li><li style="text-align:justify"><span style="font-size:1rem;font-weight:bolder">Logging and Alerting -&nbsp;</span>Log and alert generation component.</li><li style="text-align:justify"><span style="font-size:1rem;font-weight:bolder">Outputs and Plugins -&nbsp;</span>Output integration modules (i.e. alerts to syslog/mysql) and additional plugin (rule management detection plugins) support is done with this component.&nbsp;</li></ul><p style="text-align:justify"><b><span style="font-size:24px">There are three types of rules available for snort</span></b></p><ul><li style="text-align:justify"><span style="font-weight:bolder">Community Rules -&nbsp;</span>Free ruleset under the GPLv2. Publicly accessible, no need for registration.</li><li style="text-align:justify"><span style="font-weight:bolder">Registered Rules -&nbsp;</span>Free ruleset (requires registration). This ruleset contains subscriber rules with 30 days delay.</li><li style="text-align:justify"><span style="font-weight:bolder">Subscriber Rules (Paid) -&nbsp;</span>Paid ruleset&nbsp;<span style="font-size:1rem">(requires subscription)</span><span style="font-size:1rem">. This ruleset is the main ruleset and is updated twice a week (Tuesdays and Thursdays).</span></li></ul><p style="text-align:justify"><span style="font-size:1rem">You can download and read more on the rules <a href="https://www.snort.org/downloads" target="_blank">here</a>.</span></p><p style="text-align:justify"><span style="font-size:1rem"><b>Note: </b>Once you install Snort2, it automatically creates the required directories and files. However, if you want to use the community or the paid rules, you need to indicate each rule in the&nbsp;<span style="font-weight:bolder">snort.conf&nbsp;</span>file.</span></p><p style="text-align:justify"><span style="font-size:1rem">Since it is a long, all-in-one configuration file, editing it without causing misconfiguration is troublesome for some users.&nbsp;</span><b>That is why Snort has several rule updating modules and integration tools. </b><span style="font-size:1rem;font-weight:bolder">To sum up, never replace your configured Snort configuration files; you must edit your configuration files manually or update your rules with additional tools and modules to not face any fail/crash or lack of feature.</span></p><div style="text-align:justify"><ul style="text-align:left"><li style="text-align:justify"><span style="font-weight:bolder">snort.conf:&nbsp;</span><i>Main configuration file.</i></li><li style="text-align:justify"><span style="font-weight:bolder">local.rules:</span>&nbsp;<i>User-generated rules file.</i></li></ul></div><p style="text-align:justify"><span style="font-size:1rem"><b>Let's start with overviewing the main configuration file&nbsp;(snort.conf)&nbsp;</b></span><code>sudo gedit /etc/snort/snort.conf</code></p><p style="text-align:justify"><b><span style="font-size:18px">Navigate to the "Step #1: Set the network variables." section.</span></b></p><p style="text-align:justify">This section manages the scope of the detection and rule paths.<br></p><table class="table table-bordered" style="width:1074.66px"><tbody><tr><td><b>TAG NAME</b></td><td><b>INFO</b></td><td><b>EXAMPLE</b></td></tr><tr><td><span style="font-weight:700;text-align:justify">HOME_NET</span><br></td><td style="text-align:left"><span style="text-align:justify">That is where we are protecting.</span><br></td><td>&nbsp;'any' OR '192.168.1.1/24'<br></td></tr><tr><td><span style="font-weight:700;text-align:justify">EXTERNAL_NET&nbsp;</span><br></td><td style="text-align:left"><span style="text-align:justify">This field is the external network, so we need to keep it as 'any' or '!$HOME_NET'.</span><br></td><td>'any' OR '!$HOME_NET'<br></td></tr><tr><td><span style="font-weight:900;text-align:justify">RULE_PATH</span><br></td><td style="text-align:left">Hardcoded rule path.<br></td><td><span style="text-align:justify">/etc/snort/rules</span><br></td></tr><tr><td><span style="font-weight:700;text-align:justify">SO_RULE_PATH</span><br></td><td style="text-align:left"><i>These rules come with registered and subscriber rules.</i><br></td><td><span style="text-align:justify">$RULE_PATH/so_rules</span><br></td></tr><tr><td><span style="font-weight:700;text-align:justify">PREPROC_RULE_PATH</span><br></td><td style="text-align:left"><i>These rules come with registered and subscriber rules.</i><br></td><td><span style="text-align:justify">$RULE_PATH/plugin_rules</span><br></td></tr></tbody></table><p style="text-align:justify"></p><p style="text-align:justify"><span style="font-size:1rem;font-weight:bolder"><br></span><b style="font-size:1rem"><span style="font-size:18px">Navigate to the "Step #2: Configure the decoder." section.</span></b><span style="font-size:1rem;font-weight:bolder"><br></span></p><p style="text-align:justify"><span style="font-size:1rem"><span>In this section, you manage the <a class="iZ2VPWgP glossary-term" onclick="initPopOver(&#39;IPS&#39;, &#39;iZ2VPWgP&#39;)">IPS</a> mode of snort. The single-node installation model IPS model works best with "afpacket" mode. You can enable this mode and run Snort in IPS.</span></span></p><table class="table table-bordered"><tbody><tr><td><b>TAG NAME</b></td><td><b>INFO</b></td><td><b>EXAMPLE</b></td></tr><tr><td><b>#config daq:</b></td><td><span><a class="0J7fTc78 glossary-term" onclick="initPopOver(&#39;IPS&#39;, &#39;0J7fTc78&#39;)">IPS</a> mode selection.</span></td><td>afpacket</td></tr><tr><td><b>#config daq_mode:</b></td><td>Activating the inline mode</td><td>inline</td></tr><tr><td><b>#config logdir:</b></td><td>Hardcoded default log path.</td><td>/var/logs/snort</td></tr></tbody></table><p style="text-align:justify"><span style="font-size:1rem"><span>Data Acquisition Modules (<a class="h5rBYPNG glossary-term" onclick="initPopOver(&#39;DAQ&#39;, &#39;h5rBYPNG&#39;)">DAQ</a>) are specific libraries used for packet I/O, bringing flexibility to process packets. It is possible to select DAQ type and mode for different purposes.</span></span></p><p style="text-align:justify"><span style="font-size:1rem"><span>There are six <a class="VUPljWcx glossary-term" onclick="initPopOver(&#39;DAQ&#39;, &#39;VUPljWcx&#39;)">DAQ</a> modules available in Snort;</span></span></p><ul><li style="text-align:justify"><span style="font-size:1rem"><b>Pcap:</b> Default mode, known as Sniffer mode.</span></li><li style="text-align:justify"><span style="font-size:1rem"><b>Afpacket:</b><span> Inline mode, known as <a class="D8REsg5X glossary-term" onclick="initPopOver(&#39;IPS&#39;, &#39;D8REsg5X&#39;)">IPS</a> mode.</span></span></li><li style="text-align:justify"><span style="font-size:1rem"><b>Ipq:</b><span> Inline mode on <a class="muFqCQrp glossary-term" onclick="initPopOver(&#39;Linux&#39;, &#39;muFqCQrp&#39;)">Linux</a> by using Netfilter. It replaces the snort_inline patch.&nbsp;&nbsp;</span></span></li><li style="text-align:justify"><span style="font-size:1rem"><b>Nfq:</b><span> Inline mode on <a class="x3fT5HTe glossary-term" onclick="initPopOver(&#39;Linux&#39;, &#39;x3fT5HTe&#39;)">Linux</a>.</span></span></li><li style="text-align:justify"><span style="font-size:1rem"><b>Ipfw:</b> Inline on OpenBSD and FreeBSD by using divert sockets, with the pf and ipfw firewalls.</span><br></li><li style="text-align:justify"><span style="font-size:1rem"><b>Dump:</b> Testing mode of inline and normalisation.</span></li></ul><p style="text-align:justify">The most popular modes are the default (pcap) and inline/IPS (Afpacket).</p><p style="text-align:justify"><b><span style="font-size:18px">Navigate to the "Step #6: Configure output plugins" section.</span></b></p><p style="text-align:justify">This section manages the outputs of the IDS/IPS actions, such as logging and alerting format details. The default action prompts everything in the console application, so configuring this part will help you use the Snort more efficiently.&nbsp;</p><p style="text-align:justify"><b><span style="font-size:18px">Navigate to the "Step #7: Customise your ruleset" section.</span></b><br></p><table class="table table-bordered"><tbody><tr><td><b>TAG NAME</b></td><td style="text-align:center"><b>INFO</b></td><td><b>EXAMPLE</b></td></tr><tr><td><b># site specific rules</b><br></td><td style="text-align:left">Hardcoded local and user-generated rules path.</td><td>include $RULE_PATH/local.rules<br></td></tr><tr><td><b>#include $RULE_PATH/</b><br></td><td style="text-align:left">Hardcoded default/downloaded rules path.<br></td><td>include $RULE_PATH/rulename</td></tr></tbody></table><p style="text-align:justify"><span style="font-size:1rem;text-align:left;font-weight:bolder">Note that "#" is commenting operator. You should uncomment a line to activate it.</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Read the task above.
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-11">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse11">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 11                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Conclusion
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-download text-lblue" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a downloadable file"></i></span>
                        </a>
                    </div>
                    <div id="collapse11" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><form class="float-right" method="post" action="https://tryhackme.com/material/deploy">
                            <input type="hidden" name="roomCode" value="snort">
                            <input type="hidden" name="id" value="62307840e9894700553e98d7">
                            <button type="submit" class="btn btn-primary mb-3 ml-3" value="Download">
                            <i class="fas fa-cloud-download-alt mr-2"></i> Download Task Files</button>
                        </form> <p><span style="font-size:1rem">In this room, we covered Snort, what it is, how it operates, and how to create and use the rules to investigate threats.</span><br></p><ul><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Understanding and practising the fundamentals is crucial before creating advanced rules and using additional options.</span></li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Do not create complex rules at once; try to add options step by step to notice possible syntax errors or any other problem easily.</span></li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Do not reinvent the wheel; use it or modify/enhance it if there is a smooth rule.</span></li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Take a backup of the configuration files before making any change.</span></li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background-color:transparent;font-size:1rem">Never delete a rule that works properly. Comment it if you don't need it.</span><br></li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Test newly created rules before migrating them to production.</span></li></ul><p><span style="text-align:justify">Now, we invite you to complete the snort challenge room:&nbsp;</span><a href="https://tryhackme.com/room/snortchallenges1" target="_blank">Snort Challenge - Live Attacks</a></p><p><span style="font-size:1rem">A great way to quickly recall snort rules and commands is to download and refer to the TryHackMe snort cheatsheet.</span></p><p><span style="text-align:justify"></span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                &nbsp;Read the task above.
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="11">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div></div>
</div>
<div id="room-simple-details"><div class="card cd-2 text-center mt-3"><div class="card-body"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Snort_files/af7feb2c43a2c7d5f111b98ccbd15048.png"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme">tryhackme</a> and <img class="avatar-tiny" src="./TryHackMe _ Snort_files/1a02ec129689db6aef26e1cc16fb6d93.jpg"> 
        <a class="green-link" href="https://tryhackme.com/p/ujohn">ujohn</a></p><p class="mb-0">This is a <b>free</b> room, which means anyone can deploy virtual machines in the room 
        (without being subscribed)! 24598 users are in here and this room is 490 days old.</p></div></div></div>

</div>
</div>
</div>
<div id="room-content-attackbox">
<div id="room-attackbox">
<div id="attackbox-machine-instance">
<div id="room-attackbox-loading"></div>
<div id="room-attackbox-vm-view"></div>
</div>
<div id="attackbox-machine-options">
<div class="d-flex">
<a target="_blank" id="room-attackbox-url" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="View in full screen"></a>
<div onclick="extendHourWebBasedVM(null)" class="hover-pointer" id="room-attackbox-extend" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Extend machines timer"><i class="fas fa-plus"></i></div>
<div onclick="terminateWebBasedVM(null)" class="hover-pointer" id="room-attackbox-terminate" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Terminate Machine"><i class="far fa-power-off"></i></div>
<div onclick="exitViewAttackBox()" class="hover-pointer" id="room-attackbox-exitview" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Exit split view"><i class="fas fa-minus"></i></div>
<div onclick="infoAttackBox()" class="hover-pointer faded" id="room-attackbox-info" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Machine Information"><i class="fas fa-info"></i></div>
<div class="d-flex" id="room-attackbox-tabs"></div>
</div>
<div id="room-attackbox-expire-text" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Time left until your AttackBox expires"></div>
</div>
</div>
<div class="modal fade" id="attackBoxInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-light-gray">
<h5 class="modal-title m-auto">Web-Based Machine Information</h5>
</div>
<div class="modal-body">
<p>Use the web-based machine to attack other target machines you start on TryHackMe.</p>
<ul class="normalList text-gray mt-3 mb-4">
<li>Public IP: <code id="browser-machine-pubip" class="dark size-14"></code></li>
<li class="mt-1">Private IP: <code id="browser-machine-privip" class="dark size-14"></code> <span class="size-14">(Use this for your reverse shells)</span></li>
<li class="mt-1">Username: <code id="browser-username" class="dark size-14"></code></li>
<li class="mt-1">Password: <code id="browser-password" class="dark size-14"></code></li>
<li class="mt-1">Protocol: <code id="browser-protocol" class="dark size-14"></code></li>
</ul>
<hr class="hr-min">
<ul class="text-lgray mb-0">
<li class="mt-2">To copy to and from the browser-based machine, highlight the text and press <b>CTRL+SHIFT+C</b> <details><summary>or use the clipboard</summary><img src="./TryHackMe _ Snort_files/clipboard.gif"></details></li>
<li class="mt-2">When accessing target machines you start on TryHackMe tasks, make sure you're using the correct IP (it <b>should not be</b> the IP of your AttackBox)</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="award-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<button type="button" class="close size-30 text-lgray" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<div id="award-modal-badges"></div>
<p class="mb-0 text-lgray size-18">Complete the room to earn this badge</p>
</div>
</div>
</div>
</div>
<div class="modal fade" id="hint-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title"><i class="fal fa-lightbulb-on"></i> Question Hint</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body"></div>
</div>
</div>
</div>
<div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">...</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center"></div>
<div class="modal-footer"></div>
</div>
</div>
</div>
<link rel="stylesheet" href="./TryHackMe _ Snort_files/modal.css">
<div class="modal-design-green modal fade" id="roomCompleted" tabindex="-1" role="dialog" data-backdrop="static" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content" id="roomCompletedModalContent">
<div class="modal-body text-center">
<button type="button" class="close" id="closeRoomComplete" aria-label="Close">
<i class="fad fa-times-circle"></i>
</button>
<div class="icon-box">
<i class="fad fa-badge-check"></i>
</div>
<h3 class="text-accent mt-5">Congratulations</h3>
<p class="faded mt-1">You've completed the room! Share this with your friends: </p>
<h2 id="roomCompleted-share"></h2>
<div id="ticket-info"></div> 
<p class="faded mt-1" id="roomFeedbackBtn">
<small>
<button class="bg-white border-0">Leave
feedback</button>
</small>
</p>
<form method="post" action="https://tryhackme.com/feedback" id="roomFeedbackForm" class="d-none mt-3">
<input type="hidden" name="_csrf" value="SAfIghKh-GbHilrL4CnKnKasao-jBU1AtTHw">
<input type="hidden" name="roomCode" value="snort">
<input type="hidden" name="type" value="rooms">
<input type="hidden" name="redirect" value="json">
<div class="form-group">
<label class="mb-0" for="like">What do you like about the room?</label>
<textarea type="text" name="like" id="like" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="dislike">What don't you like about the room?</label>
<textarea type="text" name="dislike" id="dislike" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="details">Please send your suggestions, ideas and comments!</label>
<textarea id="details" type="text" name="details" class="form-control" style="padding: 5px;"></textarea>
</div>
<button type="submit" id="submitBtn" class="btn btn-success">Send Feedback</button>
</form>
<p class="mt-2 mb-0" id="formMessage"></p>
</div>
</div>
</div>
<script>
    function dismissRoomCompleteModal() {
      $('#roomCompleted').modal('hide');

      const shouldSeeReferralModal = ""
      if (shouldSeeReferralModal) {
        $('#unlockCreditModal').modal('show');

        referralModalEvent('view');
      }
    }

    document.getElementById('closeRoomComplete').addEventListener('click', dismissRoomCompleteModal)
  </script>
</div>
<script src="./TryHackMe _ Snort_files/roomFeedback.js"></script>
<div class="modal fade" id="roomStartAttackboxModal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static" data-keyboard="false">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title m-auto">To access this machine, you need to either</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close" style="position: absolute; right: 10px; top: 0; font-size: 30px;">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center">
<div class="row vertical-align-custom mb-0">
<div class="col-sm-5 pr-0">
<p class="size-18 bold">Use a VPN</p>
<p>Connect to our network via a VPN</p>
<a target="_blank" href="https://tryhackme.com/access"><button type="button" class="btn btn-light">See Instructions</button></a>
</div>
<div class="col-sm-2 size-24">
or
</div>
<div class="col-sm-5 pl-0">
<p class="size-18 bold">Use the AttackBox</p>
<p>Use a web-based attack machine <span class="size-12">(recommended)</span></p>
<button type="button" onclick="$(&#39;#roomStartAttackboxModal&#39;).modal(&#39;toggle&#39;); startAttackBox({startingMsg: false, tutorial: true})" class="btn btn-hgreen">Start AttackBox</button>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="expireSoon" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-warning fad fa-exclamation-triangle"></i></h1>
<h3 class="text-warning">Expiring Soon</h3>
<p class="faded mt-3 mb-0">Your machine is going to expire soon. Close this and add an hour to stop it from terminating!</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="terminatedMachine" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-danger fad fa-exclamation-triangle"></i></h1>
<h3 class="text-danger">Expired Machine</h3>
<p class="faded mt-3 mb-0">Your machine has expired and terminated.</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="machineDeployModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue text-center p-3">
<h4 class="mb-0 m-auto">How to access machines</h4>
<button type="button" class="close modal-close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center">
<p class="size-18 faded">Now you've started your machine, to access it you need to either</p>
<div class="row mb-0">
<div class="col-sm-6">
<img src="./TryHackMe _ Snort_files/connect_openvpn_short.png">
<p class="mt-2 mb-0 faded">Download your VPN configuration file and import it into a OpenVPN client</p>
</div>
<div class="col-sm-6">
<img src="./TryHackMe _ Snort_files/connect_kali_short.png">
<p class="mt-2 mb-0 faded">Control a web-based machine with everything you need, all from inside your browser</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="roomAlertModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title" id="roomAlertModalTitle"></h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body" id="roomAlertModalBody"></div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="resetUserProgressModal" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">Reset Your Progress</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<div><span class="text-danger"><i class="fas fa-exclamation-triangle"></i> Warning</span> You will keep your points but all your answers in this room will be erased.</div>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-danger" onclick="resetProgress()">Yes, please!</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="cloudEnvInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header  modal-dark-blue">
<h5 class="modal-title">Cloud Information</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<ul class="nav nav-tabs">
<li class="nav-item pr-2">
<a class="nav-link active" data-toggle="tab" href="https://tryhackme.com/room/snort#env-tab">Environment</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/snort#creds-tab">Credentials</a>
</li>
</ul>
<div class="tab-content">
<div class="tab-pane active" id="env-tab"></div>
<div class="tab-pane" id="creds-tab"></div>
</div>
</div>
<div class="modal-footer" id="cloudEnvModalFooter">
</div>
</div>
</div>
</div>
<div class="modal fade" id="setNameModal" role="dialog">
<div class="modal-dialog modal-lg modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title">Generating Your Certificate</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body container">
<div class="row">
<div class="col-6">
<h5 class="bold">Hey there, what's your name?</h5>
<p class="text-secondary">
If you want your name to appear on your certificate, please fill the field below.
</p>
<div class="form-group">
<label>Full Name </label>
<input id="modal-cert-field-name" type="text" placeholder="John Wick" class="mb-4 form-control">
<input id="modal-cert-field-email" type="hidden" value="giftonpaul@karunya.edu.in">
</div>
</div>
<div class="col-6">
<h5 class="bold">You're here incognito? It's ok!</h5>
<p class="text-secondary">If you chose skip, your username will be used instead!</p>
</div>
</div>
<div class="row">
<div class="col-6">
<button type="button" class="btn btn-success float-right" id="modal-cert-generate" onclick="gen_cert(true)" disabled="">
Generate with my full name
</button>
</div>
<div class="col-6">
<button type="button" class="btn btn-primary float-right" id="modal-cert-skip" onclick="gen_cert(false)">
Generate with my username
</button>
</div>
</div>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Snort_files/certificateName.js"></script>
<div class="modal fade slideout-faq" id="roomSlideoutUnstuck" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-links">
<div id="unstuck-video" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-play"></i></div>
<div class="unstuck-icon-text">Video Solution</div>
</div>
<div id="unstuck-writeups" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-pen-alt"></i></div>
<div class="unstuck-icon-text">Writeups</div>
</div>
<a id="unstuck-forum" target="_blank" class="clear-link unstuck-group" href="https://tryhackme.com/forum/thread/622fdb56b420100a71b8b471">
<div class="unstuck-icon"><i class="fas fa-comments-alt"></i></div>
<div class="unstuck-icon-text">Forum Post</div>
</a>
<a href="https://help.tryhackme.com/en/collections/3601905-getting-started-with-tryhackme" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-books"></i></div>
<div class="unstuck-icon-text">Knowledge Base</div>
</a>
<a href="https://discord.gg/DpBZz8y" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-users"></i></div>
<div class="unstuck-icon-text">Ask Community</div>
</a>
</div>
</div>
</div>
</div>
</div>
<style>

    #navConnModal .modal-body{
        position: relative;
    }

    #nav-openvpn,
    #nav-attackbox {
        display: none;
    }

    #nav-openvpn .nav-pills .nav-link.active,
    #nav-openvpn .nav-pills .show>.nav-link {
        background-color: #ec8e3d;
        color: white;
    }
    #nav-openvpn .nav-link {
        color: #909090;
    }
    #nav-openvpn a,
    #nav-attackbox a {
        color: #ec8e3d;
    }

    #nav-openvpn code.dark {
        background-color: #7d400a;
        color: #fff;
    }

    #slideout-bk {
        display: none;
        padding: 10px 15px;
        opacity: 0.8;
        cursor: pointer;
    }

    #slideout-bk:hover {
        opacity: 1;
    }

    #slideout-conn-hideip {
        display: none;
        position: absolute;
        bottom: 8px;
        right: 8px;
        opacity: 0.7;
        cursor: pointer;
    }

    #slideout-conn-hideip:hover {
        opacity: 1;
    }

</style>
<div class="modal fade slideout-faq" id="navConnModal" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-bk" class="noselect" onclick="showSlideoutConnOptions()"><i class="far fa-arrow-left mr-2"></i> Show Connection Options</div>
<div id="slideout-conn-options">
<div id="slideout-conn-header" class="text-center">
<img class="slideout-connect-img" src="./TryHackMe _ Snort_files/tryhackme_connect.png">
<div id="slideout-conn-status" class="size-22"></div>
</div>
<div class="m-3 text-center">
<p>To access target machines you need to either:</p>
<div class="row mb-3 faq-quicklinks text-left vertical-align-custom">
<div class="col-md-12 mb-3">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/snort#" onclick="showAttackBoxSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-laptop"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">AttackBox</div>
<p class="faded mb-0">Use a browser-based attack machine</p>
</div>
</div>
</div>
</a>
</div>
<div class="col-md-12">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/snort#" onclick="showVPNSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-key"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">OpenVPN</div>
<p class="faded mb-0">Connect to our network via a VPN</p>
</div>
</div>
</div>
</a>
</div>
</div>
</div>
</div>
<div id="faqCards" class="p-3">
<div id="nav-openvpn">
<div class="mb-3">
<a target="_blank" href="https://tryhackme.com/access"><i>View the dedicated OpenVPN access page for more information</i></a>
</div>
<div class="text-center">
<h4>What Operating System are you using?</h4>
<ul class="nav nav-pills mb-3 text-center" id="vpn-guide" style="display: flex; justify-content: center;">
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/snort#pills-windows" role="tab" aria-controls="pills-windows" aria-selected="true"><i class="fab fa-windows mr-2"></i> Windows</a>
</li>
<li class="nav-item m-3">
<a class="nav-link active" data-toggle="pill" href="https://tryhackme.com/room/snort#pills-linux" role="tab" aria-controls="pills-linux" aria-selected="false"><i class="fab fa-linux mr-2"></i> Linux</a>
</li>
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/snort#pills-macos" role="tab" aria-controls="pills-macos" aria-selected="false"><i class="fab fa-apple mr-2"></i> MacOS</a>
</li>
</ul>
<div class="tab-content text-left">
<div class="tab-pane fade" id="pills-windows" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a target="_blank" href="https://openvpn.net/client-connect-vpn-for-windows/">Download</a> the OpenVPN GUI application.</li>
<li class="mt-2">Install the OpenVPN GUI application. Then open the installer file and follow the setup wizard.</li>
<li class="mt-2">Open and run the OpenVPN GUI application as Administrator.<br><img class="mt-2 mb-3" src="./TryHackMe _ Snort_files/win_ran_admin.png"></li>
<li class="mt-2">The application will start running in the system tray. It's at the bottom of your screen, near the clock. Right click on the application and click <b>Import File</b>. <br><img class="mt-2 mb-3" src="./TryHackMe _ Snort_files/win_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Now right click on the application again, select your file and click Connect <br><img class="mt-2 mb-3" src="./TryHackMe _ Snort_files/win_connect.png"></li>
</ol>
</div>
<div class="tab-pane fade show active" id="pills-linux" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2">Run the following command in your terminal: <code class="dark">sudo apt install openvpn</code></li>
<li class="mt-2">Locate the full path to your VPN configuration file (normally in your ~/Downloads folder).</li>
<li class="mt-2">Use your OpenVPN file with the following command: <code class="dark">sudo openvpn /path/to/file.ovpn</code></li>
</ol>
</div>
<div class="tab-pane fade" id="pills-macos" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a href="https://openvpn.net/downloads/openvpn-connect-v2-macos.dmg">Download</a> OpenVPN for MacOS.</li>
<li class="mt-2">Install the OpenVPN GUI application, by opening the dmg file and following the setup wizard.<br><img width="250" class="mt-2 mb-3" src="./TryHackMe _ Snort_files/mac_installer.png"></li>
<li class="mt-2">Open and run the OpenVPN GUI application.</li>
<li class="mt-2">The application will start running and appear in your top bar. Right click on the application and click <b>Import File -&gt; Local file</b>.<br><img class="mt-2 mb-3" src="./TryHackMe _ Snort_files/mac_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Right click on the application again, select your file and click connect.<br><img class="mt-2 mb-3" src="./TryHackMe _ Snort_files/mac_connect.png"></li>
</ol>
</div>
</div>
<section class="text-left">
<a class="remove-underline" data-toggle="collapse" href="https://tryhackme.com/room/snort#havingProblems" role="button" aria-expanded="false" aria-controls="havingProblems">
<h5 class="mb-0 text-openvpn">Having Problems?</h5>
</a>
<div class="collapse" id="havingProblems">
<ul class="mt-2 mb-0">
<li>If you can access <a target="_blank" href="http://10.10.10.10/">10.10.10.10</a>, you're connected.</li>
<li>Downloading and getting a 404? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>Getting inline cert error? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>If you are using a virtual machine, you will need to run the VPN inside that machine.</li>
<li>Is the OpenVPN client running as root? <span class="size-14 faded">(On Windows, run OpenVPN GUI as administrator. On Linux, run with sudo)</span></li>
<li>Have you restarted your VM?</li>
<li>Is your OpenVPN up-to-date?</li>
<li>Only 1 OpenVPN connection is allowed. <span class="size-14 faded">(Run <code class="dark">ps aux | grep openvpn</code> - are there 2 VPN sessions running?)</span></li>
<li>Still having issues? Check our <a href="https://help.tryhackme.com/en/articles/6496029-openvpn-general-troubleshooting-detailed/">docs</a> out.</li>
</ul>
</div>
</section>
</div>
</div>
<div id="nav-attackbox">
<div class="text-center">
<h4>AttackBox</h4>
<p class="faded">Use your own web-based linux machine to access machines on TryHackMe</p>
</div>
<p>To start your AttackBox in the room, click the <a class="preventDefault" onclick="showAttackBoxBtnFromSlideout()" href="https://tryhackme.com/room/snort#">Start AttackBox</a> button. Your private machine will take 2 minutes to start.</p>
<p>Free users get 1 free AttackBox hour. <a class="hacker-green" href="https://tryhackme.com/why-subscribe">Subscribed</a> users get more powerful machines with unlimited deploys.</p>
</div>
</div>
<span id="slideout-conn-hideip" onclick="hideNavConnIP()">Hide IP</span>
</div>
</div>
</div>
</div>
<script>

    const navConnVPNEl = document.querySelector('#nav-openvpn')
    const navConnAttackBoxEl = document.querySelector('#nav-attackbox')
    const navConnOptions = document.querySelector('#slideout-conn-options')

    const navConnBkBtn = document.querySelector('#slideout-bk')

    function showVPNSteps() {
        navConnOptions.style.display = 'none'
        navConnVPNEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showAttackBoxSteps() {
        navConnOptions.style.display = 'none'
        navConnAttackBoxEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showSlideoutConnOptions() {
        navConnVPNEl.style.display = 'none'
        navConnAttackBoxEl.style.display = 'none'
        navConnBkBtn.style.display = 'none'
        navConnOptions.style.display = 'block'
    }

    function showAttackBoxBtnFromSlideout() {
        $('#navConnModal').modal('toggle')
        setTimeout(function() {
            showAttackBoxBtnIntro()
        }, 100)   
    }

  </script>
</div>
<script src="./TryHackMe _ Snort_files/notify.js"></script>
<script src="./TryHackMe _ Snort_files/api-requests.js"></script>
<script src="./TryHackMe _ Snort_files/events.js"></script>
<script src="./TryHackMe _ Snort_files/underscore-min.js"></script>
<script src="./TryHackMe _ Snort_files/apexcharts.min.js"></script> 
<script src="./TryHackMe _ Snort_files/chart.js"></script>
<script src="./TryHackMe _ Snort_files/expire.js"></script>
<script src="./TryHackMe _ Snort_files/sockets.js"></script>
<script src="./TryHackMe _ Snort_files/faqSearch.js"></script>
<script src="./TryHackMe _ Snort_files/certificate.js"></script>
<script src="./TryHackMe _ Snort_files/utils.js"></script>
<script src="./TryHackMe _ Snort_files/roomSpecific.js"></script>
<script src="./TryHackMe _ Snort_files/confetti.js"></script>
<script src="./TryHackMe _ Snort_files/videos.js"></script>
<script src="./TryHackMe _ Snort_files/intro.js"></script>
<script src="./TryHackMe _ Snort_files/prism.js"></script>
<script src="./TryHackMe _ Snort_files/asciinema-player.js"></script>
<script src="./TryHackMe _ Snort_files/magnific-popup.min.js"></script>
<script src="./TryHackMe _ Snort_files/introjsLogic.js"></script>
<script src="./TryHackMe _ Snort_files/logic.js"></script>
<script src="./TryHackMe _ Snort_files/tasks.js"></script>
<script src="./TryHackMe _ Snort_files/connection-status.js"></script>
<script src="./TryHackMe _ Snort_files/glossary.js"></script>
<script src="./TryHackMe _ Snort_files/room-mymachine.js"></script>
<script src="./TryHackMe _ Snort_files/heartbeat.js" defer=""></script>
<script>

    let height
    $(window).scroll(function () { /* Function to make IP information sticky. */
      if (height == undefined || height < 30) {
        height = ($('#instance-info').offset().top)
      }
      let scroll = $(window).scrollTop()
      if (((scroll >= (height + 150))) && height > 30) {
        $("#instance-info").addClass('instance-sticky')
      } else if ((scroll <= (height))) {
        $("#instance-info").removeClass("instance-sticky")
      }
    })

    const csrfToken = "SAfIghKh-GbHilrL4CnKnKasao-jBU1AtTHw"
    $.ajaxSetup({ headers: { 'CSRF-Token': csrfToken } }) // all $.post headers include token (needs csrfProtection middleware)

    const roomCode = "snort"
    const simpleRoom = true 
    const events = {"tickets":false}

    let userObj = { 
      subscribed: 1,
      splitScreen: true,
      path: "soclevel1",
      tutorial: {
        rooms: true,
        attackbox: true,
        staticsite: true
      },
      experiments:  JSON.parse(`{"onboardingAchievement":{},"scheduler":{"startDate":"2023-06-14T13:38:51.108Z"},"showEasyPath":true}`),
    }

    const roomSettings = {
      remAttackBoxBtn : true
    };

    const heartbeatInterval = 30;

    const cloudEnabled = false 
    let cloudObj

    initRoom()
    checkVideoTab()
    if(!simpleRoom) showChart(roomCode)

    checkRoomAwards(roomCode)

    getRoomVotes()

    displayStreakFreezeAwardedFromMemory();
    
    window.addEventListener('load', function () {
      introjsInit(roomCode)
    })

  </script>


<svg id="SvgjsSvg1001" width="2" height="0" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.dev" style="overflow: hidden; top: -100%; left: -100%; position: absolute; opacity: 0;"><defs id="SvgjsDefs1002"></defs><polyline id="SvgjsPolyline1003" points="0,0"></polyline><path id="SvgjsPath1004" d="M0 0 "></path></svg><div id="DF7BA288-E233-3333-8877-CD6E78797F28"></div><iframe id="_hjSafeContext_18875554" title="_hjSafeContext" tabindex="-1" aria-hidden="true" src="./TryHackMe _ Snort_files/saved_resource.html" style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;"></iframe><iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" aria-hidden="true" tabindex="-1" title="Intercom" src="./TryHackMe _ Snort_files/saved_resource(1).html"></iframe><div class="intercom-lightweight-app"><div class="intercom-lightweight-app-launcher intercom-launcher" role="button" tabindex="0" aria-label="Open Intercom Messenger" aria-live="polite"><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-open"><img src="./TryHackMe _ Snort_files/9e0f012f15b6fc981dde2f1f5198d728.png" alt="" class="intercom-lightweight-app-launcher-custom-icon-open"></div><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-minimize"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M18.601 8.39897C18.269 8.06702 17.7309 8.06702 17.3989 8.39897L12 13.7979L6.60099 8.39897C6.26904 8.06702 5.73086 8.06702 5.39891 8.39897C5.06696 8.73091 5.06696 9.2691 5.39891 9.60105L11.3989 15.601C11.7309 15.933 12.269 15.933 12.601 15.601L18.601 9.60105C18.9329 9.2691 18.9329 8.73091 18.601 8.39897Z" fill="white"></path>
</svg>
</div></div><style id="intercom-lightweight-app-style" type="text/css">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    0% {
      opacity: 0;
      transform: scale(0);
    }
    40% {
      opacity: 1;
    }
    100% {
      transform: scale(1);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji", Helvetica, Arial, sans-serif;
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    padding: 0 !important;
    margin: 0 !important;
    border: none;
    bottom: 20px;
    right: 20px;
    max-width: 48px;
    width: 48px;
    max-height: 48px;
    height: 48px;
    border-radius: 50%;
    background: #1C2538;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    transition: transform 167ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    box-sizing: content-box;
  }


  .intercom-lightweight-app-launcher:hover {
    transition: transform 250ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    transform: scale(1.1)
  }

  .intercom-lightweight-app-launcher:active {
    transform: scale(0.85);
    transition: transform 134ms cubic-bezier(0.45, 0, 0.2, 1);
  }


  .intercom-lightweight-app-launcher:focus {
    outline: none;

    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 48px;
    height: 48px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 24px;
    height: 24px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 44px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 24px;
    max-width: 24px;

    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: white;
    animation: intercom-lightweight-app-messenger 250ms cubic-bezier(0, 1, 1, 1);
    transform-origin: bottom right;
    
        width: 400px;
        height: calc(100% - 104px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 84px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
      

    border-radius: 16px;
  }

  .intercom-lightweight-app-messenger-header {
    height: 64px;
    border-bottom: none;
    background: #1c2538

    
  }

  .intercom-lightweight-app-messenger-footer{
    position:absolute;
    bottom:0;
    width: 100%;
    height: 80px;
    background: #fff;
    font-size: 14px;
    line-height: 21px;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0px 0px 25px rgba(0, 0, 0, 0.05);
    
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div></body></html>