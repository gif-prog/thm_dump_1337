<!DOCTYPE html>
<!-- saved from url=(0036)https://tryhackme.com/room/introtoav -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>TryHackMe | Introduction to Antivirus</title>
<meta name="description" content="Understand how antivirus software works and what detection techniques are used to bypass malicious file checks.">
<meta name="og:description" content="Understand how antivirus software works and what detection techniques are used to bypass malicious file checks.">
<meta name="keywords" content="cyber,security,cyber security,cyber security training,coding,computer,bitcoin,hacking,hackers,hacks,hack,exploits,keylogger,learn,poc">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<meta property="og:site_name" content="TryHackMe">
<meta property="og:title" content="TryHackMe | Introduction to Antivirus">
<meta property="og:image" content="https://tryhackme-images.s3.amazonaws.com/room-icons/0ad87658878df43e1232587177221386.png">
<meta property="og:url" content="https://tryhackme.com/room/introtoav">
<meta name="twitter:image" content="https://tryhackme.com/img/meta/default.png">
<meta property="og:description" content="Understand how antivirus software works and what detection techniques are used to bypass malicious file checks.">

<script type="text/javascript" async="" src="./TryHackMe _ Introduction to Antivirus_files/pgpbhph6"></script><script src="./TryHackMe _ Introduction to Antivirus_files/jquery.min.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/popper.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Introduction to Antivirus_files/boostrap431.min.css">
<script src="./TryHackMe _ Introduction to Antivirus_files/bootstrap431.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Introduction to Antivirus_files/animate.min.css">
<link rel="stylesheet" href="./TryHackMe _ Introduction to Antivirus_files/all.css" integrity="sha384-ekOryaXPbeCpWQNxMwSWVvQ0+1VrStoPJq54shlYhR8HzQgig1v5fas6YgOqLoKz" crossorigin="anonymous">
<link rel="icon" type="image/png" href="https://assets.tryhackme.com/img/favicon.png">
<link rel="stylesheet" media="screen" href="./TryHackMe _ Introduction to Antivirus_files/general-style.css">
<script src="./TryHackMe _ Introduction to Antivirus_files/script.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/validation.js"></script>

<link rel="stylesheet" type="text/css" href="./TryHackMe _ Introduction to Antivirus_files/cookieconsent.min.css">
<script src="./TryHackMe _ Introduction to Antivirus_files/cookieconsent.min.js"></script>
<script async="" src="./TryHackMe _ Introduction to Antivirus_files/js"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-Z8D4WL3D4P');
  </script>


<script>
    window.intercomSettings = {
      api_base: "https://api-iam.intercom.io",
      app_id: "pgpbhph6"
    };
  </script>
<script>
    (function (h, o, t, j, a, r) {
      h.hj = h.hj || function () { (h.hj.q = h.hj.q || []).push(arguments) };
      h._hjSettings = { hjid: 1950941, hjsv: 6 };
      a = o.getElementsByTagName('head')[0];
      r = o.createElement('script'); r.async = 1;
      r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
      a.appendChild(r);
    })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
  </script><script async="" src="./TryHackMe _ Introduction to Antivirus_files/hotjar-1950941.js"></script>
<script>
    /* Global javascript variables */

    // Used inside script.js for createRooms compelted users.
    const username = 'Silv3rsurf3r'
    const subscribed = '1'
    const level = '10'
    const intercomEnabled = 'true'
  </script>
<script>
    //add back tracking info
    const userId = "63d14e7f857ae10041bb192f"
    let tutorialComplete = false
    if ('false' == "true") {
      tutorialComplete = true
    }
    if(intercomEnabled === "true"){
      window.intercomSettings = {
        api_base: "https://api-iam.intercom.io",
        app_id: "pgpbhph6",
        user_id: userId,
        username: username,
        email: "giftonpaul@karunya.edu.in",
        created_at: Math.floor(new Date("Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)").getTime() / 1000) // Signup date as a Unix timestamp
      };
    }
    window.hj('identify', userId, {
      displayName: username,
      subscribed: "1",
      dateSignUp: "Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)",
      experience: "advanced"
    })
  </script>
<script type="application/ld+json">

   {
      "@context":"https://schema.org",
      "@type":"Organization",
      "url":"https://tryhackme.com",
      "name":"TryHackMe",
      "logo":"https://tryhackme.com/img/favicon.png",
      "description":"TryHackMe is a free online platform for learning cyber security, using hands-on exercises and labs, all through your browser!",
      "email": "support@tryhackme.com",
      "sameAs":[
         "https://www.linkedin.com/company/tryhackme",
         "https://twitter.com/realtryhackme"
      ]
   }

</script>
<script>
    console.log(`%c
      ------------------
      < Happy Hacking! >
      ------------------
              \\   ^__^
               \\  (oo)\\_______
                  (__)\\       )\\/\\
                      ||----w |
                      ||     ||`, "font-family:monospace")
  </script>
<script>
  (function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pgpbhph6';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>
<script src="./TryHackMe _ Introduction to Antivirus_files/socket.io.js"></script><script>
  let socket = io.connect({
    transports: ['websocket'],
    reconnection: true,
    reconnectionDelay: 1000,
    reconnectionAttempts: 10
  })
</script><style type="text/css">.apexcharts-canvas {
  position: relative;
  user-select: none;
  /* cannot give overflow: hidden as it will crop tooltips which overflow outside chart area */
}


/* scrollbar is not visible by default for legend, hence forcing the visibility */
.apexcharts-canvas ::-webkit-scrollbar {
  -webkit-appearance: none;
  width: 6px;
}

.apexcharts-canvas ::-webkit-scrollbar-thumb {
  border-radius: 4px;
  background-color: rgba(0, 0, 0, .5);
  box-shadow: 0 0 1px rgba(255, 255, 255, .5);
  -webkit-box-shadow: 0 0 1px rgba(255, 255, 255, .5);
}


.apexcharts-inner {
  position: relative;
}

.apexcharts-text tspan {
  font-family: inherit;
}

.legend-mouseover-inactive {
  transition: 0.15s ease all;
  opacity: 0.20;
}

.apexcharts-series-collapsed {
  opacity: 0;
}

.apexcharts-tooltip {
  border-radius: 5px;
  box-shadow: 2px 2px 6px -4px #999;
  cursor: default;
  font-size: 14px;
  left: 62px;
  opacity: 0;
  pointer-events: none;
  position: absolute;
  top: 20px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  white-space: nowrap;
  z-index: 12;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-theme-light {
  border: 1px solid #e3e3e3;
  background: rgba(255, 255, 255, 0.96);
}

.apexcharts-tooltip.apexcharts-theme-dark {
  color: #fff;
  background: rgba(30, 30, 30, 0.8);
}

.apexcharts-tooltip * {
  font-family: inherit;
}


.apexcharts-tooltip-title {
  padding: 6px;
  font-size: 15px;
  margin-bottom: 4px;
}

.apexcharts-tooltip.apexcharts-theme-light .apexcharts-tooltip-title {
  background: #ECEFF1;
  border-bottom: 1px solid #ddd;
}

.apexcharts-tooltip.apexcharts-theme-dark .apexcharts-tooltip-title {
  background: rgba(0, 0, 0, 0.7);
  border-bottom: 1px solid #333;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  display: inline-block;
  font-weight: 600;
  margin-left: 5px;
}

.apexcharts-tooltip-text-y-label:empty,
.apexcharts-tooltip-text-y-value:empty,
.apexcharts-tooltip-text-goals-label:empty,
.apexcharts-tooltip-text-goals-value:empty,
.apexcharts-tooltip-text-z-value:empty {
  display: none;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  font-weight: 600;
}

.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-goals-group, 
.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  display: flex;
}
.apexcharts-tooltip-text-goals-label:not(:empty),
.apexcharts-tooltip-text-goals-value:not(:empty) {
  margin-top: -6px;
}

.apexcharts-tooltip-marker {
  width: 12px;
  height: 12px;
  position: relative;
  top: 0px;
  margin-right: 10px;
  border-radius: 50%;
}

.apexcharts-tooltip-series-group {
  padding: 0 10px;
  display: none;
  text-align: left;
  justify-content: left;
  align-items: center;
}

.apexcharts-tooltip-series-group.apexcharts-active .apexcharts-tooltip-marker {
  opacity: 1;
}

.apexcharts-tooltip-series-group.apexcharts-active,
.apexcharts-tooltip-series-group:last-child {
  padding-bottom: 4px;
}

.apexcharts-tooltip-series-group-hidden {
  opacity: 0;
  height: 0;
  line-height: 0;
  padding: 0 !important;
}

.apexcharts-tooltip-y-group {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-box, .apexcharts-custom-tooltip {
  padding: 4px 8px;
}

.apexcharts-tooltip-boxPlot {
  display: flex;
  flex-direction: column-reverse;
}

.apexcharts-tooltip-box>div {
  margin: 4px 0;
}

.apexcharts-tooltip-box span.value {
  font-weight: bold;
}

.apexcharts-tooltip-rangebar {
  padding: 5px 8px;
}

.apexcharts-tooltip-rangebar .category {
  font-weight: 600;
  color: #777;
}

.apexcharts-tooltip-rangebar .series-name {
  font-weight: bold;
  display: block;
  margin-bottom: 5px;
}

.apexcharts-xaxistooltip {
  opacity: 0;
  padding: 9px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
  transition: 0.15s ease all;
}

.apexcharts-xaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-xaxistooltip:after,
.apexcharts-xaxistooltip:before {
  left: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-xaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-left: -6px;
}

.apexcharts-xaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-left: -7px;
}

.apexcharts-xaxistooltip-bottom:after,
.apexcharts-xaxistooltip-bottom:before {
  bottom: 100%;
}

.apexcharts-xaxistooltip-top:after,
.apexcharts-xaxistooltip-top:before {
  top: 100%;
}

.apexcharts-xaxistooltip-bottom:after {
  border-bottom-color: #ECEFF1;
}

.apexcharts-xaxistooltip-bottom:before {
  border-bottom-color: #90A4AE;
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:after {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:before {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top:after {
  border-top-color: #ECEFF1
}

.apexcharts-xaxistooltip-top:before {
  border-top-color: #90A4AE;
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:after {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:before {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-yaxistooltip {
  opacity: 0;
  padding: 4px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
}

.apexcharts-yaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-yaxistooltip:after,
.apexcharts-yaxistooltip:before {
  top: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-yaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-top: -6px;
}

.apexcharts-yaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-top: -7px;
}

.apexcharts-yaxistooltip-left:after,
.apexcharts-yaxistooltip-left:before {
  left: 100%;
}

.apexcharts-yaxistooltip-right:after,
.apexcharts-yaxistooltip-right:before {
  right: 100%;
}

.apexcharts-yaxistooltip-left:after {
  border-left-color: #ECEFF1;
}

.apexcharts-yaxistooltip-left:before {
  border-left-color: #90A4AE;
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:after {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:before {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right:after {
  border-right-color: #ECEFF1;
}

.apexcharts-yaxistooltip-right:before {
  border-right-color: #90A4AE;
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:after {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:before {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip.apexcharts-active {
  opacity: 1;
}

.apexcharts-yaxistooltip-hidden {
  display: none;
}

.apexcharts-xcrosshairs,
.apexcharts-ycrosshairs {
  pointer-events: none;
  opacity: 0;
  transition: 0.15s ease all;
}

.apexcharts-xcrosshairs.apexcharts-active,
.apexcharts-ycrosshairs.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-ycrosshairs-hidden {
  opacity: 0;
}

.apexcharts-selection-rect {
  cursor: move;
}

.svg_select_boundingRect, .svg_select_points_rot {
  pointer-events: none;
  opacity: 0;
  visibility: hidden;
}
.apexcharts-selection-rect + g .svg_select_boundingRect,
.apexcharts-selection-rect + g .svg_select_points_rot {
  opacity: 0;
  visibility: hidden;
}

.apexcharts-selection-rect + g .svg_select_points_l,
.apexcharts-selection-rect + g .svg_select_points_r {
  cursor: ew-resize;
  opacity: 1;
  visibility: visible;
}

.svg_select_points {
  fill: #efefef;
  stroke: #333;
  rx: 2;
}

.apexcharts-svg.apexcharts-zoomable.hovering-zoom {
  cursor: crosshair
}

.apexcharts-svg.apexcharts-zoomable.hovering-pan {
  cursor: move
}

.apexcharts-zoom-icon,
.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon,
.apexcharts-reset-icon,
.apexcharts-pan-icon,
.apexcharts-selection-icon,
.apexcharts-menu-icon,
.apexcharts-toolbar-custom-icon {
  cursor: pointer;
  width: 20px;
  height: 20px;
  line-height: 24px;
  color: #6E8192;
  text-align: center;
}

.apexcharts-zoom-icon svg,
.apexcharts-zoomin-icon svg,
.apexcharts-zoomout-icon svg,
.apexcharts-reset-icon svg,
.apexcharts-menu-icon svg {
  fill: #6E8192;
}

.apexcharts-selection-icon svg {
  fill: #444;
  transform: scale(0.76)
}

.apexcharts-theme-dark .apexcharts-zoom-icon svg,
.apexcharts-theme-dark .apexcharts-zoomin-icon svg,
.apexcharts-theme-dark .apexcharts-zoomout-icon svg,
.apexcharts-theme-dark .apexcharts-reset-icon svg,
.apexcharts-theme-dark .apexcharts-pan-icon svg,
.apexcharts-theme-dark .apexcharts-selection-icon svg,
.apexcharts-theme-dark .apexcharts-menu-icon svg,
.apexcharts-theme-dark .apexcharts-toolbar-custom-icon svg {
  fill: #f3f4f5;
}

.apexcharts-canvas .apexcharts-zoom-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-selection-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-reset-zoom-icon.apexcharts-selected svg {
  fill: #008FFB;
}

.apexcharts-theme-light .apexcharts-selection-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoom-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoomin-icon:hover svg,
.apexcharts-theme-light .apexcharts-zoomout-icon:hover svg,
.apexcharts-theme-light .apexcharts-reset-icon:hover svg,
.apexcharts-theme-light .apexcharts-menu-icon:hover svg {
  fill: #333;
}

.apexcharts-selection-icon,
.apexcharts-menu-icon {
  position: relative;
}

.apexcharts-reset-icon {
  margin-left: 5px;
}

.apexcharts-zoom-icon,
.apexcharts-reset-icon,
.apexcharts-menu-icon {
  transform: scale(0.85);
}

.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon {
  transform: scale(0.7)
}

.apexcharts-zoomout-icon {
  margin-right: 3px;
}

.apexcharts-pan-icon {
  transform: scale(0.62);
  position: relative;
  left: 1px;
  top: 0px;
}

.apexcharts-pan-icon svg {
  fill: #fff;
  stroke: #6E8192;
  stroke-width: 2;
}

.apexcharts-pan-icon.apexcharts-selected svg {
  stroke: #008FFB;
}

.apexcharts-pan-icon:not(.apexcharts-selected):hover svg {
  stroke: #333;
}

.apexcharts-toolbar {
  position: absolute;
  z-index: 11;
  max-width: 176px;
  text-align: right;
  border-radius: 3px;
  padding: 0px 6px 2px 6px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.apexcharts-menu {
  background: #fff;
  position: absolute;
  top: 100%;
  border: 1px solid #ddd;
  border-radius: 3px;
  padding: 3px;
  right: 10px;
  opacity: 0;
  min-width: 110px;
  transition: 0.15s ease all;
  pointer-events: none;
}

.apexcharts-menu.apexcharts-menu-open {
  opacity: 1;
  pointer-events: all;
  transition: 0.15s ease all;
}

.apexcharts-menu-item {
  padding: 6px 7px;
  font-size: 12px;
  cursor: pointer;
}

.apexcharts-theme-light .apexcharts-menu-item:hover {
  background: #eee;
}

.apexcharts-theme-dark .apexcharts-menu {
  background: rgba(0, 0, 0, 0.7);
  color: #fff;
}

@media screen and (min-width: 768px) {
  .apexcharts-canvas:hover .apexcharts-toolbar {
    opacity: 1;
  }
}

.apexcharts-datalabel.apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-pie-label,
.apexcharts-datalabels,
.apexcharts-datalabel,
.apexcharts-datalabel-label,
.apexcharts-datalabel-value {
  cursor: default;
  pointer-events: none;
}

.apexcharts-pie-label-delay {
  opacity: 0;
  animation-name: opaque;
  animation-duration: 0.3s;
  animation-fill-mode: forwards;
  animation-timing-function: ease;
}

.apexcharts-canvas .apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-hide .apexcharts-series-points {
  opacity: 0;
}

.apexcharts-gridline,
.apexcharts-annotation-rect,
.apexcharts-tooltip .apexcharts-marker,
.apexcharts-area-series .apexcharts-area,
.apexcharts-line,
.apexcharts-zoom-rect,
.apexcharts-toolbar svg,
.apexcharts-area-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-line-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-radar-series path,
.apexcharts-radar-series polygon {
  pointer-events: none;
}


/* markers */

.apexcharts-marker {
  transition: 0.15s ease all;
}

@keyframes opaque {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}


/* Resize generated styles */

@keyframes resizeanim {
  from {
    opacity: 0;
  }
  to {
    opacity: 0;
  }
}

.resize-triggers {
  animation: 1ms resizeanim;
  visibility: hidden;
  opacity: 0;
}

.resize-triggers,
.resize-triggers>div,
.contract-trigger:before {
  content: " ";
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  overflow: hidden;
}

.resize-triggers>div {
  background: #eee;
  overflow: auto;
}

.contract-trigger:before {
  width: 200%;
  height: 200%;
}</style><style data-jss="" data-meta="MuiDialog">
@media print {
  .MuiDialog-root {
    position: absolute !important;
  }
}
.MuiDialog-scrollPaper {
  display: flex;
  align-items: center;
  justify-content: center;
}
.MuiDialog-scrollBody {
  overflow-x: hidden;
  overflow-y: auto;
  text-align: center;
}
.MuiDialog-scrollBody:after {
  width: 0;
  height: 100%;
  content: "";
  display: inline-block;
  vertical-align: middle;
}
.MuiDialog-container {
  height: 100%;
  outline: 0;
}
@media print {
  .MuiDialog-container {
    height: auto;
  }
}
.MuiDialog-paper {
  margin: 32px;
  position: relative;
  overflow-y: auto;
}
@media print {
  .MuiDialog-paper {
    box-shadow: none;
    overflow-y: visible;
  }
}
.MuiDialog-paperScrollPaper {
  display: flex;
  max-height: calc(100% - 64px);
  flex-direction: column;
}
.MuiDialog-paperScrollBody {
  display: inline-block;
  text-align: left;
  vertical-align: middle;
}
.MuiDialog-paperWidthFalse {
  max-width: calc(100% - 64px);
}
.MuiDialog-paperWidthXs {
  max-width: 444px;
}
@media (max-width:507.95px) {
  .MuiDialog-paperWidthXs.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthSm {
  max-width: 600px;
}
@media (max-width:663.95px) {
  .MuiDialog-paperWidthSm.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthMd {
  max-width: 960px;
}
@media (max-width:1023.95px) {
  .MuiDialog-paperWidthMd.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthLg {
  max-width: 1280px;
}
@media (max-width:1343.95px) {
  .MuiDialog-paperWidthLg.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthXl {
  max-width: 1920px;
}
@media (max-width:1983.95px) {
  .MuiDialog-paperWidthXl.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperFullWidth {
  width: calc(100% - 64px);
}
.MuiDialog-paperFullScreen {
  width: 100%;
  height: 100%;
  margin: 0;
  max-width: 100%;
  max-height: none;
  border-radius: 0;
}
.MuiDialog-paperFullScreen.MuiDialog-paperScrollBody {
  margin: 0;
  max-width: 100%;
}
</style><script async="" src="./TryHackMe _ Introduction to Antivirus_files/modules.5957fbf26d1b525b5a12.js" charset="utf-8"></script><style></style></head>


<body><div role="dialog" aria-live="polite" aria-label="cookieconsent" aria-describedby="cookieconsent:desc" class="cc-window cc-floating cc-type-info cc-theme-classic cc-bottom cc-right cc-color-override-382972913 cc-invisible" style="display: none;"><!--googleoff: all--><span id="cookieconsent:desc" class="cc-message">We use cookies to ensure you get the best user experience. For more information contact us. <a aria-label="learn more about cookies" role="button" tabindex="0" class="cc-link" href="https://tryhackme.com/legal/terms-of-use" target="_blank">Read more</a></span><div class="cc-compliance"><a aria-label="dismiss cookie message" role="button" tabindex="0" class="cc-btn cc-dismiss">Got it!</a></div><!--googleon: all--></div>
<link href="./TryHackMe _ Introduction to Antivirus_files/scoreboard.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Introduction to Antivirus_files/introjs.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Introduction to Antivirus_files/slideout.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Introduction to Antivirus_files/public-rooms.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Introduction to Antivirus_files/asciinema-player.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Introduction to Antivirus_files/prism.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Introduction to Antivirus_files/magnific-popup.css" rel="stylesheet" type="text/css"> 
<script src="./TryHackMe _ Introduction to Antivirus_files/lottie-player.js"></script>

<div id="room-content">
<div id="room-content-main">
<nav class="navbar navbar-expand-md navbar-dark navbar-color-loggedin navbar-main">
<div class="container">
<button id="thm-mobile-nav-open" class="thm-nav__hamburger-btn" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Open mobile navigation">
<span class="thm-nav__hamburger-lines"></span>
</button>
<div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
<div class="navbar-brand" href="/">
<a href="https://tryhackme.com/dashboard">
<img width="115px" src="./TryHackMe _ Introduction to Antivirus_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
</div>
<ul class="navbar-nav mr-auto mt-2 mt-lg-0 navbar-pagelinks">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="navbar-item-icon far fa-browser"></i>
<div class="navbar-item-text">Dashboard</div>
</a>
</li>
<li class="nav-item active" id="nav-learn">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="navbar-item-icon far fa-book-open"></i>
<div class="navbar-item-text">Learn</div>
</a>
</li>
<li class="nav-item  dropdown lite-removable">
<a id="nav-other" class="nav-link" href="https://tryhackme.com/room/introtoav#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-trophy"></i>
<div class="navbar-item-text">Compete</div>
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdown">
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/leaderboards">
<div class="dropdown-menu-icon">
<i class="fas fa-trophy"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/games/koth">
<div class="dropdown-menu-icon">
<i class="fas fa-crown"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/workspace">
<div class="dropdown-menu-icon">
<i class="fas fa-user-friends"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item dropdown">
<a data-cy="nav-other-menu-button" id="nav-other" class="nav-link" href="https://tryhackme.com/room/introtoav#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-ellipsis-h-alt"></i>
<div class="navbar-item-text">Other</div>
</a>
<div data-cy="nav-other-menu" class="dropdown-menu dropdown-menu-center large-dropdown" aria-labelledby="navbarDropdown">
<span class="dropdown-menu-arrow"></span>
<a class="dropdown-item" href="https://tryhackme.com/resources">Resources</a>
<a class="dropdown-item" href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a class="dropdown-item" href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/business">For Business</a>
<a class="dropdown-item" href="https://tryhackme.com/classrooms">For Education</a>
<a class="dropdown-item" target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
<a class="dropdown-item" href="https://tryhackme.com/glossary">Glossary</a>
</div>
</li>
</ul>
<ul class="navbar-nav navbar-right options vertical-align-custom">
<li class="nav-item" data-toggle="modal" data-target="#navConnModal">
<div id="thm-connection-status" class="thm-disconnected" style="display: flex;">
<div id="thm-connection-status-dot" class="dot-small"></div> <span id="thm-connection-status-txt" class="ml-2 size-18 text-white">Access Machines</span>
</div>
</li>
<li class="nav-item">
<div class="nav-item-streak">
<span id="streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="">
<span id="user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>
<script>
                            let usersStreak = { // Global variable, used in rooms logic
                                streakFirstAnswered: new Date('Mon Jul 10 2023 03:13:45 GMT+0100 (British Summer Time)'),
                                streakLastAnswered: new Date('Sun Jul 16 2023 18:47:44 GMT+0100 (British Summer Time)'),
                                usersTimezone: 'Asia/Kolkata',
                                streakFreeze: 1
                            };
                            setSidebarStreaks(usersStreak.streakFirstAnswered, usersStreak.streakLastAnswered, usersStreak.usersTimezone, usersStreak.streakFreeze)
                        </script>
</div>
</li>
<li class="nav-item dropdown" id="notification-navitem">
<a class="nav-link vertical-align-custom size-22 pl-0" href="https://tryhackme.com/room/introtoav#" id="notification-btn" role="button" data-toggle="dropdown">
<i id="notification-icon" class="fal fa-bell"></i>
<div id="notification-dot"></div>
</a>
<div id="nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="notification-header">Notifications</div>
<div id="nav-notifications">
<div class="text-center mt-2 mb-2"><i>Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle remove-arrow p-0" href="https://tryhackme.com/room/introtoav#" id="navbarAvatarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
<img src="./TryHackMe _ Introduction to Antivirus_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarAvatarDropdown">
<a class="dropdown-item" href="https://tryhackme.com/profile">Profile</a>
<a class="dropdown-item" href="https://tryhackme.com/referrals">Refer a friend</a>
<a class="dropdown-item" href="https://tryhackme.com/badges">Badges</a>
<a class="dropdown-item" href="https://tryhackme.com/rooms">My Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/access">Access</a>
<a class="dropdown-item" href="https://tryhackme.com/feedback">Give Feedback</a>
<a class="dropdown-item" href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</div>
</div>
</nav>
<link rel="stylesheet" href="./TryHackMe _ Introduction to Antivirus_files/streak-freeze.css">
<div class="modal fade modal-streak-freeze" id="unlocked-streak-freeze" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<button type="button" class="close close-streak" id="close-streak-freeze-popup" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<div class="modal-body">
<figure>
<img class="img-streak" width="400px" alt="streak freeze unlocked" src="./TryHackMe _ Introduction to Antivirus_files/streak-freeze.svg">
</figure>
<h2>You've unlocked a streak freeze!</h2>
<p>With these one-time streak freezes, you can miss one day of hacking without losing your streak.</p>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Introduction to Antivirus_files/streak-freeze.js"></script>
<nav id="thm-mobile-nav-menu" class="thm-mobile-nav" aria-label="Mobile secondary navigation menu.">
<header>
<a href="https://tryhackme.com/" aria-label="Go to the home page">
<img width="140" src="./TryHackMe _ Introduction to Antivirus_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
<button id="thm-mobile-nav-close" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Close mobile navigation">
<i class="fal fa-times"></i>
</button>
</header>
<ul class="thm-mobile-nav-items mb-0">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="nav-title-icon far fa-browser"></i>
<div class="nav-title">Dashboard</div>
</a>
</li>
<li class="nav-item active">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="nav-title-icon far fa-book-open"></i>
<div class="nav-title">Learn</div>
</a>
</li>
<li class="nav-item ">
<a aria-expanded="false" aria-controls="mobile-nav-compete" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-compete" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-trophy"></i>
<div class="nav-title">Compete</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-compete" class="dropdown-wrapper">
<a href="https://tryhackme.com/leaderboards">
<div>
<i class="fas fa-trophy"></i>
</div>
<div>
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a href="https://tryhackme.com/games/koth">
<div>
<i class="fas fa-crown"></i>
</div>
<div>
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a href="https://tryhackme.com/workspace">
<div>
<i class="fas fa-user-friends"></i>
</div>
<div>
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item">
<a aria-expanded="false" aria-controls="mobile-nav-other" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-other" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-ellipsis-h-alt"></i>
<div class="nav-title">Other</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-other" class="dropdown-wrapper">
<a href="https://tryhackme.com/resources">Resources</a>
<a href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a href="https://tryhackme.com/business">For Business</a>
<a href="https://tryhackme.com/classrooms">For Education</a>
<a target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
</div>
</li>
<li class="nav-item text-center">
<div class="nav-item-streak">
<span id="mobile-streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="">
<span id="mobile-user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>
</div>
</li>
<li class="nav-item text-center">
<a class="nav-link size-22 d-inline-block" href="https://tryhackme.com/room/introtoav#" id="mobile-notification-btn" role="button" data-toggle="dropdown">
<i id="mobile-notification-icon" class="fal fa-bell"></i>
<div id="mobile-notification-dot"></div>
</a>
<div id="mobile-nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="mobile-notification-header">Notifications</div>
<div id="mobile-nav-notifications">
<div class="text-center mt-2 mb-2"><i>Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item text-center">
<a aria-expanded="false" aria-controls="mobile-nav-auth" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-auth" class="sublinks-toggle nav-link d-inline-block">
<img src="./TryHackMe _ Introduction to Antivirus_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div id="mobile-nav-auth" class="dropdown-wrapper">
<a href="https://tryhackme.com/profile">Profile</a>
<a href="https://tryhackme.com/referrals">Refer a friend</a>
<a href="https://tryhackme.com/badges">Badges</a>
<a href="https://tryhackme.com/rooms">My Rooms</a>
<a href="https://tryhackme.com/access">Access</a>
<a href="https://tryhackme.com/feedback">Give Feedback</a>
<a href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</nav>
<script defer="" src="./TryHackMe _ Introduction to Antivirus_files/mobile-nav.js"></script>
<script>
  const userSignedUpLessThanSevenDaysAgo = Math.floor(
    (new Date() - new Date('Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)')) / (1000 * 60 * 60 * 24) < 7
  );

  const userHasFirst4RoomsBadge = !!``;
  const isBeginner = `advanced` === 'complete-beginner';
</script>
<script src="./TryHackMe _ Introduction to Antivirus_files/notifications.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/streak-freeze(1).js"></script>
<div id="wrapper">
<div id="room-banner" class="shadow-light">
<img id="room-image-large" src="./TryHackMe _ Introduction to Antivirus_files/461db271e310812a73d4a96abd2dc9eb.png">
<div>
<div id="room-details">
<div class="container">
<div class="page-header">
<div class="room-header">
<div id="room-voting" class="text-center vertical-align-custom">
<div class="voting-buttons">
<i class="fas fa-thumbs-up display-block" onclick="makeVote(true)" id="vote-up" style="color: rgb(185, 185, 185);"></i>
<div class="display-block" id="vote-number">464</div>
<i class="fas fa-thumbs-down display-block" onclick="makeVote(false)" id="vote-down" style="color: rgb(185, 185, 185);"></i>
</div>
</div>
<div id="room-logo" class="vertical-align-custom">
<div id="logo"><img class="room-avatar" src="./TryHackMe _ Introduction to Antivirus_files/0ad87658878df43e1232587177221386.png" onerror="replaceImg(this)"></div>
</div>
<div class="vertical-align-custom">
<div id="room-basic-data">
<div class="d-flex justify-content-between">
<h1 id="title" class="bold-head">Introduction to Antivirus</h1>
<div id="room-title-options">

<div class="btn-group" id="browser-machine-options" role="group" aria-label="Start AttackBox or Kali Linux" style="display: inline-flex;">
<button id="browser-machine-start" type="button" class="btn btn-secondary"><i class="far fa-laptop"></i> Start AttackBox</button>
<div class="btn-group" id="browser-machines" role="group">
<button id="btnGroupDrop1" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
<div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
<a class="dropdown-item  preventDefault" href="https://tryhackme.com/room/introtoav#" onclick="changeMyMachine(&quot;kali-linux&quot;)">
<span class="mb-0">Use Kali Linux</span>
<div class="text-lgray size-12">Web-based Kali Machine</div>
</a>
<a class="dropdown-item preventDefault" href="https://tryhackme.com/room/introtoav#" onclick="changeMyMachine(&quot;attackbox&quot;)">
<span class="mb-0">Use AttackBox</span>
<div class="text-lgray size-12">Recommended</div>
</a>
</div>
</div>
</div>
<button id="browser-machine-split-view" type="button" class="btn btn-secondary">Show Split View</button>
<button id="cloud-details" type="button" class="btn btn-info"><i class="far fa-clouds mr-1"></i>Cloud Details</button>
<span id="awards-model-btn" data-toggle="modal" data-target="#award-modal" class="badge badge-warning ml-1 noselect">Awards</span>
<span id="room-faq-slideout" type="button" class="badge badge-info ml-1 noselect d-inline-flex" onclick="openHelpMenu()">
Help
</span>
<div class="dropright room-dropright noselect ml-1" id="room-options" style="display: inline-block;">
<span class="badge badge-secondary" data-toggle="dropdown">
<i class="fas fa-cog"></i>
</span>
<div class="dropdown-menu">
<a class="dropdown-item" href="https://tryhackme.com/api/room/manage/clone/introtoav" id="clone-room" style="display: none;"><i class="far fa-clone faded"></i> Clone Room</a>
<a class="dropdown-item preventDefault" id="writeups-simple" style="display: inline-block;"><i class="fas fa-pen-alt faded"></i> Writeups</a>
<a class="dropdown-item preventDefault" data-toggle="modal" data-target="#resetUserProgressModal"><i class="fas fa-eraser faded"></i> Reset Progress</a>
<a class="dropdown-item preventDefault" id="leave-room"><i class="fas fa-sign-out-alt faded"></i> Leave</a>
</div>
</div>
<span id="bookmark" class="badge badge-secondary badge-bookmark ">
<img class="bookmark" src="./TryHackMe _ Introduction to Antivirus_files/bookmark.svg">
<span class="bookmark-popover" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="top" data-content="&lt;p class=&#39;mb-0&#39;&gt;Save room &lt;/p&gt;
" data-original-title="" title="">
</span>
</span>
</div>
</div>
<p class="mb0 faded" id="description">Understand how antivirus software works and what detection techniques are used to bypass malicious file checks.</p>
</div>
</div>
</div>
</div>

</div>
</div>
<div id="room-banner-stats">
<div class="creators"></div>
<div class="numbers"></div>
</div>
</div>
</div>
<div class="container main pb">
<div id="room-message"></div>
<section id="sponsor">
<i id="sponsor-close" class="fas fa-times"></i>
<div id="sponsor-data"></div>
</section>
<div id="top-panel">
<ul class="nav nav-tabs" id="task-navs">
<li class="nav-item">
<a class="nav-link  active " data-toggle="tab" href="https://tryhackme.com/room/introtoav#chart">
<i class="fas fa-chart-line icon-right"></i> Chart
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/introtoav#scoreboard">
<i class="fas fa-trophy icon-right"></i> Scoreboard
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/introtoav#chat">
<i class="fas fa-comments-alt icon-right chat-icon"></i> Discuss
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/introtoav#writeups">
<i class="fas fa-pen-alt icon-right"></i> Writeups
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/introtoav#about">
<i class="fas fa-info-circle icon-right"></i> More
</a>
</li>
</ul>
<div class="card cd-2 nav-above-con" id="room-main">
<div class="card-body">
<span id="room-tabs">
<div class="tab-content">
<div id="chart" class="tab-pane  active ">
<span id="difficulty-bar">
    <span class="room-difficulty diff-text">
      Difficulty: 
        <span class="difficulty-easy">Easy</span>
    </span></span>
<br><div id="chart-data"></div>
</div>
<div id="scoreboard" class="tab-pane fade">
<table class="table table-striped table-bordered table-condensed table-header-rotated mb-0" id="scoreboard_table">
<thead>
<tr id="scoreboard_header">
<th>Rank</th>
<th>Username</th>
<th>Total Score</th>
</tr>
</thead>
<tbody id="scoreboard_body"></tbody>
</table>
</div>
<div id="chat" class="tab-pane fade">

<div class="row">
<div class="col-sm-6 text-center">
<h3 class="mb-2">Discord</h3>
<p>Come join our <a target="_blank" href="https://discord.gg/QgC6Tdk">Discord</a> server for support or further discussions</p>
</div>
<div class="col-sm-6 text-center">
<h3 class="mb-2">Forum</h3>
<div id="forum-text">Read or post on the dedicated forum <a href="https://tryhackme.com/forum/thread/627178922cd7150052389911">post</a></div>
</div>
</div>
</div>
<div id="writeups" class="tab-pane text-center">
<div id="writeups-data">There are no writeups submitted.</div>
<button onclick="showWriteupForm(this)" type="button" class="btn btn-xs btn-secondary mt-3 mb-2">Add Writeup</button>
<div id="writeup-form">
<div class="form-row">
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-title" placeholder="Writeup Title">
</div>
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-link" placeholder="Writeup URL">
</div>
<div class="col-auto">
<button id="submit-writeup" type="submit" class="btn btn-success mb-2">Submit</button>
</div>
</div>
<p class="faded mb-0 size-14"><i class="fas fa-exclamation-triangle text-warning"></i> Writeups should have a link to TryHackMe and not include any passwords/cracked hashes/flags</p>
</div>
</div>
<div id="about" class="tab-pane text-center">
<p id="about-freeRoom"><p class="mb-0">This is a <b>free</b> room, which means anyone can deploy virtual machines in the room 
        (without being subscribed)! 11157 users are in here and this room is 362 days old.</p></p>
<p id="about-owner"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Introduction to Antivirus_files/af7feb2c43a2c7d5f111b98ccbd15048.png"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme">tryhackme</a> and <img class="avatar-tiny" src="./TryHackMe _ Introduction to Antivirus_files/26286532ed37cf8b7b375905f4306110.png"> 
        <a class="green-link" href="https://tryhackme.com/p/arebel">arebel</a></p></p>
</div>
</div>
</span>
</div>
</div>
</div>
<div id="room-simple-video" class="card card-body cd-2"></div>
<div class="card mt-3 mb-3 cd-2 text-center" id="instance-info">
<div class="card-header card-header-red">Active Machine Information</div>
<div class="card-body">
<div class="row vertical-align-custom">
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3" id="table-machine-ip">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
</div>
</div>
</div>
<div id="task-list">
<div id="room-task-detail" class="mb-3"><span id="progress-bar" style="display: block;"><div class="progress"><div class="progress-bar bg-success" role="progressbar" style="width: 100%; aria-valuemin=" 0"="" aria-valuemax="100"> 100%</div></div></span></div>
<div id="taskContent"><div class="card" id="task-1">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse1">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 1                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Introduction
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse1" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span style="font-size:24px"><span>Welcome to Intro to <a class="cUQiYjuT glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;cUQiYjuT&#39;)">AV</a></span></span></p><p><span style="font-size:1rem"><span>Antivirus (<a class="YPWlG4s0 glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;YPWlG4s0&#39;)">AV</a>) software is one of the essential host-based security solutions available to detect and prevent malware attacks </span></span>within the end-user's machine<span style="font-size:1rem">.&nbsp;</span><span style="font-size:1rem"><span><a class="2P8s8yCf glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;2P8s8yCf&#39;)">AV</a> software consists of different modules, features, and detection techniques, which are discussed in this room.</span></span><br></p><p style="text-align:center"></p><p><span style="font-size:1rem"><span>As a red teamer or pentester, it is essential to be familiar with and understand how <a class="nxaAkZVR glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;nxaAkZVR&#39;)">AV</a> software&nbsp;</span></span>and its detection techniques<span style="font-size:1rem"><span>&nbsp;work. Once this knowledge is acquired, it will be easier to work toward <a class="FWqbIoGS glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;FWqbIoGS&#39;)">AV</a> evasion techniques.</span></span><img src="./TryHackMe _ Introduction to Antivirus_files/1c337e6e58b75099340f628252383a1c.png" style="float:right;width:431.148px;height:262.906px" class="note-float-right" alt=""></p><p></p><p><span style="font-size:24px">Learning Objectives</span><br></p><ul>
<li>What is Antivirus software?</li>
<li>Antivirus detection approaches</li>
<li><span>Enumerate installed <a class="JhtDkOtM glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;JhtDkOtM&#39;)">AV</a> software in the target machine</span></li>
<li>Test in a simulated environment<br></li></ul><p><span style="font-size:24px">Room prerequisites</span></p><ul>
<li>General knowledge of host-based detection solutions; check <a href="https://tryhackme.com/room/thelayoftheland" target="_blank">The Lay of the Land</a> room for more information.</li><li>General experience with Hashing crypto; check the&nbsp;<a href="https://tryhackme.com/room/hashingcrypto101" target="_blank">Hashing - Crypto 101</a> room for more information.</li><li>Basic knowledge of Yara Rules; check the THM <a href="https://tryhackme.com/room/yara" target="_blank">Yara</a> room for more information.</li></ul><ul>
</ul><ul>
</ul></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Let's get started!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="1">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-2">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse2">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 2                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Antivirus Software
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse2" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span style="font-size:24px"><span>What is <a class="OO6UFBFW glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;OO6UFBFW&#39;)">AV</a> software</span></span><span style="font-size:24px">?</span></p><p></p>
<p></p>
<p><span>Antivirus (<a class="Bb03eQbx glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;Bb03eQbx&#39;)">AV</a>) software is an extra layer of security that aims to detect and prevent the execution and spread of malicious files in a target operating system.</span></p>

<p><span>It is a host-based application that runs in real-time (in the background) to monitor and check the current and newly downloaded files. The <a class="mWAubDgm glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;mWAubDgm&#39;)">AV</a> software inspects and decides whether files are malicious using different techniques, which will be covered later in this room.

</span><img src="./TryHackMe _ Introduction to Antivirus_files/cc7df5646938a83c96371cc0dc615253.png" style="float:right;width:489.5px;height:298.489px" class="note-float-right" alt=""></p>

<p>Interestingly, the first antivirus software was designed solely to detect and remove&nbsp;<a href="https://malware-history.fandom.com/wiki/Virus">computer viruses</a>. Nowadays, that has changed; modern antivirus applications can detect and remove computer viruses as well other harmful files and threats.<br></p>
<p><span style="font-size:24px"><span>What does <a class="WXu2xFCc glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;WXu2xFCc&#39;)">AV</a> software look for?</span></span></p><p><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt"><span>Traditional <a class="ZxH9J1YO glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;ZxH9J1YO&#39;)">AV</a> software looks for&nbsp;</span></span><strong>malware</strong><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">&nbsp;with predefined malicious patterns or signatures. Malware is harmful software whose primary goal is to cause damage to a target machine, including but not limited to:</span></p>
<ul>
<li>Gain full access to a target machine.</li>
<li>Steal sensitive information such as passwords.</li>
<li>Encrypt files and cause damage to files.</li>
<li>Inject other malicious software or unwanted advertisements.</li>
<li>Used the compromised machine to perform further attacks such as botnet attacks.<br></li>
</ul>
<h2><p style="font-size:16px"><span style="font-size:24px"><span><a class="DS5jtkM9 glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;DS5jtkM9&#39;)">AV</a> vs other security products</span></span></p><p style="font-size:16px"><img src="./TryHackMe _ Introduction to Antivirus_files/ff53d2570143967d4073d0f9005d0928.png" style="float:left;width:272.429px;height:166.109px" class="note-float-left"></p><p style="font-size:16px"></p></h2>
<p><span>In addition to <a class="8GRInaB8 glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;8GRInaB8&#39;)">AV</a> software, other host-based security solutions provide real-time protection to endpoint devices. Endpoint Detection and Response (EDR) is a security solution that provides real-time protection based on behavioral analytics. An antivirus application performs scanning, detecting, and removing malicious files. On the other hand, EDR monitors various security checks in the target machine, including file activities, memory, network connections, Windows registry, processes, etc.</span></p>
<p><span>Modern Antivirus products are implemented to integrate the traditional Antivirus features and other advanced functionalities (similar to <a class="60lHf4ZN glossary-term" onclick="initPopOver(&#39;EDR&#39;, &#39;60lHf4ZN&#39;)">EDR</a> functionalities) into one product to provide comprehensive protection against digital threats.&nbsp;</span><span style="font-size:1rem">For more information about Host-based security solutions, we suggest visiting the THM room:&nbsp;</span><a href="https://tryhackme.com/room/thelayoftheland" target="_blank">The Lay of the Land</a><span style="font-size:1rem">.</span></p><h2><p style="font-size:16px"><span style="font-size:24px"><span><a class="gIylTcqY glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;gIylTcqY&#39;)">AV</a> software in the past and present</span></span></p></h2>
<p><span>McAfee Associates, Inc. started the first <a class="9SFnCiow glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;9SFnCiow&#39;)">AV</a> software implementation in 1987. It was called "VirusScan," and its main goal at that time was to remove a virus named "Brain" that infected John McAfee's computer.&nbsp;</span><span style="font-size:1rem"><span>Later, other companies joined in the battle against viruses. <a class="u6UbVMfr glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;u6UbVMfr&#39;)">AV</a> software was called scanners, and they were command-line software that searched for malicious patterns in files.</span></span></p>
<p><span>Since then, things have changed. <a class="Nmno11AV glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;Nmno11AV&#39;)">AV</a> software nowadays uses a Graphical User Interface (GUI) to perform scans for malicious files and other tasks.&nbsp;Malware programs have also expanded in scope and now target victims on Windows and other operating systems.</span><span style="font-size:1rem"><span>&nbsp;Modern <a class="xlGxIsJr glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;xlGxIsJr&#39;)">AV</a> software supports most devices and platforms, including Windows, Linux, macOS, Android, and iOS. </span></span><span>Modern <a class="B5xWdFov glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;B5xWdFov&#39;)">AV</a> software has improved and become</span><span style="font-size:1rem">&nbsp;more intelligent and sophisticated, </span>as they pack a bundle of versatile features<span style="font-size:1rem">, including Antivirus, Anti-Exploit, Firewall, Encryption tool, etc.</span></p>
<p><span>We will be discussing some <a class="qpiOQnh3 glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;qpiOQnh3&#39;)">AV</a> features in the next task.</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                What was the virus name that infected John McAfee's&nbsp;PC?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *****" value="Brain" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span>Which PC Antivirus vendor implemented the first <a class="I8lXISAf glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;I8lXISAf&#39;)">AV</a> software on the market?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ******" value="McAfee" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Antivirus software is a _____-based security solution.</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****" value="Host" disabled="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-3">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse3">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 3                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Antivirus Features
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse3" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span style="font-size:24px">Antivirus Engines</span></p><p></p><p><span>An <a class="bRrYac6M glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;bRrYac6M&#39;)">AV</a> engine is responsible for finding and removing malicious code and files. Good AV software implements an effective and solid AV core&nbsp;that accurately and quickly analyzes</span><span style="font-size:1rem">&nbsp;</span>malicious files<span style="font-size:1rem">. Also, It should handle and support various file types, including archive files, where it can self-extract and inspect all compressed files.</span></p><p><span>Most <a class="EstXZQ6i glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;EstXZQ6i&#39;)">AV</a> products share the same common features but are implemented&nbsp; differently, including but not limited to:</span></p><ul><li>Scanner</li><li>Detection techniques</li><li>Compressors and Archives</li><li>Unpackers</li><li>Emulators<br></li></ul><p><span style="font-size:24px">Scanner</span></p><p><span>The scanner feature is included in most <a class="Nwm7KpgM glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;Nwm7KpgM&#39;)">AV</a> products: AV software runs and scans in real-time or on-demand. This feature is available in the GUI or through the command prompt. The user can use it whenever required to check files or directories. The scanning feature must support the most known malicious file types to detect and remove the threat. In addition, it also may support other types of scanning depending on the AV software, including vulnerabilities, emails, Windows memory, and Windows Registry.</span><br></p><p><span style="font-size:24px">Detection techniques</span></p><p><span>An <a class="9ynrLebp glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;9ynrLebp&#39;)">AV</a> detection technique searches for and detects malicious files; different detection techniques can be used within the AV engine, including: </span></p><ul><li><span>Signature-based detection is the traditional <a class="19EEPdp2 glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;19EEPdp2&#39;)">AV</a> technique that looks for predefined malicious patterns and signatures within files.</span></li><li>Heuristic detection is a more advanced technique that includes various behavioral methods to analyze suspicious files.</li><li>Dynamic detection is a technique that includes monitoring the system calls and APIs and testing and analyzing in an isolated environment.</li></ul><p><span>We will cover these techniques in the next task. A good <a class="ZkVcukg1 glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;ZkVcukg1&#39;)">AV</a> engine is accurate and quickly detects malicious files with fewer false-positive results. We will showcase several AV products that provide inaccurate results and misclassify a file.</span><br></p><p><span style="font-size:24px">Compressors and Archives</span></p><p><span>The "Compressors and Archives" feature should be included in any <a class="UmFAv08a glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;UmFAv08a&#39;)">AV</a> software. It must support and be able to deal with various system file types, including compressed or archived files: ZIP, TGZ, 7z, XAR, RAR, etc.&nbsp;Malicious code often tries to evade host-based security solutions by hiding in compressed files.</span><span style="font-size:1rem"><span>&nbsp;For this reason, <a class="DnruQMzF glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;DnruQMzF&#39;)">AV</a> software must decompress and scan through all files </span></span>before a user opens a file within the archive<span style="font-size:1rem">.<br></span></p><p><span style="font-size:24px">PE&nbsp;</span><span style="font-size:24px">(Portable Executable) Parsing and&nbsp;</span><span style="font-size:24px">Unpackers</span></p><p><span>Malware hides and packs its malicious code by compressing and encrypting it within a payload. It decompresses and decrypts itself during runtime to make it harder to perform static analysis. Thus, <a class="HWaFHLLa glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;HWaFHLLa&#39;)">AV</a> software must be able to detect and unpack most of the known packers (UPX, Armadillo, ASPack, etc.) before the runtime for static analysis. </span></p><p><span>Malware developers use various techniques, such as Packing, to shrink the size and change the malicious file's structure. Packing compresses the original executable file to make it harder to analyze. Therefore, <a class="cLeRziJz glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;cLeRziJz&#39;)">AV</a> software must have an unpacker feature to unpack protected or compressed executable files into the original code.</span><br></p><p><span>Another feature that <a class="hfBbRDVf glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;hfBbRDVf&#39;)">AV</a> software must have is Windows Portable Executable (PE) header parser. Parsing PE of executable files helps distinguish malicious and legitimate software (.exe files). The PE file format in Windows (32 and 64 bits) contains various information and resources, such as object code, DLLs, icon files, font files, and core dumps.</span><br></p><p><span style="font-size:24px">Emulators</span></p><p><span>An emulator is an Antivirus feature that does further analysis on suspicious files. Once an emulator receives a request, the emulator runs the suspect (exe, <a class="xGsqosy1 glossary-term" onclick="initPopOver(&#39;DLL&#39;, &#39;xGsqosy1&#39;)">DLL</a>, PDF, etc.) files in a virtualized and controlled environment. It monitors the executable files' behavior during the execution, including the Windows APIs calls, Registry, and other Windows files. The following are examples of the artifacts that the emulator may collect: </span></p><ul><li>API calls </li><li>Memory dumps </li><li>Filesystem modifications</li><li>Log events </li><li>Running processes</li><li>Web requests<br></li></ul><p>An emulator stops the execution of a file when enough artifacts are collected to detect malware.</p><p><span style="font-size:24px">Other common features</span></p><p><span style="font-size:1rem"><span>The following are some common features found in <a class="ADUsNj1e glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;ADUsNj1e&#39;)">AV</a> products:</span></span></p><ul><li><span style="font-size:1rem"><span>A self-protection driver to guard against malware attacking the actual <a class="vGDkusNR glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;vGDkusNR&#39;)">AV</a>.</span></span></li><li><span style="font-size:1rem">Firewall and network inspection functionality.</span></li><li><span style="font-size:1rem">Command-line and graphical interface tools.</span></li><li><span style="font-size:1rem">A daemon or service.</span></li><li><span style="font-size:1rem">A management console.<br></span></li>
</ul></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span>Which <a class="Z5GcOnzF glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;Z5GcOnzF&#39;)">AV</a> feature analyzes malware in a safe and isolated environment?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ********" value="Emulator" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>An _______ feature is a process of restoring or decrypting the compressed executable files to the original.&nbsp;</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ********" value="unpacker" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details"><span>
                                Read the above to proceed to the next task, where we discuss the AV detection techniques.
                            </span></div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-4">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse4">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 4                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Deploy the VM
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-server text-lgreen" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a deployable machine"></i></span>
                        </a>
                    </div>
                    <div id="collapse4" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><div class="btn-group mb-3 ml-3 float-right">
            <button type="button" class="btn btn-success" value="630cc3bdacb6200043fccf5b" onclick="deploy(this)"><i class="fas fa-play mr-2"></i> Start Machine</button>
        </div> <p><span>We have provided a Windows machine 10 Pro to complete this room. The <a class="PYbfHgTS glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;PYbfHgTS&#39;)">VM</a> can be accessed through the in-browser feature. Once the VM is deployed, your browser should split into two windows, as the following:</span></p><p style="text-align:center"><img src="./TryHackMe _ Introduction to Antivirus_files/cd4aae33ce8fdd617eb544a6321b4b38.png" style="width:100%"><br></p><p>If the browser doesn't split, you can select the "Show Split View" bottom located at the top of your browser.</p><p style="text-align:center"><img src="./TryHackMe _ Introduction to Antivirus_files/dbd5b42819beff951254adaf5f202399.png" style="width:100%"><br></p><p><span style="font-size:1rem"><span>You can also connect via <a class="MSfjpGDW glossary-term" onclick="initPopOver(&#39;RDP&#39;, &#39;MSfjpGDW&#39;)">RDP</a>, make sure you deploy the AttackBox or connect&nbsp;</span></span><u>to the VPN</u><span style="font-size:1rem">.</span><br></p><p><span style="font-size:1rem">Use the following credentials below.</span></p><p style="text-align:center">Machine IP:&nbsp;<span class="notion-enable-hover" style="text-align:left;font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">MACHINE_IP</span><span style="font-size:1rem;text-align:left">&nbsp;</span><span style="font-size:1rem">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Username:&nbsp;</span><span class="notion-enable-hover" style="text-align:left;font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">thm</span><span style="font-size:1rem;text-align:left">&nbsp;</span><span style="font-size:1rem">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="font-size:1rem">Password:&nbsp;</span><span class="notion-enable-hover" style="text-align:left;font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">TryHackM3</span><span style="font-size:1rem;text-align:left">&nbsp;</span></p>
<p>
</p><div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top"><span>Connect to the <a class="C9hCoHQB glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;C9hCoHQB&#39;)">VM</a> via the RDP client</span></div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@machine</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">xfreerdp /v:MACHINE_IP /u:thm /p:TryHackM3</span></span></code>
	    </pre></div></div>
<p></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span>Once you've deployed the <a class="B8D6Pwjz glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;B8D6Pwjz&#39;)">VM</a>, it will take a few minutes to boot up. Then, progress to the next task!</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-5">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse5">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 5                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> AV Static  Detection
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse5" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span style="font-size:1rem"><span>Generally speaking, <a class="JpGW3Azm glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;JpGW3Azm&#39;)">AV</a> detection can be classified into three main approaches:</span></span><br></p><ol><li>Static Detection</li><li>Dynamic Detection<br></li><li>Heuristic and Behavioral Detection&nbsp;</li></ol><p><span style="font-size:24px">Static Detection</span></p><p>A static detection technique is the simplest type of Antivirus detection, which is based on predefined signatures of malicious files. Simply, it uses pattern-matching techniques in the detection, such as finding a unique string, CRC (Checksums), sequence of bytecode/Hex values, and Cryptographic hashes (MD5, SHA1, etc.).<br></p><p>It then performs a set of comparisons between existing files within the operating system and a database of signatures. If the signature exists in the database, then it is considered malicious. This method is effective against static malware.</p><p style="text-align:center"><img src="./TryHackMe _ Introduction to Antivirus_files/06689aaadc7842fbe0cc1424e89e1b3c.png" alt="Static detection flow"><br></p><p style="text-align:center"></p><p>In this task, we will be using a signature-based detection method to see how antivirus products detect malicious files. It is important to note that this technique works against known malicious files only with pre-generated signatures in a database. Thus, the database needs to be updated from time to time.</p><p>We will use the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">ClamAV</span><span style="font-size:1rem;background-color:transparent;--darkreader-inline-bgcolor:transparent">&nbsp;</span>antivirus software to demonstrate how signature-based detection identifies malicious files<span style="font-size:1rem"><span>. The ClamAV software is pre-installed in the provided <a class="FxoEPCMa glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;FxoEPCMa&#39;)">VM</a>, and we can access it in the following path:&nbsp;</span></span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">c:\Program Files\ClamAV\clamscan.exe</span><span style="background-color:transparent;font-size:1rem;--darkreader-inline-bgcolor:transparent">.</span><span style="font-size:1rem">&nbsp;We will also scan a couple of malware samples, which can be found on the desktop. The Malware samples folder contains the following files:</span></p><ol><li><span style="background:transparent;color:rgb(14, 16, 26);font-size:1rem;margin-top:0pt;margin-bottom:0pt;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:transparent;--darkreader-inline-color:#dbd8d4"><b>EICAR </b><span>is a test file containing ASCII strings used to test <a class="CXUaDQWM glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;CXUaDQWM&#39;)">AV</a> software's effectiveness instead of real malware that could damage your machine. For more information, you may visit the official EICAR website,&nbsp;</span></span><a target="_blank" href="https://www.eicar.org/?page_id=3950" class="editor-rtfLink">Here</a><span style="background:transparent;color:rgb(14, 16, 26);font-size:1rem;margin-top:0pt;margin-bottom:0pt;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:transparent;--darkreader-inline-color:#dbd8d4">.</span></li><li><b>Backdoor 1</b> is a C# program that uses a well-known technique to establish a reverse connection, including creating a process and executing a Metasploit Framework shellcode.</li><li><b>Backdoor 2</b> is a C# program that uses process injection and encryption to establish a reverse connection, including injecting a Metasploit shellcode into an existing and running process.</li><li><b>AV-Check</b><span> is a C# program that enumerates <a class="jtlDVh7s glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;jtlDVh7s&#39;)">AV</a> software in a target machine. Note that this file is not malicious. We will discuss this tool in more detail in task 6.&nbsp;</span></li><li><b>notes.txt</b> is a text file that contains a command line. Note that this file is not malicious.</li></ol><p>ClamAV comes with its database, and during the installation, we need to download the recently updated version. Let's try to scan the Malware sample folder using the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">clamscan.exe</span>&nbsp;binary and check how ClamAV performs against these samples.</p>
<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Command Prompt<br></div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">c:\&gt;"c:\Program Files\ClamAV\clamscan.exe" c:\Users\thm\Desktop\Samples
Loading:    22s, ETA:   0s [========================&gt;]    8.61M/8.61M sigs
Compiling:   4s, ETA:   0s [========================&gt;]       41/41 tasks

C:\Users\thm\Desktop\Samples\AV-Check.exe: OK
C:\Users\thm\Desktop\Samples\backdoor1.exe: Win.Malware.Swrort-9872015-0 FOUND
C:\Users\thm\Desktop\Samples\backdoor2.exe: OK
C:\Users\thm\Desktop\Samples\eicar.com: Win.Test.EICAR_HDB-1 FOUND
C:\Users\thm\Desktop\Samples\notes.txt: OK</span></code>
	    </pre></div></div><p></p>
<p>The above output shows that ClamAV software correctly analyzed and flagged two of our tested files (EICAR, backdoor1, AV-Check, and notes.txt) as malicious. However, it incorrectly identified the backdoor2 as non-malicious while it does.</p><p><span style="font-size:1rem">You can run&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">clamscan.exe --debug &lt;file_to_scan&gt;</span><span style="font-size:1rem">, and you will see all modules loaded and used during the scanning. For example, it uses the unpacking method to split the files and look for a predefined malicious sequence of bytecode&nbsp;values, and that is how it was able to detect the C# backdoor 1. The bytecode value of the Metasploit shellcode used in backdoor 1 was previously identified and added to ClamAV's database.&nbsp;</span><br></p><p>However, backdoor 2 uses an encryption technique (XOR) for the Metasploit shellcode, resulting in different sequences of bytecode&nbsp;values that it doesn't find in the ClamAV database.&nbsp;</p><p><span style="font-size:1rem">While the ClamAV was able to detect the EICAR.COM test file as malicious using the md5 signature-based technique. To confirm this, we can re-scan the EICAR.COM test file again in debug mode (--debug). At some point in the output, you will see the following message:</span></p><p>

</p><pre style="font-size:14px" class=" language-javascript" tabindex="0"><code class=" language-javascript">LibClamAV debug<span class="token operator">:</span> <span class="token constant">FP</span> <span class="token constant">SIGNATURE</span><span class="token operator">:</span> <span class="token number">44</span>d88612fea8a8f36de82e1278abb02f<span class="token operator">:</span><span class="token number">68</span><span class="token operator">:</span>Win<span class="token punctuation">.</span>Test<span class="token punctuation">.</span><span class="token constant">EICAR_HDB</span><span class="token operator">-</span><span class="token number">1</span>  # Name<span class="token operator">:</span> eicar<span class="token punctuation">.</span>com<span class="token punctuation">,</span> Type<span class="token operator">:</span> <span class="token constant">CL_TYPE_TEXT_ASCII</span></code></pre>
<p></p><p><span style="font-size:16px">﻿Now let's generate the md5 value of the EICAR.COM if it matches what we see in the previous message from the output. We will be using the sigtool for that:&nbsp;</span><br></p>

<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Command Prompt<br></div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">c:\&gt;"c:\Program Files\ClamAV\sigtool.exe" --md5 c:\Users\thm\Desktop\Samples\eicar.com
44d88612fea8a8f36de82e1278abb02f:68:eicar.com</span></code>
	    </pre></div></div><span style="font-size:24px">
</span><p></p>

<p>If you closely check the generated MD5 value,&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">44d88612fea8a8f36de82e1278abb02f</span><span style="font-size:1rem">, it matches.<br><br></span></p><p><span style="font-size:24px">Create Your Own Signature Database&nbsp;</span></p><p>One of ClamAV's features is creating your own database, allowing you to include items not found in the official ClamAV database. Let's try to create a signature for Backdoor 2, which ClamAV already missed, and add it to a database. The following are the required steps:</p><ol><li>Generate an MD5 signature for the file.</li><li>Add the generated signature into a database with the extension ".hdb".</li><li>Re-scan the ClamAV against the file using our new database.</li></ol><p>First, we will be using the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">sigtool</span><span style="background-color:transparent;font-size:1rem;--darkreader-inline-bgcolor:transparent">&nbsp;</span><span style="font-size:1rem">tool, which is included in the ClamAV suite, to generate an MD5 hash of&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">backdoor2.exe</span><span style="font-size:1rem;background-color:transparent;--darkreader-inline-bgcolor:transparent">&nbsp;</span><span style="font-size:1rem">&nbsp;using the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">--md5</span><span style="background-color:transparent;font-size:1rem;--darkreader-inline-bgcolor:transparent">&nbsp;</span><span style="font-size:1rem">argument.</span><br></p><p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span style="font-size:16px">Generate an MD5 hash</span><br></div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">C:\Users\thm\Desktop\Samples&gt;"c:\Program Files\ClamAV\sigtool.exe" --md5 backdoor2.exe
75047189991b1d119fdb477fef333ceb:6144:backdoor2.exe </span></code>
	    </pre></div></div><p></p><p>As shown in the output, the generated hash string contains the following structure: <span style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c" class="notion-enable-hover">Hash:Size-in-byte:FileName</span>.  Note that ClamAV uses the generated value in the comparison during the scan.</p><p>Now that we have the MD5 hash, now let's create our own database. We will use the <span style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c" class="notion-enable-hover">sigtool</span> tool and save the output into a file using the <span style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c" class="notion-enable-hover">&gt; thm.hdb</span> as follows, </p><p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Generate our new database<br></div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">C:\Users\thm\Desktop\Samples&gt;"c:\Program Files\ClamAV\sigtool.exe" --md5 backdoor2.exe &gt; thm.hdb</span></code>
	    </pre></div></div><p></p><p>As a result, a <span style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c" class="notion-enable-hover">thm.hdb</span> file will be created in the current directory that executes the command.&nbsp;</p><p><span style="font-size:1rem">We already know that ClamAV did not detect the backdoor2.exe using the official database! Now, let's re-scan it using the database we created, </span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">thm.hdb</span><span style="font-size:1rem">, and see the result!</span></p><p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Re-scanning backdoor2.exe using the new database!<br></div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">C:\Users\thm\Desktop\Samples&gt;"c:\Program Files\ClamAV\clamscan.exe" -d thm.hdb backdoor2.exe
Loading:     0s, ETA:   0s [========================&gt;]        1/1 sigs
Compiling:   0s, ETA:   0s [========================&gt;]       10/10 tasks

C:\Users\thm\Desktop\Samples\backdoor2.exe: backdoor2.exe.UNOFFICIAL FOUND</span></code>
	    </pre></div></div><p></p><p>As we expected,&nbsp;<span style="font-size:1rem">the </span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">ClamAV</span><span style="font-size:1rem"> tool flagged the </span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">backdoor2.exe</span><span style="font-size:1rem"> binary as malicious based on the database we provided. As a practice, add the AV-Check.exe's MD5 signature into the same database we already created, then check whether ClamAV can flag AV-Check.exe as malicious.<br><br></span></p><p><span style="font-size:24px">Yara Rules for Static Detection</span></p><p><span style="font-size:24px"></span></p><p>One of the tools that help in static detection is <a href="http://virustotal.github.io/yara/" target="_blank">Yara</a>. Yara is a tool that allows&nbsp;malware engineers to classify and detect malware. Yara uses rule-based detection, so in order to detect new malware, we need to create a new rule. ClamAV can also deal with Yara rules to detect malicious files. The rule will be the same as in our database in the previous section.&nbsp;</p><p>To create a rule, we need to examine and analyze the malware; based on the findings, we write a rule. Let's take AV-Check.exe as an example and write a rule for it.&nbsp;</p><p>First, let's analyze the file and list all human-readable strings in the binary using the strings tool. As a result, we will see all functions, variables, and nonsense strings. But, if you look closely, we can use some of the unique strings in our rules to detect this file in the future. The AV-Check uses a program database (.pdb), which contains a type and symbolic debugging information of the program during the compiling.</p>

<p>
</p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Command Prompt<br></div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">C:\Users\thm\Desktop\Samples&gt;strings AV-Check.exe | findstr pdb
C:\Users\thm\source\repos\AV-Check\AV-Check\obj\Debug\AV-Check.pdb</span></code>
	    </pre></div></div>
<p></p>

<p><span style="font-size:1rem">We will use the path in the previous command's output as our unique string example in the Yara rule that we will create. The signature could be something else in the real world, such as Registry keys, commands, etc. If you are not familiar with Yara, then we suggest checking the <a href="https://tryhackme.com/room/yara" target="_blank">Yara THM room</a>. The following is Yara's rule that we will use in our detection</span><span style="font-size:1rem">:</span></p>

<p>
</p><pre style="font-size:14px" class=" language-yara" tabindex="0"><code class=" language-yara">rule thm_demo_rule {
	meta:
		author = "THM: Intro-to-AV-Room"
		description = "Look at how the Yara rule works with ClamAV"
	strings:
		$a = "C:\\Users\\thm\\source\\repos\\AV-Check\\AV-Check\\obj\\Debug\\AV-Check.pdb"
	condition:
		$a
}</code></pre>
<p></p>

<p>Let's explain this Yara's rule a bit more.</p><ul><li>The rule starts with&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">rule thm_demo_rule</span><span style="font-size:1rem">,&nbsp;</span>which is the name of our rule. ClamAV uses this name if a rule matches.</li><li>The metadata section, which is general information, contains the author and description, which the user can fill.</li><li>The strings section contains the strings or bytecode that we are looking for. We are using the C# program's database path in this case. Notice that we add an extra&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">\</span><span style="font-size:1rem">&nbsp;in that path to escape the special character, so it does not break the rule.&nbsp;</span></li><li>In the condition section, we specify if the defined string is found in the string section, then flag the file.</li></ul><p>Note that Yara rules must store in a&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">.yara</span>&nbsp;extension file for ClamAV to deal with it. Let's re-scan the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">c:\Users\thm\Desktop\Samples</span>&nbsp;folder again using the Yara rule we created. You can find a copy of the Yara rule on the desktop at&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">c:\Users\thm\Desktop\Files\thm-demo-1.yara</span><span style="font-size:1rem">.</span></p>

<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Scanning using the Yara rule<br></div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">C:\Users\thm&gt;"c:\Program Files\ClamAV\clamscan.exe" -d Desktop\Files\thm-demo-1.yara Desktop\Samples
Loading:     0s, ETA:   0s [========================&gt;]        1/1 sigs
Compiling:   0s, ETA:   0s [========================&gt;]       40/40 tasks

C:\Users\thm\Desktop\Samples\AV-Check.exe: YARA.thm_demo_rule.UNOFFICIAL FOUND
C:\Users\thm\Desktop\Samples\backdoor1.exe: OK
C:\Users\thm\Desktop\Samples\backdoor2.exe: OK
C:\Users\thm\Desktop\Samples\eicar.com: OK
C:\Users\thm\Desktop\Samples\notes.txt: YARA.thm_demo_rule.UNOFFICIAL FOUND</span></code>
	    </pre></div></div><p></p>

<p>As a result, ClamAV can detect the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">AV-Check.exe</span>&nbsp;binary as malicious based on the Yara rule we provide. However, ClamAV gave a false-positive result where it flagged the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">notes.txt</span>&nbsp;file as malicious. If we open the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">notes.txt</span>&nbsp;file, we can see that the text contains the same path we specified in the rule.</p><p>Let's improve our Yara rule to reduce the false-positive result. We will be specifying the file type in our rule. Often, the types of a file can be identified using magic numbers, which are the first two bytes of the binary. For example, <a href="https://en.wikipedia.org/wiki/DOS_MZ_executable" target="_blank">executable files</a> (.exe) always start with the ASCII "MZ" value or "4D 5A" in hex.</p><p>To confirm this, let's use the <a href="https://mh-nexus.de/en/hxd/" target="_blank">HxD</a> application, which is a freeware Hex Editor, to examine the AV-Check.exe binary and see the first two bytes. Note that the HxD is&nbsp;<span style="font-size:1rem"><span>already available in the provided <a class="q699SEY1 glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;q699SEY1&#39;)">VM</a>.</span></span></p><p style="text-align:center"><img src="./TryHackMe _ Introduction to Antivirus_files/44dfc0fa904b0e4a9dfe983001d38a2e.png" alt="HxD Application" style="width:805px;height:321.641px"><span style="font-size:1rem"><br></span></p><p style="text-align:center"><span style="font-size:1rem">

</span></p>

<p>Knowing this will help improve the detection, let's include this in our Yara rule to flag only the .exe files that contain our signature string as malicious. The following is the improved Yara rule:</p><p>

</p><pre style="font-size:14px" class=" language-yara" tabindex="0"><code class=" language-yara">rule thm_demo_rule {
	meta:
		author = "THM: Intro-to-AV-Room"
		description = "Look at how the Yara rule works with ClamAV"
	strings:
		$a = "C:\\Users\\thm\\source\\repos\\AV-Check\\AV-Check\\obj\\Debug\\AV-Check.pdb"
		$b = "MZ"
	condition:
		$b at 0 and $a
}</code></pre>
<p></p>


<p></p><p>In the new Yara rule, we defined a unique string ($b) equal to the MZ as an identifier for the .exe file type. We also updated the condition section, which now includes the following conditions:</p><ol><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:decimal;--darkreader-inline-color:#dbd8d4;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:transparent"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:transparent">If the string "MZ" is found at the 0 location, the file's beginning.</span></li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:decimal;--darkreader-inline-color:#dbd8d4;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:transparent">If the unique string (the path) occurs within the binary.</li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:decimal;--darkreader-inline-color:#dbd8d4;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:transparent">In the condition section, we used the&nbsp;<span style="color:rgb(33, 37, 41);--darkreader-inline-color:#d1cdc7">&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">AND</span><span style="color:rgb(33, 37, 41);--darkreader-inline-color:#d1cdc7">&nbsp;operator for both&nbsp;</span>definitions in 1 and 2 are found, then we have a match.&nbsp;</li></ol><p>You can find the updated rule in&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">Desktop\Files\thm-demo-2.yara</span><span style="font-size:1rem">. Now that we have our updated Yara rule, now let's try it again.</span></p>

<p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Scanning using the Yara rule<br></div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">C:\Users\thm&gt;"c:\Program Files\ClamAV\clamscan.exe" -d Desktop\Files\thm-demo-2.yara Desktop\Samples
Loading:     0s, ETA:   0s [========================&gt;]        1/1 sigs
Compiling:   0s, ETA:   0s [========================&gt;]       40/40 tasks

C:\Users\thm\Desktop\Samples\AV-Check.exe: YARA.thm_demo_rule.UNOFFICIAL FOUND
C:\Users\thm\Desktop\Samples\backdoor1.exe: OK
C:\Users\thm\Desktop\Samples\backdoor2.exe: OK
C:\Users\thm\Desktop\Samples\eicar.com: OK
C:\Users\thm\Desktop\Samples\notes.txt: OK</span></code>
	    </pre></div></div><p></p>
<p><span>The output shows we improved our Yara rule to reduce the false-positive results. That was a simple example of how <a class="DeiVJpAW glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;DeiVJpAW&#39;)">AV</a> software works. Thus, AV software vendors work hard to fight against malware and improve their products and database to enhance the performance and accuracy of results.</span></p><p>The drawback of the signature-based detection is that files<span style="font-size:1rem">&nbsp;will have a different hash value if the binary is modified.&nbsp;</span><span>Therefore, it is easy for someone to bypass signature-based detection techniques if they know what <a class="dRWFzPmA glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;dRWFzPmA&#39;)">AV</a> software looks for and how to analyze binaries, as shown in later rooms.</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                What is the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">sigtool</span>&nbsp;tool output to generate an MD5 of the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em;--darkreader-inline-bgimage:initial;--darkreader-inline-bgcolor:rgba(96, 104, 108, 0.15);--darkreader-inline-color:#ec5c5c">AV-Check.exe</span>&nbsp;binary?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ********************************:****:********.***" value="f4a974b0cf25dca7fbce8701b7ab3a88:6144:AV-Check.exe" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Use the strings tool to list all human-readable strings of the AV-Check binary. What is the flag?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{**************}" value="THM{Y0uC4nC-5tr16s}" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-6">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse6">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 6                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Other Detection Techniques
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse6" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p>The concept of static detection is relatively simple. In this section, we will discuss the different types of detection techniques.<br><br></p><p><span style="font-size:24px">Dynamic Detection</span><br></p><p>The dynamic detection approach is advanced and more complicated than static detection. Dynamic detection is focused more on checking files at runtime using different methods. The following diagram shows the dynamic detection scanning flow:</p><p style="text-align:center"><img src="./TryHackMe _ Introduction to Antivirus_files/5d0d8cd90a2c4b2ce035af1f3b735563.png" alt="Dynamic detection flow"><br></p>
<p style="text-align:center"></p><p style="text-align:left">The first method is by monitoring Windows APIs. The detection engine inspects Windows application calls and monitors Windows API calls using Windows <a href="https://docs.microsoft.com/en-us/windows/win32/winmsg/about-hooks" target="_blank">Hooks</a>. </p><p style="text-align:left">Another method for dynamic detection is Sandboxing. A sandbox is a virtualized environment used to run malicious files separated from the host computer. This is usually done in an isolated environment, and the primary goal is to analyze how the malicious software acts in the system. Once the malicious software is confirmed, a unique signature and rule will be created based on the characteristic of the binary. Finally, a new update will be pushed into the cloud database for future use.</p><p style="text-align:left">This type of detection also has drawbacks because it requires executing and running the malicious software for a limited time in the virtual environment to protect the system resources. As with other detection techniques, dynamic detection can be bypassed. Malware developers implement their software to not work within the virtual or simulated environment to avoid dynamic analysis. For example, they check if the system spawns a real process of executing the software before running malicious activities or let the software wait sometime before execution.</p><p style="text-align:left">For more information about sandbox evasion, we suggest checking the THM room: <a href="https://tryhackme.com/room/sandboxevasion" target="_blank">Sandbox Evasion</a>!<br><br></p><p><span style="font-size:24px">Heuristic and Behavioral Detection</span><br></p><p><span>Heuristic and behavioral detection have become essential in today's modern <a class="kvlkI2yI glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;kvlkI2yI&#39;)">AV</a> products. Modern AV software relies on this type of detection to detect malicious software. The heuristic analysis uses various techniques, including static and dynamic heuristic methods:</span></p><ol><li>Static Heuristic Analysis is a process of decompiling (if possible) and extracting the source code of the malicious software. Then, the extracted source code is compared to other well-known virus source codes. These source codes are previously known and predefined in a heuristic database. If a match meets or exceeds a threshold percentage, the code is flagged as malicious.</li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:decimal"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Dynamic Heuristic Analysis is based on predefined behavioral rules. Security researchers analyzed suspicious software in isolated and secured environments. Based on their findings, they flagged the software as malicious. Then, behavioral rules are created to match the software's malicious activities within a target machine.</span></li></ol><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:decimal">The following are examples of behavioral rules:&nbsp;</p><p></p><ul><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc">If a process tries to interact with the LSASS.exe process that contains users' 
NTLM hashes, Kerberos tickets, and more</li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span>If a process opens a listening port and waits to receive commands from a Command 
and Control (C2) server</span></li></ul><p style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc">The following diagram shows the Heuristic and behavioral&nbsp;detection scanning flow:</p><p style="text-align:center;background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><img src="./TryHackMe _ Introduction to Antivirus_files/bbdeb1fd3e1140a20ebee8553b194054.png" alt="Heuristic and behavioral detection flow"><br></p><p style="text-align:center"><br></p><p><span style="font-size:24px">Summing up detection methods</span><br></p><p><span>Let's summarize how modern <a class="5064xM2n glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;5064xM2n&#39;)">AV</a> software works as one unit, including all components, and combines various features and detection techniques to implement its AV engine. The following is an example of the components of an antivirus engine:</span></p><p style="text-align:center"><img src="./TryHackMe _ Introduction to Antivirus_files/61b1c8a009202170cf3deee3cefe7ccf.png" alt="Detection methods summary"><br></p><p style="text-align:center"></p><p style="text-align:left"><span style="font-size:1rem">In the diagram, you can see a&nbsp;</span>suspicious<span style="font-size:1rem">&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Foobar.zip</span><span style="background-color:transparent;font-size:1rem">&nbsp;</span><span style="font-size:1rem"><span>file is passed to <a class="7NY6S2kv glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;7NY6S2kv&#39;)">AV</a> software to scan. AV software recognizes that it is a compressed file (.zip). </span></span><span style="font-size:1rem">Since the software supports .zip files, it&nbsp;</span><span style="font-size:1rem">applies an un-archiver feature to extract the files (</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Foobar.exe</span><span style="font-size:1rem">). Next, it identifies the file type to know which module to work with and then performs a PE parsing operation to pull the binary's information and other characteristic features. </span>Next, it checks whether the file is packed; if it is, it unpacks the code.<span style="font-size:1rem"><span>&nbsp;Finally, it passes the collected information and the binary to the <a class="o2nrhdXT glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;o2nrhdXT&#39;)">AV</a> engine, where it tries to detect if it is malicious and gives us the result.</span></span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Which detection method is used to analyze malicious software inside virtual environments?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ******* *********" value="Dynamic Detection" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-7">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse7">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 7                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> AV Testing and Fingerprinting 
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse7" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span style="font-size:24px"><span><a class="F4HTvMSw glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;F4HTvMSw&#39;)">AV</a> Vendors</span></span></p><p><span style="font-size:16px"><span>Many <a class="zVsZD82m glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;zVsZD82m&#39;)">AV</a> vendors in the market mainly focus on implementing a security product for home or enterprise users. Modern AV software has improved and now combines antivirus capabilities with other security features such as Firewall, Encryption, Anti-spam, EDR, vulnerability scanning, VPN, etc. </span></span></p><p><span style="font-size:16px"><span>It is important to note that it is hard to recommend which <a class="IKSn0pyp glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;IKSn0pyp&#39;)">AV</a> software is the best. It all comes down to user preferences and experience. Nowadays, AV vendors focus on business security in addition to end-user security.&nbsp;</span></span>We suggest checking the<a href="https://www.av-comparatives.org/list-of-enterprise-av-vendors-pc/" target="_blank"> AV comparatives website</a><span> for more details on enterprise <a class="xQhMU85B glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;xQhMU85B&#39;)">AV</a> vendors.</span><br></p><p><span style="font-size:24px"><span><a class="pZvhCTJg glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;pZvhCTJg&#39;)">AV</a> Testing Environment&nbsp;</span></span><br></p><p><span><a class="fQrGEzF0 glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;fQrGEzF0&#39;)">AV</a> testing environments are a great place to check suspicious or malicious files. You can upload files to get them scanned against various AV software vendors. Moreover, platforms such as VirusTotal use various techniques and provide results within seconds. As a red teamer or a pentester, we must test a payload against the most well-known AV applications to check the effectiveness of the bypass technique.</span><br></p><p><span style="font-size:24px">VirusTotal&nbsp;</span><span style="font-size:1rem"><br></span></p><p style="text-align:center"><img src="./TryHackMe _ Introduction to Antivirus_files/368287c08435172ac9740a2a68e4e3fa.png" style="width:407px;height:78.6826px"><br></p><p>VirusTotal is a well-known web-based scanning platform for checking suspicious files. It allows users to upload files to be scanned with over 70 antivirus detection engines. VirusTotal passes the uploaded files to the Antivirus engines to be checked, returns the result, and reports whether it is malicious or not. Many checkpoints are applied, including checking for blacklisted URLs or services, signatures, binary analysis, behavioral analysis, as well as checking for API calls. In addition, the binary will be run and checked in a simulated and isolated environment for better results. For more information and to check other features, you may visit the <a href="https://www.virustotal.com/" target="_blank">VirusTotal </a>website.<br><br></p><p></p><ul style="box-sizing:border-box;margin-top:0px;margin-bottom:1rem;color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;orphans:2;text-align:left;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial"></ul><p></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:1rem;color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;orphans:2;text-align:left;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial"><span style="box-sizing:border-box;font-size:24px">VirusTotal alternatives</span><br></p><p><strong>Important Note:</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">&nbsp;VirusTotal is a handy scanning platform with great features, but it has a sharing policy. All scanned results will be passed and shared with antivirus vendors to improve their products and update their databases for known malware. As a red teamer, this will burn a dropper or a payload you use in engagements. Thus, alternative solutions are available for testing against various security product vendors, and the most important advantage is that they do not have a sharing policy. However, there are other limitations. You will have a limited number of files to scan per day; otherwise, a&nbsp;</span><span style="color:rgb(14, 16, 26);font-size:1rem">subscription</span><span style="color:rgb(14, 16, 26);font-size:1rem">&nbsp;is needed&nbsp;</span><span style="background-color:transparent;color:rgb(14, 16, 26);font-size:1rem">for unlimited testing. For those reasons, we recommend you only test your malware on sites that do not share information, such as:</span></p><ul><li><a href="https://antiscan.me/" target="_blank">AntiscanMe</a>&nbsp;(6 free scans a day)</li><li><a href="https://virusscan.jotti.org/" target="_blank">Virus Scan Jotti's malware scan</a><br><br></li></ul><p><span style="font-size:24px"><span>Fingerprinting <a class="877JuCba glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;877JuCba&#39;)">AV</a> software</span></span><br></p><p><span>As a red teamer, we do not know what <a class="m9B3Ri8Q glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;m9B3Ri8Q&#39;)">AV</a> software is in place once we gain initial access to a target machine. Therefore, it is important to find and identify what host-based security products are installed, including AV software. AV fingerprinting is an essential process to determine which AV vendor is present. Knowing which AV software is installed is also quite helpful in creating the same environment to test bypass techniques.&nbsp;&nbsp;</span><br></p><p>This section introduces different ways to look at and identify antivirus software based on static artifacts, including service names, process names, domain names, registry keys, and filesystems.</p><p><span>The following table contains well-known and commonly used <a class="nGMX7aDM glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;nGMX7aDM&#39;)">AV</a> software.&nbsp;</span></p><table class="table table-bordered"><tbody><tr><td><b>Antivirus Name</b></td><td><b>Service Name</b></td><td><b>Process Name</b></td></tr><tr><td>Microsoft Defender</td><td>WinDefend</td><td>MSMpEng.exe</td></tr><tr><td>Trend Micro</td><td>TMBMSRV</td><td>TMBMSRV.exe<br></td></tr><tr><td>Avira</td><td>AntivirService, Avira.ServiceHost</td><td>avguard.exe, Avira.ServiceHost.exe</td></tr><tr><td>Bitdefender</td><td>VSSERV</td><td>bdagent.exe, vsserv.exe</td></tr><tr><td>Kaspersky</td><td>AVP&lt;Version #&gt;</td><td>avp.exe, ksde.exe<br></td></tr><tr><td>AVG</td><td>AVG Antivirus</td><td>AVGSvc.exe</td></tr><tr><td>Norton</td><td>Norton Security</td><td>NortonSecurity.exe</td></tr><tr><td>McAfee</td><td>McAPExe, Mfemms</td><td>MCAPExe.exe, mfemms.exe</td></tr><tr><td>Panda</td><td>PavPrSvr</td><td>PavPrSvr.exe</td></tr><tr><td>Avast</td><td>Avast Antivirus</td><td>afwServ.exe, AvastSvc.exe</td></tr></tbody></table><br><p><span style="font-size:24px">SharpEDRChecker</span></p><p><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span>One way to fingerprint <a class="mf0DrCAS glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;mf0DrCAS&#39;)">AV</a> is by using public tools such as&nbsp;</span></span><a target="_blank" href="https://github.com/PwnDexter/SharpEDRChecker" class="editor-rtfLink">SharpEDRChecker</a><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span>. It is written in C# and performs various checks on a target machine, including checks for <a class="Z5vfiZQx glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;Z5vfiZQx&#39;)">AV</a> software, like running processes, files' metadata, loaded DLL files, Registry keys, services, directories, and files.</span></span></p><p><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">We have pre-downloaded the SharpEDRChecker from the <a href="https://github.com/PwnDexter/SharpEDRChecker" target="_blank">GitHub repo</a><span>&nbsp;so that we can use it in the attached <a class="7thiMFNr glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;7thiMFNr&#39;)">VM</a>. Now we need to compile the project, and we have already created a shortcut to the project on the desktop (SharpEDRChecker). To do so, double-click on it to open it in Microsoft Visual Studio 2022. Now that we have our project ready, we need to compile it, as shown in the following screenshot:</span></span></p><p style="text-align:left"><img src="./TryHackMe _ Introduction to Antivirus_files/9f2dc2083d2a8227b688cef623ac9bf8.png"><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><br></span></p><div style="text-align:center"></div><p>Once it is compiled, we can find the path of the compiled version in the output section, as highlighted in step 3. We also added a copy of the compiled version in the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">C:\Users\thm\Desktop\Files</span><span style="font-size:1rem"> directory.&nbsp;</span><span style="font-size:1rem">Now let's try to run it and see the result as follows:</span></p>

<p>
</p><table style="border-collapse:collapse;width:100%">
<tbody>
<tr>
<td style="width:26.2964%">
<div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Command Prompt!</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
<code class=" language-shell-session"><span class="token output">C:\&gt; SharpEDRChecker.exe










</span></code></pre>
</div>
</div>
</td>
<td style="width:2.2708%;text-align:center"><span style="font-size:24px">➜</span></td>
<td style="width:71.4327%">
<div class="terminal-container"><div class="terminal-content"><div class="terminal-top">SharpEDRChecker's Summary</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
<code class=" language-shell-session"><span class="token output">[!] Directory Summary:
   [-] C:\Program Files\Windows Defender : defender
   [-] C:\Program Files\Windows Defender Advanced Threat Protection : defender, threat
   [-] C:\Program Files (x86)\Windows Defender : defender

[!] Service Summary:
   [-] PsShutdownSvc : sysinternal
   [-] Sense : defender, threat
   [-] WdNisSvc : defender, nissrv
   [-] WinDefend : antimalware, defender, malware, msmpeng
   [-] wscsvc : antivirus</span></code>
</pre></div></div>
</td>
</tr>
</tbody>
</table>
<p></p>




<p><span style="font-size:1rem"><span>As a result, the Windows Defender is found based on folders and services. Note that this program may be flagged by <a class="cEl5lipi glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;cEl5lipi&#39;)">AV</a> software as malicious since it does various checks and APIs calls.&nbsp;</span><br></span></p><p><span style="font-size:24px">C# Fingerprint checks</span></p><p><span style="font-size:16px"><span>Another way to enumerate <a class="u11PEmdX glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;u11PEmdX&#39;)">AV</a> software is by coding our own program.</span></span><span>&nbsp;We have prepared a C# program in the provided Windows 10 Pro <a class="HVq5JNkV glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;HVq5JNkV&#39;)">VM</a>, so we can do some hands-on experiments! You can find the project's icon on the desktop (AV-Check) and double-click it to open it using Microsoft Visual Studio 2022.&nbsp;</span></p><p><span>The following C# code is straightforward, and its primary goal is to determine whether <a class="hWTdKwLA glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;hWTdKwLA&#39;)">AV</a> software is installed based on a predefined list of well-known AV applications.</span><br></p><span style="font-size:16px">
</span><p>
</p><pre style="font-size:14px" class=" language-csharp" tabindex="0"><code class=" language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Management</span><span class="token punctuation">;</span>

<span class="token keyword">internal</span> <span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> status <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"[+] Antivirus check is running .. "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> AV_Check <span class="token operator">=</span> <span class="token punctuation">{</span> 
            <span class="token string">"MsMpEng.exe"</span><span class="token punctuation">,</span> <span class="token string">"AdAwareService.exe"</span><span class="token punctuation">,</span> <span class="token string">"afwServ.exe"</span><span class="token punctuation">,</span> <span class="token string">"avguard.exe"</span><span class="token punctuation">,</span> <span class="token string">"AVGSvc.exe"</span><span class="token punctuation">,</span> 
            <span class="token string">"bdagent.exe"</span><span class="token punctuation">,</span> <span class="token string">"BullGuardCore.exe"</span><span class="token punctuation">,</span> <span class="token string">"ekrn.exe"</span><span class="token punctuation">,</span> <span class="token string">"fshoster32.exe"</span><span class="token punctuation">,</span> <span class="token string">"GDScan.exe"</span><span class="token punctuation">,</span> 
            <span class="token string">"avp.exe"</span><span class="token punctuation">,</span> <span class="token string">"K7CrvSvc.exe"</span><span class="token punctuation">,</span> <span class="token string">"McAPExe.exe"</span><span class="token punctuation">,</span> <span class="token string">"NortonSecurity.exe"</span><span class="token punctuation">,</span> <span class="token string">"PavFnSvr.exe"</span><span class="token punctuation">,</span> 
            <span class="token string">"SavService.exe"</span><span class="token punctuation">,</span> <span class="token string">"EnterpriseService.exe"</span><span class="token punctuation">,</span> <span class="token string">"WRSA.exe"</span><span class="token punctuation">,</span> <span class="token string">"ZAPrivacyService.exe"</span> 
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">var</span></span> searcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ManagementObjectSearcher</span><span class="token punctuation">(</span><span class="token string">"select * from win32_process"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">var</span></span> processList <span class="token operator">=</span> searcher<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> process <span class="token keyword">in</span> processList<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">int</span></span> _index <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span>AV_Check<span class="token punctuation">,</span> process<span class="token punctuation">[</span><span class="token string">"Name"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>_index <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"--AV Found: {0}"</span><span class="token punctuation">,</span> process<span class="token punctuation">[</span><span class="token string">"Name"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                status <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            i<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>status<span class="token punctuation">)</span> <span class="token punctuation">{</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"--AV software is not found!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p><span>Let's explain the code a bit more. We have predefined a list of well-known <a class="3BGrtjuM glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;3BGrtjuM&#39;)">AV</a> applications in the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">AV_Check</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem"><span>array within our code, which is taken from the previous section, where we discussed fingerprinting <a class="Jd4SmR1P glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;Jd4SmR1P&#39;)">AV</a> software (table above). Then, we use the Windows Management Instrumentation Command-Line (WMIC) query (</span></span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">select * from win32_process</span><span style="font-size:1rem">) to list all currently running processes in the target machine and store them in the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">processList</span><span style="font-size:1rem">&nbsp;variable</span><span style="font-size:1rem">. Next, we go through the currently running processes and compare if they exist in the </span>predefined<span style="font-size:1rem"><span>&nbsp;array. If a match is found, then we have <a class="Ehf7jNpt glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;Ehf7jNpt&#39;)">AV</a> software installed.</span></span></p><p><span style="font-size:16px"><span>The C# program utilizes a WMIC object to list current running processes, which may be monitored by <a class="VjMIf8t2 glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;VjMIf8t2&#39;)">AV</a> software. If AV software is poorly implemented to monitor the WMIC queries or Windows APIs, it may cause false-positive results in scanning our C# program. </span></span></p><p>Let's compile an x86 version of the C# program, upload it to the VirusTotal website, and check the results!&nbsp;<span style="font-size:1rem">To compile the C# program in the Microsoft Visual Studio 2022, select <b>Build </b>from the bar menu and choose the <b>Build Solution</b> option. Then, if it complied correctly, you can find the path of the compiled version in the output section, as highlighted in step 3 in the screenshot below.</span></p><p></p><div style="text-align:center"><img src="./TryHackMe _ Introduction to Antivirus_files/4abf4090797989e9457af9a2cb18a35b.png" alt="Compiling the C# project"><br></div><p><span></span></p><div style="text-align:left"><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">If we upload the AV-Check program to the&nbsp;</span><a target="_blank" href="https://www.virustotal.com/gui/home/upload" class="editor-rtfLink">VirusTotal website</a><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span>&nbsp;and check the result, surprisingly, VirusTotal showed that two <a class="dIOIQyTe glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;dIOIQyTe&#39;)">AV</a> vendors (MaxSecure and SecureAge APEX) flagged our program as malicious! Thus, this is a false-positive result where it incorrectly identifies a file as malicious where it is not. One of the possible reasons is that these AV vendors' software uses a machine-learning classifier or rule-based detection method that is poorly implemented. For more details about the actual submission report, see&nbsp;</span></span><a target="_blank" href="https://www.virustotal.com/gui/file/5f7d3e6cf58596a0186d89c20004c76805769f9ef93dc39e346e7331eee9e7ff?nocache=1" class="editor-rtfLink">here</a><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">. There are four main sections: Detection, Details, Behavior, and Community. If we check the Behavior section, we can see all calls of Windows APIs, Registry keys, modules, and the WMIC query.</span><br></div><p></p><p style="text-align:center;box-sizing:border-box;margin-top:0px;margin-bottom:1rem;color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial"><img src="./TryHackMe _ Introduction to Antivirus_files/87289129012d58c2d77c1791131333c3.png" alt="VirusTotal check" style="width:100%"><span style="box-sizing:border-box;font-size:1rem"><br></span></p><p><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">In the Detection section, there are Sigma rules that, if a system event during execution is matched (in the sandbox environment), consider the file malicious. This result is likely based on the rules; VirusTotal flagged our program because of the&nbsp;</span><a target="_blank" href="https://pentestlaboratories.com/2021/12/08/process-ghosting/" class="editor-rtfLink">Process Ghosting technique</a><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">, as shown in the following screenshot.</span><br></p><p style="text-align:center"><img src="./TryHackMe _ Introduction to Antivirus_files/c4de9def10a394bc77b0b05580cae8e5.png" alt="VirusTotal check" style="width:883.333px;height:302.389px"><span style="font-size:1rem"><br></span></p><p><span style="font-size:1rem"><span>Now let's re-compile the C# program using an x64 CPU and check if the check engines act differently. In our submission attempt this time, three <a class="qINC4ygT glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;qINC4ygT&#39;)">AV</a> vendors' software (Cyren AV is added to the list) flagged the file as malicious.&nbsp;</span></span><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">For more details about the actual submission report, look&nbsp;</span><a target="_blank" href="https://www.virustotal.com/gui/file/b092173827888ed62adea0c2bf4f451175898d158608cf7090e668952314e308?nocache=1" class="editor-rtfLink">here</a><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">.&nbsp;</span></p><p></p><div style="text-align:center"><img src="./TryHackMe _ Introduction to Antivirus_files/6992f821933117c890b129f63cbbcebf.png" alt="VirusTotal check" style="width:100%"></div><div style="text-align:center"><br></div><div style="text-align:left"><strong>Note:</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span>&nbsp;if you try to submit a file to the VirusTotal website, it may give you a different result. Keep in mind that VirusTotal shares submission reports with the Antivirus vendors to improve their <a class="cOPojhGm glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;cOPojhGm&#39;)">AV</a> detection engines, including false-positive results.</span></span></div><p></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details"><span>
                                For the C# AV fingerprint, try to rewrite the code in a different language, such as Python, and check whether VirusTotal flag it as malicious.
                            </span></div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="7">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Read the Above!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="7">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-8">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse8">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 8                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Conclusion
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse8" class="collapse " data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span style="font-size:24px">Recap</span></p><p><span>In this room, we covered Antivirus software and its detection approaches. As a red teamer, it is important to know how <a class="FhaDn22O glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;FhaDn22O&#39;)">AV</a> software works and detects malicious applications to be able to implement bypass techniques.</span></p><p>We also discussed the static detection technique in detail and showcased how ClamAV, an open-source Antivirus, detects malicious files using static analysis. Additionally, we showed how to create your own database and use Yara rules to detect malicious files that are not detected by the official database.</p><p><span>Once we obtain access to a target, it is essential to enumerate the target machine before performing further actions, such as privilege escalation or lateral movement. The reason is to not trigger alerts for suspicious activities, which may cause losing access to the target machine. Thus, we introduced two methods to practice <a class="id8xw030 glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;id8xw030&#39;)">AV</a> fingerprinting using public and private tools.</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <div>Congrats on completing the room, and keep learning!</div>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="8">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div></div>
</div>
<div id="room-simple-details"><div class="card cd-2 text-center mt-3"><div class="card-body"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Introduction to Antivirus_files/af7feb2c43a2c7d5f111b98ccbd15048.png"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme">tryhackme</a> and <img class="avatar-tiny" src="./TryHackMe _ Introduction to Antivirus_files/26286532ed37cf8b7b375905f4306110.png"> 
        <a class="green-link" href="https://tryhackme.com/p/arebel">arebel</a></p><p class="mb-0">This is a <b>free</b> room, which means anyone can deploy virtual machines in the room 
        (without being subscribed)! 11157 users are in here and this room is 362 days old.</p></div></div></div>

</div>
</div>
</div>
<div id="room-content-attackbox">
<div id="room-attackbox">
<div id="attackbox-machine-instance">
<div id="room-attackbox-loading"></div>
<div id="room-attackbox-vm-view"></div>
</div>
<div id="attackbox-machine-options">
<div class="d-flex">
<a target="_blank" id="room-attackbox-url" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="View in full screen"></a>
<div onclick="extendHourWebBasedVM(null)" class="hover-pointer" id="room-attackbox-extend" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Extend machines timer"><i class="fas fa-plus"></i></div>
<div onclick="terminateWebBasedVM(null)" class="hover-pointer" id="room-attackbox-terminate" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Terminate Machine"><i class="far fa-power-off"></i></div>
<div onclick="exitViewAttackBox()" class="hover-pointer" id="room-attackbox-exitview" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Exit split view"><i class="fas fa-minus"></i></div>
<div onclick="infoAttackBox()" class="hover-pointer faded" id="room-attackbox-info" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Machine Information"><i class="fas fa-info"></i></div>
<div class="d-flex" id="room-attackbox-tabs"></div>
</div>
<div id="room-attackbox-expire-text" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Time left until your AttackBox expires"></div>
</div>
</div>
<div class="modal fade" id="attackBoxInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-light-gray">
<h5 class="modal-title m-auto">Web-Based Machine Information</h5>
</div>
<div class="modal-body">
<p>Use the web-based machine to attack other target machines you start on TryHackMe.</p>
<ul class="normalList text-gray mt-3 mb-4">
<li>Public IP: <code id="browser-machine-pubip" class="dark size-14"></code></li>
<li class="mt-1">Private IP: <code id="browser-machine-privip" class="dark size-14"></code> <span class="size-14">(Use this for your reverse shells)</span></li>
<li class="mt-1">Username: <code id="browser-username" class="dark size-14"></code></li>
<li class="mt-1">Password: <code id="browser-password" class="dark size-14"></code></li>
<li class="mt-1">Protocol: <code id="browser-protocol" class="dark size-14"></code></li>
</ul>
<hr class="hr-min">
<ul class="text-lgray mb-0">
<li class="mt-2">To copy to and from the browser-based machine, highlight the text and press <b>CTRL+SHIFT+C</b> <details><summary>or use the clipboard</summary><img src="./TryHackMe _ Introduction to Antivirus_files/clipboard.gif"></details></li>
<li class="mt-2">When accessing target machines you start on TryHackMe tasks, make sure you're using the correct IP (it <b>should not be</b> the IP of your AttackBox)</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="award-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<button type="button" class="close size-30 text-lgray" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<div id="award-modal-badges"></div>
<p class="mb-0 text-lgray size-18">Complete the room to earn this badge</p>
</div>
</div>
</div>
</div>
<div class="modal fade" id="hint-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title"><i class="fal fa-lightbulb-on"></i> Question Hint</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body"></div>
</div>
</div>
</div>
<div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">...</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center"></div>
<div class="modal-footer"></div>
</div>
</div>
</div>
<link rel="stylesheet" href="./TryHackMe _ Introduction to Antivirus_files/modal.css">
<div class="modal-design-green modal fade" id="roomCompleted" tabindex="-1" role="dialog" data-backdrop="static" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content" id="roomCompletedModalContent">
<div class="modal-body text-center">
<button type="button" class="close" id="closeRoomComplete" aria-label="Close">
<i class="fad fa-times-circle"></i>
</button>
<div class="icon-box">
<i class="fad fa-badge-check"></i>
</div>
<h3 class="text-accent mt-5">Congratulations</h3>
<p class="faded mt-1">You've completed the room! Share this with your friends: </p>
<h2 id="roomCompleted-share"></h2>
<div id="ticket-info"></div> 
<p class="faded mt-1" id="roomFeedbackBtn">
<small>
<button class="bg-white border-0">Leave
feedback</button>
</small>
</p>
<form method="post" action="https://tryhackme.com/feedback" id="roomFeedbackForm" class="d-none mt-3">
<input type="hidden" name="_csrf" value="U7bOwoE4-1ZrunescUNQuosg6moA80HbxBtA">
<input type="hidden" name="roomCode" value="introtoav">
<input type="hidden" name="type" value="rooms">
<input type="hidden" name="redirect" value="json">
<div class="form-group">
<label class="mb-0" for="like">What do you like about the room?</label>
<textarea type="text" name="like" id="like" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="dislike">What don't you like about the room?</label>
<textarea type="text" name="dislike" id="dislike" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="details">Please send your suggestions, ideas and comments!</label>
<textarea id="details" type="text" name="details" class="form-control" style="padding: 5px;"></textarea>
</div>
<button type="submit" id="submitBtn" class="btn btn-success">Send Feedback</button>
</form>
<p class="mt-2 mb-0" id="formMessage"></p>
</div>
</div>
</div>
<script>
    function dismissRoomCompleteModal() {
      $('#roomCompleted').modal('hide');

      const shouldSeeReferralModal = ""
      if (shouldSeeReferralModal) {
        $('#unlockCreditModal').modal('show');

        referralModalEvent('view');
      }
    }

    document.getElementById('closeRoomComplete').addEventListener('click', dismissRoomCompleteModal)
  </script>
</div>
<script src="./TryHackMe _ Introduction to Antivirus_files/roomFeedback.js"></script>
<div class="modal fade" id="roomStartAttackboxModal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static" data-keyboard="false">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title m-auto">To access this machine, you need to either</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close" style="position: absolute; right: 10px; top: 0; font-size: 30px;">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center">
<div class="row vertical-align-custom mb-0">
<div class="col-sm-5 pr-0">
<p class="size-18 bold">Use a VPN</p>
<p>Connect to our network via a VPN</p>
<a target="_blank" href="https://tryhackme.com/access"><button type="button" class="btn btn-light">See Instructions</button></a>
</div>
<div class="col-sm-2 size-24">
or
</div>
<div class="col-sm-5 pl-0">
<p class="size-18 bold">Use the AttackBox</p>
<p>Use a web-based attack machine <span class="size-12">(recommended)</span></p>
<button type="button" onclick="$(&#39;#roomStartAttackboxModal&#39;).modal(&#39;toggle&#39;); startAttackBox({startingMsg: false, tutorial: true})" class="btn btn-hgreen">Start AttackBox</button>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="expireSoon" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-warning fad fa-exclamation-triangle"></i></h1>
<h3 class="text-warning">Expiring Soon</h3>
<p class="faded mt-3 mb-0">Your machine is going to expire soon. Close this and add an hour to stop it from terminating!</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="terminatedMachine" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-danger fad fa-exclamation-triangle"></i></h1>
<h3 class="text-danger">Expired Machine</h3>
<p class="faded mt-3 mb-0">Your machine has expired and terminated.</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="machineDeployModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue text-center p-3">
<h4 class="mb-0 m-auto">How to access machines</h4>
<button type="button" class="close modal-close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center">
<p class="size-18 faded">Now you've started your machine, to access it you need to either</p>
<div class="row mb-0">
<div class="col-sm-6">
<img src="./TryHackMe _ Introduction to Antivirus_files/connect_openvpn_short.png">
<p class="mt-2 mb-0 faded">Download your VPN configuration file and import it into a OpenVPN client</p>
</div>
<div class="col-sm-6">
<img src="./TryHackMe _ Introduction to Antivirus_files/connect_kali_short.png">
<p class="mt-2 mb-0 faded">Control a web-based machine with everything you need, all from inside your browser</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="roomAlertModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title" id="roomAlertModalTitle"></h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body" id="roomAlertModalBody"></div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="resetUserProgressModal" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">Reset Your Progress</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<div><span class="text-danger"><i class="fas fa-exclamation-triangle"></i> Warning</span> You will keep your points but all your answers in this room will be erased.</div>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-danger" onclick="resetProgress()">Yes, please!</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="cloudEnvInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header  modal-dark-blue">
<h5 class="modal-title">Cloud Information</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<ul class="nav nav-tabs">
<li class="nav-item pr-2">
<a class="nav-link active" data-toggle="tab" href="https://tryhackme.com/room/introtoav#env-tab">Environment</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/introtoav#creds-tab">Credentials</a>
</li>
</ul>
<div class="tab-content">
<div class="tab-pane active" id="env-tab"></div>
<div class="tab-pane" id="creds-tab"></div>
</div>
</div>
<div class="modal-footer" id="cloudEnvModalFooter">
</div>
</div>
</div>
</div>
<div class="modal fade" id="setNameModal" role="dialog">
<div class="modal-dialog modal-lg modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title">Generating Your Certificate</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body container">
<div class="row">
<div class="col-6">
<h5 class="bold">Hey there, what's your name?</h5>
<p class="text-secondary">
If you want your name to appear on your certificate, please fill the field below.
</p>
<div class="form-group">
<label>Full Name </label>
<input id="modal-cert-field-name" type="text" placeholder="John Wick" class="mb-4 form-control">
<input id="modal-cert-field-email" type="hidden" value="giftonpaul@karunya.edu.in">
</div>
</div>
<div class="col-6">
<h5 class="bold">You're here incognito? It's ok!</h5>
<p class="text-secondary">If you chose skip, your username will be used instead!</p>
</div>
</div>
<div class="row">
<div class="col-6">
<button type="button" class="btn btn-success float-right" id="modal-cert-generate" onclick="gen_cert(true)" disabled="">
Generate with my full name
</button>
</div>
<div class="col-6">
<button type="button" class="btn btn-primary float-right" id="modal-cert-skip" onclick="gen_cert(false)">
Generate with my username
</button>
</div>
</div>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Introduction to Antivirus_files/certificateName.js"></script>
<div class="modal fade slideout-faq" id="roomSlideoutUnstuck" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-links">
<div id="unstuck-video" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-play"></i></div>
<div class="unstuck-icon-text">Video Solution</div>
</div>
<div id="unstuck-writeups" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-pen-alt"></i></div>
<div class="unstuck-icon-text">Writeups</div>
</div>
<a id="unstuck-forum" target="_blank" class="clear-link unstuck-group" href="https://tryhackme.com/forum/thread/627178922cd7150052389911">
<div class="unstuck-icon"><i class="fas fa-comments-alt"></i></div>
<div class="unstuck-icon-text">Forum Post</div>
</a>
<a href="https://help.tryhackme.com/en/collections/3601905-getting-started-with-tryhackme" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-books"></i></div>
<div class="unstuck-icon-text">Knowledge Base</div>
</a>
<a href="https://discord.gg/DpBZz8y" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-users"></i></div>
<div class="unstuck-icon-text">Ask Community</div>
</a>
</div>
</div>
</div>
</div>
</div>
<style>

    #navConnModal .modal-body{
        position: relative;
    }

    #nav-openvpn,
    #nav-attackbox {
        display: none;
    }

    #nav-openvpn .nav-pills .nav-link.active,
    #nav-openvpn .nav-pills .show>.nav-link {
        background-color: #ec8e3d;
        color: white;
    }
    #nav-openvpn .nav-link {
        color: #909090;
    }
    #nav-openvpn a,
    #nav-attackbox a {
        color: #ec8e3d;
    }

    #nav-openvpn code.dark {
        background-color: #7d400a;
        color: #fff;
    }

    #slideout-bk {
        display: none;
        padding: 10px 15px;
        opacity: 0.8;
        cursor: pointer;
    }

    #slideout-bk:hover {
        opacity: 1;
    }

    #slideout-conn-hideip {
        display: none;
        position: absolute;
        bottom: 8px;
        right: 8px;
        opacity: 0.7;
        cursor: pointer;
    }

    #slideout-conn-hideip:hover {
        opacity: 1;
    }

</style>
<div class="modal fade slideout-faq" id="navConnModal" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-bk" class="noselect" onclick="showSlideoutConnOptions()"><i class="far fa-arrow-left mr-2"></i> Show Connection Options</div>
<div id="slideout-conn-options">
<div id="slideout-conn-header" class="text-center">
<img class="slideout-connect-img" src="./TryHackMe _ Introduction to Antivirus_files/tryhackme_connect.png">
<div id="slideout-conn-status" class="size-22">You are <span class="text-danger">disconnected</span></div>
</div>
<div class="m-3 text-center">
<p>To access target machines you need to either:</p>
<div class="row mb-3 faq-quicklinks text-left vertical-align-custom">
<div class="col-md-12 mb-3">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/introtoav#" onclick="showAttackBoxSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-laptop"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">AttackBox</div>
<p class="faded mb-0">Use a browser-based attack machine</p>
</div>
</div>
</div>
</a>
</div>
<div class="col-md-12">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/introtoav#" onclick="showVPNSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-key"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">OpenVPN</div>
<p class="faded mb-0">Connect to our network via a VPN</p>
</div>
</div>
</div>
</a>
</div>
</div>
</div>
</div>
<div id="faqCards" class="p-3">
<div id="nav-openvpn">
<div class="mb-3">
<a target="_blank" href="https://tryhackme.com/access"><i>View the dedicated OpenVPN access page for more information</i></a>
</div>
<div class="text-center">
<h4>What Operating System are you using?</h4>
<ul class="nav nav-pills mb-3 text-center" id="vpn-guide" style="display: flex; justify-content: center;">
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/introtoav#pills-windows" role="tab" aria-controls="pills-windows" aria-selected="true"><i class="fab fa-windows mr-2"></i> Windows</a>
</li>
<li class="nav-item m-3">
<a class="nav-link active" data-toggle="pill" href="https://tryhackme.com/room/introtoav#pills-linux" role="tab" aria-controls="pills-linux" aria-selected="false"><i class="fab fa-linux mr-2"></i> Linux</a>
</li>
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/introtoav#pills-macos" role="tab" aria-controls="pills-macos" aria-selected="false"><i class="fab fa-apple mr-2"></i> MacOS</a>
</li>
</ul>
<div class="tab-content text-left">
<div class="tab-pane fade" id="pills-windows" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a target="_blank" href="https://openvpn.net/client-connect-vpn-for-windows/">Download</a> the OpenVPN GUI application.</li>
<li class="mt-2">Install the OpenVPN GUI application. Then open the installer file and follow the setup wizard.</li>
<li class="mt-2">Open and run the OpenVPN GUI application as Administrator.<br><img class="mt-2 mb-3" src="./TryHackMe _ Introduction to Antivirus_files/win_ran_admin.png"></li>
<li class="mt-2">The application will start running in the system tray. It's at the bottom of your screen, near the clock. Right click on the application and click <b>Import File</b>. <br><img class="mt-2 mb-3" src="./TryHackMe _ Introduction to Antivirus_files/win_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Now right click on the application again, select your file and click Connect <br><img class="mt-2 mb-3" src="./TryHackMe _ Introduction to Antivirus_files/win_connect.png"></li>
</ol>
</div>
<div class="tab-pane fade show active" id="pills-linux" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2">Run the following command in your terminal: <code class="dark">sudo apt install openvpn</code></li>
<li class="mt-2">Locate the full path to your VPN configuration file (normally in your ~/Downloads folder).</li>
<li class="mt-2">Use your OpenVPN file with the following command: <code class="dark">sudo openvpn /path/to/file.ovpn</code></li>
</ol>
</div>
<div class="tab-pane fade" id="pills-macos" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a href="https://openvpn.net/downloads/openvpn-connect-v2-macos.dmg">Download</a> OpenVPN for MacOS.</li>
<li class="mt-2">Install the OpenVPN GUI application, by opening the dmg file and following the setup wizard.<br><img width="250" class="mt-2 mb-3" src="./TryHackMe _ Introduction to Antivirus_files/mac_installer.png"></li>
<li class="mt-2">Open and run the OpenVPN GUI application.</li>
<li class="mt-2">The application will start running and appear in your top bar. Right click on the application and click <b>Import File -&gt; Local file</b>.<br><img class="mt-2 mb-3" src="./TryHackMe _ Introduction to Antivirus_files/mac_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Right click on the application again, select your file and click connect.<br><img class="mt-2 mb-3" src="./TryHackMe _ Introduction to Antivirus_files/mac_connect.png"></li>
</ol>
</div>
</div>
<section class="text-left">
<a class="remove-underline" data-toggle="collapse" href="https://tryhackme.com/room/introtoav#havingProblems" role="button" aria-expanded="false" aria-controls="havingProblems">
<h5 class="mb-0 text-openvpn">Having Problems?</h5>
</a>
<div class="collapse" id="havingProblems">
<ul class="mt-2 mb-0">
<li>If you can access <a target="_blank" href="http://10.10.10.10/">10.10.10.10</a>, you're connected.</li>
<li>Downloading and getting a 404? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>Getting inline cert error? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>If you are using a virtual machine, you will need to run the VPN inside that machine.</li>
<li>Is the OpenVPN client running as root? <span class="size-14 faded">(On Windows, run OpenVPN GUI as administrator. On Linux, run with sudo)</span></li>
<li>Have you restarted your VM?</li>
<li>Is your OpenVPN up-to-date?</li>
<li>Only 1 OpenVPN connection is allowed. <span class="size-14 faded">(Run <code class="dark">ps aux | grep openvpn</code> - are there 2 VPN sessions running?)</span></li>
<li>Still having issues? Check our <a href="https://help.tryhackme.com/en/articles/6496029-openvpn-general-troubleshooting-detailed/">docs</a> out.</li>
</ul>
</div>
</section>
</div>
</div>
<div id="nav-attackbox">
<div class="text-center">
<h4>AttackBox</h4>
<p class="faded">Use your own web-based linux machine to access machines on TryHackMe</p>
</div>
<p>To start your AttackBox in the room, click the <a class="preventDefault" onclick="showAttackBoxBtnFromSlideout()" href="https://tryhackme.com/room/introtoav#">Start AttackBox</a> button. Your private machine will take 2 minutes to start.</p>
<p>Free users get 1 free AttackBox hour. <a class="hacker-green" href="https://tryhackme.com/why-subscribe">Subscribed</a> users get more powerful machines with unlimited deploys.</p>
</div>
</div>
<span id="slideout-conn-hideip" onclick="hideNavConnIP()" style="display: none;">Hide IP</span>
</div>
</div>
</div>
</div>
<script>

    const navConnVPNEl = document.querySelector('#nav-openvpn')
    const navConnAttackBoxEl = document.querySelector('#nav-attackbox')
    const navConnOptions = document.querySelector('#slideout-conn-options')

    const navConnBkBtn = document.querySelector('#slideout-bk')

    function showVPNSteps() {
        navConnOptions.style.display = 'none'
        navConnVPNEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showAttackBoxSteps() {
        navConnOptions.style.display = 'none'
        navConnAttackBoxEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showSlideoutConnOptions() {
        navConnVPNEl.style.display = 'none'
        navConnAttackBoxEl.style.display = 'none'
        navConnBkBtn.style.display = 'none'
        navConnOptions.style.display = 'block'
    }

    function showAttackBoxBtnFromSlideout() {
        $('#navConnModal').modal('toggle')
        setTimeout(function() {
            showAttackBoxBtnIntro()
        }, 100)   
    }

  </script>
</div>
<script src="./TryHackMe _ Introduction to Antivirus_files/notify.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/api-requests.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/events.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/underscore-min.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/apexcharts.min.js"></script> 
<script src="./TryHackMe _ Introduction to Antivirus_files/chart.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/expire.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/sockets.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/faqSearch.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/certificate.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/utils.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/roomSpecific.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/confetti.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/videos.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/intro.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/prism.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/asciinema-player.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/magnific-popup.min.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/introjsLogic.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/logic.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/tasks.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/connection-status.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/glossary.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/room-mymachine.js"></script>
<script src="./TryHackMe _ Introduction to Antivirus_files/heartbeat.js" defer=""></script>
<script>

    let height
    $(window).scroll(function () { /* Function to make IP information sticky. */
      if (height == undefined || height < 30) {
        height = ($('#instance-info').offset().top)
      }
      let scroll = $(window).scrollTop()
      if (((scroll >= (height + 150))) && height > 30) {
        $("#instance-info").addClass('instance-sticky')
      } else if ((scroll <= (height))) {
        $("#instance-info").removeClass("instance-sticky")
      }
    })

    const csrfToken = "U7bOwoE4-1ZrunescUNQuosg6moA80HbxBtA"
    $.ajaxSetup({ headers: { 'CSRF-Token': csrfToken } }) // all $.post headers include token (needs csrfProtection middleware)

    const roomCode = "introtoav"
    const simpleRoom = true 
    const events = {"tickets":false}

    let userObj = { 
      subscribed: 1,
      splitScreen: true,
      path: "redteaming",
      tutorial: {
        rooms: true,
        attackbox: true,
        staticsite: true
      },
      experiments:  JSON.parse(`{"onboardingAchievement":{},"scheduler":{"startDate":"2023-06-14T13:38:51.108Z"},"showEasyPath":true}`),
    }

    const roomSettings = {
      remAttackBoxBtn : false
    };

    const heartbeatInterval = 30;

    const cloudEnabled = false 
    let cloudObj

    initRoom()
    checkVideoTab()
    if(!simpleRoom) showChart(roomCode)

    checkRoomAwards(roomCode)

    getRoomVotes()

    displayStreakFreezeAwardedFromMemory();
    
    window.addEventListener('load', function () {
      introjsInit(roomCode)
    })

  </script>


<svg id="SvgjsSvg1001" width="2" height="0" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.dev" style="overflow: hidden; top: -100%; left: -100%; position: absolute; opacity: 0;"><defs id="SvgjsDefs1002"></defs><polyline id="SvgjsPolyline1003" points="0,0"></polyline><path id="SvgjsPath1004" d="M0 0 "></path></svg><div id="AC779A4B-3CF3-DCB3-A6EB-3F3F0F903018"></div><iframe id="_hjSafeContext_49473403" title="_hjSafeContext" tabindex="-1" aria-hidden="true" src="./TryHackMe _ Introduction to Antivirus_files/saved_resource.html" style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;"></iframe><iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" aria-hidden="true" tabindex="-1" title="Intercom" src="./TryHackMe _ Introduction to Antivirus_files/saved_resource(1).html"></iframe><div class="intercom-lightweight-app"><div class="intercom-lightweight-app-launcher intercom-launcher" role="button" tabindex="0" aria-label="Open Intercom Messenger" aria-live="polite"><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-open"><img src="./TryHackMe _ Introduction to Antivirus_files/9e0f012f15b6fc981dde2f1f5198d728.png" alt="" class="intercom-lightweight-app-launcher-custom-icon-open"></div><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-minimize"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M18.601 8.39897C18.269 8.06702 17.7309 8.06702 17.3989 8.39897L12 13.7979L6.60099 8.39897C6.26904 8.06702 5.73086 8.06702 5.39891 8.39897C5.06696 8.73091 5.06696 9.2691 5.39891 9.60105L11.3989 15.601C11.7309 15.933 12.269 15.933 12.601 15.601L18.601 9.60105C18.9329 9.2691 18.9329 8.73091 18.601 8.39897Z" fill="white"></path>
</svg>
</div></div><style id="intercom-lightweight-app-style" type="text/css">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    0% {
      opacity: 0;
      transform: scale(0);
    }
    40% {
      opacity: 1;
    }
    100% {
      transform: scale(1);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji", Helvetica, Arial, sans-serif;
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    padding: 0 !important;
    margin: 0 !important;
    border: none;
    bottom: 20px;
    right: 20px;
    max-width: 48px;
    width: 48px;
    max-height: 48px;
    height: 48px;
    border-radius: 50%;
    background: #1C2538;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    transition: transform 167ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    box-sizing: content-box;
  }


  .intercom-lightweight-app-launcher:hover {
    transition: transform 250ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    transform: scale(1.1)
  }

  .intercom-lightweight-app-launcher:active {
    transform: scale(0.85);
    transition: transform 134ms cubic-bezier(0.45, 0, 0.2, 1);
  }


  .intercom-lightweight-app-launcher:focus {
    outline: none;

    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 48px;
    height: 48px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 24px;
    height: 24px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 44px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 24px;
    max-width: 24px;

    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: white;
    animation: intercom-lightweight-app-messenger 250ms cubic-bezier(0, 1, 1, 1);
    transform-origin: bottom right;
    
        width: 400px;
        height: calc(100% - 104px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 84px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
      

    border-radius: 16px;
  }

  .intercom-lightweight-app-messenger-header {
    height: 64px;
    border-bottom: none;
    background: #1c2538

    
  }

  .intercom-lightweight-app-messenger-footer{
    position:absolute;
    bottom:0;
    width: 100%;
    height: 80px;
    background: #fff;
    font-size: 14px;
    line-height: 21px;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0px 0px 25px rgba(0, 0, 0, 0.05);
    
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div></body></html>