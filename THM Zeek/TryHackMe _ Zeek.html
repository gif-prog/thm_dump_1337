<!DOCTYPE html>
<!-- saved from url=(0034)https://tryhackme.com/room/zeekbro -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>TryHackMe | Zeek</title>
<meta name="description" content="Introduction to hands-on network monitoring and threat detection with Zeek (formerly Bro).">
<meta name="og:description" content="Introduction to hands-on network monitoring and threat detection with Zeek (formerly Bro).">
<meta name="keywords" content="cyber,security,cyber security,cyber security training,coding,computer,bitcoin,hacking,hackers,hacks,hack,exploits,keylogger,learn,poc">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<meta property="og:site_name" content="TryHackMe">
<meta property="og:title" content="TryHackMe | Zeek">
<meta property="og:image" content="https://tryhackme-images.s3.amazonaws.com/room-icons/85ba4a3cd4cafc3f43d83fbacf12ca14.png">
<meta property="og:url" content="https://tryhackme.com/room/zeekbro">
<meta name="twitter:image" content="https://tryhackme.com/img/meta/default.png">
<meta property="og:description" content="Introduction to hands-on network monitoring and threat detection with Zeek (formerly Bro).">

<script type="text/javascript" async="" src="./TryHackMe _ Zeek_files/pgpbhph6"></script><script src="./TryHackMe _ Zeek_files/jquery.min.js"></script>
<script src="./TryHackMe _ Zeek_files/popper.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Zeek_files/boostrap431.min.css">
<script src="./TryHackMe _ Zeek_files/bootstrap431.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Zeek_files/animate.min.css">
<link rel="stylesheet" href="./TryHackMe _ Zeek_files/all.css" integrity="sha384-ekOryaXPbeCpWQNxMwSWVvQ0+1VrStoPJq54shlYhR8HzQgig1v5fas6YgOqLoKz" crossorigin="anonymous">
<link rel="icon" type="image/png" href="https://assets.tryhackme.com/img/favicon.png">
<link rel="stylesheet" media="screen" href="./TryHackMe _ Zeek_files/general-style.css">
<script src="./TryHackMe _ Zeek_files/script.js"></script>
<script src="./TryHackMe _ Zeek_files/validation.js"></script>

<link rel="stylesheet" type="text/css" href="./TryHackMe _ Zeek_files/cookieconsent.min.css">
<script src="./TryHackMe _ Zeek_files/cookieconsent.min.js"></script>
<script async="" src="./TryHackMe _ Zeek_files/js"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-Z8D4WL3D4P');
  </script>


<script>
    window.intercomSettings = {
      api_base: "https://api-iam.intercom.io",
      app_id: "pgpbhph6"
    };
  </script>
<script>
    (function (h, o, t, j, a, r) {
      h.hj = h.hj || function () { (h.hj.q = h.hj.q || []).push(arguments) };
      h._hjSettings = { hjid: 1950941, hjsv: 6 };
      a = o.getElementsByTagName('head')[0];
      r = o.createElement('script'); r.async = 1;
      r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
      a.appendChild(r);
    })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
  </script><script async="" src="./TryHackMe _ Zeek_files/hotjar-1950941.js"></script>
<script>
    /* Global javascript variables */

    // Used inside script.js for createRooms compelted users.
    const username = 'Silv3rsurf3r'
    const subscribed = '1'
    const level = '10'
    const intercomEnabled = 'true'
  </script>
<script>
    //add back tracking info
    const userId = "63d14e7f857ae10041bb192f"
    let tutorialComplete = false
    if ('false' == "true") {
      tutorialComplete = true
    }
    if(intercomEnabled === "true"){
      window.intercomSettings = {
        api_base: "https://api-iam.intercom.io",
        app_id: "pgpbhph6",
        user_id: userId,
        username: username,
        email: "giftonpaul@karunya.edu.in",
        created_at: Math.floor(new Date("Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)").getTime() / 1000) // Signup date as a Unix timestamp
      };
    }
    window.hj('identify', userId, {
      displayName: username,
      subscribed: "1",
      dateSignUp: "Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)",
      experience: "advanced"
    })
  </script>
<script type="application/ld+json">

   {
      "@context":"https://schema.org",
      "@type":"Organization",
      "url":"https://tryhackme.com",
      "name":"TryHackMe",
      "logo":"https://tryhackme.com/img/favicon.png",
      "description":"TryHackMe is a free online platform for learning cyber security, using hands-on exercises and labs, all through your browser!",
      "email": "support@tryhackme.com",
      "sameAs":[
         "https://www.linkedin.com/company/tryhackme",
         "https://twitter.com/realtryhackme"
      ]
   }

</script>
<script>
    console.log(`%c
      ------------------
      < Happy Hacking! >
      ------------------
              \\   ^__^
               \\  (oo)\\_______
                  (__)\\       )\\/\\
                      ||----w |
                      ||     ||`, "font-family:monospace")
  </script>
<script>
  (function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pgpbhph6';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>
<script src="./TryHackMe _ Zeek_files/socket.io.js"></script><script>
  let socket = io.connect({
    transports: ['websocket'],
    reconnection: true,
    reconnectionDelay: 1000,
    reconnectionAttempts: 10
  })
</script><meta http-equiv="origin-trial" content="AymqwRC7u88Y4JPvfIF2F37QKylC04248hLCdJAsh8xgOfe/dVJPV3XS3wLFca1ZMVOtnBfVjaCMTVudWM//5g4AAAB7eyJvcmlnaW4iOiJodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1RoaXJkUGFydHkiOnRydWV9"><style type="text/css">.apexcharts-canvas {
  position: relative;
  user-select: none;
  /* cannot give overflow: hidden as it will crop tooltips which overflow outside chart area */
}


/* scrollbar is not visible by default for legend, hence forcing the visibility */
.apexcharts-canvas ::-webkit-scrollbar {
  -webkit-appearance: none;
  width: 6px;
}

.apexcharts-canvas ::-webkit-scrollbar-thumb {
  border-radius: 4px;
  background-color: rgba(0, 0, 0, .5);
  box-shadow: 0 0 1px rgba(255, 255, 255, .5);
  -webkit-box-shadow: 0 0 1px rgba(255, 255, 255, .5);
}


.apexcharts-inner {
  position: relative;
}

.apexcharts-text tspan {
  font-family: inherit;
}

.legend-mouseover-inactive {
  transition: 0.15s ease all;
  opacity: 0.20;
}

.apexcharts-series-collapsed {
  opacity: 0;
}

.apexcharts-tooltip {
  border-radius: 5px;
  box-shadow: 2px 2px 6px -4px #999;
  cursor: default;
  font-size: 14px;
  left: 62px;
  opacity: 0;
  pointer-events: none;
  position: absolute;
  top: 20px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  white-space: nowrap;
  z-index: 12;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-theme-light {
  border: 1px solid #e3e3e3;
  background: rgba(255, 255, 255, 0.96);
}

.apexcharts-tooltip.apexcharts-theme-dark {
  color: #fff;
  background: rgba(30, 30, 30, 0.8);
}

.apexcharts-tooltip * {
  font-family: inherit;
}


.apexcharts-tooltip-title {
  padding: 6px;
  font-size: 15px;
  margin-bottom: 4px;
}

.apexcharts-tooltip.apexcharts-theme-light .apexcharts-tooltip-title {
  background: #ECEFF1;
  border-bottom: 1px solid #ddd;
}

.apexcharts-tooltip.apexcharts-theme-dark .apexcharts-tooltip-title {
  background: rgba(0, 0, 0, 0.7);
  border-bottom: 1px solid #333;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  display: inline-block;
  font-weight: 600;
  margin-left: 5px;
}

.apexcharts-tooltip-text-y-label:empty,
.apexcharts-tooltip-text-y-value:empty,
.apexcharts-tooltip-text-goals-label:empty,
.apexcharts-tooltip-text-goals-value:empty,
.apexcharts-tooltip-text-z-value:empty {
  display: none;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  font-weight: 600;
}

.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-goals-group, 
.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  display: flex;
}
.apexcharts-tooltip-text-goals-label:not(:empty),
.apexcharts-tooltip-text-goals-value:not(:empty) {
  margin-top: -6px;
}

.apexcharts-tooltip-marker {
  width: 12px;
  height: 12px;
  position: relative;
  top: 0px;
  margin-right: 10px;
  border-radius: 50%;
}

.apexcharts-tooltip-series-group {
  padding: 0 10px;
  display: none;
  text-align: left;
  justify-content: left;
  align-items: center;
}

.apexcharts-tooltip-series-group.apexcharts-active .apexcharts-tooltip-marker {
  opacity: 1;
}

.apexcharts-tooltip-series-group.apexcharts-active,
.apexcharts-tooltip-series-group:last-child {
  padding-bottom: 4px;
}

.apexcharts-tooltip-series-group-hidden {
  opacity: 0;
  height: 0;
  line-height: 0;
  padding: 0 !important;
}

.apexcharts-tooltip-y-group {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-box, .apexcharts-custom-tooltip {
  padding: 4px 8px;
}

.apexcharts-tooltip-boxPlot {
  display: flex;
  flex-direction: column-reverse;
}

.apexcharts-tooltip-box>div {
  margin: 4px 0;
}

.apexcharts-tooltip-box span.value {
  font-weight: bold;
}

.apexcharts-tooltip-rangebar {
  padding: 5px 8px;
}

.apexcharts-tooltip-rangebar .category {
  font-weight: 600;
  color: #777;
}

.apexcharts-tooltip-rangebar .series-name {
  font-weight: bold;
  display: block;
  margin-bottom: 5px;
}

.apexcharts-xaxistooltip {
  opacity: 0;
  padding: 9px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
  transition: 0.15s ease all;
}

.apexcharts-xaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-xaxistooltip:after,
.apexcharts-xaxistooltip:before {
  left: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-xaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-left: -6px;
}

.apexcharts-xaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-left: -7px;
}

.apexcharts-xaxistooltip-bottom:after,
.apexcharts-xaxistooltip-bottom:before {
  bottom: 100%;
}

.apexcharts-xaxistooltip-top:after,
.apexcharts-xaxistooltip-top:before {
  top: 100%;
}

.apexcharts-xaxistooltip-bottom:after {
  border-bottom-color: #ECEFF1;
}

.apexcharts-xaxistooltip-bottom:before {
  border-bottom-color: #90A4AE;
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:after {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:before {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top:after {
  border-top-color: #ECEFF1
}

.apexcharts-xaxistooltip-top:before {
  border-top-color: #90A4AE;
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:after {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:before {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-yaxistooltip {
  opacity: 0;
  padding: 4px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
}

.apexcharts-yaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-yaxistooltip:after,
.apexcharts-yaxistooltip:before {
  top: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-yaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-top: -6px;
}

.apexcharts-yaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-top: -7px;
}

.apexcharts-yaxistooltip-left:after,
.apexcharts-yaxistooltip-left:before {
  left: 100%;
}

.apexcharts-yaxistooltip-right:after,
.apexcharts-yaxistooltip-right:before {
  right: 100%;
}

.apexcharts-yaxistooltip-left:after {
  border-left-color: #ECEFF1;
}

.apexcharts-yaxistooltip-left:before {
  border-left-color: #90A4AE;
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:after {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:before {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right:after {
  border-right-color: #ECEFF1;
}

.apexcharts-yaxistooltip-right:before {
  border-right-color: #90A4AE;
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:after {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:before {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip.apexcharts-active {
  opacity: 1;
}

.apexcharts-yaxistooltip-hidden {
  display: none;
}

.apexcharts-xcrosshairs,
.apexcharts-ycrosshairs {
  pointer-events: none;
  opacity: 0;
  transition: 0.15s ease all;
}

.apexcharts-xcrosshairs.apexcharts-active,
.apexcharts-ycrosshairs.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-ycrosshairs-hidden {
  opacity: 0;
}

.apexcharts-selection-rect {
  cursor: move;
}

.svg_select_boundingRect, .svg_select_points_rot {
  pointer-events: none;
  opacity: 0;
  visibility: hidden;
}
.apexcharts-selection-rect + g .svg_select_boundingRect,
.apexcharts-selection-rect + g .svg_select_points_rot {
  opacity: 0;
  visibility: hidden;
}

.apexcharts-selection-rect + g .svg_select_points_l,
.apexcharts-selection-rect + g .svg_select_points_r {
  cursor: ew-resize;
  opacity: 1;
  visibility: visible;
}

.svg_select_points {
  fill: #efefef;
  stroke: #333;
  rx: 2;
}

.apexcharts-svg.apexcharts-zoomable.hovering-zoom {
  cursor: crosshair
}

.apexcharts-svg.apexcharts-zoomable.hovering-pan {
  cursor: move
}

.apexcharts-zoom-icon,
.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon,
.apexcharts-reset-icon,
.apexcharts-pan-icon,
.apexcharts-selection-icon,
.apexcharts-menu-icon,
.apexcharts-toolbar-custom-icon {
  cursor: pointer;
  width: 20px;
  height: 20px;
  line-height: 24px;
  color: #6E8192;
  text-align: center;
}

.apexcharts-zoom-icon svg,
.apexcharts-zoomin-icon svg,
.apexcharts-zoomout-icon svg,
.apexcharts-reset-icon svg,
.apexcharts-menu-icon svg {
  fill: #6E8192;
}

.apexcharts-selection-icon svg {
  fill: #444;
  transform: scale(0.76)
}

.apexcharts-theme-dark .apexcharts-zoom-icon svg,
.apexcharts-theme-dark .apexcharts-zoomin-icon svg,
.apexcharts-theme-dark .apexcharts-zoomout-icon svg,
.apexcharts-theme-dark .apexcharts-reset-icon svg,
.apexcharts-theme-dark .apexcharts-pan-icon svg,
.apexcharts-theme-dark .apexcharts-selection-icon svg,
.apexcharts-theme-dark .apexcharts-menu-icon svg,
.apexcharts-theme-dark .apexcharts-toolbar-custom-icon svg {
  fill: #f3f4f5;
}

.apexcharts-canvas .apexcharts-zoom-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-selection-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-reset-zoom-icon.apexcharts-selected svg {
  fill: #008FFB;
}

.apexcharts-theme-light .apexcharts-selection-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoom-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoomin-icon:hover svg,
.apexcharts-theme-light .apexcharts-zoomout-icon:hover svg,
.apexcharts-theme-light .apexcharts-reset-icon:hover svg,
.apexcharts-theme-light .apexcharts-menu-icon:hover svg {
  fill: #333;
}

.apexcharts-selection-icon,
.apexcharts-menu-icon {
  position: relative;
}

.apexcharts-reset-icon {
  margin-left: 5px;
}

.apexcharts-zoom-icon,
.apexcharts-reset-icon,
.apexcharts-menu-icon {
  transform: scale(0.85);
}

.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon {
  transform: scale(0.7)
}

.apexcharts-zoomout-icon {
  margin-right: 3px;
}

.apexcharts-pan-icon {
  transform: scale(0.62);
  position: relative;
  left: 1px;
  top: 0px;
}

.apexcharts-pan-icon svg {
  fill: #fff;
  stroke: #6E8192;
  stroke-width: 2;
}

.apexcharts-pan-icon.apexcharts-selected svg {
  stroke: #008FFB;
}

.apexcharts-pan-icon:not(.apexcharts-selected):hover svg {
  stroke: #333;
}

.apexcharts-toolbar {
  position: absolute;
  z-index: 11;
  max-width: 176px;
  text-align: right;
  border-radius: 3px;
  padding: 0px 6px 2px 6px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.apexcharts-menu {
  background: #fff;
  position: absolute;
  top: 100%;
  border: 1px solid #ddd;
  border-radius: 3px;
  padding: 3px;
  right: 10px;
  opacity: 0;
  min-width: 110px;
  transition: 0.15s ease all;
  pointer-events: none;
}

.apexcharts-menu.apexcharts-menu-open {
  opacity: 1;
  pointer-events: all;
  transition: 0.15s ease all;
}

.apexcharts-menu-item {
  padding: 6px 7px;
  font-size: 12px;
  cursor: pointer;
}

.apexcharts-theme-light .apexcharts-menu-item:hover {
  background: #eee;
}

.apexcharts-theme-dark .apexcharts-menu {
  background: rgba(0, 0, 0, 0.7);
  color: #fff;
}

@media screen and (min-width: 768px) {
  .apexcharts-canvas:hover .apexcharts-toolbar {
    opacity: 1;
  }
}

.apexcharts-datalabel.apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-pie-label,
.apexcharts-datalabels,
.apexcharts-datalabel,
.apexcharts-datalabel-label,
.apexcharts-datalabel-value {
  cursor: default;
  pointer-events: none;
}

.apexcharts-pie-label-delay {
  opacity: 0;
  animation-name: opaque;
  animation-duration: 0.3s;
  animation-fill-mode: forwards;
  animation-timing-function: ease;
}

.apexcharts-canvas .apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-hide .apexcharts-series-points {
  opacity: 0;
}

.apexcharts-gridline,
.apexcharts-annotation-rect,
.apexcharts-tooltip .apexcharts-marker,
.apexcharts-area-series .apexcharts-area,
.apexcharts-line,
.apexcharts-zoom-rect,
.apexcharts-toolbar svg,
.apexcharts-area-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-line-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-radar-series path,
.apexcharts-radar-series polygon {
  pointer-events: none;
}


/* markers */

.apexcharts-marker {
  transition: 0.15s ease all;
}

@keyframes opaque {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}


/* Resize generated styles */

@keyframes resizeanim {
  from {
    opacity: 0;
  }
  to {
    opacity: 0;
  }
}

.resize-triggers {
  animation: 1ms resizeanim;
  visibility: hidden;
  opacity: 0;
}

.resize-triggers,
.resize-triggers>div,
.contract-trigger:before {
  content: " ";
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  overflow: hidden;
}

.resize-triggers>div {
  background: #eee;
  overflow: auto;
}

.contract-trigger:before {
  width: 200%;
  height: 200%;
}</style><script async="" src="./TryHackMe _ Zeek_files/modules.5957fbf26d1b525b5a12.js" charset="utf-8"></script><style data-jss="" data-meta="MuiDialog">
@media print {
  .MuiDialog-root {
    position: absolute !important;
  }
}
.MuiDialog-scrollPaper {
  display: flex;
  align-items: center;
  justify-content: center;
}
.MuiDialog-scrollBody {
  overflow-x: hidden;
  overflow-y: auto;
  text-align: center;
}
.MuiDialog-scrollBody:after {
  width: 0;
  height: 100%;
  content: "";
  display: inline-block;
  vertical-align: middle;
}
.MuiDialog-container {
  height: 100%;
  outline: 0;
}
@media print {
  .MuiDialog-container {
    height: auto;
  }
}
.MuiDialog-paper {
  margin: 32px;
  position: relative;
  overflow-y: auto;
}
@media print {
  .MuiDialog-paper {
    box-shadow: none;
    overflow-y: visible;
  }
}
.MuiDialog-paperScrollPaper {
  display: flex;
  max-height: calc(100% - 64px);
  flex-direction: column;
}
.MuiDialog-paperScrollBody {
  display: inline-block;
  text-align: left;
  vertical-align: middle;
}
.MuiDialog-paperWidthFalse {
  max-width: calc(100% - 64px);
}
.MuiDialog-paperWidthXs {
  max-width: 444px;
}
@media (max-width:507.95px) {
  .MuiDialog-paperWidthXs.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthSm {
  max-width: 600px;
}
@media (max-width:663.95px) {
  .MuiDialog-paperWidthSm.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthMd {
  max-width: 960px;
}
@media (max-width:1023.95px) {
  .MuiDialog-paperWidthMd.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthLg {
  max-width: 1280px;
}
@media (max-width:1343.95px) {
  .MuiDialog-paperWidthLg.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthXl {
  max-width: 1920px;
}
@media (max-width:1983.95px) {
  .MuiDialog-paperWidthXl.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperFullWidth {
  width: calc(100% - 64px);
}
.MuiDialog-paperFullScreen {
  width: 100%;
  height: 100%;
  margin: 0;
  max-width: 100%;
  max-height: none;
  border-radius: 0;
}
.MuiDialog-paperFullScreen.MuiDialog-paperScrollBody {
  margin: 0;
  max-width: 100%;
}
</style><style></style></head>


<body><div role="dialog" aria-live="polite" aria-label="cookieconsent" aria-describedby="cookieconsent:desc" class="cc-window cc-floating cc-type-info cc-theme-classic cc-bottom cc-right cc-color-override-382972913 cc-invisible" style="display: none;"><!--googleoff: all--><span id="cookieconsent:desc" class="cc-message">We use cookies to ensure you get the best user experience. For more information contact us. <a aria-label="learn more about cookies" role="button" tabindex="0" class="cc-link" href="https://tryhackme.com/legal/terms-of-use" target="_blank">Read more</a></span><div class="cc-compliance"><a aria-label="dismiss cookie message" role="button" tabindex="0" class="cc-btn cc-dismiss">Got it!</a></div><!--googleon: all--></div>
<link href="./TryHackMe _ Zeek_files/scoreboard.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Zeek_files/introjs.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Zeek_files/slideout.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Zeek_files/public-rooms.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Zeek_files/asciinema-player.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Zeek_files/prism.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Zeek_files/magnific-popup.css" rel="stylesheet" type="text/css"> 
<script src="./TryHackMe _ Zeek_files/lottie-player.js"></script>

<div id="room-content">
<div id="room-content-main">
<nav class="navbar navbar-expand-md navbar-dark navbar-color-loggedin navbar-main">
<div class="container">
<button id="thm-mobile-nav-open" class="thm-nav__hamburger-btn" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Open mobile navigation">
<span class="thm-nav__hamburger-lines"></span>
</button>
<div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
<div class="navbar-brand" href="/">
<a href="https://tryhackme.com/dashboard">
<img width="115px" src="./TryHackMe _ Zeek_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
</div>
<ul class="navbar-nav mr-auto mt-2 mt-lg-0 navbar-pagelinks">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="navbar-item-icon far fa-browser"></i>
<div class="navbar-item-text">Dashboard</div>
</a>
</li>
<li class="nav-item active" id="nav-learn">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="navbar-item-icon far fa-book-open"></i>
<div class="navbar-item-text">Learn</div>
</a>
</li>
<li class="nav-item  dropdown lite-removable">
<a id="nav-other" class="nav-link" href="https://tryhackme.com/room/zeekbro#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-trophy"></i>
<div class="navbar-item-text">Compete</div>
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdown">
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/leaderboards">
<div class="dropdown-menu-icon">
<i class="fas fa-trophy"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/games/koth">
<div class="dropdown-menu-icon">
<i class="fas fa-crown"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/workspace">
<div class="dropdown-menu-icon">
<i class="fas fa-user-friends"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item dropdown">
<a data-cy="nav-other-menu-button" id="nav-other" class="nav-link" href="https://tryhackme.com/room/zeekbro#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-ellipsis-h-alt"></i>
<div class="navbar-item-text">Other</div>
</a>
<div data-cy="nav-other-menu" class="dropdown-menu dropdown-menu-center large-dropdown" aria-labelledby="navbarDropdown">
<span class="dropdown-menu-arrow"></span>
<a class="dropdown-item" href="https://tryhackme.com/resources">Resources</a>
<a class="dropdown-item" href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a class="dropdown-item" href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/business">For Business</a>
<a class="dropdown-item" href="https://tryhackme.com/classrooms">For Education</a>
<a class="dropdown-item" target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
<a class="dropdown-item" href="https://tryhackme.com/glossary">Glossary</a>
</div>
</li>
</ul>
<ul class="navbar-nav navbar-right options vertical-align-custom">
<li class="nav-item" data-toggle="modal" data-target="#navConnModal">
<div id="thm-connection-status" class="thm-unconnected">
<div id="thm-connection-status-dot" class="dot-small"></div> <span id="thm-connection-status-txt" class="ml-2 size-18 text-white"></span>
</div>
</li>
<li class="nav-item">
<div class="nav-item-streak">
<span id="streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="">
<span id="user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>
<script>
                            let usersStreak = { // Global variable, used in rooms logic
                                streakFirstAnswered: new Date('Mon Jul 10 2023 03:13:45 GMT+0100 (British Summer Time)'),
                                streakLastAnswered: new Date('Sun Jul 16 2023 18:47:44 GMT+0100 (British Summer Time)'),
                                usersTimezone: 'Asia/Kolkata',
                                streakFreeze: 1
                            };
                            setSidebarStreaks(usersStreak.streakFirstAnswered, usersStreak.streakLastAnswered, usersStreak.usersTimezone, usersStreak.streakFreeze)
                        </script>
</div>
</li>
<li class="nav-item dropdown" id="notification-navitem">
<a class="nav-link vertical-align-custom size-22 pl-0" href="https://tryhackme.com/room/zeekbro#" id="notification-btn" role="button" data-toggle="dropdown">
<i id="notification-icon" class="fal fa-bell"></i>
<div id="notification-dot"></div>
</a>
<div id="nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="notification-header">Notifications</div>
<div id="nav-notifications">
<div class="text-center mt-2 mb-2"><i>Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle remove-arrow p-0" href="https://tryhackme.com/room/zeekbro#" id="navbarAvatarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
<img src="./TryHackMe _ Zeek_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarAvatarDropdown">
<a class="dropdown-item" href="https://tryhackme.com/profile">Profile</a>
<a class="dropdown-item" href="https://tryhackme.com/referrals">Refer a friend</a>
<a class="dropdown-item" href="https://tryhackme.com/badges">Badges</a>
<a class="dropdown-item" href="https://tryhackme.com/rooms">My Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/access">Access</a>
<a class="dropdown-item" href="https://tryhackme.com/feedback">Give Feedback</a>
<a class="dropdown-item" href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</div>
</div>
</nav>
<link rel="stylesheet" href="./TryHackMe _ Zeek_files/streak-freeze.css">
<div class="modal fade modal-streak-freeze" id="unlocked-streak-freeze" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<button type="button" class="close close-streak" id="close-streak-freeze-popup" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<div class="modal-body">
<figure>
<img class="img-streak" width="400px" alt="streak freeze unlocked" src="./TryHackMe _ Zeek_files/streak-freeze.svg">
</figure>
<h2>You've unlocked a streak freeze!</h2>
<p>With these one-time streak freezes, you can miss one day of hacking without losing your streak.</p>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Zeek_files/streak-freeze.js"></script>
<nav id="thm-mobile-nav-menu" class="thm-mobile-nav" aria-label="Mobile secondary navigation menu.">
<header>
<a href="https://tryhackme.com/" aria-label="Go to the home page">
<img width="140" src="./TryHackMe _ Zeek_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
<button id="thm-mobile-nav-close" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Close mobile navigation">
<i class="fal fa-times"></i>
</button>
</header>
<ul class="thm-mobile-nav-items mb-0">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="nav-title-icon far fa-browser"></i>
<div class="nav-title">Dashboard</div>
</a>
</li>
<li class="nav-item active">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="nav-title-icon far fa-book-open"></i>
<div class="nav-title">Learn</div>
</a>
</li>
<li class="nav-item ">
<a aria-expanded="false" aria-controls="mobile-nav-compete" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-compete" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-trophy"></i>
<div class="nav-title">Compete</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-compete" class="dropdown-wrapper">
<a href="https://tryhackme.com/leaderboards">
<div>
<i class="fas fa-trophy"></i>
</div>
<div>
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a href="https://tryhackme.com/games/koth">
<div>
<i class="fas fa-crown"></i>
</div>
<div>
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a href="https://tryhackme.com/workspace">
<div>
<i class="fas fa-user-friends"></i>
</div>
<div>
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item">
<a aria-expanded="false" aria-controls="mobile-nav-other" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-other" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-ellipsis-h-alt"></i>
<div class="nav-title">Other</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-other" class="dropdown-wrapper">
<a href="https://tryhackme.com/resources">Resources</a>
<a href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a href="https://tryhackme.com/business">For Business</a>
<a href="https://tryhackme.com/classrooms">For Education</a>
<a target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
</div>
</li>
<li class="nav-item text-center">
<div class="nav-item-streak">
<span id="mobile-streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="">
<span id="mobile-user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>
</div>
</li>
<li class="nav-item text-center">
<a class="nav-link size-22 d-inline-block" href="https://tryhackme.com/room/zeekbro#" id="mobile-notification-btn" role="button" data-toggle="dropdown">
<i id="mobile-notification-icon" class="fal fa-bell"></i>
<div id="mobile-notification-dot"></div>
</a>
<div id="mobile-nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="mobile-notification-header">Notifications</div>
<div id="mobile-nav-notifications">
<div class="text-center mt-2 mb-2"><i>Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item text-center">
<a aria-expanded="false" aria-controls="mobile-nav-auth" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-auth" class="sublinks-toggle nav-link d-inline-block">
<img src="./TryHackMe _ Zeek_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div id="mobile-nav-auth" class="dropdown-wrapper">
<a href="https://tryhackme.com/profile">Profile</a>
<a href="https://tryhackme.com/referrals">Refer a friend</a>
<a href="https://tryhackme.com/badges">Badges</a>
<a href="https://tryhackme.com/rooms">My Rooms</a>
<a href="https://tryhackme.com/access">Access</a>
<a href="https://tryhackme.com/feedback">Give Feedback</a>
<a href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</nav>
<script defer="" src="./TryHackMe _ Zeek_files/mobile-nav.js"></script>
<script>
  const userSignedUpLessThanSevenDaysAgo = Math.floor(
    (new Date() - new Date('Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)')) / (1000 * 60 * 60 * 24) < 7
  );

  const userHasFirst4RoomsBadge = !!``;
  const isBeginner = `advanced` === 'complete-beginner';
</script>
<script src="./TryHackMe _ Zeek_files/notifications.js"></script>
<script src="./TryHackMe _ Zeek_files/streak-freeze(1).js"></script>
<div id="wrapper">
<div id="room-banner" class="shadow-light">
<img id="room-image-large" src="./TryHackMe _ Zeek_files/c2cc6be2c76d68126e72ee7a03779ea5.png">
<div>
<div id="room-details">
<div class="container">
<div class="page-header">
<div class="room-header">
<div id="room-voting" class="text-center vertical-align-custom">
<div class="voting-buttons">
<i class="fas fa-thumbs-up display-block" onclick="makeVote(true)" id="vote-up" style="color: rgb(185, 185, 185);"></i>
<div class="display-block" id="vote-number">293</div>
<i class="fas fa-thumbs-down display-block" onclick="makeVote(false)" id="vote-down" style="color: rgb(185, 185, 185);"></i>
</div>
</div>
<div id="room-logo" class="vertical-align-custom">
<div id="logo"><img class="room-avatar" src="./TryHackMe _ Zeek_files/85ba4a3cd4cafc3f43d83fbacf12ca14.png" onerror="replaceImg(this)"></div>
</div>
<div class="vertical-align-custom">
<div id="room-basic-data">
<div class="d-flex justify-content-between">
<h1 id="title" class="bold-head">Zeek</h1>
<div id="room-title-options">

<div class="btn-group" id="browser-machine-options" role="group" aria-label="Start AttackBox or Kali Linux" style="display: none;">
<button id="browser-machine-start" type="button" class="btn btn-secondary"><i class="far fa-laptop"></i> Start AttackBox</button>
<div class="btn-group" id="browser-machines" role="group">
<button id="btnGroupDrop1" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
<div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
<a class="dropdown-item  preventDefault" href="https://tryhackme.com/room/zeekbro#" onclick="changeMyMachine(&quot;kali-linux&quot;)">
<span class="mb-0">Use Kali Linux</span>
<div class="text-lgray size-12">Web-based Kali Machine</div>
</a>
<a class="dropdown-item preventDefault" href="https://tryhackme.com/room/zeekbro#" onclick="changeMyMachine(&quot;attackbox&quot;)">
<span class="mb-0">Use AttackBox</span>
<div class="text-lgray size-12">Recommended</div>
</a>
</div>
</div>
</div>
<button id="browser-machine-split-view" type="button" class="btn btn-secondary">Show Split View</button>
<button id="cloud-details" type="button" class="btn btn-info"><i class="far fa-clouds mr-1"></i>Cloud Details</button>
<span id="awards-model-btn" data-toggle="modal" data-target="#award-modal" class="badge badge-warning ml-1 noselect">Awards</span>
<span id="room-faq-slideout" type="button" class="badge badge-info ml-1 noselect d-inline-flex" onclick="openHelpMenu()">
Help
</span>
<div class="dropright room-dropright noselect ml-1" id="room-options" style="display: inline-block;">
<span class="badge badge-secondary" data-toggle="dropdown">
<i class="fas fa-cog"></i>
</span>
<div class="dropdown-menu">
<a class="dropdown-item" href="https://tryhackme.com/api/room/manage/clone/zeekbro" id="clone-room" style="display: none;"><i class="far fa-clone faded"></i> Clone Room</a>
<a class="dropdown-item preventDefault" id="writeups-simple" style="display: inline-block;"><i class="fas fa-pen-alt faded"></i> Writeups</a>
<a class="dropdown-item preventDefault" data-toggle="modal" data-target="#resetUserProgressModal"><i class="fas fa-eraser faded"></i> Reset Progress</a>
<a class="dropdown-item preventDefault" id="leave-room"><i class="fas fa-sign-out-alt faded"></i> Leave</a>
</div>
</div>
<span id="bookmark" class="badge badge-secondary badge-bookmark ">
<img class="bookmark" src="./TryHackMe _ Zeek_files/bookmark.svg">
<span class="bookmark-popover" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="top" data-content="&lt;p class=&#39;mb-0&#39;&gt;Save room &lt;/p&gt;
" data-original-title="" title="">
</span>
</span>
</div>
</div>
<p class="mb0 faded" id="description">Introduction to hands-on network monitoring and threat detection with Zeek (formerly Bro).</p>
</div>
</div>
</div>
</div>

</div>
</div>
<div id="room-banner-stats">
<div class="creators"></div>
<div class="numbers"></div>
</div>
</div>
</div>
<div class="container main pb">
<div id="room-message"></div>
<section id="sponsor">
<i id="sponsor-close" class="fas fa-times"></i>
<div id="sponsor-data"></div>
</section>
<div id="top-panel">
<ul class="nav nav-tabs" id="task-navs">
<li class="nav-item">
<a class="nav-link  active " data-toggle="tab" href="https://tryhackme.com/room/zeekbro#chart">
<i class="fas fa-chart-line icon-right"></i> Chart
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/zeekbro#scoreboard">
<i class="fas fa-trophy icon-right"></i> Scoreboard
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/zeekbro#chat">
<i class="fas fa-comments-alt icon-right chat-icon"></i> Discuss
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/zeekbro#writeups">
<i class="fas fa-pen-alt icon-right"></i> Writeups
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/zeekbro#about">
<i class="fas fa-info-circle icon-right"></i> More
</a>
</li>
</ul>
<div class="card cd-2 nav-above-con" id="room-main">
<div class="card-body">
<span id="room-tabs">
<div class="tab-content">
<div id="chart" class="tab-pane  active ">
<span id="difficulty-bar">
    <span class="room-difficulty diff-text">
      Difficulty: 
        <span class="difficulty-medium">Medium</span>
    </span></span>
<br><div id="chart-data"></div>
</div>
<div id="scoreboard" class="tab-pane fade">
<table class="table table-striped table-bordered table-condensed table-header-rotated mb-0" id="scoreboard_table">
<thead>
<tr id="scoreboard_header">
<th>Rank</th>
<th>Username</th>
<th>Total Score</th>
</tr>
</thead>
<tbody id="scoreboard_body"></tbody>
</table>
</div>
<div id="chat" class="tab-pane fade">

<div class="row">
<div class="col-sm-6 text-center">
<h3 class="mb-2">Discord</h3>
<p>Come join our <a target="_blank" href="https://discord.gg/QgC6Tdk">Discord</a> server for support or further discussions</p>
</div>
<div class="col-sm-6 text-center">
<h3 class="mb-2">Forum</h3>
<div id="forum-text">Read or post on the dedicated forum <a href="https://tryhackme.com/forum/thread/62dff38db79ccb005e73361f">post</a></div>
</div>
</div>
</div>
<div id="writeups" class="tab-pane text-center">
<div id="writeups-data">There are no writeups submitted.</div>
<button onclick="showWriteupForm(this)" type="button" class="btn btn-xs btn-secondary mt-3 mb-2">Add Writeup</button>
<div id="writeup-form">
<div class="form-row">
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-title" placeholder="Writeup Title">
</div>
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-link" placeholder="Writeup URL">
</div>
<div class="col-auto">
<button id="submit-writeup" type="submit" class="btn btn-success mb-2">Submit</button>
</div>
</div>
<p class="faded mb-0 size-14"><i class="fas fa-exclamation-triangle text-warning"></i> Writeups should have a link to TryHackMe and not include any passwords/cracked hashes/flags</p>
</div>
</div>
<div id="about" class="tab-pane text-center">
<p id="about-freeRoom"><p class="mb-0">Only subscribers can deploy virtual machines in this room! 
        Go to your <a href="https://tryhackme.com/profile">profile</a> page to subscribe (if you have not already). 7976 users are in here and this room is 356 days old.</p></p>
<p id="about-owner"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Zeek_files/af7feb2c43a2c7d5f111b98ccbd15048.png"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme">tryhackme</a> and <img class="avatar-tiny" src="./TryHackMe _ Zeek_files/1a02ec129689db6aef26e1cc16fb6d93.jpg"> 
        <a class="green-link" href="https://tryhackme.com/p/ujohn">ujohn</a></p></p>
</div>
</div>
</span>
</div>
</div>
</div>
<div id="room-simple-video" class="card card-body cd-2"></div>
<div class="card mt-3 mb-3 cd-2 text-center" id="instance-info">
<div class="card-header card-header-red">Active Machine Information</div>
<div class="card-body">
<div class="row vertical-align-custom">
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3" id="table-machine-ip">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
</div>
</div>
</div>
<div id="task-list">
<div id="room-task-detail" class="mb-3"><span id="progress-bar" style="display: block;"><div class="progress"><div class="progress-bar bg-secondary" role="progressbar" style="width: 5%; aria-valuemin=" 0"="" aria-valuemax="100"> 0%</div></div></span></div>
<div id="taskContent"><div class="card" id="task-1">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse1" aria-expanded="true">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 1                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Introduction
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-server text-lgreen" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a deployable machine"></i></span>
                        </a>
                    </div>
                    <div id="collapse1" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><div class="btn-group mb-3 ml-3 float-right">
            <button type="button" class="btn btn-success" value="62769b4d132456004b2c52ab" onclick="deploy(this)"><i class="fas fa-play mr-2"></i> Start Machine</button>
        </div> <p style="text-align:center"><img src="./TryHackMe _ Zeek_files/28e589bb58d154301e8b2f12b1d501d4.png" alt="Zeek logo."><br></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Zeek (formerly Bro) is an open-source and commercial network monitoring tool (traffic analyser).</span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><br></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><a target="_blank" href="https://docs.zeek.org/en/master/about.html" class="editor-rtfLink">The official description;</a><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span>&nbsp;"Zeek (formerly Bro) is the world's leading platform for network security monitoring. Flexible, open-source, and powered by defenders." "Zeek is a passive, open-source network traffic analyser. Many operators use Zeek as a network security monitor (<a class="ihVidBTT glossary-term" onclick="initPopOver(&#39;NSM&#39;, &#39;ihVidBTT&#39;)">NSM</a>) to support suspicious or malicious activity investigations. Zeek also supports a wide range of traffic analysis tasks beyond the security domain, including performance measurement and troubleshooting."</span></span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><br></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span>The room aims to provide a general network monitoring overview and work with Zeek to investigate captured traffic. This room will expect you to have basic <a class="VmF7ZXGw glossary-term" onclick="initPopOver(&#39;Linux&#39;, &#39;VmF7ZXGw&#39;)">Linux</a> familiarity and Network fundamentals (ports, protocols and traffic data). We suggest completing the "</span></span><a target="_blank" href="https://tryhackme.com/module/network-fundamentals" class="editor-rtfLink"><strong>Network Fundamentals</strong></a><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">" path before starting working in this room.&nbsp;</span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><br></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span>A <a class="LZgQ8DIN glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;LZgQ8DIN&#39;)">VM</a> is attached to this room. You don't need SSH or RDP; the room provides a "Split View" feature. Exercise files are located in the folder on the desktop. Log cleaner script&nbsp;</span></span><strong>"clear-logs.sh"</strong><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">&nbsp;is available in each exercise folder.</span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><br></span></p><p style="text-align:center;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><img src="./TryHackMe _ Zeek_files/08f3f924977c891a06827b5838d989bb.png" alt="VM and interactive exercise materials."><br></p><p style="text-align:center;margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)"></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Read the task above.
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="1">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-2">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse2">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 2                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Network Security Monitoring and Zeek
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse2" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="text-align:center"><img src="./TryHackMe _ Zeek_files/2d36c346c977d3ec66a9625e8ae7f3bb.png" style="width:50%"><span style="font-weight:bolder"><span style="font-size:24px"><br></span></span></p><p style="text-align:left"><b style="text-align:justify;font-size:1rem"><span style="font-size:24px">Introduction to Network Monitoring Approaches</span></b><br></p><p style="text-align:justify"><span>Network monitoring is a set of management actions to watch/continuously overview and optionally save the network traffic for further investigation. This action aims to detect and reduce network problems, improve performance, and in some cases, increase overall productivity. It is a main part of the daily IT/SOC operations and differs from Network Security Monitoring (<a class="Z4JQqUnj glossary-term" onclick="initPopOver(&#39;NSM&#39;, &#39;Z4JQqUnj&#39;)">NSM</a>) in its purpose.</span></p><p style="text-align:justify"><span style="font-weight:bolder;font-size:18px">Network Monitoring</span></p><p style="text-align:justify;line-height:1.5"><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Network monitoring is highly focused on IT assets like uptime (availability), device health and connection quality (performance), and network traffic balance and management (configuration). Monitoring and visualising the network traffic, troubleshooting, and root cause analysis are also part of the Network Monitoring process</span><strong>.</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span>&nbsp;This model is helpful for network administrators and usually doesn't cover identifying non-asset in-depth vulnerabilities and significant security concerns like internal threats and zero-day vulnerabilities. Usually, Network Monitoring is not within the <a class="eoGgcVis glossary-term" onclick="initPopOver(&#39;SOC&#39;, &#39;eoGgcVis&#39;)">SOC</a> scope. It is linked to the enterprise IT/Network management team.</span></span><br></p><p style="text-align:justify"><span style="font-weight:bolder;font-size:18px">Network Security Monitoring</span></p><p style="text-align:justify"><span>Network Security Monitoring is focused on network anomalies like rogue hosts, encrypted traffic, suspicious service and port usage, and malicious/suspicious traffic patterns in an intrusion/anomaly detection and response approach. Monitoring and visualising the network traffic and investigating suspicious events is a core part of Network Security Monitoring. This model is helpful for security analysts/incident responders, security engineers and threat hunters and covers identifying threats, vulnerabilities and security issues with a set of rules, signatures and patterns. Network Security Monitoring is part of the <a class="1RTztxay glossary-term" onclick="initPopOver(&#39;SOC&#39;, &#39;1RTztxay&#39;)">SOC</a>, and the actions are separated between tier 1-2-3 analyst levels.</span><br></p><p style="text-align:justify"><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;font-size:24px"><b>What is ZEEK?</b></span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Zeek (formerly Bro) is an open-source and commercial passive Network Monitoring tool (traffic analysis framework) developed by Lawrence Berkeley Labs. Today, Zeek is supported by several developers, and Corelight provides an Enterprise-ready fork of Zeek. Therefore this tool is called both open source and commercial. The differences between the open-source version and the commercial version are detailed&nbsp;</span><a target="_blank" href="https://corelight.com/products/compare-to-open-source-zeek?hsLang=en" class="editor-rtfLink">here</a><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">.</span></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><br></span></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Zeek differs from known monitoring and IDS/IPS tools by providing a wide range of detailed logs ready to investigate both for forensics and data analysis actions. Currently,</span><strong>&nbsp;</strong><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Zeek provides 50+ logs in 7 categories.</span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><br></span></p><p style="text-align:justify"><b><span style="font-size:24px">Zeek vs Snort</span></b></p><p style="text-align:justify">While both are called IDS/NIDS, it is good to know the cons and pros of each tool and use them in a specific manner. While there are some overlapping functionalities, they have different purposes for usage.</p><table class="table table-bordered"><tbody><tr><td><b>Tool</b></td><td><b>Zeek</b></td><td><b>Snort</b></td></tr><tr><td><b>Capabilities</b></td><td><span><a class="OE2ZoFWY glossary-term" onclick="initPopOver(&#39;NSM&#39;, &#39;OE2ZoFWY&#39;)">NSM</a> and IDS framework. It is heavily focused on network analysis. It is more focused on specific threats to trigger alerts. The detection mechanism is focused on events.</span></td><td>An IDS/IPS system. It is heavily focused on signatures to detect vulnerabilities. The detection mechanism is focused on signature patterns and packets.</td></tr><tr><td><b>Cons</b></td><td><p>Hard to use.</p><p>The analysis is done out of the Zeek, manually or by automation.&nbsp;</p></td><td>Hard to detect complex threats.</td></tr><tr><td><b>Pros</b></td><td><p>It provides in-depth traffic visibility.</p><p>Useful for threat hunting.</p><p>Ability to detect complex threats.</p><p>It has a scripting language and supports event correlation.&nbsp;</p><p>Easy to read logs.</p></td><td><p>Easy to write rules.</p><p>Cisco supported rules.</p><p>Community support.</p></td></tr><tr><td><b>Common Use Case</b></td><td>Network monitoring.<br>In-depth traffic investigation. <br>Intrusion detecting in chained events.&nbsp;</td><td>Intrusion detection and prevention. <br>Stop known attacks/threats.</td></tr></tbody></table><p style="text-align:justify"></p><p style="text-align:justify"><b style="font-size:1rem"><span style="font-size:24px">Zeek Architecture</span></b><br></p><p style="text-align:justify">Zeek has two primary layers; "Event Engine" and "Policy Script Interpreter". The Event Engine layer is where the packets are processed; it is called the event core and is responsible for describing the event without focusing on event details. It is where the packages are divided into parts such as source and destination addresses, protocol identification, session analysis and file extraction. The Policy Script Interpreter layer is where the semantic analysis is conducted. It is responsible for describing the event correlations by using Zeek scripts.</p><p style="text-align:justify"><img src="./TryHackMe _ Zeek_files/07d58ecdaa53829df19be1ec47d2d666.png" style="width:100%"><br></p><p style="text-align:center"><br></p><span style="font-weight:bolder;font-size:1rem"><span style="font-size:24px">Zeek Frameworks</span></span><br><p></p><p style="text-align:justify">Zeek has several frameworks to provide extended functionality in the scripting layer. These frameworks enhance Zeek's flexibility and compatibility with other network components. Each framework focuses on the specific use case and easily runs with Zeek installation. For instance, we will be using the "Logging Framework" for all cases. Having ide on each framework's functionality can help users quickly identify an event of interest.&nbsp;</p><p style="text-align:justify"><b style="font-size:1rem"><span style="font-size:18px">Available Frameworks</span></b></p><table class="table table-bordered"><tbody><tr><td>Logging</td><td>Notice</td><td>Input</td><td>Configuration</td><td>Intelligence</td></tr><tr><td>Cluster</td><td>Broker Communication</td><td>Supervisor</td><td>GeoLocation</td><td>File Analysis</td></tr><tr><td>Signature</td><td>Summary</td><td>NetControl</td><td>Packet Analysis</td><td>TLS Decryption</td></tr></tbody></table><p style="text-align:justify"><span style="font-size:1rem"><span style="font-size:16px">You can read more on frameworks <a href="https://docs.zeek.org/en/master/frameworks/index.html" target="_blank"><b>here</b></a>.&nbsp;</span></span></p><p style="text-align:justify"><span style="font-weight:bolder;font-size:1rem"><span style="font-size:24px">Zeek Outputs</span></span><span style="font-size:1rem"><span style="font-size:16px"><br></span></span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">As mentioned before, Zeek provides 50+ log files under seven different categories, which are helpful in various areas such as traffic monitoring, intrusion detection, threat hunting and web analytics. This section is not intended to discuss the logs in-depth. The logs are covered in&nbsp;</span><strong>TASK 3</strong><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">.</span><br></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><br></span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;font-size:1rem;text-align:left;margin-top:0pt;margin-bottom:0pt">Once you run Zeek, it will automatically start investigating the traffic or the given pcap file and generate logs automatically. Once you process a pcap with Zeek, it will create the logs in the working directory.</span><strong>&nbsp;</strong><span style="background:transparent;font-size:1rem;text-align:left;margin-top:0pt;margin-bottom:0pt">If you run the Zeek as a service, your logs will be located in the default log path.</span>&nbsp;The default log path is:</span><code> /opt/zeek/logs/&nbsp;</code></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><br></p><p style="text-align:justify"><b><span style="font-size:24px">Working with Zeek</span></b></p><p style="text-align:justify"><span style="background:transparent;color:rgb(14, 16, 26);font-size:1rem;margin-top:0pt;margin-bottom:0pt">There are two operation options for Zeek. The first one is running it as a service, and the second option is running the Zeek against a pcap. Before starting working with Zeek, let's check the version of the Zeek instance with the following command: </span><code>zeek -v</code></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;font-size:1rem;text-align:left;margin-top:0pt;margin-bottom:0pt">Now we are sure that we have Zeek installed. Let's start the Zeek as a service! To do this, we need to use the "ZeekControl" module, as shown below. The "ZeekControl" module requires superuser permissions to use.</span><strong>&nbsp;</strong><span style="background:transparent;font-size:1rem;text-align:left;margin-top:0pt;margin-bottom:0pt">You can elevate the session privileges and switch to the superuser account to examine the generated log files with the following command:</span>&nbsp;</span><code>sudo su</code></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><br></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"></span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Here we can manage the Zeek service and view the status of the service. Primary management of the Zeek service is done with three commands; "status", "start", and "stop".&nbsp;</span></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><br></span></p>
<div class="terminal-container">
    <div class="terminal-content defender">
        <div class="terminal-top">
            ZeekControl Module</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">root@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">zeekctl</span></span>
<span class="token output">Welcome to ZeekControl 2.X.0
[ZeekControl] &gt; status
Name         Type       Host          Status    Pid    Started
zeek         standalone localhost     stopped
[ZeekControl] &gt; start
starting zeek ...
[ZeekControl] &gt; status
Name         Type       Host          Status    Pid    Started
zeek         standalone localhost     running   2541   13 Mar 18:25:08
[ZeekControl] &gt; stop
stopping zeek ...
[ZeekControl] &gt; status
Name         Type       Host          Status    Pid    Started
zeek         standalone localhost     stopped</span></code>
        </pre>
    </div>
</div>
<p style="text-align:justify">You can also use the "ZeekControl" mode with the following commands as well;<br></p><ul><li style="text-align:justify"><code>zeekctl status</code></li><li style="text-align:justify"><code>zeekctl start</code><span style="font-size:1rem">&nbsp;</span></li><li style="text-align:justify"><span style="font-size:1rem"> </span><code>zeekctl stop</code><span style="font-size:1rem">&nbsp;</span></li></ul><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">The only way to listen to the live network traffic is using Zeek as a service. Apart from using the Zeek as a network monitoring tool, we can also use it as a packet investigator.</span><strong>&nbsp;</strong><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">To do so, we need to process the pcap files with Zeek, as shown below. Once you process a pcap file, Zeek automatically creates log files according to the traffic.</span><br></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><br></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">In pcap processing mode, logs are saved in the working directory. You can view the generated logs using the </span><code>ls -l</code><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"> command.&nbsp;&nbsp;</span></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><br></span></p>

<div class="terminal-container">
    <div class="terminal-content defender">
        <div class="terminal-top">
            ZeekControl Module</div>
        <pre class="terminal-code language-shell-session" tabindex="0">           <code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">root@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">zeek -C -r sample.pcap </span></span>

<span class="token command"><span class="token info punctuation"><span class="token user">root@ubuntu</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">ls</span> -l</span></span>
<span class="token output">-rw-r--r-- 1 ubuntu ubuntu  11366 Mar 13 20:45 conn.log
-rw-r--r-- 1 ubuntu ubuntu    763 Mar 13 20:45 dhcp.log
-rw-r--r-- 1 ubuntu ubuntu   2918 Mar 13 20:45 dns.log
-rw-r--r-- 1 ubuntu ubuntu    254 Mar 13 20:45 packet_filter.log </span></code>
        </pre>
    </div>
</div>

<p style="text-align:justify"><b style="font-size:1rem">Main Zeek command line parameters are explained below;</b><br></p><table class="table table-bordered"><tbody><tr><td><b>Parameter</b></td><td><b>Description</b></td></tr><tr><td><b>-r</b></td><td>&nbsp;Reading option, read/process a pcap file.</td></tr><tr><td><b>-C</b></td><td>&nbsp;Ignoring checksum errors.</td></tr><tr><td><b>-v</b></td><td>&nbsp;Version information.</td></tr><tr><td><b>zeekctl</b></td><td>ZeekControl module.</td></tr></tbody></table><p style="text-align:justify">Investigating the generated logs will require command-line tools (cat, cut, grep sort, and uniq) and additional tools (zeek-cut). We will cover them in the following tasks.</p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Each exercise has a folder. Ensure you are in the right directory to find the pcap file and accompanying files.&nbsp;</span><strong>Desktop/Exercise-Files/TASK-2</strong><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                What is the installed Zeek instance version number?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *.*.*" value="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="font-size:1rem">What is the version of the ZeekControl module?</span><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *.*.*" value="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="font-size:1rem">Investigate the </span><b style="font-size:1rem">"sample.pcap"</b><span style="font-size:1rem"> file. What is the number of generated alert files?</span><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *" value="">
                            <input type="hidden" value="4">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-3">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse3">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 3                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Zeek Logs
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse3" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="text-align:center"><img src="./TryHackMe _ Zeek_files/9c44a0b3015dcabaeffb58d5d6422db9.png" alt="Zeek-Logs task image."><img><br></p><p><b style="font-size:1rem"><span style="font-size:24px">Zeek Logs</span></b><br></p><p style="text-align:justify;background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5">Zeek generates log files according to the traffic data. You will have logs for every connection in the wire, including the application level protocols and fields. Zeek is capable of identifying 50+ logs and categorising them into seven categories. Zeek logs are well structured and tab-separated ASCII files, so reading and processing them is easy but requires effort. You should be familiar with networking and protocols to correlate the logs in an investigation, know where to focus, and find a specific piece of evidence.</p><p style="text-align:justify;background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"><br></p><p style="text-align:justify;background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5">Each log output consists of multiple fields, and each field holds a different part of the traffic data. Correlation is done through a unique value called "UID". The "UID" represents the unique identifier assigned to each session.</p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><br></span></p><p style="text-align:justify"><b><span style="font-size:18px">Zeek logs in a nutshell;</span></b></p><table class="table table-bordered"><tbody><tr><td><span style="font-weight:bolder">Category</span><br></td><td><span style="font-weight:bolder">Description</span><br></td><td><b>Log Files</b></td></tr><tr><td><span style="font-weight:bolder">Network</span><br></td><td>Network protocol logs.<br></td><td style="text-align:justify"><i>conn.log, dce_rpc.log, dhcp.log, dnp3.log, dns.log, ftp.log, http.log, irc.log, kerberos.log, modbus.log, modbus_register_change.log, mysql.log, ntlm.log, ntp.log, radius.log, rdp.log, rfb.log, sip.log, smb_cmd.log, smb_files.log, smb_mapping.log, smtp.log, snmp.log, socks.log, ssh.log, ssl.log, syslog.log, tunnel.log.</i><br></td></tr><tr><td><span style="font-weight:bolder">Files</span><br></td><td>File analysis result logs.<br></td><td style="text-align:left"><i>files.log, ocsp.log, pe.log, x509.log.</i><br></td></tr><tr><td><span style="font-weight:bolder">NetControl</span><br></td><td>Network control and flow logs.<br></td><td style="text-align:left"><i>netcontrol.log, netcontrol_drop.log, netcontrol_shunt.log, netcontrol_catch_release.log, openflow.log.</i><br></td></tr><tr><td><span style="font-weight:bolder">Detection</span><br></td><td>Detection and possible indicator logs.<br></td><td style="text-align:justify"><i>intel.log, notice.log, notice_alarm.log, signatures.log, traceroute.log.</i><br></td></tr><tr><td><span style="font-weight:bolder">Network Observations</span><br></td><td>Network flow logs.<br></td><td style="text-align:left"><i>known_certs.log, known_hosts.log, known_modbus.log, known_services.log, software.log.</i><br></td></tr><tr><td><span style="font-weight:bolder">Miscellaneous</span><br></td><td>Additional logs cover external alerts, inputs and failures.<br></td><td style="text-align:left"><i>barnyard2.log, dpd.log, unified2.log, unknown_protocols.log, weird.log, weird_stats.log.</i><br></td></tr><tr><td><span style="font-weight:bolder">Zeek Diagnostic</span><br></td><td>Zeek diagnostic logs cover system messages, actions and some statistics.<br></td><td style="text-align:left"><i>broker.log, capture_loss.log, cluster.log, config.log, loaded_scripts.log, packet_filter.log, print.log, prof.log, reporter.log, stats.log, stderr.log, stdout.log.</i><br></td></tr></tbody></table><p style="text-align:justify;line-height:1.5"><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Please refer to&nbsp;</span><a target="_blank" href="https://docs.zeek.org/en/current/script-reference/log-files.html" class="editor-rtfLink">Zeek's official documentation</a><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">&nbsp;and&nbsp;</span><a target="_blank" href="https://corelight.com/about-zeek/zeek-data" class="editor-rtfLink">Corelight log cheat sheet</a><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">&nbsp;for more information. Although there are multiple log files, some log files are updated daily, and some are updated in each session. Some of the most commonly used logs are explained in the given table.</span></p><table class="table table-bordered"><tbody><tr><td><b>Update Frequency</b></td><td><b>Log Name<br></b></td><td><b>Description</b><br></td></tr><tr><td><b>Daily</b></td><td><i>known_hosts.log</i></td><td style="text-align:left"><span>&nbsp;List of hosts that completed <a class="qk4nRpt8 glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;qk4nRpt8&#39;)">TCP</a> handshakes.</span></td></tr><tr><td><b>Daily</b></td><td><i>known_services.log</i></td><td style="text-align:left">&nbsp;List of services used by hosts.</td></tr><tr><td><b>Daily</b></td><td><i>known_certs.log</i></td><td style="text-align:left">&nbsp;List of SSL certificates.</td></tr><tr><td><b>Daily</b></td><td><i>software.log</i></td><td style="text-align:left">&nbsp;List of software used on the network.</td></tr><tr><td><b>Per Session</b></td><td><i>notice.log</i></td><td style="text-align:left">&nbsp;Anomalies detected by Zeek.</td></tr><tr><td><b>Per Session</b><br></td><td><i>intel.log</i></td><td style="text-align:left">&nbsp;Traffic contains malicious patterns/indicators.</td></tr><tr><td><span style="font-weight:bolder">Per Session</span><br></td><td><i>signatures.log</i></td><td style="text-align:left">&nbsp;List of triggered signatures.</td></tr></tbody></table><p style="text-align:justify">This is too much protocol and log information! Yes, it is true; a difficulty of working with Zeek is having the required network knowledge and investigation mindset. Don't worry; you can have both of these and even more knowledge by working through TryHackMe paths. Just keep the streak!&nbsp;</p><p><b><span style="font-size:18px">Brief log usage primer table;</span></b></p><table class="table table-bordered"><tbody><tr><td><b>Overall Info</b></td><td><b>Protocol Based</b></td><td><b>Detection</b></td><td><b>Observation</b></td></tr><tr><td><i>conn.log</i></td><td><i>http.log</i></td><td><i>notice.log</i></td><td><i>known_host.log</i></td></tr><tr><td><i>files.log</i></td><td><i>dns.log</i></td><td><i>signatures.log</i></td><td><i>known_services.log</i></td></tr><tr><td><i>intel.log</i></td><td><i>ftp.log</i></td><td><i>pe.log</i></td><td><i>software.log</i></td></tr><tr><td><i>loaded_scripts.log</i></td><td><i>ssh.log</i></td><td><i>traceroute.log</i></td><td><i>weird.log</i></td></tr></tbody></table><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">You can categorise the logs before starting an investigation. Thus, finding the evidence/anomaly you are looking for will be easier. The given table is a brief example of using multiple log files. You can create your working model or customise the given one. Make sure you read each log description and understand the purpose to know what to expect from the corresponding log file. Note that</span><strong>&nbsp;</strong><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">these are not the only ones to focus on. Investigated logs are highly associated with the investigation case type and hypothesis, so do not just rely only on the logs given in the example table!</span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><br></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">The table shows us how to use multiple logs to identify anomalies and run an investigation by correlating across the available logs.</span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc;line-height:1.8"><br></p><ul style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><li style="text-align:justify;background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><strong>Overall Info:&nbsp;</strong><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">The aim is to review the overall connections, shared files, loaded scripts and indicators at once. This is the first step of the investigation.</span></li><li style="text-align:justify;background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><strong>Protocol Based:&nbsp;</strong><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Once you review the overall traffic and find suspicious indicators or want to conduct a more in-depth investigation, you focus on a specific protocol.</span></li><li style="text-align:justify;background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><strong>Detection:&nbsp;</strong><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Use the prebuild or custom scripts and signature outcomes to support your findings by having additional indicators or linked actions.&nbsp;</span></li><li style="text-align:justify;background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><strong>Observation:&nbsp;</strong><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">The summary of the hosts, services, software, and unexpected activity statistics will help you discover possible missing points and conclude the investigation.</span></li></ul><p><span style="text-align:justify;font-size:1rem"><br>Remember, we mention the pros and cons of the Zeek logs at the beginning of this task. Now let's demonstrate the log viewing and identify the differences between them.</span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><strong>Recall 1:</strong><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">&nbsp;Zeek logs are well structured and tab-separated ASCII files, so reading and processing them is easy but requires effort.</span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><strong>Recall 2:</strong><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">&nbsp;Investigating the generated logs will require command-line tools (cat, cut, grep sort, and uniq) and additional tools (zeek-cut).&nbsp;<br><br></span></p><p><b><span style="font-size:18px">Opening a Zeek log with a text editor and built-in commands;</span></b></p><p style="text-align:center"><img src="./TryHackMe _ Zeek_files/93f31d7853edd50e43be99dd791325e7.png" alt="Zeek logfile details."><br></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">The above image shows that reading the logs with tools is not enough to spot an anomaly quickly. Logs provide a vast amount of data to investigate and correlate. You will need to have technical knowledge and event correlation ability to carry out an investigation. It is possible to use external visualisation and correlation tools such as ELK and Splunk. We will focus on using and processing the logs with a hands-on approach in this room. </span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><br></span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span>In addition to <a class="eeHtPk1k glossary-term" onclick="initPopOver(&#39;Linux&#39;, &#39;eeHtPk1k&#39;)">Linux</a> command-line tools, one auxiliary program called </span></span><code>zeek-cut</code><strong>&nbsp;</strong><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">reduces the effort of extracting specific columns from log files.&nbsp;</span><span style="background-color:transparent;font-size:1rem">Each log file provides "field names" in the beginning. This information will help you while using </span><code>zeek-cut</code><span style="background-color:transparent;font-size:1rem">. Make sure that you use the "fields" and not the "types".</span></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><br></span></p><table class="table table-bordered"><tbody><tr><td><b>Tool/Auxilary Name</b></td><td><b>Purpose</b></td></tr><tr><td><b>Zeek-cut</b></td><td>Cut specific columns from zeek logs.</td></tr></tbody></table><p style="text-align:justify">Let's see the "zeek-cut" in action. Let's extract the uid, protocol, source and destination hosts, and source and destination ports from the conn.log. We will first read the logs with the <code>cat</code> command and then extract the event of interest fields with <code>zeek-cut</code> auxiliary to compare the difference.<br></p>

<div class="terminal-container">
    <div class="terminal-content defender">
        <div class="terminal-top">
            zeek-cut usage example</div>
        <pre class="terminal-code language-markup" tabindex="0">           <code class=" language-markup">root@ubuntu$ cat conn.log 
...
#fields	ts	uid	id.orig_h	id.orig_p	id.resp_h	id.resp_p	proto	service	duration	orig_bytes	resp_bytes	conn_state	local_orig	local_resp	missed_bytes	history	orig_pkts	orig_ip_bytes	resp_pkts	resp_ip_bytes	tunnel_parents
#types	time	string	addr	port	addr	port	enum	string	interval	count	count	string	bool	bool	count	string	count	count	count	count	set[string]
1488571051.943250	CTMFXm1AcIsSnq2Ric	192.168.121.2	51153	192.168.120.22	53	udp	dns	0.001263	36	106	SF	-	-0	Dd	1	64	1	134	-
1488571038.380901	CLsSsA3HLB2N6uJwW	192.168.121.10	50080	192.168.120.10	514	udp	-	0.000505	234	0	S0	-	-0	D	2	290	0	0	-

root@ubuntu$ cat conn.log | zeek-cut uid proto id.orig_h id.orig_p id.resp_h id.resp_p 
CTMFXm1AcIsSnq2Ric	udp	192.168.121.2	51153	192.168.120.22	53
CLsSsA3HLB2N6uJwW	udp	192.168.121.10	50080	192.168.120.10	514</code>
        </pre>
    </div>
</div>
<p><span style="text-align:justify;background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">As shown in the above output, the "zeek-cut"</span><strong>&nbsp;</strong><span style="text-align:justify;background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">auxiliary provides massive help to extract specific fields with minimal effort. Now take time to read log formats, practice the log reading/extracting operations and answer the questions.</span><br></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Each exercise has a folder. Ensure you are in the right directory to find the pcap file and accompanying files.&nbsp;</span><strong>Desktop/Exercise-Files/TASK-3</strong><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Investigate the&nbsp;</span><strong>sample.pcap</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">&nbsp;file. Investigate the <b>dhcp.log</b> file. What is the available hostname?</span><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ************" value="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Investigate the&nbsp;</span><strong>dns</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><b>.log</b><span> file. What is the number of unique <a class="1Vw5XNzz glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;1Vw5XNzz&#39;)">DNS</a> queries?</span></span><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *" value="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Investigate the&nbsp;</span><strong>conn.log</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">&nbsp;file. What is the longest connection duration?</span><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***.******" value="">
                            <input type="hidden" value="4">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-4">
                    <div class="card-header task-header collapsed" data-toggle="collapse" href="#collapse4" aria-expanded="false">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 4                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> CLI Kung-Fu Recall: Processing Zeek Logs
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse4" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="text-align:center"><img src="./TryHackMe _ Zeek_files/364aa0f61373366b6739d93112688b56.png" alt="Zeek cli kung-fu task image." style="width:100%"><br></p><p><b style="font-size:1rem"><span style="font-size:24px">CLI Kung-Fu Recall: Processing Zeek Logs</span></b><br></p><p></p><div style="text-align:justify"><div>Graphical User Interfaces (GUI) are handy and good for accomplishing tasks and processing information quickly. There are multiple advantages of GUIs, especially when processing the information visually. However, when processing massive amounts of data, GUIs are not stable and as effective as the CLI (Command Line Interface) tools.</div><div><br></div><div>The critical point is: What if there is no "function/button/feature" for what you want to find/view/extract?</div><div><br></div><div><span>Having the power to manipulate the data at the command line is a crucial skill for analysts. Not only in this room but each time you deal with packets, you will need to use command-line tools, Berkeley Packet Filters (<a class="kgjCqXbV glossary-term" onclick="initPopOver(&#39;BPF&#39;, &#39;kgjCqXbV&#39;)">BPF</a>) and regular expressions to find/view/extract the data you are looking for.&nbsp;</span><span style="font-size:1rem">This task provides quick cheat-sheet like information to help you write CLI queries for your event of interest.</span></div></div><p><span style="font-size:1rem"><br></span></p><table class="table table-bordered"><tbody><tr><td><span style="font-weight:bolder">Category</span><br></td><td><span style="font-weight:bolder">Command Purpose and Usage&nbsp;</span><br></td><td><span style="font-weight:bolder">Category</span><br></td><td><span style="font-weight:bolder">Command Purpose and Usage&nbsp;</span><br></td></tr><tr><td><span style="font-weight:bolder">Basics</span><br></td><td><p style="text-align:left"><span style="font-size:1rem">View the command history:<br></span><code>ubuntu@ubuntu$ history</code><span style="font-size:1rem"></span><br></p><p style="text-align:left">Execute the 10th command in history:<br><code style="font-size:14px">ubuntu@ubuntu$ !10</code></p><p style="text-align:left"><span style="font-size:1rem">Execute the previous command:<br></span><code style="font-size:14px">ubuntu@ubuntu$&nbsp;!!</code></p></td><td><span style="font-weight:700">Read&nbsp;</span><b>File</b></td><td><p style="text-align:left;line-height:1"><br></p><p style="text-align:left">Read sample.txt file:<br><code style="font-size:14px">ubuntu@ubuntu$ cat sample.txt</code><b><br></b></p><p style="text-align:left">Read the first 10 lines of the file:<br><code style="font-size:14px">ubuntu@ubuntu$ head sample.txt</code><span style="color:rgb(186, 200, 212);font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;white-space:pre-wrap;background-color:rgb(30, 60, 97)"></span><br></p><p style="text-align:left">Read the last 10 lines of the file:<br><code style="font-size:14px">ubuntu@ubuntu$ tail sample.txt</code></p></td></tr><tr><td><p><span style="font-weight:bolder">Find<br></span><span style="font-weight:bolder;font-size:1rem">&amp;<br></span><span style="font-weight:bolder;font-size:1rem">Filter</span></p></td><td><p style="text-align:left;line-height:1.2"><br></p><p style="text-align:left">Cut the 1st field:<br><code style="font-size:14px">ubuntu@ubuntu$ cat test.txt | cut -f 1</code><br></p><p style="text-align:left">Cut the 1st column:<br><code style="font-size:14px">ubuntu@ubuntu$ cat test.txt | cut -c1</code><span style="font-weight:bolder"><br></span></p><p style="text-align:left">Filter specific keywords:<br><code style="font-size:14px">ubuntu@ubuntu$ cat test.txt | grep 'keywords'</code><br></p><p style="text-align:left">Sort outputs alphabetically:<br><code style="font-size:14px">ubuntu@ubuntu$ cat test.txt | sort</code><span style="font-size:1rem"></span></p><p style="text-align:left">Sort outputs numerically:<br><code style="font-size:14px">ubuntu@ubuntu$ cat test.txt | sort -n</code><span style="font-size:1rem"></span></p><p style="text-align:left">Eliminate duplicate lines:<br><code style="font-size:14px">ubuntu@ubuntu$ cat test.txt | uniq</code><br></p><p style="text-align:left">Count line numbers:<br><code style="font-size:14px">ubuntu@ubuntu$ cat test.txt | wc -l</code><br></p><p style="text-align:left">Show line numbers<span style="background-color:rgb(255, 255, 255)"><br></span><code>ubuntu@ubuntu$ cat test.txt | nl</code></p></td><td><span style="font-weight:bolder">Advanced</span><br></td><td><p style="text-align:left"><span style="font-size:1rem"><br></span></p><p style="text-align:left"><span style="font-size:1rem">Print line 11:<br></span><code style="font-size:14px">ubuntu@ubuntu$ cat test.txt | sed -n '11p'</code><span style="font-size:1rem"><br></span></p><p style="text-align:left"><span style="font-size:1rem">Print lines between 10-15:<br></span><code style="font-size:14px">ubuntu@ubuntu$ cat test.txt | sed -n '10,15p'</code><span style="font-size:1rem"></span></p><p style="text-align:left">Print lines below 11:<br><code style="font-size:14px">ubuntu@ubuntu$ cat test.txt | awk 'NR &lt; 11 {print $0}'</code><br></p><p style="text-align:left">Print line 11:<br><code style="font-size:14px">ubuntu@ubuntu$ cat test.txt | awk 'NR == 11 {print $0}'</code></p></td></tr></tbody></table>

<table class="table table-bordered"><tbody><tr><td><b>Special</b></td><td><div style="text-align:justify"><span style="text-align:left;font-size:1rem">Filter specific fields of Zeek logs:</span></div><div style="text-align:justify"><code>ubuntu@ubuntu$ cat signatures.log | zeek-cut uid src_addr dst_addr</code><span style="text-align:left"></span></div></td></tr></tbody></table><table class="table table-bordered"><tbody><tr><td><b>Use Case</b></td><td><b>Description</b></td></tr><tr><td><p><code>sort | uniq</code></p></td><td style="text-align:left">Remove duplicate values.<br></td></tr><tr><td><p><code>sort | uniq -c&nbsp;</code></p></td><td style="text-align:left">Remove duplicates and count the number of occurrences for each value.<br></td></tr><tr><td><p><code>sort -nr</code></p></td><td style="text-align:left">Sort values numerically and recursively.</td></tr><tr><td><p><code>rev</code></p></td><td style="text-align:left">Reverse string characters.</td></tr><tr><td><p><code>cut -f 1</code></p></td><td style="text-align:left">Cut field 1.</td></tr><tr><td><p><code>cut -d '.' -f 1-2</code></p></td><td style="text-align:left">Split the string on every dot and print keep the first two fields.</td></tr><tr><td><p><code>grep -v 'test'</code></p></td><td style="text-align:left">Display lines that&nbsp; don't match the "test" string.</td></tr><tr><td><p><code>grep -v -e 'test1' -e 'test2'</code></p></td><td style="text-align:left">Display lines that don't match one or both "test1" and "test2" strings.</td></tr><tr><td><p><code>file&nbsp;</code></p></td><td style="text-align:left">View file information.</td></tr><tr><td><p><code>grep -rin Testvalue1 * | column -t | less -S</code></p></td><td style="text-align:left">Search the "Testvalue1" string everywhere, organise column spaces and view the output with less.</td></tr></tbody></table></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Read the task above.
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-5">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse5">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 5                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Zeek Signatures
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse5" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="text-align:center"><img src="./TryHackMe _ Zeek_files/a6fb1153dfbd0a96dbf8f593027a9452.png" alt="Zeek signatures task image."><b><span style="font-size:24px"><br></span></b></p><p><b style="font-size:1rem"><span style="font-size:24px">Zeek Signatures</span></b><br></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"><span style="background-color:transparent;font-size:1rem">Zeek supports signatures to have rules and event correlations to find noteworthy activities on the network. Zeek signatures use low-level pattern matching and cover conditions similar to Snort rules. Unlike Snort rules, Zeek rules are not the primary event detection point. Zeek has a scripting language and can chain multiple events to find an event of interest. We focus on the signatures in this task, and then we will focus on Zeek scripting in the following tasks.</span><br></p><p style="text-align:justify;background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"><br></p><p style="text-align:justify;background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"></span></p><p style="text-align:justify;background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5">Zeek signatures are composed of three logical paths; signature id, conditions and action. The signature breakdown is shown in the table below;</p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><br></span></p><table class="table table-bordered"><tbody><tr><td><b>Signature id</b></td><td style="text-align:justify"><b>&nbsp;Unique</b> signature name.</td></tr><tr><td><b>Conditions</b></td><td><div style="text-align:justify"><b style="font-size:1rem">Header:&nbsp;</b><span style="text-align:center;background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">Filtering the packet headers for specific source and destination addresses, protocol and port numbers.</span></div><b><div style="text-align:justify"><b style="font-size:1rem">Content: </b><span style="font-size:1rem;font-weight:400">Filtering the packet payload for specific value/pattern.</span></div></b></td></tr><tr><td><b>Action</b></td><td><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><strong>Default action:&nbsp;</strong><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Create the "signatures.log" file in case of a signature match.</span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><strong>Additional action:&nbsp;</strong><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Trigger a Zeek script.</span></p></td></tr></tbody></table><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"><span style="background-color:transparent;font-size:1rem">Now let's dig more into the Zeek signatures. The below table provides the most common conditions and filters for the Zeek signatures.</span></p><p style="margin-top:0pt;margin-bottom:0pt;text-align:justify;color:rgb(14, 16, 26);background:transparent;line-height:1.5"><br></p><table class="table table-bordered" style="width:1075.56px"><tbody><tr><td><span style="font-weight:bolder">Condition Field</span></td><td><span style="font-weight:bolder">Available Filters</span></td></tr><tr><td><span style="font-weight:bolder">Header</span></td><td><div style="text-align:justify"><span style="font-weight:bolder;font-size:1rem">src-ip:&nbsp;</span><span style="font-size:1rem">Source IP.</span></div><span style="font-weight:bolder"><div style="text-align:justify"><span style="font-weight:bolder;font-size:1rem">dst-ip:&nbsp;</span><span style="font-size:1rem;font-weight:400">Destination IP.</span></div></span><span style="font-weight:bolder"><div style="text-align:justify"><span style="font-weight:bolder;font-size:1rem">src-port:&nbsp;</span><span style="font-size:1rem;font-weight:400">Source port.</span></div></span><span style="font-weight:bolder"><div style="text-align:justify"><span style="font-weight:bolder;font-size:1rem">dst-port:&nbsp;</span><span style="font-size:1rem;font-weight:400">Destination port.</span></div></span><span style="font-weight:bolder"><div style="text-align:justify"><span style="font-weight:bolder;font-size:1rem">ip-proto:</span><span style="font-size:1rem;font-weight:400"><span>&nbsp;Target protocol. Supported protocols; <a class="XpSJb3Ik glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;XpSJb3Ik&#39;)">TCP</a>, UDP, ICMP, ICMP6, IP, IP6</span></span></div></span></td></tr><tr><td><span style="font-weight:bolder">Content</span></td><td style="text-align:justify"><b>payload:</b>&nbsp;Packet payload.<br><b>http-request: </b>Decoded&nbsp;HTTP requests.<br><b>http-request-header:</b><span> Client-side <a class="jscbBFSa glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;jscbBFSa&#39;)">HTTP</a> headers.</span><br><b>http-request-body:</b><span> Client-side <a class="6bgARti7 glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;6bgARti7&#39;)">HTTP</a> request bodys.</span><br><b>http-reply-header:</b><span> Server-side <a class="ArCcDFDG glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;ArCcDFDG&#39;)">HTTP</a> headers.</span><br><b>http-reply-body:</b><span> Server-side <a class="Pzsg2zcl glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;Pzsg2zcl&#39;)">HTTP</a> request bodys.</span><br><b>ftp:</b><span> Command line input of <a class="JWnMaN8E glossary-term" onclick="initPopOver(&#39;FTP&#39;, &#39;JWnMaN8E&#39;)">FTP</a> sessions.</span><br></td></tr><tr><td><b>Context</b></td><td style="text-align:justify"><b>same-ip:</b> Filtering the source and destination addresses for duplication.<br></td></tr><tr><td><span style="font-weight:bolder">Action</span></td><td style="text-align:justify"><b>event: </b>Signature match message.<br></td></tr><tr><td><b>Comparison<br>Operators</b></td><td style="text-align:justify"><b>==</b>, <b>!=</b>, <b>&lt;</b>, <b>&lt;=</b>, <b>&gt;</b>, <b>&gt;=</b></td></tr><tr><td><b>NOTE!</b></td><td style="text-align:justify">&nbsp;Filters accept string, numeric and regex values.</td></tr></tbody></table>

<div class="terminal-container">
    <div class="terminal-content defender">
        <div class="terminal-top">
            Run Zeek with signature file</div>
        <pre class="terminal-code language-markdown" tabindex="0">           <code class=" language-markdown">ubuntu@ubuntu$ zeek -C -r sample.pcap -s sample.sig</code>
        </pre>
    </div>
</div>

<p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"><br></p><table class="table table-bordered"><tbody><tr><td style="text-align:left">Zeek signatures use the ".sig" extension.</td></tr><tr><td><div style="text-align:left"><span style="font-size:1rem"><b>-C:</b> Ignore checksum errors.</span></div><div style="text-align:left"><span style="font-size:1rem"><b>&nbsp;-r:</b> Read pcap file.</span></div><div style="text-align:left"><span style="font-size:1rem"><b>-s:</b> Use signature file.&nbsp;</span></div></td></tr></tbody></table><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"><br></p><p><span style="font-weight:bolder;font-size:1rem"><span style="font-size:24px">Example | Cleartext Submission of Password</span></span><br></p><p style="margin-top:0pt;margin-bottom:0pt;background:transparent;text-align:justify;color:rgb(14, 16, 26);line-height:2"><span style="background-color:transparent;font-size:1rem"><span>Let's create a simple signature to detect <a class="get5ht1k glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;get5ht1k&#39;)">HTTP</a> cleartext passwords.</span></span></p>

<p></p>
<details open="">
  <summary><b>View Signature</b></summary>
<div style="text-align:center">

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Sample Signature</div>
        <pre class="terminal-code language-markdown" tabindex="0">           <code class=" language-markdown">signature http-password {
     ip-proto == tcp
     dst_port == 80
     payload /.<span class="token italic"><span class="token punctuation">*</span><span class="token content">password.</span><span class="token punctuation">*</span></span>/
     event "Cleartext Password Found!"
}

<span class="token title important"><span class="token punctuation">#</span> signature: Signature name.</span>
<span class="token title important"><span class="token punctuation">#</span><span> ip-proto: Filtering <a class="5yASj7x6 glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;5yASj7x6&#39;)">TCP</a> connection.</span></span>
<span class="token title important"><span class="token punctuation">#</span> dst-port: Filtering destination port 80.</span>
<span class="token title important"><span class="token punctuation">#</span> payload: Filtering the "password" phrase.</span>
<span class="token title important"><span class="token punctuation">#</span> event: Signature match message.</span></code>
        </pre>
    </div>
</div>

<br></div>
</details>
<p></p>

<p style="margin-top:0pt;margin-bottom:0pt;text-align:justify;background:transparent;line-height:1.8"><span style="background:transparent;color:rgb(14, 16, 26);font-size:1rem;margin-top:0pt;margin-bottom:0pt">Remember, Zeek signatures support regex. Regex "</span><span style="background-color:transparent;color:rgb(14, 16, 26);font-size:1rem">.*</span><span style="background:transparent;color:rgb(14, 16, 26);font-size:1rem;margin-top:0pt;margin-bottom:0pt">" matches any character zero or more times. The rule will match when a "password" phrase is detected in the packet payload. Once the match occurs, Zeek will generate an alert and create additional log files (signatures.log and notice.log).</span><br></p><p style="margin-top:0pt;margin-bottom:0pt;text-align:justify;color:rgb(14, 16, 26);background:transparent;line-height:1.5"><br></p>

<div class="terminal-container">
    <div class="terminal-content defender">
        <div class="terminal-top">
            Signature Usage and Log Analysis</div>
        <pre class="terminal-code language-markdown" tabindex="0">           <code class=" language-markdown">ubuntu@ubuntu$ zeek -C -r http.pcap -s http-password.sig 
ubuntu@ubuntu$ ls
clear-logs.sh  conn.log  files.log  http-password.sig  http.log  http.pcap  notice.log  packet_filter.log  signatures.log

ubuntu@ubuntu$ cat notice.log  | zeek-cut id.orig_h id.resp_h msg 
10.10.57.178	44.228.249.3	10.10.57.178: Cleartext Password Found!
10.10.57.178	44.228.249.3	10.10.57.178: Cleartext Password Found!

ubuntu@ubuntu$ cat signatures.log | zeek-cut src_addr dest_addr sig_id event_msg 
10.10.57.178		http-password	10.10.57.178: Cleartext Password Found!
10.10.57.178		http-password	10.10.57.178: Cleartext Password Found!</code>
        </pre>
    </div>
</div>
<p style="margin-top:0pt;margin-bottom:0pt;text-align:justify;color:rgb(14, 16, 26);background:transparent;line-height:1.5"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><br></span></p><p style="margin-top:0pt;margin-bottom:0pt;text-align:justify;background:transparent;line-height:1.5">As shown in the above terminal output, the signatures.log and notice.log provide basic details and the signature message. Both of the logs also have the application banner field. So it is possible to know where the signature match occurs. Let's look at the application banner!<br></p><p style="margin-top:0pt;margin-bottom:0pt;text-align:justify;color:rgb(14, 16, 26);background:transparent;line-height:1.5"><br></p>

<div class="terminal-container">
    <div class="terminal-content defender">
        <div class="terminal-top">
            Log Analysis</div>
        <pre class="terminal-code language-markdown" tabindex="0">           <code class=" language-markdown"><span>ubuntu@ubuntu$ cat signatures.log | zeek-cut sub_msg
POST /userinfo.php HTTP/1.1\x0d\x0aHost: testphp.vulnweb.com\x0d\x0aUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:98.0) Gecko/20100101 Firefox/...

ubuntu@ubuntu$ cat notice.log  | zeek-cut sub
POST /userinfo.php HTTP/1.1\x0d\x0aHost: testphp.vulnweb.com\x0d\x0aUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:98.0) Gecko/20100101 Firefox/...</span></code>
        </pre>
    </div>
</div>

<p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"><span style="background:transparent;font-size:1rem;margin-top:0pt;margin-bottom:0pt">We will demonstrate only one log file output to avoid duplication after this point. You can practice discovering the event of interest by analysing&nbsp;</span><span style="font-size:1rem">notice.log</span><span style="background:transparent;font-size:1rem;margin-top:0pt;margin-bottom:0pt">&nbsp;and&nbsp;</span><span style="font-size:1rem">signatures.log.</span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"><span style="color:rgb(33, 37, 41);font-size:24px;font-weight:700;text-align:left"><br></span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"><span style="color:rgb(33, 37, 41);font-size:24px;font-weight:700;text-align:left"><span>Example | <a class="oll59cMv glossary-term" onclick="initPopOver(&#39;FTP&#39;, &#39;oll59cMv&#39;)">FTP</a> Brute-force</span></span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"><br></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"><span>Let's create another rule to filter <a class="S6mthpOl glossary-term" onclick="initPopOver(&#39;FTP&#39;, &#39;S6mthpOl&#39;)">FTP</a> traffic. This time, we will use the FTP content filter to investigate command-line inputs of the FTP traffic. The aim is to detect FTP "admin" login attempts. This basic signature will help us identify the admin login attempts and have an idea of possible admin account abuse or compromise events.</span></p>



<p></p>
<details open="">
  <summary><b>View Signature</b></summary>
<div style="text-align:center">

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Sample Signature</div>
        <pre class="terminal-code language-markdown" tabindex="0">           <code class=" language-markdown">signature ftp-admin {
     ip-proto == tcp
     ftp /.<span class="token italic"><span class="token punctuation">*</span><span class="token content">USER.</span><span class="token punctuation">*</span></span>dmin.*/
     event "FTP Admin Login Attempt!"
}</code>
        </pre>
    </div>
</div>

<br></div>
</details>
<p></p>

<p>Let's run the Zeek with the signature and investigate the signatures.log and notice.log.<br><br></p>

<div class="terminal-container">
    <div class="terminal-content defender">
        <div class="terminal-top"><span>
            FTP Signature</span></div>
        <pre class="terminal-code language-markdown" tabindex="0">           <code class=" language-markdown"><span>ubuntu@ubuntu$ zeek -C -r ftp.pcap -s ftp-admin.sig
ubuntu@ubuntu$ cat signatures.log | zeek-cut src_addr dst_addr event_msg sub_msg | sort -r| uniq
10.234.125.254	10.121.70.151	10.234.125.254: FTP Admin Login Attempt!	USER administrator
10.234.125.254	10.121.70.151	10.234.125.254: FTP Admin Login Attempt!	USER admin </span></code>
        </pre>
    </div>
</div>
<p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Our rule shows us that there are multiple logging attempts with account names containing the "admin" phrase. The output gives us great information to notice if there is a brute-force attempt for an admin account.</span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><br></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">This signature can be considered a case signature. While it is accurate and works fine, we need global signatures to detect the "known threats/anomalies". We will need those case-based signatures for significant and sophistical anomalies like zero-days and insider attacks in the real-life environment. Having individual rules for each case will create dozens of logs and alerts and cause missing the real anomaly. The critical point is logging logically, not logging everything.</span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><br></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span>We can improve our signature by not limiting the focus only to an admin account. In that case, we need to know how the <a class="bZ6gcu5E glossary-term" onclick="initPopOver(&#39;FTP&#39;, &#39;bZ6gcu5E&#39;)">FTP</a> protocol works and the default response codes. If you don't know these details, please refer to&nbsp;</span></span><a target="_blank" href="https://datatracker.ietf.org/doc/html/rfc765" class="editor-rtfLink">RFC documentation</a><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">.&nbsp;</span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"><br></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"><b><span>Let's optimise our rule and make it detect all possible <a class="nMDGwttu glossary-term" onclick="initPopOver(&#39;FTP&#39;, &#39;nMDGwttu&#39;)">FTP</a> brute-force attempts.</span><br><br></b></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"></p><p style="text-align:justify;background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.8">This signature will create logs for each event containing "FTP 530 response", which allows us to track the login failure events regardless of username.&nbsp;</p>


<p></p>
<details open="">
  <summary><b>View Signature</b></summary>
<div style="text-align:center">

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Sample Signature</div>
        <pre class="terminal-code language-markdown" tabindex="0">           <code class=" language-markdown">signature ftp-brute {
     ip-proto == tcp
     payload /.<span class="token italic"><span class="token punctuation">*</span><span class="token content">530.</span><span class="token punctuation">*</span></span>Login.<span class="token italic"><span class="token punctuation">*</span><span class="token content">incorrect.</span><span class="token punctuation">*</span></span>/
     event "FTP Brute-force Attempt"
}</code>
        </pre>
    </div>
</div>

<br></div>
</details>
<p></p>

<p style="text-align:justify;background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5">Zeek signature files can consist of multiple signatures. Therefore we can have one file for each protocol/situation/threat type. Let's demonstrate this feature in our global rule.</p>


<p></p>
<details open="">
  <summary><b>View Signature</b></summary>
<div style="text-align:center">

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Sample Signature</div>
        <pre class="terminal-code language-markdown" tabindex="0">           <code class=" language-markdown">signature ftp-username {
    ip-proto == tcp
    ftp /.<span class="token italic"><span class="token punctuation">*</span><span class="token content">USER.</span><span class="token punctuation">*</span></span>/
    event "FTP Username Input Found!"
}

signature ftp-brute {
    ip-proto == tcp
     payload /.<span class="token italic"><span class="token punctuation">*</span><span class="token content">530.</span><span class="token punctuation">*</span></span>Login.<span class="token italic"><span class="token punctuation">*</span><span class="token content">incorrect.</span><span class="token punctuation">*</span></span>/
    event "FTP Brute-force Attempt!"
}</code>
        </pre>
    </div>
</div>

<br></div>
</details>
<p></p>


<p style="text-align:justify;background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.8">Let's merge both of the signatures in a single file. We will have two different signatures, and they will generate alerts according to match status. The result will show us how we benefit from this action. Again, we will need the "CLI Kung-Fu" skills to extract the event of interest.</p><p style="text-align:justify;background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.8"><br></p><p style="text-align:justify;background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.8">This rule should show us two types of alerts and help us to correlate the events by having "FTP Username Input" and "FTP Brute-force Attempt" event messages. Let's investigate the logs. We're grepping the logs in range 1001-1004 to demonstrate that the first rule matches two different accounts (admin and administrator).&nbsp;</p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"><br></p>

<div class="terminal-container">
    <div class="terminal-content defender">
        <div class="terminal-top"><span>
            FTP Signature</span></div>
        <pre class="terminal-code language-markdown" tabindex="0">           <code class=" language-markdown"><span>ubuntu@ubuntu$ zeek -C -r ftp.pcap -s ftp-admin.sig
ubuntu@ubuntu$ cat notice.log | zeek-cut uid id.orig_h id.resp_h msg sub | sort -r| nl | uniq | sed -n '1001,1004p'
  1001	CeMYiaHA6AkfhSnd	10.234.125.254	10.121.70.151	10.234.125.254: FTP Username Input Found!	USER admin
  1002	CeMYiaHA6AkfhSnd	10.234.125.254	10.121.70.151	10.121.70.151: FTP Brute-force Attempt!	530 Login incorrect.
  1003	CeDTDZ2erDNF5w7dyf	10.234.125.254	10.121.70.151	10.234.125.254: FTP Username Input Found!	USER administrator
  1004	CeDTDZ2erDNF5w7dyf	10.234.125.254	10.121.70.151	10.121.70.151: FTP Brute-force Attempt!	530 Login incorrect.</span></code>
        </pre>
    </div>
</div>

<p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"><br></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"><b><span style="font-size:24px">Snort Rules in Zeek?</span></b><br></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"><br></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;line-height:1.5"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">While Zeek was known as Bro, it supported Snort rules with a script called snort2bro, which converted Snort rules to Bro signatures. However, after the rebranding, workflows between the two platforms have changed.&nbsp;</span><a target="_blank" href="https://docs.zeek.org/en/master/frameworks/signatures.html" class="editor-rtfLink">The official Zeek document</a><span style="background:transparent;font-size:1rem;margin-top:0pt;margin-bottom:0pt">&nbsp;mentions that&nbsp;</span><span style="background-color:transparent;font-size:1rem">the script is no longer supported and is not a part of the Zeek distribution.</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Each exercise has a folder. Ensure you are in the right directory to find the pcap file and accompanying files.&nbsp;</span><strong>Desktop/Exercise-Files/TASK-5</strong><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="font-size:1rem">Investigate the <b>http.pcap</b><span> file. Create the&nbsp; <a class="uOMbX87i glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;uOMbX87i&#39;)">HTTP</a> signature shown in the task and investigate the pcap.&nbsp;</span></span><span style="font-size:1rem">What is the source IP of the first event?</span><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **.**.**.***" value="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What is the source port of the second event?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *****" value="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Investigate the <b>conn.log. <br></b>What is the total number of the sent and received packets from source port 38706?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **" value="">
                            <input type="hidden" value="4">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="font-size:1rem">Create the global rule shown in the task and investigate the </span><b style="font-size:1rem">ftp.pcap </b><span style="font-size:1rem">file</span><span style="font-size:1rem">.</span><br></p><p>Investigate the<b> notice.log.&nbsp;</b>What is the number of unique events?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****" value="">
                            <input type="hidden" value="5">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>What is the number of <b>ftp-brute&nbsp;</b>signature matches?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****" value="">
                            <input type="hidden" value="6">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-6">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse6">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 6                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Zeek Scripts | Fundamentals
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse6" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="text-align:center"><img src="./TryHackMe _ Zeek_files/7adbffdc48f19bfe997772acc318cec3.png" alt="Zeek scripts task image."><img><span style="font-weight:bolder"><span style="font-size:24px"><br></span></span></p><p><span style="font-weight:bolder;font-size:1rem"><span style="font-size:24px">Zeek Scripts</span></span><br></p><p style="margin-top:0pt;margin-bottom:0pt;background:transparent;text-align:justify;color:rgb(14, 16, 26);line-height:1.5"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Zeek has its own event-driven scripting language, which is as powerful as high-level languages and allows us to investigate and correlate the detected events. Since it is as capable as high-level programming languages, you will need to spend time on Zeek scripting language in order to become proficient. In this room, we will cover the basics of Zeek scripting to help you understand, modify and create basic scripts. Note that scripts can be used to apply a policy and in this case, they are called policy scripts.</span></p><p style="margin-top:0pt;margin-bottom:0pt;background:transparent;text-align:justify;color:rgb(14, 16, 26);line-height:1.5"><br></p><table class="table table-bordered"><tbody><tr><td style="text-align:left">Zeek has base scripts installed by default,&nbsp;<span style="font-size:1rem">and these are not intended to be modified.</span><br></td><td style="text-align:left"><span style="color:rgb(14, 16, 26)">These scripts are located in<br>&nbsp;</span><span style="font-weight:bolder;color:rgb(14, 16, 26)">"/opt/zeek/share/zeek/base"</span><span style="color:rgb(14, 16, 26)">.</span><br></td></tr><tr><td style="text-align:left"><p style="text-align:left;margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26);line-height:1.5"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">User-generated or modified scripts should be located in a specific path.&nbsp;</span></p></td><td style="text-align:left">These scripts are located in<br><b>"/opt/zeek/share/zeek/site"<span style="color:rgb(14, 16, 26)">.</span></b><br></td></tr><tr><td style="text-align:left"><p style="text-align:left;margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26);line-height:1.5"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Policy scripts are located in a specific path.&nbsp;</span></p></td><td style="text-align:left"><span style="color:rgb(14, 16, 26)">These scripts are located in<br>&nbsp;</span><b>"/opt/zeek/share/zeek/policy"</b><span style="font-weight:bolder"><span style="color:rgb(14, 16, 26)">.</span></span><br></td></tr><tr><td style="text-align:left"><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Like Snort, to automatically load/use a script in live sniffing mode, you must identify the script in the Zeek configuration file. You can also use a script for a single run, just like the signatures.&nbsp;</span></p></td><td style="text-align:left"><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">The configuration file is located in<br>&nbsp;</span><span style="color:rgb(14, 16, 26);font-weight:bolder">"/opt/zeek/share/zeek/site/local.zeek"</span><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">.</span><br></td></tr></tbody></table><ul><li><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Zeek scripts use the&nbsp;</span><span style="color:rgb(14, 16, 26)">".zeek"</span><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">&nbsp;extension.</span><br></li><li>Do not modify anything under the "zeek/base" directory. User-generated and modified scripts should be in the "zeek/site" directory.</li><li>You can call scripts in live monitoring mode by loading them with the command&nbsp;<code style="font-size:14px">load @/script/path</code>&nbsp;or&nbsp;<code style="font-size:14px">load @script-name</code>&nbsp;in&nbsp;local.zeek&nbsp;file.&nbsp;<br></li><li><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">Zeek is event-oriented, not packet-oriented! We need to use/write scripts to handle the event of interest.</span></li></ul>

<div class="terminal-container">
    <div class="terminal-content defender">
        <div class="terminal-top">
            running Zeek with signature</div>
        <pre class="terminal-code language-markdown" tabindex="0">           <code class=" language-markdown">ubuntu@ubuntu$ zeek -C -r sample.pcap -s sample.sig</code>
        </pre></div></div>

<p><b style="font-size:24px"><br>GUI vs Scripts</b><br></p><p style="text-align:justify">Have you ever thought about automating tasks in Wireshark, tshark or tcpdump? Zeek provides that chance to us with its scripting power.&nbsp;<span style="text-align:justify;font-size:1rem"><span>Let's say we need to extract all available <a class="uuGoLNG1 glossary-term" onclick="initPopOver(&#39;DHCP&#39;, &#39;uuGoLNG1&#39;)">DHCP</a> hostnames from a pcap file. In that case, we have several options like using tcpdump, Wireshark, tshark or Zeek.&nbsp;</span></span></p><p style="text-align:justify"><img src="./TryHackMe _ Zeek_files/13664d8ab7d9a836c6c4a1c01c7a38f2.png" style="float:right;width:25%" class="note-float-right" alt="Zeek room - Wireshark hostname">Let's see Wireshark on the stage first. You can have the same information with Wireshark. However, while this information can be extracted using Wireshark is not easy to transfer the data to another tool for processing. Tcpdump and tshark are command-line tools, and it is easy to extract and transfer the data to another tool for processing and correlating.<br><br></p>

<div class="terminal-container">
    <div class="terminal-content defender">
        <div class="terminal-top">
            extracting hostnames with tcpdump and tshark</div>
        <pre class="terminal-code language-markdown" tabindex="0">           <code class=" language-markdown">ubuntu@ubuntu$ sudo tcpdump -ntr smallFlows.pcap port 67 or port 68 -e -vv | grep 'Hostname Option' | awk -F: '{print $2}' | sort -nr | uniq | nl
     1	 "vinlap01"
     2	 "student01-PC"
ubuntu@ubuntu$ tshark -V -r smallFlows.pcap -Y "udp.port==67 or udp.port==68" -T fields -e dhcp.option.hostname | nl | awk NF
     1	student01-PC
     2	vinlap01</code>
        </pre></div></div>
<p></p><p style="text-align:justify"></p><p></p><p style="text-align:justify"></p><p style="text-align:justify">Now let's see Zeek scripts in action. First, let's look at the components of the Zeek script. Here the first, second and fourth lines are the predefined syntaxes of the scripting language.&nbsp;<span style="font-size:1rem"><span>The only part we created is the third line which tells Zeek to extract <a class="wiq0TdOM glossary-term" onclick="initPopOver(&#39;DHCP&#39;, &#39;wiq0TdOM&#39;)">DHCP</a> hostnames. Now compare this automation ease with the rest of the methods. Obviously, this four-line script is easier to create and use. While tcpdump and tshark can provide similar results, transferring uncontrolled data through multiple pipelines is not much preferred.</span></span></p>

<p></p>
<details open="">
  <summary><b>View Script</b></summary>
<div style="text-align:center">

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Sample Script</div>
        <pre class="terminal-code language-markdown" tabindex="0">           <code class=" language-markdown">event dhcp_message (c: connection, is_orig: bool, msg: DHCP::Msg, options: DHCP::Options)
{
print options$host_name;
}</code>
        </pre>
    </div>
</div>

<br></div>
</details>
<p></p>

<p>Now let's use the Zeek script and see the output.</p>

<div class="terminal-container">
    <div class="terminal-content defender">
        <div class="terminal-top">
            extracting hostnames with tcpdump and tshark</div>
        <pre class="terminal-code language-markdown" tabindex="0">           <code class=" language-markdown">ubuntu@ubuntu$ zeek -C -r smallFlows.pcap dhcp-hostname.zeek 
student01-PC
vinlap01</code>
        </pre></div></div>

<p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">The provided outputs show that our script works fine and can extract the requested information. This should show why Zeek is helpful in data extraction and correlation. Note that Zeek scripting is a programming language itself, and we are not covering the fundamentals of Zeek scripting. In this room, we will cover the logic of Zeek scripting and how to use Zeek scripts. You can learn and practice the Zeek scripting language by using&nbsp;</span><a target="_blank" href="https://try.bro.org/#/?example=hello" class="editor-rtfLink">Zeek's official training platform</a><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">&nbsp;for free.</span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><br></span></p><p style="text-align:justify;color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">There are multiple options to trigger conditions in Zeek. Zeek can use "Built-In Function" (Bif) and protocols to extract information from traffic data. You can find supported protocols and Bif either by looking in your setup or visiting the&nbsp;</span><a target="_blank" href="https://docs.zeek.org/en/master/script-reference/scripts.html" class="editor-rtfLink">Zeek repo</a><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">.</span></p><table class="table table-bordered"><tbody><tr><td><b><span style="font-size:18px">Customized script locations</span></b></td></tr><tr><td><div style="text-align:left"><span style="font-size:1rem">/opt/zeek/share/zeek/base/bif</span></div><div style="text-align:left"><span style="font-size:1rem">/opt/zeek/share/zeek/base/bif/plugins</span></div><div style="text-align:left"><span style="font-size:1rem">/opt/zeek/share/zeek/base/protocols</span></div></td></tr></tbody></table></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Each exercise has a folder. Ensure you are in the right directory to find the pcap file and accompanying files.&nbsp;</span><strong>Desktop/Exercise-Files/TASK-6</strong><br>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="font-size:1rem">Investigate the <b>smallFlows.pcap</b> file. Investigate the </span><b style="font-size:1rem">dhcp.log</b><span style="font-size:1rem"> file. What is the domain value of the <b>"vinlap01"</b> host?</span><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***************" value="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="font-size:1rem">Investigate the</span><span style="font-size:1rem">&nbsp;<b>big</b></span><span style="font-size:1rem;font-weight:bolder">Flows.pcap</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">file.&nbsp;</span><span style="font-size:1rem">Investigate the </span><b style="font-size:1rem">dhcp.log</b><span style="font-size:1rem"> file. What is the number of identified unique hostnames?</span><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **" value="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Investigate the&nbsp;<span style="font-weight:bolder">dhcp.log</span>&nbsp;file. What is the identified domain value?<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ******.***" value="">
                            <input type="hidden" value="4">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Investigate the&nbsp;<span style="font-weight:bolder">dns.log</span>&nbsp;file. What is the number of unique queries?<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****" value="">
                            <input type="hidden" value="5">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-7">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse7">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 7                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Zeek Scripts | Scripts and Signatures
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse7" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="text-align:center"><img src="./TryHackMe _ Zeek_files/221d95b8e97b873350c6080b17733009.png" alt="Zeek user cli task image."><span style="font-size:24px;font-weight:bolder"><br></span></p><p style="text-align:justify"><span style="font-size:24px;font-weight:bolder">Scripts 101 | Write Basic Scripts</span><br></p><p style="text-align:justify"><span style="background:transparent;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">Scripts contain operators, types, attributes, declarations and statements, and directives. Let's look at a simple example event called&nbsp;</span><span style="background:transparent;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">"zeek_init"</span><span style="background:transparent;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">&nbsp;and&nbsp;</span><span style="background:transparent;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">"zeek_done"</span><span style="background:transparent;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">. These events work once the Zeek process starts and stops. Note that these events don't have parameters, and some events will require parameters.</span><br></p>

<p></p>
<details open="">
  <summary><b>View Script</b></summary>
<div style="text-align:center">

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Sample Script</div>
        <pre class="terminal-code language-markdown" tabindex="0">           <code class=" language-markdown">event zeek_init()
    {
     print ("Started Zeek!");
    }
event zeek_done()
    {
    print ("Stopped Zeek!");
    }

<span class="token title important"><span class="token punctuation">#</span> zeek_init: Do actions once Zeek starts its process.</span>
<span class="token title important"><span class="token punctuation">#</span> zeek_done: Do activities once Zeek finishes its process.</span>
<span class="token title important"><span class="token punctuation">#</span> print: Prompt a message on the terminal.</span></code>
        </pre>
    </div>
</div>

<br></div>
</details>
<p></p>


<p>Run Zeek with the script</p>
<div class="terminal-container"><div class="terminal-content defender"><div class="terminal-top">Run Zeek with a script</div><pre class="terminal-code language-markdown" style="font-size:14px" tabindex="0">           <code class=" language-markdown">ubuntu@ubuntu$ zeek -C -r sample.pcap 101.zeek 
Started Zeek!
Stopped Zeek!</code>
        </pre></div></div>




<p><span style="font-size:1rem">The above output shows how the script works and provides messages on the terminal. Zeek will create logs in the working directory separately from the scripts tasks.</span></p><p><span style="text-align:justify">Let's print the packet data to the terminal and see the raw data. In this script, we are requesting details of a connection and extracting them without any filtering or sorting of the data. To accomplish this, we are using the "new_connection" event. This event is automatically generated for each new connection.&nbsp;</span><span style="font-size:1rem;text-align:justify">This script provides bulk information on the terminal. We need to get familiar with Zeek's data structure to reduce the amount of information and focus on the event of interest. To do so, we need to investigate the bulk data.</span><span style="font-size:1rem"><br></span></p>


<p></p>
<details open="">
  <summary><b>View Script</b></summary>
<div style="text-align:center">

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Sample Script</div>
        <pre class="terminal-code language-markdown" tabindex="0">           <code class=" language-markdown">event new_connection(c: connection)
{
	print c;
}</code>
        </pre>
    </div>
</div>

<br></div>
</details>
<p></p>


<div style="text-align:justify"><span style="text-align:left">Run Zeek with the script</span></div><div style="text-align:justify"><br></div>


<div class="terminal-container"><div class="terminal-content defender"><div class="terminal-top">Run Zeek with a script</div><pre class="terminal-code language-markdown" style="font-size:14px" tabindex="0">           <code class=" language-markdown">ubuntu@ubuntu$ zeek -C -r sample.pcap 102.zeek 
[id=[orig_h=192.168.121.40, orig_p=123/udp, resp_h=212.227.54.68, resp_p=123/udp], orig=[size=48, state=1, num_pkts=0, num_bytes_ip=0, flow_label=0, l2_addr=00:16:47:df:e7:c1], resp=[size=0, state=0, num_pkts=0, num_bytes_ip=0, flow_label=0, l2_addr=00:00:0c:9f:f0:79], start_time=1488571365.706238, duration=0 secs, service={}, history=D, uid=CajwDY2vSUtLkztAc, tunnel=, vlan=121, inner_vlan=, dpd=, dpd_state=, removal_hooks=, conn=, extract_orig=F, extract_resp=F, thresholds=, dce_rpc=, dce_rpc_state=, dce_rpc_backing=, dhcp=, dnp3=, dns=, dns_state=, ftp=, ftp_data_reuse=F, ssl=, http=, http_state=, irc=, krb=, modbus=, mysql=, ntlm=, ntp=, radius=, rdp=, rfb=, sip=, sip_state=, snmp=, smb_state=, smtp=, smtp_state=, socks=, ssh=, syslog=]</code>
        </pre></div></div>

<p></p><p style="text-align:justify">The above terminal provides bulk data for each connection. This style is not the best usage, and in real life, we will need to filter the information for specific purposes. If you look closely at the output, you can see an ID and field value for each part.</p><p style="text-align:justify">To filter the event of interest, we will use the primary tag (in this case, it is c --comes from "c: connection"--), id value (id=), and field name. You should notice that the fields are the same as the fields in the log files.</p>


<p></p>
<details open="">
  <summary><b>View Script</b></summary>
<div style="text-align:center">

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Sample Script</div>
        <pre class="terminal-code language-markdown" tabindex="0">           <code class=" language-markdown">event new_connection(c: connection)
{
	print ("###########################################################");
	print ("");
	print ("New Connection Found!");
	print ("");
	print fmt ("Source Host: %s # %s ---&gt;", c$id$orig_h, c$id$orig_p);
	print fmt ("Destination Host: resp: %s # %s &lt;---", c$id$resp_h, c$id$resp_p);
	print ("");
}

<span class="token title important"><span class="token punctuation">#</span> %s: Identifies string output for the source.</span>
<span class="token title important"><span class="token punctuation">#</span> c$id: Source reference field for the identifier.</span>

</code>
        </pre>
    </div>
</div>

<br></div>
</details>
<p></p>


<p style="text-align:justify">Now you have a general idea of running a script and following the provided output on the console. Let's look closer to another script that extracts specific information from packets. The script above creates logs and prompts each source and destination address for each connection.&nbsp;</p><p><span style="font-size:1rem">Let's see this script in action.</span><br></p>

<div class="terminal-container"><div class="terminal-content defender"><div class="terminal-top">Run Zeek with a script</div><pre class="terminal-code language-markdown" style="font-size:14px" tabindex="0">           <code class=" language-markdown">ubuntu@ubuntu$ zeek -C -r sample.pcap 103.zeek 
<span class="token title important"><span class="token punctuation">###########################################################</span></span>
New Connection Found! Source Host: 192.168.121.2 # 58304/udp ---&gt; 
Destination Host: resp: 192.168.120.22 # 53/udp &lt;--- 
<span class="token title important"><span class="token punctuation">###########################################################</span></span></code>
        </pre></div></div>

<p style="text-align:justify">The above output shows that we successfully extract specific information from the events. Remember that this script extracts the event of interest (in this example, a new connection), and we still have logs in the working directory. We can always modify and optimise the scripts at any time.</p><p><span style="font-weight:bolder;text-align:justify"><span style="font-size:24px">Scripts 201 | Use Scripts and Signatures Together</span></span><br></p><p style="text-align:justify">Up to here, we covered the basics of Zeek scripts.&nbsp;<span style="font-size:1rem">Now it is time to use scripts collaboratively with other scripts and signatures to get one step closer to event correlation. Zeek scripts can refer to signatures and other Zeek scripts as well. This flexibility provides a massive advantage in event correlation.</span></p><p>Let's demonstrate this concept with an example. We will create a script that detects if our previously created "<span style="font-weight:bolder">ftp-admin</span>" rule has a hit.&nbsp;</p>


<p></p>
<details open="">
  <summary><b>View Script</b></summary>
<div style="text-align:center">

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Sample Script</div>
        <pre class="terminal-code language-markdown" tabindex="0">           <code class=" language-markdown">event signature_match (state: signature_state, msg: string, data: string)
{
if (state$sig_id == "ftp-admin")
    {
    print ("Signature hit! --&gt; #FTP-Admin ");
    }
}</code>
        </pre>
    </div>
</div>

<br></div>
</details>
<p></p>


<p><span style="font-size:1rem;text-align:justify">This basic script quickly checks if there is a signature hit and provides terminal output to notify us. We are using the "</span><span style="font-size:1rem;text-align:justify">signature_match</span><span style="font-size:1rem;text-align:justify">" event to accomplish this. You can read more about events&nbsp;</span><a href="https://docs.zeek.org/en/master/scripts/base/bif/event.bif.zeek.html?highlight=signature_match" target="_blank">here</a><span style="font-size:1rem;text-align:justify">. Note that we are looking only for "</span><span style="font-size:1rem;text-align:justify">ftp-admin</span><span style="font-size:1rem;text-align:justify">" signature hits. The signature is shown below.&nbsp;</span></p>


<p></p>
<details open="">
  <summary><b>View Script</b></summary>
<div style="text-align:center">

<div class="terminal-container">
    <div class="terminal-content">
        <div class="terminal-top">
            Sample Script</div>
        <pre class="terminal-code language-markdown" tabindex="0">           <code class=" language-markdown">signature ftp-admin {
    ip-proto == tcp
    ftp /.<span class="token italic"><span class="token punctuation">*</span><span class="token content">USER.</span><span class="token punctuation">*</span></span>admin.*/
    event "FTP Username Input Found!"
}</code>
        </pre>
    </div>
</div>

<br></div>
</details>
<p></p>


<p style="text-align:justify"><span style="font-size:1rem"><b>&nbsp;Let's see this script in action.</b></span></p>

<div class="terminal-container"><div class="terminal-content defender"><div class="terminal-top">Run Zeek with signature and script</div><pre class="terminal-code language-markdown" style="font-size:14px" tabindex="0">           <code class=" language-markdown">ubuntu@ubuntu$ zeek -C -r ftp.pcap -s ftp-admin.sig 201.zeek 
Signature hit! --&gt; #FTP-Admin Signature hit! --&gt; #FTP-Admin
Signature hit! --&gt; #FTP-Admin Signature hit! --&gt; #FTP-Admin</code>

        </pre></div></div>
<p style="text-align:justify">The above output shows that we successfully combined the signature and script. Zeek processed the signature and logs then the script controlled the outputs and provided a terminal output for each rule hit.</p>

<p style="text-align:justify"><span style="font-size:24px;font-weight:bolder">Scripts 202 | Load Local Scripts</span><br></p><p style="text-align:justify"><b><span style="font-size:18px">Load all local scripts</span></b></p><p style="text-align:justify">We mentioned that Zeek has base scripts located in <span style="font-size:1rem;text-align:left;color:rgb(14, 16, 26)">"/opt/zeek/share/zeek/base</span><span style="font-size:1rem">". You can load all local scripts identified in your "local.zeek" file. Note that base scripts cover multiple framework functionalities. You can load all base scripts by easily running the </span><code>local</code><span style="font-size:1rem">&nbsp;command.</span></p>

<div class="terminal-container"><div class="terminal-content defender"><div class="terminal-top">Load local scripts</div><pre class="terminal-code language-markdown" style="font-size:14px" tabindex="0">           <code class=" language-markdown">ubuntu@ubuntu$ zeek -C -r ftp.pcap local 
ubuntu@ubuntu$ ls
101.zeek  103.zeek          clear-logs.sh  ftp.pcap            packet_filter.log  stats.log
102.zeek  capture_loss.log  conn.log       loaded_scripts.log  sample.pcap        weird.log </code>
        </pre></div></div>

<p style="text-align:justify">The above output demonstrates how to run all base scripts using the "local" command. Look at the above terminal output; Zeek provided additional log files this time. Loaded scripts generated loaded_scripts.log, capture_loss.log, notice.log, stats.log files. Note that, in our instance, 465 scripts loaded and used by using the "local" command. However, Zeek doesn't provide log files for the scripts doesn't have hits or results.</p><p style="text-align:justify"><b><span style="font-size:18px">Load Specific Scripts</span></b></p><p style="text-align:justify"><span>Another way to load scripts is by identifying the script path. In that case, you have the opportunity of loading a specific script or framework. Let's go back to <a class="x3Lzg1EQ glossary-term" onclick="initPopOver(&#39;FTP&#39;, &#39;x3Lzg1EQ&#39;)">FTP</a> brute-forcing case. We created a script that detects multiple admin login failures in previous steps. Zeek has an FTP brute-force detection script as well. Now let's use the default script and identify the differences.&nbsp;</span><br></p>

<div class="terminal-container"><div class="terminal-content defender"><div class="terminal-top">Load local scripts</div><pre class="terminal-code language-markdown" style="font-size:14px" tabindex="0">           <code class=" language-markdown"><span>ubuntu@ubuntu$ zeek -C -r ftp.pcap /opt/zeek/share/zeek/policy/protocols/ftp/detect-bruteforcing.zeek 

ubuntu@ubuntu$ cat notice.log | zeek-cut ts note msg 
1024380732.223481	FTP::Bruteforcing	10.234.125.254 had 20 failed logins on 1 FTP server in 0m1s
</span></code>
        </pre></div></div>

<p style="text-align:justify"><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">The above output shows how to load a specific script. This script provides much more information than the one we created. It provides one single line output and a connection summary for the suspicious incident. You can find and read more on the prebuilt scripts and frameworks by visiting Zeek's online book&nbsp;</span><a target="_blank" href="https://docs.zeek.org/en/master/frameworks/index.html" class="editor-rtfLink">here</a><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">.</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Each exercise has a folder. Ensure you are in the right directory to find the pcap file and accompanying files.&nbsp;</span><strong>Desktop/Exercise-Files/TASK-7</strong><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="7">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="font-size:1rem">Go to folder <b>TASK-7/101</b>.<br>Investigate the</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem;font-weight:bolder">sample.pcap</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">file with <b>103.zeek script</b>.</span><span style="font-size:1rem">&nbsp;I</span><span style="font-size:1rem">nvestigate the </span><b style="font-size:1rem">terminal output</b><span style="font-size:1rem">. What is the number of the detected new connections?</span><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **" value="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="7">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Go to folder&nbsp;<span style="font-weight:bolder">TASK-7/201</span>.<span style="font-size:1rem"><br>Investigate the</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem;font-weight:bolder">ftp.pcap</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">file with <b>ftp-admin.sig</b>&nbsp;signature and&nbsp;&nbsp;<b>201.zeek </b>script.&nbsp;</span><span style="font-size:1rem">Investigate the&nbsp;</span><span style="font-size:1rem;font-weight:bolder">signatures.log</span><span style="font-size:1rem">&nbsp;file.</span><span style="font-size:1rem">&nbsp;What </span><b style="font-size:1rem">i</b><span style="font-size:1rem">s the number of signature hits?</span><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ****" value="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="7">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Investigate the&nbsp;<span style="font-size:1rem;font-weight:bolder">signatures.log</span><span style="font-size:1rem">&nbsp;file.</span>&nbsp;What is the total number of "administrator" username detections?<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***" value="">
                            <input type="hidden" value="4">
                            <input type="hidden" value="7">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Investigate the <b>ftp.pcap</b> file with <b>all local scripts</b>, and investigate the&nbsp;<span style="font-size:1rem;font-weight:bolder">loaded_scripts.log</span><span style="font-size:1rem">&nbsp;file.</span>&nbsp;What is the total number of loaded scripts?<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***" value="">
                            <input type="hidden" value="5">
                            <input type="hidden" value="7">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="font-size:1rem">Go to folder</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem;font-weight:bolder">TASK-7/202</span><span style="font-size:1rem">.<br></span><span style="font-size:1rem">Investigate the</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem;font-weight:bolder">ftp-brute.pcap</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">file with&nbsp;<b>"</b></span><b><span style="font-size:1rem">/opt/zeek/share/zeek/policy/protocols/ftp/detect-bruteforcing.zeek</span><span style="font-size:1rem">"</span></b><span style="font-size:1rem"><b>&nbsp;</b>script.&nbsp;</span><span style="font-size:1rem">Investigate the&nbsp;</span><span style="font-size:1rem;font-weight:bolder">notice.log</span><span style="font-size:1rem">&nbsp;file.</span><span style="font-size:1rem">&nbsp;What </span><span style="font-size:1rem">is the total number of brute-force detections?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *" value="">
                            <input type="hidden" value="6">
                            <input type="hidden" value="7">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-8">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse8">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 8                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Zeek Scripts | Frameworks
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse8" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p></p><p style="text-align:center"><img src="./TryHackMe _ Zeek_files/b8a09a41f095c4532bf0a33f10356169.png" alt="Zeek frameworks task image."><span style="font-size:24px;font-weight:bolder"><br></span></p><p style="text-align:justify"><span style="font-size:24px;font-weight:bolder">Scripts 203 | Load Frameworks</span><br></p><p style="text-align:justify"><span style="font-size:16px">Zeek has 15+ frameworks that help analysts to discover the different events of interest. In this task, we will cover the common frameworks and functions.&nbsp;</span><span style="font-size:1rem">You can find and read more on the prebuilt scripts and frameworks by visiting Zeek's online book&nbsp;</span><a href="https://docs.zeek.org/en/master/frameworks/index.html" target="_blank">here</a>.</p><p style="text-align:justify"><span style="font-size:18px"><b>File Framework | Hashes</b></span></p><p style="text-align:justify">Not all framework functionalities are intended to be used in CLI mode. The majority of them are used in scripting. You can easily see the usage of frameworks in scripts by calling a specific framework as <code>load @ $PATH/base/frameworks/framework-name</code>. Now, let's use a prebuilt function of the file framework and have MD5, SHA1 and SHA256 hashes of the detected files. We will call the "File Analysis" framework's "hash-all-files" script to accomplish this. Before loading the scripts, let's look at how it works.<br></p>

<div class="terminal-container"><div class="terminal-content defender"><div class="terminal-top">View file framework</div><pre class="terminal-code language-markdown" style="font-size:14px" tabindex="0">           <code class=" language-markdown">ubuntu@ubuntu$ cat hash-demo.zeek 
<span class="token title important"><span class="token punctuation">#</span> Enable MD5, SHA1 and SHA256 hashing for all files.</span>
@load /opt/zeek/share/zeek/policy/frameworks/files/hash-all-files.zeek</code>
        </pre></div></div>

<p style="text-align:justify">The above output shows how frameworks are loaded. In earlier tasks, we mentioned that Zeek highly relies on scripts, and the frameworks depend on scripts. Let's have a closer look at the file hash framework and see the script behind it.</p>

<div class="terminal-container"><div class="terminal-content defender"><div class="terminal-top">View file framework</div><pre class="terminal-code language-markdown" style="font-size:14px" tabindex="0">           <code class=" language-markdown">ubuntu@ubuntu$ cat /opt/zeek/share/zeek/policy/frameworks/files/hash-all-files.zeek 
<span class="token title important"><span class="token punctuation">#</span> Enable MD5, SHA1 and SHA256 hashing for all files.</span>

@load base/files/hash
event file_new(f: fa_file)
	{
	Files::add_analyzer(f, Files::ANALYZER_MD5);
	Files::add_analyzer(f, Files::ANALYZER_SHA1);
	Files::add_analyzer(f, Files::ANALYZER_SHA256);
	}</code>
        </pre></div></div>

<p style="text-align:justify">Now let's execute the script and investigate the log file.</p>

<div class="terminal-container"><div class="terminal-content defender"><div class="terminal-top">Grab file hashes</div><pre class="terminal-code language-markdown" style="font-size:14px" tabindex="0">           <code class=" language-markdown">ubuntu@ubuntu$ zeek -C -r case1.pcap hash-demo.zeek
ubuntu@ubuntu$ zeek -C -r case1.pcap /opt/zeek/share/zeek/policy/frameworks/files/hash-all-files.zeek 

ubuntu@ubuntu$ cat files.log | zeek-cut md5 sha1 sha256
cd5a4d3fdd5bffc16bf959ef75cf37bc	33bf88d5b82df3723d5863c7d23445e345828904	6137f8db2192e638e13610f75e73b9247c05f4706f0afd1fdb132d86de6b4012
b5243ec1df7d1d5304189e7db2744128	a66bd2557016377dfb95a87c21180e52b23d2e4e	f808229aa516ba134889f81cd699b8d246d46d796b55e13bee87435889a054fb
cc28e40b46237ab6d5282199ef78c464	0d5c820002cf93384016bd4a2628dcc5101211f4	749e161661290e8a2d190b1a66469744127bc25bf46e5d0c6f2e835f4b92db18</code>
        </pre></div></div>
<p style="text-align:justify"><span style="font-size:1rem">Look at the above terminal outputs. Both of the scripts provided the same result. Here the preference is up to the user. Both of the usage formats are true. Prebuilt frameworks are commonly used in scriptings with the </span><span style="font-size:1rem">"@load"</span><span style="font-size:1rem"> method. Specific scripts are used as practical scripts for particular use cases.</span></p><p style="text-align:justify"><span style="font-weight:bolder;font-size:18px">File Framework | Extract Files</span><span style="font-size:1rem"><br></span></p><p style="text-align:justify">The file framework can extract the files transferred. Let's see this feature in action!</p>

<div class="terminal-container"><div class="terminal-content defender"><div class="terminal-top">Extract files</div><pre class="terminal-code language-markdown" style="font-size:14px" tabindex="0">           <code class=" language-markdown">ubuntu@ubuntu$ zeek -C -r case1.pcap /opt/zeek/share/zeek/policy/frameworks/files/extract-all-files.zeek

ubuntu@ubuntu$ ls
101.zeek  102.zeek  103.zeek  case1.pcap  clear-logs.sh  conn.log  dhcp.log  dns.log  extract_files  files.log  ftp.pcap  http.log  packet_filter.log  pe.log</code>
        </pre></div></div>

<p style="text-align:justify">We successfully extracted files from the pcap. A new folder called "extract_files" is automatically created, and all detected files are located in it. First, we will list the contents of the folder, and then we will use the <code>file</code> command to determine the file type of the extracted files.</p>

<div class="terminal-container"><div class="terminal-content defender"><div class="terminal-top">Investigate files</div><pre class="terminal-code language-markdown" style="font-size:14px" tabindex="0">           <code class=" language-markdown">ubuntu@ubuntu$ ls extract_files | nl
     1	extract-1561667874.743959-HTTP-Fpgan59p6uvNzLFja
     2	extract-1561667889.703239-HTTP-FB5o2Hcauv7vpQ8y3
     3	extract-1561667899.060086-HTTP-FOghls3WpIjKpvXaEl

ubuntu@ubuntu$ cd extract_files

ubuntu@ubuntu$ file *| nl
     1	extract-1561667874.743959-HTTP-Fpgan59p6uvNzLFja:  ASCII text, with no line terminators
     2	extract-1561667889.703239-HTTP-FB5o2Hcauv7vpQ8y3:  Composite Document File V2 Document, Little Endian, Os: Windows, Version 6.3, Code page: 1252, Template: Normal.dotm, Last Saved By: Administrator, Revision Number: 2, Name of Creating Application: Microsoft Office Word, Create Time/Date: Thu Jun 27 18:24:00 2019, Last Saved Time/Date: Thu Jun 27 18:24:00 2019, Number of Pages: 1, Number of Words: 0, Number of Characters: 1, Security: 0
     3	extract-1561667899.060086-HTTP-FOghls3WpIjKpvXaEl: PE32 executable (GUI) Intel 80386, for MS Windows</code>
        </pre></div></div>

<p style="text-align:justify">Zeek extracted three files. The "file" command shows us one .txt file, one .doc/.docx file and one .exe file. Zeek renames extracted files. The name format consists of four values that come from conn.log and files.log files; default "extract" keyword, timestamp value (ts), protocol (source), and connection id (conn_uids). Let's look at the files.log to understand possible anomalies better and verify the findings. Look at the below output; files.log provides the same results with additional details. Let's focus on the .exe and correlate this finding by searching its connection id (conn_uids).</p><p style="text-align:justify">The given terminal output shows us that there are three files extracted from the traffic capture. Let's look at the file.log and correlate the findings with the rest of the log files.&nbsp;</p>

<div class="terminal-container"><div class="terminal-content defender"><div class="terminal-top">Investigate files</div><pre class="terminal-code language-markdown" style="font-size:14px" tabindex="0">           <code class=" language-markdown">ubuntu@ubuntu$ cat files.log | zeek-cut fuid conn_uids tx_hosts rx_hosts mime_type extracted | nl
     1	Fpgan59p6uvNzLFja	CaeNgL1QzYGxxZPwpk	23.63.254.163	10.6.27.102	text/plain	extract-1561667874.743959-HTTP-Fpgan59p6uvNzLFja
     2	FB5o2Hcauv7vpQ8y3	CCwdoX1SU0fF3BGBCe	107.180.50.162	10.6.27.102	application/msword	extract-1561667889.703239-HTTP-FB5o2Hcauv7vpQ8y3
     3	FOghls3WpIjKpvXaEl	CZruIO2cqspVhLuAO9	107.180.50.162	10.6.27.102	application/x-dosexec	extract-1561667899.060086-HTTP-FOghls3WpIjKpvXaEl

ubuntu@ubuntu$ grep -rin CZruIO2cqspVhLuAO9 * | column -t | nl | less -S
<span class="token title important"><span class="token punctuation">#</span><span>NOTE: The full output is not shown here!. Redo the same actions in the attached <a class="oYejcBYb glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;oYejcBYb&#39;)">VM</a>!</span></span><span>
     1	conn.log:43:1561667898.852600   CZruIO2cqspVhLuAO9  10.6.27.102     49162        107.180.50.162      80    tcp  http        
     2	files.log:11:1561667899.060086  FOghls3WpIjKpvXaEl  107.180.50.162  10.6.27.102  CZruIO2cqspVhLuAO9  HTTP  0    EXTRACT,PE  
     3	http.log:11:1561667898.911759   CZruIO2cqspVhLuAO9  10.6.27.102     49162        107.180.50.162      80    1    GET         </span></code>
        </pre></div></div>

<p style="text-align:justify"><span>The "grep" tool helps us investigate the particular value across all available logs. The above terminal output shows us that the connection id linked with .exe appears in conn.log, files.log, and http.log files. Given example demonstrates how to filter some fields and correlate the findings with the rest of the logs. We've listed the source and destination addresses, file and connection id numbers, <a class="spLOcT1J glossary-term" onclick="initPopOver(&#39;MIME&#39;, &#39;spLOcT1J&#39;)">MIME</a> types, and file names. Up to now, provided outputs and findings show us that record number three is a .exe file, and other log files provide additional information.&nbsp;</span><br></p><p style="text-align:justify"><span style="font-weight:bolder;font-size:18px">Notice Framework | Intelligence</span><span style="font-size:1rem"><br></span></p><p style="text-align:justify">The intelligence framework can work with data feeds to process and correlate events and identify anomalies. The intelligence framework requires a feed to match and create alerts from the network traffic. Let's demonstrate a single user-generated threat intel file and let Zeek use it as the primary intelligence source.&nbsp;</p><p style="text-align:justify">Intelligence source location: <code>/opt/zeek/intel/zeek_intel.txt</code></p><p style="text-align:justify">There are two critical points you should never forget. First, the source file has to be tab-delimited. Second, you can manually update the source and adding extra lines doesn't require any re-deployment. However, if you delete a line from the file, you will need to re-deploy the Zeek instance.&nbsp;</p><p style="text-align:justify">Let's add the suspicious URL gathered from the case1.pcap file as a source intel and see this feature in action! Before executing the script, let's look at the intelligence file and the script contents.</p>

<div class="terminal-container"><div class="terminal-content defender"><div class="terminal-top">Investigate intel file and script</div><pre class="terminal-code language-markdown" style="font-size:14px" tabindex="0">           <code class=" language-markdown">ubuntu@ubuntu$ cat /opt/zeek/intel/zeek_intel.txt 
<span class="token title important"><span class="token punctuation">#</span>fields	indicator	indicator_type	meta.source	meta.desc</span>
smart-fax.com	Intel::DOMAIN	zeek-intel-test	Zeek-Intelligence-Framework-Test

ubuntu@ubuntu$ cat intelligence-demo.zeek 
<span class="token title important"><span class="token punctuation">#</span> Load intelligence framework!</span>
@load policy/frameworks/intel/seen
@load policy/frameworks/intel/do_notice
redef Intel::read_files += { "/opt/zeek/intel/zeek_intel.txt" }; </code>
        </pre></div></div>

<p style="text-align:justify">The above output shows the contents of the intel file and script contents. There is one intelligence input, and it is focused on a domain name, so when this domain name appears in the network traffic, Zeek will create the "intel.log" file and provide the available details.</p>

<div class="terminal-container"><div class="terminal-content defender"><div class="terminal-top">Investigate intel file and script</div><pre class="terminal-code language-markdown" style="font-size:14px" tabindex="0">           <code class=" language-markdown">ubuntu@ubuntu$ zeek -C -r case1.pcap intelligence-demo.zeek 

ubuntu@ubuntu$ cat intel.log | zeek-cut uid id.orig_h id.resp_h seen.indicator matched
CZ1jLe2nHENdGQX377	10.6.27.102	10.6.27.1	smart-fax.com	Intel::DOMAIN	
C044Ot1OxBt8qCk7f2	10.6.27.102	107.180.50.162	smart-fax.com	Intel::DOMAIN </code>
        </pre></div></div>

<p style="text-align:justify"><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">The above output shows that Zeek detected the listed domain and created the intel.log file. This is one of the easiest ways of using the intelligence framework. You can read more on the intelligence framework&nbsp;</span><a target="_blank" href="https://docs.zeek.org/en/master/frameworks/intel.html" class="editor-rtfLink">here</a><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">&nbsp;and&nbsp;</span><a target="_blank" href="https://docs.zeek.org/en/current/scripts/base/frameworks/intel/main.zeek.html#type-Intel::Type" class="editor-rtfLink">here</a><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">.</span></p>
</div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Each exercise has a folder. Ensure you are in the right directory to find the pcap file and accompanying files.&nbsp;</span><strong>Desktop/Exercise-Files/TASK-8</strong><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="8">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Investigate the&nbsp;</span><strong>case1</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">.pcap file with&nbsp;</span><strong>intelligence-demo.zeek</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">&nbsp;script. Investigate the <b>intel.log</b> file. Look at the second finding, where was the intel info found?&nbsp;</span><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **************" value="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="8">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-outline-dorange btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="font-size:1rem">Investigate the </span><b style="font-size:1rem">http.log </b><span style="font-size:1rem">file. What is the name of the downloaded .exe file?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***.***" value="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="8">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="font-size:1rem">Investigate the</span><span style="font-size:1rem">&nbsp;<span style="font-weight:bolder">case1</span></span><span style="font-size:1rem;font-weight:bolder">.pcap</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">file with</span><span style="font-size:1rem">&nbsp;</span><b>hash-demo.zeek </b>script.&nbsp;<span style="font-size:1rem">Investigate the&nbsp;</span><span style="font-size:1rem;font-weight:bolder">files.log&nbsp;</span><span style="font-size:1rem">file. What is the MD5 hash of the downloaded .exe file?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ********************************" value="">
                            <input type="hidden" value="4">
                            <input type="hidden" value="8">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="font-size:1rem">Investigate the</span><span style="font-size:1rem">&nbsp;<span style="font-weight:bolder">case1</span></span><span style="font-size:1rem;font-weight:bolder">.pcap</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">file with&nbsp;</span><span style="font-size:1rem"><b>file-extract-demo.zeek</b> script.</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">Investigate the&nbsp;</span><span style="font-size:1rem;font-weight:bolder">"extract_files"&nbsp;</span><span style="font-size:1rem">folder. Review the contents of the text file. What is written in the file?</span><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ********* ****" value="">
                            <input type="hidden" value="5">
                            <input type="hidden" value="8">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-9">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse9">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 9                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Zeek Scripts | Packages
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse9" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="text-align:center"><img src="./TryHackMe _ Zeek_files/7f04a7fc9417676b573a29bbd914f6fa.png" alt="Zeek packages task image."><span style="font-size:24px;font-weight:bolder"><br></span></p><p style="text-align:justify"><span style="font-size:24px;font-weight:bolder">Scripts 204 | Package Manager</span><br></p><p style="text-align:justify"><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Zeek Package Manager helps users install third-party scripts and plugins to extend Zeek functionalities with ease. The package manager is installed with Zeek and available with the </span><code>zkg</code><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"> command. Users can install, load, remove, update and create packages with the "zkg" tool. You can read more on and view available packages&nbsp;</span><a target="_blank" href="https://packages.zeek.org/" class="editor-rtfLink">here</a><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">&nbsp;and&nbsp;</span><a target="_blank" href="https://github.com/zeek/packages" class="editor-rtfLink">here</a><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">. Please note that you need root privileges to use the "zkg" tool.</span><br></p><p style="text-align:justify"><b>Basic usage of zkg;</b></p><table class="table table-bordered"><tbody><tr><td><b>Command</b></td><td><b>Description</b></td></tr><tr><td style="text-align:left"><p><code>zkg install package_path</code></p></td><td style="text-align:left">Install a package. Example (zkg install zeek/j-gras/zeek-af_packet-plugin).</td></tr><tr><td style="text-align:left"><p><code>zkg install git_url</code></p></td><td style="text-align:left">Install package. Example (zkg install https://github.com/corelight/ztest).</td></tr><tr><td style="text-align:left"><p><code>zkg list</code></p></td><td style="text-align:left">List installed package.</td></tr><tr><td style="text-align:left"><p><code>zkg remove</code></p></td><td style="text-align:left">Remove installed package.</td></tr><tr><td style="text-align:left"><p><code>zkg refresh</code></p></td><td style="text-align:left">Check version updates for installed packages.</td></tr><tr><td style="text-align:left"><p><code>zkg upgrade</code></p></td><td style="text-align:left">Update installed packages.</td></tr></tbody></table><p style="text-align:justify">There are multiple ways of using packages. The first approach is using them as frameworks and calling specific package path/directory per usage. The second and most common approach is calling packages from a script with the "@load" method. The third and final approach to using packages is calling their package names; note that this method works only for packages installed with the "zkg" install method.&nbsp;<br></p><p style="text-align:justify"><span style="font-size:18px;font-weight:700">Packages | </span><span style="text-align:left;font-size:18px"><b>Cleartext Submission of Password</b></span><br></p><p style="text-align:justify">Let's install a package first and then demonstrate the usage in different approaches.&nbsp;<br><b>Note: </b><span>The package is installed in the given <a class="wUjVhH07 glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;wUjVhH07&#39;)">VM</a>.</span></p>

<div class="terminal-container"><div class="terminal-content defender"><div class="terminal-top">Install package with zkg</div><pre class="terminal-code language-markdown" style="font-size:14px" tabindex="0">           <code class=" language-markdown"><span>ubuntu@ubuntu$ zkg install zeek/cybera/zeek-sniffpass
The following packages will be INSTALLED:
  zeek/cybera/zeek-sniffpass (master)
Proceed? [Y/n] Y
Installing "zeek/cybera/zeek-sniffpass"
Installed "zeek/cybera/zeek-sniffpass" (master)
Loaded "zeek/cybera/zeek-sniffpass"

ubuntu@ubuntu$ zkg list
zeek/cybera/zeek-sniffpass (installed: master) - Sniffpass will alert on cleartext passwords discovered in HTTP POST requests</span></code>
        </pre></div></div>

<p style="text-align:justify"><span>The above output shows how to install and list the installed packages. Now we successfully installed a package. As the description mentions on the above terminal, this package creates alerts for cleartext passwords found in <a class="xj4EhibM glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;xj4EhibM&#39;)">HTTP</a> traffic. Let's use this package in three different ways!</span></p>


<div class="terminal-container"><div class="terminal-content defender"><div class="terminal-top">Execute/load package</div><pre class="terminal-code language-markdown" style="font-size:14px" tabindex="0">           <code class=" language-markdown"><span class="token title important"><span class="token punctuation">###</span> Calling with script</span>
ubuntu@ubuntu$ zeek -Cr http.pcap sniff-demo.zeek 

<span class="token title important"><span class="token punctuation">###</span> View script contents</span>
ubuntu@ubuntu$ cat sniff-demo.zeek 
@load /opt/zeek/share/zeek/site/zeek-sniffpass

<span class="token title important"><span class="token punctuation">###</span> Calling from path</span>
ubuntu@ubuntu$ zeek -Cr http.pcap /opt/zeek/share/zeek/site/zeek-sniffpass

<span class="token title important"><span class="token punctuation">###</span> Calling with package name</span>
ubuntu@ubuntu$ zeek -Cr http.pcap zeek-sniffpass </code>
        </pre></div></div>

<p style="text-align:justify">The above output demonstrates how to execute/load packages against a pcap. You can use the best one for your case. The "zeek-sniffpass" package provides additional information in the notice.log file. Now let's review the logs and discover the obtained data using the specific package.</p>


<div class="terminal-container"><div class="terminal-content defender"><div class="terminal-top">Investigate log files</div><pre class="terminal-code language-markdown" style="font-size:14px" tabindex="0">           <code class=" language-markdown">ubuntu@ubuntu$ cat notice.log | zeek-cut id.orig_h id.resp_h proto note msg
10.10.57.178	44.228.249.3	tcp	SNIFFPASS::HTTP_POST_Password_Seen	Password found for user BroZeek
10.10.57.178	44.228.249.3	tcp	SNIFFPASS::HTTP_POST_Password_Seen	Password found for user ZeekBro</code>
        </pre></div></div>



<p style="text-align:justify"><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">The above output shows that the package found cleartext password submissions, provided notice, and grabbed the usernames. Remember, in&nbsp;</span><strong>TASK-5</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">&nbsp;we created a signature to do the same action. Now we can do the same activity without using a signature file. This is a simple demonstration of the benefit and flexibility of the Zeek scripts.</span></p><p style="text-align:justify"><span style="font-size:18px;font-weight:700">Packages |&nbsp;</span><span style="text-align:left;font-size:18px"><span style="font-weight:bolder">Geolocation Data</span></span><br></p><p style="text-align:justify">Let's use another helpful package called "geoip-conn". This package provides geolocation information for the IP addresses in the conn.log file. It depends on "GeoLite2-City.mmdb" database created by MaxMind. This package provides location information for only matched IP addresses from the internal database.</p>

<div class="terminal-container"><div class="terminal-content defender"><div class="terminal-top">Execute/load package</div><pre class="terminal-code language-markdown" style="font-size:14px" tabindex="0">           <code class=" language-markdown">ubuntu@ubuntu$ zeek -Cr case1.pcap geoip-conn

ubuntu@ubuntu$ cat conn.log | zeek-cut uid id.orig_h id.resp_h geo.orig.country_code geo.orig.region geo.orig.city geo.orig.latitude geo.orig.longitude geo.resp.country_code geo.resp.region geo.resp.city                                                  
Cbk46G2zXi2i73FOU6	10.6.27.102	23.63.254.163	-	-	-	-	-	US	CA	Los Angeles</code>
        </pre></div></div>

<p style="text-align:justify">Up to now, we've covered what the Zeek packages are and how to use them. There are much more packages and scripts available for Zeek in the wild. You can try ready or third party packages and scripts or learn Zeek scripting language and create new ones.</p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Each exercise has a folder. Ensure you are in the right directory to find the pcap file and accompanying files.&nbsp;</span><strong>Desktop/Exercise-Files/TASK-9</strong><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="9">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <div><span style="font-size:1rem">Investigate the</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem;font-weight:bolder">http.pcap</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">file with the&nbsp;</span><b style="font-size:1rem">zeek-sniffpass</b><span style="font-size:1rem">&nbsp;module.&nbsp;</span><span style="font-size:1rem">Investigate the&nbsp;</span><span style="font-size:1rem;font-weight:bolder">notice.log</span><span style="font-size:1rem">&nbsp;file.</span><span style="font-size:1rem">&nbsp;Which username has more module hits?</span><br></div>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *******" value="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="9">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <div><span style="font-size:1rem">Investigate the</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem;font-weight:bolder">case2.pcap</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">file with <b>geoip-conn&nbsp;</b></span><span style="font-size:1rem">module.&nbsp;</span><span style="font-size:1rem">Investigate the&nbsp;</span><span style="font-size:1rem;font-weight:bolder">conn.log</span><span style="font-size:1rem">&nbsp;file. What is the name of the identified City?</span><br></div>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *******" value="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="9">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="font-size:1rem">Which IP address is associated with the identified City?</span><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **.**.**.**" value="">
                            <input type="hidden" value="4">
                            <input type="hidden" value="9">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="font-size:1rem">Investigate the</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem;font-weight:bolder">case2.pcap</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">file with&nbsp;</span><b style="font-size:1rem">sumstats-counttable.zeek</b><span style="font-size:1rem"><span style="font-weight:bolder">&nbsp;</span></span><span style="font-size:1rem">script.&nbsp;</span><span style="font-size:1rem">How many types of status codes are there in the given traffic capture?</span><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *" value="">
                            <input type="hidden" value="5">
                            <input type="hidden" value="9">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Submit
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-10">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse10">
                        <a class="card-link">
                            <span class="task-dropdown-title red">Task 10                             <span class="task-dropdown-icon"><i class="far fa-circle text-lgray"></i></span></span> Conclusion
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse10" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-incomplete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span style="font-weight:bolder;font-size:1rem">Congratulations!&nbsp;</span><span style="font-size:1rem">You just finished the Zeek room.&nbsp;</span><span style="font-size:1rem">In this room, we covered Zeek, what it is, how it operates, and how to use it to investigate threats.&nbsp;</span></p><p><span style="background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial">Now, we invite you to complete the Zeek Exercise
room:&nbsp;</span><a href="https://tryhackme.com/room/zeekbroexercises" target="_blank"><b>ZeekExercises</b></a><span style="font-weight:bold;background-image:initial;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial"></span><span style="font-size:1rem"><br></span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom red">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Read the task above.
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-outline-success task-answer" onclick="answerQuestion(this)">
                            <i class="far fa-paper-plane"></i> Completed
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div></div>
</div>
<div id="room-simple-details"><div class="card cd-2 text-center mt-3"><div class="card-body"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Zeek_files/af7feb2c43a2c7d5f111b98ccbd15048.png"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme">tryhackme</a> and <img class="avatar-tiny" src="./TryHackMe _ Zeek_files/1a02ec129689db6aef26e1cc16fb6d93.jpg"> 
        <a class="green-link" href="https://tryhackme.com/p/ujohn">ujohn</a></p><p class="mb-0">Only subscribers can deploy virtual machines in this room! 
        Go to your <a href="https://tryhackme.com/profile">profile</a> page to subscribe (if you have not already). 7976 users are in here and this room is 356 days old.</p></div></div></div>

</div>
</div>
</div>
<div id="room-content-attackbox">
<div id="room-attackbox">
<div id="attackbox-machine-instance">
<div id="room-attackbox-loading"></div>
<div id="room-attackbox-vm-view"></div>
</div>
<div id="attackbox-machine-options">
<div class="d-flex">
<a target="_blank" id="room-attackbox-url" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="View in full screen"></a>
<div onclick="extendHourWebBasedVM(null)" class="hover-pointer" id="room-attackbox-extend" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Extend machines timer"><i class="fas fa-plus"></i></div>
<div onclick="terminateWebBasedVM(null)" class="hover-pointer" id="room-attackbox-terminate" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Terminate Machine"><i class="far fa-power-off"></i></div>
<div onclick="exitViewAttackBox()" class="hover-pointer" id="room-attackbox-exitview" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Exit split view"><i class="fas fa-minus"></i></div>
<div onclick="infoAttackBox()" class="hover-pointer faded" id="room-attackbox-info" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Machine Information"><i class="fas fa-info"></i></div>
<div class="d-flex" id="room-attackbox-tabs"></div>
</div>
<div id="room-attackbox-expire-text" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Time left until your AttackBox expires"></div>
</div>
</div>
<div class="modal fade" id="attackBoxInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-light-gray">
<h5 class="modal-title m-auto">Web-Based Machine Information</h5>
</div>
<div class="modal-body">
<p>Use the web-based machine to attack other target machines you start on TryHackMe.</p>
<ul class="normalList text-gray mt-3 mb-4">
<li>Public IP: <code id="browser-machine-pubip" class="dark size-14"></code></li>
<li class="mt-1">Private IP: <code id="browser-machine-privip" class="dark size-14"></code> <span class="size-14">(Use this for your reverse shells)</span></li>
<li class="mt-1">Username: <code id="browser-username" class="dark size-14"></code></li>
<li class="mt-1">Password: <code id="browser-password" class="dark size-14"></code></li>
<li class="mt-1">Protocol: <code id="browser-protocol" class="dark size-14"></code></li>
</ul>
<hr class="hr-min">
<ul class="text-lgray mb-0">
<li class="mt-2">To copy to and from the browser-based machine, highlight the text and press <b>CTRL+SHIFT+C</b> <details><summary>or use the clipboard</summary><img src="./TryHackMe _ Zeek_files/clipboard.gif"></details></li>
<li class="mt-2">When accessing target machines you start on TryHackMe tasks, make sure you're using the correct IP (it <b>should not be</b> the IP of your AttackBox)</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="award-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<button type="button" class="close size-30 text-lgray" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<div id="award-modal-badges"></div>
<p class="mb-0 text-lgray size-18">Complete the room to earn this badge</p>
</div>
</div>
</div>
</div>
<div class="modal fade" id="hint-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title"><i class="fal fa-lightbulb-on"></i> Question Hint</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body"></div>
</div>
</div>
</div>
<div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">...</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center"></div>
<div class="modal-footer"></div>
</div>
</div>
</div>
<link rel="stylesheet" href="./TryHackMe _ Zeek_files/modal.css">
<div class="modal-design-green modal fade" id="roomCompleted" tabindex="-1" role="dialog" data-backdrop="static" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content" id="roomCompletedModalContent">
<div class="modal-body text-center">
<button type="button" class="close" id="closeRoomComplete" aria-label="Close">
<i class="fad fa-times-circle"></i>
</button>
<div class="icon-box">
<i class="fad fa-badge-check"></i>
</div>
<h3 class="text-accent mt-5">Congratulations</h3>
<p class="faded mt-1">You've completed the room! Share this with your friends: </p>
<h2 id="roomCompleted-share"></h2>
<div id="ticket-info"></div> 
<p class="faded mt-1" id="roomFeedbackBtn">
<small>
<button class="bg-white border-0">Leave
feedback</button>
</small>
</p>
<form method="post" action="https://tryhackme.com/feedback" id="roomFeedbackForm" class="d-none mt-3">
<input type="hidden" name="_csrf" value="rFtq8je8-5IfWJOImyn1SeJTnQmqUyv4vcEw">
<input type="hidden" name="roomCode" value="zeekbro">
<input type="hidden" name="type" value="rooms">
<input type="hidden" name="redirect" value="json">
<div class="form-group">
<label class="mb-0" for="like">What do you like about the room?</label>
<textarea type="text" name="like" id="like" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="dislike">What don't you like about the room?</label>
<textarea type="text" name="dislike" id="dislike" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="details">Please send your suggestions, ideas and comments!</label>
<textarea id="details" type="text" name="details" class="form-control" style="padding: 5px;"></textarea>
</div>
<button type="submit" id="submitBtn" class="btn btn-success">Send Feedback</button>
</form>
<p class="mt-2 mb-0" id="formMessage"></p>
</div>
</div>
</div>
<script>
    function dismissRoomCompleteModal() {
      $('#roomCompleted').modal('hide');

      const shouldSeeReferralModal = ""
      if (shouldSeeReferralModal) {
        $('#unlockCreditModal').modal('show');

        referralModalEvent('view');
      }
    }

    document.getElementById('closeRoomComplete').addEventListener('click', dismissRoomCompleteModal)
  </script>
</div>
<script src="./TryHackMe _ Zeek_files/roomFeedback.js"></script>
<div class="modal fade" id="roomStartAttackboxModal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static" data-keyboard="false">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title m-auto">To access this machine, you need to either</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close" style="position: absolute; right: 10px; top: 0; font-size: 30px;">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center">
<div class="row vertical-align-custom mb-0">
<div class="col-sm-5 pr-0">
<p class="size-18 bold">Use a VPN</p>
<p>Connect to our network via a VPN</p>
<a target="_blank" href="https://tryhackme.com/access"><button type="button" class="btn btn-light">See Instructions</button></a>
</div>
<div class="col-sm-2 size-24">
or
</div>
<div class="col-sm-5 pl-0">
<p class="size-18 bold">Use the AttackBox</p>
<p>Use a web-based attack machine <span class="size-12">(recommended)</span></p>
<button type="button" onclick="$(&#39;#roomStartAttackboxModal&#39;).modal(&#39;toggle&#39;); startAttackBox({startingMsg: false, tutorial: true})" class="btn btn-hgreen">Start AttackBox</button>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="expireSoon" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-warning fad fa-exclamation-triangle"></i></h1>
<h3 class="text-warning">Expiring Soon</h3>
<p class="faded mt-3 mb-0">Your machine is going to expire soon. Close this and add an hour to stop it from terminating!</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="terminatedMachine" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-danger fad fa-exclamation-triangle"></i></h1>
<h3 class="text-danger">Expired Machine</h3>
<p class="faded mt-3 mb-0">Your machine has expired and terminated.</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="machineDeployModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue text-center p-3">
<h4 class="mb-0 m-auto">How to access machines</h4>
<button type="button" class="close modal-close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center">
<p class="size-18 faded">Now you've started your machine, to access it you need to either</p>
<div class="row mb-0">
<div class="col-sm-6">
<img src="./TryHackMe _ Zeek_files/connect_openvpn_short.png">
<p class="mt-2 mb-0 faded">Download your VPN configuration file and import it into a OpenVPN client</p>
</div>
<div class="col-sm-6">
<img src="./TryHackMe _ Zeek_files/connect_kali_short.png">
<p class="mt-2 mb-0 faded">Control a web-based machine with everything you need, all from inside your browser</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="roomAlertModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title" id="roomAlertModalTitle"></h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body" id="roomAlertModalBody"></div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="resetUserProgressModal" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">Reset Your Progress</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<div><span class="text-danger"><i class="fas fa-exclamation-triangle"></i> Warning</span> You will keep your points but all your answers in this room will be erased.</div>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-danger" onclick="resetProgress()">Yes, please!</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="cloudEnvInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header  modal-dark-blue">
<h5 class="modal-title">Cloud Information</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<ul class="nav nav-tabs">
<li class="nav-item pr-2">
<a class="nav-link active" data-toggle="tab" href="https://tryhackme.com/room/zeekbro#env-tab">Environment</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/zeekbro#creds-tab">Credentials</a>
</li>
</ul>
<div class="tab-content">
<div class="tab-pane active" id="env-tab"></div>
<div class="tab-pane" id="creds-tab"></div>
</div>
</div>
<div class="modal-footer" id="cloudEnvModalFooter">
</div>
</div>
</div>
</div>
<div class="modal fade" id="setNameModal" role="dialog">
<div class="modal-dialog modal-lg modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title">Generating Your Certificate</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body container">
<div class="row">
<div class="col-6">
<h5 class="bold">Hey there, what's your name?</h5>
<p class="text-secondary">
If you want your name to appear on your certificate, please fill the field below.
</p>
<div class="form-group">
<label>Full Name </label>
<input id="modal-cert-field-name" type="text" placeholder="John Wick" class="mb-4 form-control">
<input id="modal-cert-field-email" type="hidden" value="giftonpaul@karunya.edu.in">
</div>
</div>
<div class="col-6">
<h5 class="bold">You're here incognito? It's ok!</h5>
<p class="text-secondary">If you chose skip, your username will be used instead!</p>
</div>
</div>
<div class="row">
<div class="col-6">
<button type="button" class="btn btn-success float-right" id="modal-cert-generate" onclick="gen_cert(true)" disabled="">
Generate with my full name
</button>
</div>
<div class="col-6">
<button type="button" class="btn btn-primary float-right" id="modal-cert-skip" onclick="gen_cert(false)">
Generate with my username
</button>
</div>
</div>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Zeek_files/certificateName.js"></script>
<div class="modal fade slideout-faq" id="roomSlideoutUnstuck" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-links">
<div id="unstuck-video" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-play"></i></div>
<div class="unstuck-icon-text">Video Solution</div>
</div>
<div id="unstuck-writeups" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-pen-alt"></i></div>
<div class="unstuck-icon-text">Writeups</div>
</div>
<a id="unstuck-forum" target="_blank" class="clear-link unstuck-group" href="https://tryhackme.com/forum/thread/62dff38db79ccb005e73361f">
<div class="unstuck-icon"><i class="fas fa-comments-alt"></i></div>
<div class="unstuck-icon-text">Forum Post</div>
</a>
<a href="https://help.tryhackme.com/en/collections/3601905-getting-started-with-tryhackme" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-books"></i></div>
<div class="unstuck-icon-text">Knowledge Base</div>
</a>
<a href="https://discord.gg/DpBZz8y" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-users"></i></div>
<div class="unstuck-icon-text">Ask Community</div>
</a>
</div>
</div>
</div>
</div>
</div>
<style>

    #navConnModal .modal-body{
        position: relative;
    }

    #nav-openvpn,
    #nav-attackbox {
        display: none;
    }

    #nav-openvpn .nav-pills .nav-link.active,
    #nav-openvpn .nav-pills .show>.nav-link {
        background-color: #ec8e3d;
        color: white;
    }
    #nav-openvpn .nav-link {
        color: #909090;
    }
    #nav-openvpn a,
    #nav-attackbox a {
        color: #ec8e3d;
    }

    #nav-openvpn code.dark {
        background-color: #7d400a;
        color: #fff;
    }

    #slideout-bk {
        display: none;
        padding: 10px 15px;
        opacity: 0.8;
        cursor: pointer;
    }

    #slideout-bk:hover {
        opacity: 1;
    }

    #slideout-conn-hideip {
        display: none;
        position: absolute;
        bottom: 8px;
        right: 8px;
        opacity: 0.7;
        cursor: pointer;
    }

    #slideout-conn-hideip:hover {
        opacity: 1;
    }

</style>
<div class="modal fade slideout-faq" id="navConnModal" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-bk" class="noselect" onclick="showSlideoutConnOptions()"><i class="far fa-arrow-left mr-2"></i> Show Connection Options</div>
<div id="slideout-conn-options">
<div id="slideout-conn-header" class="text-center">
<img class="slideout-connect-img" src="./TryHackMe _ Zeek_files/tryhackme_connect.png">
<div id="slideout-conn-status" class="size-22"></div>
</div>
<div class="m-3 text-center">
<p>To access target machines you need to either:</p>
<div class="row mb-3 faq-quicklinks text-left vertical-align-custom">
<div class="col-md-12 mb-3">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/zeekbro#" onclick="showAttackBoxSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-laptop"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">AttackBox</div>
<p class="faded mb-0">Use a browser-based attack machine</p>
</div>
</div>
</div>
</a>
</div>
<div class="col-md-12">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/zeekbro#" onclick="showVPNSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-key"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">OpenVPN</div>
<p class="faded mb-0">Connect to our network via a VPN</p>
</div>
</div>
</div>
</a>
</div>
</div>
</div>
</div>
<div id="faqCards" class="p-3">
<div id="nav-openvpn">
<div class="mb-3">
<a target="_blank" href="https://tryhackme.com/access"><i>View the dedicated OpenVPN access page for more information</i></a>
</div>
<div class="text-center">
<h4>What Operating System are you using?</h4>
<ul class="nav nav-pills mb-3 text-center" id="vpn-guide" style="display: flex; justify-content: center;">
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/zeekbro#pills-windows" role="tab" aria-controls="pills-windows" aria-selected="true"><i class="fab fa-windows mr-2"></i> Windows</a>
</li>
<li class="nav-item m-3">
<a class="nav-link active" data-toggle="pill" href="https://tryhackme.com/room/zeekbro#pills-linux" role="tab" aria-controls="pills-linux" aria-selected="false"><i class="fab fa-linux mr-2"></i> Linux</a>
</li>
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/zeekbro#pills-macos" role="tab" aria-controls="pills-macos" aria-selected="false"><i class="fab fa-apple mr-2"></i> MacOS</a>
</li>
</ul>
<div class="tab-content text-left">
<div class="tab-pane fade" id="pills-windows" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a target="_blank" href="https://openvpn.net/client-connect-vpn-for-windows/">Download</a> the OpenVPN GUI application.</li>
<li class="mt-2">Install the OpenVPN GUI application. Then open the installer file and follow the setup wizard.</li>
<li class="mt-2">Open and run the OpenVPN GUI application as Administrator.<br><img class="mt-2 mb-3" src="./TryHackMe _ Zeek_files/win_ran_admin.png"></li>
<li class="mt-2">The application will start running in the system tray. It's at the bottom of your screen, near the clock. Right click on the application and click <b>Import File</b>. <br><img class="mt-2 mb-3" src="./TryHackMe _ Zeek_files/win_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Now right click on the application again, select your file and click Connect <br><img class="mt-2 mb-3" src="./TryHackMe _ Zeek_files/win_connect.png"></li>
</ol>
</div>
<div class="tab-pane fade show active" id="pills-linux" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2">Run the following command in your terminal: <code class="dark">sudo apt install openvpn</code></li>
<li class="mt-2">Locate the full path to your VPN configuration file (normally in your ~/Downloads folder).</li>
<li class="mt-2">Use your OpenVPN file with the following command: <code class="dark">sudo openvpn /path/to/file.ovpn</code></li>
</ol>
</div>
<div class="tab-pane fade" id="pills-macos" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a href="https://openvpn.net/downloads/openvpn-connect-v2-macos.dmg">Download</a> OpenVPN for MacOS.</li>
<li class="mt-2">Install the OpenVPN GUI application, by opening the dmg file and following the setup wizard.<br><img width="250" class="mt-2 mb-3" src="./TryHackMe _ Zeek_files/mac_installer.png"></li>
<li class="mt-2">Open and run the OpenVPN GUI application.</li>
<li class="mt-2">The application will start running and appear in your top bar. Right click on the application and click <b>Import File -&gt; Local file</b>.<br><img class="mt-2 mb-3" src="./TryHackMe _ Zeek_files/mac_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Right click on the application again, select your file and click connect.<br><img class="mt-2 mb-3" src="./TryHackMe _ Zeek_files/mac_connect.png"></li>
</ol>
</div>
</div>
<section class="text-left">
<a class="remove-underline" data-toggle="collapse" href="https://tryhackme.com/room/zeekbro#havingProblems" role="button" aria-expanded="false" aria-controls="havingProblems">
<h5 class="mb-0 text-openvpn">Having Problems?</h5>
</a>
<div class="collapse" id="havingProblems">
<ul class="mt-2 mb-0">
<li>If you can access <a target="_blank" href="http://10.10.10.10/">10.10.10.10</a>, you're connected.</li>
<li>Downloading and getting a 404? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>Getting inline cert error? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>If you are using a virtual machine, you will need to run the VPN inside that machine.</li>
<li>Is the OpenVPN client running as root? <span class="size-14 faded">(On Windows, run OpenVPN GUI as administrator. On Linux, run with sudo)</span></li>
<li>Have you restarted your VM?</li>
<li>Is your OpenVPN up-to-date?</li>
<li>Only 1 OpenVPN connection is allowed. <span class="size-14 faded">(Run <code class="dark">ps aux | grep openvpn</code> - are there 2 VPN sessions running?)</span></li>
<li>Still having issues? Check our <a href="https://help.tryhackme.com/en/articles/6496029-openvpn-general-troubleshooting-detailed/">docs</a> out.</li>
</ul>
</div>
</section>
</div>
</div>
<div id="nav-attackbox">
<div class="text-center">
<h4>AttackBox</h4>
<p class="faded">Use your own web-based linux machine to access machines on TryHackMe</p>
</div>
<p>To start your AttackBox in the room, click the <a class="preventDefault" onclick="showAttackBoxBtnFromSlideout()" href="https://tryhackme.com/room/zeekbro#">Start AttackBox</a> button. Your private machine will take 2 minutes to start.</p>
<p>Free users get 1 free AttackBox hour. <a class="hacker-green" href="https://tryhackme.com/why-subscribe">Subscribed</a> users get more powerful machines with unlimited deploys.</p>
</div>
</div>
<span id="slideout-conn-hideip" onclick="hideNavConnIP()">Hide IP</span>
</div>
</div>
</div>
</div>
<script>

    const navConnVPNEl = document.querySelector('#nav-openvpn')
    const navConnAttackBoxEl = document.querySelector('#nav-attackbox')
    const navConnOptions = document.querySelector('#slideout-conn-options')

    const navConnBkBtn = document.querySelector('#slideout-bk')

    function showVPNSteps() {
        navConnOptions.style.display = 'none'
        navConnVPNEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showAttackBoxSteps() {
        navConnOptions.style.display = 'none'
        navConnAttackBoxEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showSlideoutConnOptions() {
        navConnVPNEl.style.display = 'none'
        navConnAttackBoxEl.style.display = 'none'
        navConnBkBtn.style.display = 'none'
        navConnOptions.style.display = 'block'
    }

    function showAttackBoxBtnFromSlideout() {
        $('#navConnModal').modal('toggle')
        setTimeout(function() {
            showAttackBoxBtnIntro()
        }, 100)   
    }

  </script>
</div>
<script src="./TryHackMe _ Zeek_files/notify.js"></script>
<script src="./TryHackMe _ Zeek_files/api-requests.js"></script>
<script src="./TryHackMe _ Zeek_files/events.js"></script>
<script src="./TryHackMe _ Zeek_files/underscore-min.js"></script>
<script src="./TryHackMe _ Zeek_files/apexcharts.min.js"></script> 
<script src="./TryHackMe _ Zeek_files/chart.js"></script>
<script src="./TryHackMe _ Zeek_files/expire.js"></script>
<script src="./TryHackMe _ Zeek_files/sockets.js"></script>
<script src="./TryHackMe _ Zeek_files/faqSearch.js"></script>
<script src="./TryHackMe _ Zeek_files/certificate.js"></script>
<script src="./TryHackMe _ Zeek_files/utils.js"></script>
<script src="./TryHackMe _ Zeek_files/roomSpecific.js"></script>
<script src="./TryHackMe _ Zeek_files/confetti.js"></script>
<script src="./TryHackMe _ Zeek_files/videos.js"></script>
<script src="./TryHackMe _ Zeek_files/intro.js"></script>
<script src="./TryHackMe _ Zeek_files/prism.js"></script>
<script src="./TryHackMe _ Zeek_files/asciinema-player.js"></script>
<script src="./TryHackMe _ Zeek_files/magnific-popup.min.js"></script>
<script src="./TryHackMe _ Zeek_files/introjsLogic.js"></script>
<script src="./TryHackMe _ Zeek_files/logic.js"></script>
<script src="./TryHackMe _ Zeek_files/tasks.js"></script>
<script src="./TryHackMe _ Zeek_files/connection-status.js"></script>
<script src="./TryHackMe _ Zeek_files/glossary.js"></script>
<script src="./TryHackMe _ Zeek_files/room-mymachine.js"></script>
<script src="./TryHackMe _ Zeek_files/heartbeat.js" defer=""></script>
<script>

    let height
    $(window).scroll(function () { /* Function to make IP information sticky. */
      if (height == undefined || height < 30) {
        height = ($('#instance-info').offset().top)
      }
      let scroll = $(window).scrollTop()
      if (((scroll >= (height + 150))) && height > 30) {
        $("#instance-info").addClass('instance-sticky')
      } else if ((scroll <= (height))) {
        $("#instance-info").removeClass("instance-sticky")
      }
    })

    const csrfToken = "rFtq8je8-5IfWJOImyn1SeJTnQmqUyv4vcEw"
    $.ajaxSetup({ headers: { 'CSRF-Token': csrfToken } }) // all $.post headers include token (needs csrfProtection middleware)

    const roomCode = "zeekbro"
    const simpleRoom = true 
    const events = {"tickets":false}

    let userObj = { 
      subscribed: 1,
      splitScreen: true,
      path: "soclevel1",
      tutorial: {
        rooms: true,
        attackbox: true,
        staticsite: true
      },
      experiments:  JSON.parse(`{"onboardingAchievement":{},"scheduler":{"startDate":"2023-06-14T13:38:51.108Z"},"showEasyPath":true}`),
    }

    const roomSettings = {
      remAttackBoxBtn : true
    };

    const heartbeatInterval = 30;

    const cloudEnabled = false 
    let cloudObj

    initRoom()
    checkVideoTab()
    if(!simpleRoom) showChart(roomCode)

    checkRoomAwards(roomCode)

    getRoomVotes()

    displayStreakFreezeAwardedFromMemory();
    
    window.addEventListener('load', function () {
      introjsInit(roomCode)
    })

  </script>


<svg id="SvgjsSvg1001" width="2" height="0" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.dev" style="overflow: hidden; top: -100%; left: -100%; position: absolute; opacity: 0;"><defs id="SvgjsDefs1002"></defs><polyline id="SvgjsPolyline1003" points="0,0"></polyline><path id="SvgjsPath1004" d="M0 0 "></path></svg><div id="5BAFC1BD-138C-7503-3C67-5D7A6AE7A92A"></div><iframe id="_hjSafeContext_43209427" title="_hjSafeContext" tabindex="-1" aria-hidden="true" src="./TryHackMe _ Zeek_files/saved_resource.html" style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;"></iframe><iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" aria-hidden="true" tabindex="-1" title="Intercom" src="./TryHackMe _ Zeek_files/saved_resource(1).html"></iframe><div class="intercom-lightweight-app"><div class="intercom-lightweight-app-launcher intercom-launcher" role="button" tabindex="0" aria-label="Open Intercom Messenger" aria-live="polite"><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-open"><img src="./TryHackMe _ Zeek_files/9e0f012f15b6fc981dde2f1f5198d728.png" alt="" class="intercom-lightweight-app-launcher-custom-icon-open"></div><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-minimize"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M18.601 8.39897C18.269 8.06702 17.7309 8.06702 17.3989 8.39897L12 13.7979L6.60099 8.39897C6.26904 8.06702 5.73086 8.06702 5.39891 8.39897C5.06696 8.73091 5.06696 9.2691 5.39891 9.60105L11.3989 15.601C11.7309 15.933 12.269 15.933 12.601 15.601L18.601 9.60105C18.9329 9.2691 18.9329 8.73091 18.601 8.39897Z" fill="white"></path>
</svg>
</div></div><style id="intercom-lightweight-app-style" type="text/css">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    0% {
      opacity: 0;
      transform: scale(0);
    }
    40% {
      opacity: 1;
    }
    100% {
      transform: scale(1);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji", Helvetica, Arial, sans-serif;
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    padding: 0 !important;
    margin: 0 !important;
    border: none;
    bottom: 20px;
    right: 20px;
    max-width: 48px;
    width: 48px;
    max-height: 48px;
    height: 48px;
    border-radius: 50%;
    background: #1C2538;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    transition: transform 167ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    box-sizing: content-box;
  }


  .intercom-lightweight-app-launcher:hover {
    transition: transform 250ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    transform: scale(1.1)
  }

  .intercom-lightweight-app-launcher:active {
    transform: scale(0.85);
    transition: transform 134ms cubic-bezier(0.45, 0, 0.2, 1);
  }


  .intercom-lightweight-app-launcher:focus {
    outline: none;

    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 48px;
    height: 48px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 24px;
    height: 24px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 44px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 24px;
    max-width: 24px;

    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: white;
    animation: intercom-lightweight-app-messenger 250ms cubic-bezier(0, 1, 1, 1);
    transform-origin: bottom right;
    
        width: 400px;
        height: calc(100% - 104px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 84px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
      

    border-radius: 16px;
  }

  .intercom-lightweight-app-messenger-header {
    height: 64px;
    border-bottom: none;
    background: #1c2538

    
  }

  .intercom-lightweight-app-messenger-footer{
    position:absolute;
    bottom:0;
    width: 100%;
    height: 80px;
    background: #fff;
    font-size: 14px;
    line-height: 21px;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0px 0px 25px rgba(0, 0, 0, 0.05);
    
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div></body></html>