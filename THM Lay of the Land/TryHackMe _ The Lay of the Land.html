<!DOCTYPE html>
<!-- saved from url=(0042)https://tryhackme.com/room/thelayoftheland -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>TryHackMe | The Lay of the Land</title>
<meta name="description" content="Learn about and get hands-on with common technologies and security products used in corporate environments; both host and network-based security solutions are covered.">
<meta name="og:description" content="Learn about and get hands-on with common technologies and security products used in corporate environments; both host and network-based security solutions are covered.">
<meta name="keywords" content="cyber,security,cyber security,cyber security training,coding,computer,bitcoin,hacking,hackers,hacks,hack,exploits,keylogger,learn,poc">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<meta property="og:site_name" content="TryHackMe">
<meta property="og:title" content="TryHackMe | The Lay of the Land">
<meta property="og:image" content="https://tryhackme-images.s3.amazonaws.com/room-icons/8e5ab636b0b3a8087ed0b3e02a6bf765.png">
<meta property="og:url" content="https://tryhackme.com/room/thelayoftheland">
<meta name="twitter:image" content="https://tryhackme.com/img/meta/default.png">
<meta property="og:description" content="Learn about and get hands-on with common technologies and security products used in corporate environments; both host and network-based security solutions are covered.">

<script type="text/javascript" async="" src="./TryHackMe _ The Lay of the Land_files/pgpbhph6"></script><script src="./TryHackMe _ The Lay of the Land_files/jquery.min.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/popper.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ The Lay of the Land_files/boostrap431.min.css">
<script src="./TryHackMe _ The Lay of the Land_files/bootstrap431.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ The Lay of the Land_files/animate.min.css">
<link rel="stylesheet" href="./TryHackMe _ The Lay of the Land_files/all.css" integrity="sha384-ekOryaXPbeCpWQNxMwSWVvQ0+1VrStoPJq54shlYhR8HzQgig1v5fas6YgOqLoKz" crossorigin="anonymous">
<link rel="icon" type="image/png" href="https://assets.tryhackme.com/img/favicon.png">
<link rel="stylesheet" media="screen" href="./TryHackMe _ The Lay of the Land_files/general-style.css">
<script src="./TryHackMe _ The Lay of the Land_files/script.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/validation.js"></script>

<link rel="stylesheet" type="text/css" href="./TryHackMe _ The Lay of the Land_files/cookieconsent.min.css">
<script src="./TryHackMe _ The Lay of the Land_files/cookieconsent.min.js"></script>
<script async="" src="./TryHackMe _ The Lay of the Land_files/js"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-Z8D4WL3D4P');
  </script>


<script>
    window.intercomSettings = {
      api_base: "https://api-iam.intercom.io",
      app_id: "pgpbhph6"
    };
  </script>
<script>
    (function (h, o, t, j, a, r) {
      h.hj = h.hj || function () { (h.hj.q = h.hj.q || []).push(arguments) };
      h._hjSettings = { hjid: 1950941, hjsv: 6 };
      a = o.getElementsByTagName('head')[0];
      r = o.createElement('script'); r.async = 1;
      r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
      a.appendChild(r);
    })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
  </script><script async="" src="./TryHackMe _ The Lay of the Land_files/hotjar-1950941.js"></script>
<script>
    /* Global javascript variables */

    // Used inside script.js for createRooms compelted users.
    const username = 'Silv3rsurf3r'
    const subscribed = '1'
    const level = '10'
    const intercomEnabled = 'true'
  </script>
<script>
    //add back tracking info
    const userId = "63d14e7f857ae10041bb192f"
    let tutorialComplete = false
    if ('false' == "true") {
      tutorialComplete = true
    }
    if(intercomEnabled === "true"){
      window.intercomSettings = {
        api_base: "https://api-iam.intercom.io",
        app_id: "pgpbhph6",
        user_id: userId,
        username: username,
        email: "giftonpaul@karunya.edu.in",
        created_at: Math.floor(new Date("Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)").getTime() / 1000) // Signup date as a Unix timestamp
      };
    }
    window.hj('identify', userId, {
      displayName: username,
      subscribed: "1",
      dateSignUp: "Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)",
      experience: "advanced"
    })
  </script>
<script type="application/ld+json">

   {
      "@context":"https://schema.org",
      "@type":"Organization",
      "url":"https://tryhackme.com",
      "name":"TryHackMe",
      "logo":"https://tryhackme.com/img/favicon.png",
      "description":"TryHackMe is a free online platform for learning cyber security, using hands-on exercises and labs, all through your browser!",
      "email": "support@tryhackme.com",
      "sameAs":[
         "https://www.linkedin.com/company/tryhackme",
         "https://twitter.com/realtryhackme"
      ]
   }

</script>
<script>
    console.log(`%c
      ------------------
      < Happy Hacking! >
      ------------------
              \\   ^__^
               \\  (oo)\\_______
                  (__)\\       )\\/\\
                      ||----w |
                      ||     ||`, "font-family:monospace")
  </script>
<script>
  (function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pgpbhph6';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>
<script src="./TryHackMe _ The Lay of the Land_files/socket.io.js"></script><script>
  let socket = io.connect({
    transports: ['websocket'],
    reconnection: true,
    reconnectionDelay: 1000,
    reconnectionAttempts: 10
  })
</script><style type="text/css">.apexcharts-canvas {
  position: relative;
  user-select: none;
  /* cannot give overflow: hidden as it will crop tooltips which overflow outside chart area */
}


/* scrollbar is not visible by default for legend, hence forcing the visibility */
.apexcharts-canvas ::-webkit-scrollbar {
  -webkit-appearance: none;
  width: 6px;
}

.apexcharts-canvas ::-webkit-scrollbar-thumb {
  border-radius: 4px;
  background-color: rgba(0, 0, 0, .5);
  box-shadow: 0 0 1px rgba(255, 255, 255, .5);
  -webkit-box-shadow: 0 0 1px rgba(255, 255, 255, .5);
}


.apexcharts-inner {
  position: relative;
}

.apexcharts-text tspan {
  font-family: inherit;
}

.legend-mouseover-inactive {
  transition: 0.15s ease all;
  opacity: 0.20;
}

.apexcharts-series-collapsed {
  opacity: 0;
}

.apexcharts-tooltip {
  border-radius: 5px;
  box-shadow: 2px 2px 6px -4px #999;
  cursor: default;
  font-size: 14px;
  left: 62px;
  opacity: 0;
  pointer-events: none;
  position: absolute;
  top: 20px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  white-space: nowrap;
  z-index: 12;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-theme-light {
  border: 1px solid #e3e3e3;
  background: rgba(255, 255, 255, 0.96);
}

.apexcharts-tooltip.apexcharts-theme-dark {
  color: #fff;
  background: rgba(30, 30, 30, 0.8);
}

.apexcharts-tooltip * {
  font-family: inherit;
}


.apexcharts-tooltip-title {
  padding: 6px;
  font-size: 15px;
  margin-bottom: 4px;
}

.apexcharts-tooltip.apexcharts-theme-light .apexcharts-tooltip-title {
  background: #ECEFF1;
  border-bottom: 1px solid #ddd;
}

.apexcharts-tooltip.apexcharts-theme-dark .apexcharts-tooltip-title {
  background: rgba(0, 0, 0, 0.7);
  border-bottom: 1px solid #333;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  display: inline-block;
  font-weight: 600;
  margin-left: 5px;
}

.apexcharts-tooltip-text-y-label:empty,
.apexcharts-tooltip-text-y-value:empty,
.apexcharts-tooltip-text-goals-label:empty,
.apexcharts-tooltip-text-goals-value:empty,
.apexcharts-tooltip-text-z-value:empty {
  display: none;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  font-weight: 600;
}

.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-goals-group, 
.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  display: flex;
}
.apexcharts-tooltip-text-goals-label:not(:empty),
.apexcharts-tooltip-text-goals-value:not(:empty) {
  margin-top: -6px;
}

.apexcharts-tooltip-marker {
  width: 12px;
  height: 12px;
  position: relative;
  top: 0px;
  margin-right: 10px;
  border-radius: 50%;
}

.apexcharts-tooltip-series-group {
  padding: 0 10px;
  display: none;
  text-align: left;
  justify-content: left;
  align-items: center;
}

.apexcharts-tooltip-series-group.apexcharts-active .apexcharts-tooltip-marker {
  opacity: 1;
}

.apexcharts-tooltip-series-group.apexcharts-active,
.apexcharts-tooltip-series-group:last-child {
  padding-bottom: 4px;
}

.apexcharts-tooltip-series-group-hidden {
  opacity: 0;
  height: 0;
  line-height: 0;
  padding: 0 !important;
}

.apexcharts-tooltip-y-group {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-box, .apexcharts-custom-tooltip {
  padding: 4px 8px;
}

.apexcharts-tooltip-boxPlot {
  display: flex;
  flex-direction: column-reverse;
}

.apexcharts-tooltip-box>div {
  margin: 4px 0;
}

.apexcharts-tooltip-box span.value {
  font-weight: bold;
}

.apexcharts-tooltip-rangebar {
  padding: 5px 8px;
}

.apexcharts-tooltip-rangebar .category {
  font-weight: 600;
  color: #777;
}

.apexcharts-tooltip-rangebar .series-name {
  font-weight: bold;
  display: block;
  margin-bottom: 5px;
}

.apexcharts-xaxistooltip {
  opacity: 0;
  padding: 9px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
  transition: 0.15s ease all;
}

.apexcharts-xaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-xaxistooltip:after,
.apexcharts-xaxistooltip:before {
  left: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-xaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-left: -6px;
}

.apexcharts-xaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-left: -7px;
}

.apexcharts-xaxistooltip-bottom:after,
.apexcharts-xaxistooltip-bottom:before {
  bottom: 100%;
}

.apexcharts-xaxistooltip-top:after,
.apexcharts-xaxistooltip-top:before {
  top: 100%;
}

.apexcharts-xaxistooltip-bottom:after {
  border-bottom-color: #ECEFF1;
}

.apexcharts-xaxistooltip-bottom:before {
  border-bottom-color: #90A4AE;
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:after {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:before {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top:after {
  border-top-color: #ECEFF1
}

.apexcharts-xaxistooltip-top:before {
  border-top-color: #90A4AE;
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:after {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:before {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-yaxistooltip {
  opacity: 0;
  padding: 4px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
}

.apexcharts-yaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-yaxistooltip:after,
.apexcharts-yaxistooltip:before {
  top: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-yaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-top: -6px;
}

.apexcharts-yaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-top: -7px;
}

.apexcharts-yaxistooltip-left:after,
.apexcharts-yaxistooltip-left:before {
  left: 100%;
}

.apexcharts-yaxistooltip-right:after,
.apexcharts-yaxistooltip-right:before {
  right: 100%;
}

.apexcharts-yaxistooltip-left:after {
  border-left-color: #ECEFF1;
}

.apexcharts-yaxistooltip-left:before {
  border-left-color: #90A4AE;
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:after {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:before {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right:after {
  border-right-color: #ECEFF1;
}

.apexcharts-yaxistooltip-right:before {
  border-right-color: #90A4AE;
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:after {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:before {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip.apexcharts-active {
  opacity: 1;
}

.apexcharts-yaxistooltip-hidden {
  display: none;
}

.apexcharts-xcrosshairs,
.apexcharts-ycrosshairs {
  pointer-events: none;
  opacity: 0;
  transition: 0.15s ease all;
}

.apexcharts-xcrosshairs.apexcharts-active,
.apexcharts-ycrosshairs.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-ycrosshairs-hidden {
  opacity: 0;
}

.apexcharts-selection-rect {
  cursor: move;
}

.svg_select_boundingRect, .svg_select_points_rot {
  pointer-events: none;
  opacity: 0;
  visibility: hidden;
}
.apexcharts-selection-rect + g .svg_select_boundingRect,
.apexcharts-selection-rect + g .svg_select_points_rot {
  opacity: 0;
  visibility: hidden;
}

.apexcharts-selection-rect + g .svg_select_points_l,
.apexcharts-selection-rect + g .svg_select_points_r {
  cursor: ew-resize;
  opacity: 1;
  visibility: visible;
}

.svg_select_points {
  fill: #efefef;
  stroke: #333;
  rx: 2;
}

.apexcharts-svg.apexcharts-zoomable.hovering-zoom {
  cursor: crosshair
}

.apexcharts-svg.apexcharts-zoomable.hovering-pan {
  cursor: move
}

.apexcharts-zoom-icon,
.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon,
.apexcharts-reset-icon,
.apexcharts-pan-icon,
.apexcharts-selection-icon,
.apexcharts-menu-icon,
.apexcharts-toolbar-custom-icon {
  cursor: pointer;
  width: 20px;
  height: 20px;
  line-height: 24px;
  color: #6E8192;
  text-align: center;
}

.apexcharts-zoom-icon svg,
.apexcharts-zoomin-icon svg,
.apexcharts-zoomout-icon svg,
.apexcharts-reset-icon svg,
.apexcharts-menu-icon svg {
  fill: #6E8192;
}

.apexcharts-selection-icon svg {
  fill: #444;
  transform: scale(0.76)
}

.apexcharts-theme-dark .apexcharts-zoom-icon svg,
.apexcharts-theme-dark .apexcharts-zoomin-icon svg,
.apexcharts-theme-dark .apexcharts-zoomout-icon svg,
.apexcharts-theme-dark .apexcharts-reset-icon svg,
.apexcharts-theme-dark .apexcharts-pan-icon svg,
.apexcharts-theme-dark .apexcharts-selection-icon svg,
.apexcharts-theme-dark .apexcharts-menu-icon svg,
.apexcharts-theme-dark .apexcharts-toolbar-custom-icon svg {
  fill: #f3f4f5;
}

.apexcharts-canvas .apexcharts-zoom-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-selection-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-reset-zoom-icon.apexcharts-selected svg {
  fill: #008FFB;
}

.apexcharts-theme-light .apexcharts-selection-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoom-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoomin-icon:hover svg,
.apexcharts-theme-light .apexcharts-zoomout-icon:hover svg,
.apexcharts-theme-light .apexcharts-reset-icon:hover svg,
.apexcharts-theme-light .apexcharts-menu-icon:hover svg {
  fill: #333;
}

.apexcharts-selection-icon,
.apexcharts-menu-icon {
  position: relative;
}

.apexcharts-reset-icon {
  margin-left: 5px;
}

.apexcharts-zoom-icon,
.apexcharts-reset-icon,
.apexcharts-menu-icon {
  transform: scale(0.85);
}

.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon {
  transform: scale(0.7)
}

.apexcharts-zoomout-icon {
  margin-right: 3px;
}

.apexcharts-pan-icon {
  transform: scale(0.62);
  position: relative;
  left: 1px;
  top: 0px;
}

.apexcharts-pan-icon svg {
  fill: #fff;
  stroke: #6E8192;
  stroke-width: 2;
}

.apexcharts-pan-icon.apexcharts-selected svg {
  stroke: #008FFB;
}

.apexcharts-pan-icon:not(.apexcharts-selected):hover svg {
  stroke: #333;
}

.apexcharts-toolbar {
  position: absolute;
  z-index: 11;
  max-width: 176px;
  text-align: right;
  border-radius: 3px;
  padding: 0px 6px 2px 6px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.apexcharts-menu {
  background: #fff;
  position: absolute;
  top: 100%;
  border: 1px solid #ddd;
  border-radius: 3px;
  padding: 3px;
  right: 10px;
  opacity: 0;
  min-width: 110px;
  transition: 0.15s ease all;
  pointer-events: none;
}

.apexcharts-menu.apexcharts-menu-open {
  opacity: 1;
  pointer-events: all;
  transition: 0.15s ease all;
}

.apexcharts-menu-item {
  padding: 6px 7px;
  font-size: 12px;
  cursor: pointer;
}

.apexcharts-theme-light .apexcharts-menu-item:hover {
  background: #eee;
}

.apexcharts-theme-dark .apexcharts-menu {
  background: rgba(0, 0, 0, 0.7);
  color: #fff;
}

@media screen and (min-width: 768px) {
  .apexcharts-canvas:hover .apexcharts-toolbar {
    opacity: 1;
  }
}

.apexcharts-datalabel.apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-pie-label,
.apexcharts-datalabels,
.apexcharts-datalabel,
.apexcharts-datalabel-label,
.apexcharts-datalabel-value {
  cursor: default;
  pointer-events: none;
}

.apexcharts-pie-label-delay {
  opacity: 0;
  animation-name: opaque;
  animation-duration: 0.3s;
  animation-fill-mode: forwards;
  animation-timing-function: ease;
}

.apexcharts-canvas .apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-hide .apexcharts-series-points {
  opacity: 0;
}

.apexcharts-gridline,
.apexcharts-annotation-rect,
.apexcharts-tooltip .apexcharts-marker,
.apexcharts-area-series .apexcharts-area,
.apexcharts-line,
.apexcharts-zoom-rect,
.apexcharts-toolbar svg,
.apexcharts-area-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-line-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-radar-series path,
.apexcharts-radar-series polygon {
  pointer-events: none;
}


/* markers */

.apexcharts-marker {
  transition: 0.15s ease all;
}

@keyframes opaque {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}


/* Resize generated styles */

@keyframes resizeanim {
  from {
    opacity: 0;
  }
  to {
    opacity: 0;
  }
}

.resize-triggers {
  animation: 1ms resizeanim;
  visibility: hidden;
  opacity: 0;
}

.resize-triggers,
.resize-triggers>div,
.contract-trigger:before {
  content: " ";
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  overflow: hidden;
}

.resize-triggers>div {
  background: #eee;
  overflow: auto;
}

.contract-trigger:before {
  width: 200%;
  height: 200%;
}</style><style data-jss="" data-meta="MuiDialog">
@media print {
  .MuiDialog-root {
    position: absolute !important;
  }
}
.MuiDialog-scrollPaper {
  display: flex;
  align-items: center;
  justify-content: center;
}
.MuiDialog-scrollBody {
  overflow-x: hidden;
  overflow-y: auto;
  text-align: center;
}
.MuiDialog-scrollBody:after {
  width: 0;
  height: 100%;
  content: "";
  display: inline-block;
  vertical-align: middle;
}
.MuiDialog-container {
  height: 100%;
  outline: 0;
}
@media print {
  .MuiDialog-container {
    height: auto;
  }
}
.MuiDialog-paper {
  margin: 32px;
  position: relative;
  overflow-y: auto;
}
@media print {
  .MuiDialog-paper {
    box-shadow: none;
    overflow-y: visible;
  }
}
.MuiDialog-paperScrollPaper {
  display: flex;
  max-height: calc(100% - 64px);
  flex-direction: column;
}
.MuiDialog-paperScrollBody {
  display: inline-block;
  text-align: left;
  vertical-align: middle;
}
.MuiDialog-paperWidthFalse {
  max-width: calc(100% - 64px);
}
.MuiDialog-paperWidthXs {
  max-width: 444px;
}
@media (max-width:507.95px) {
  .MuiDialog-paperWidthXs.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthSm {
  max-width: 600px;
}
@media (max-width:663.95px) {
  .MuiDialog-paperWidthSm.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthMd {
  max-width: 960px;
}
@media (max-width:1023.95px) {
  .MuiDialog-paperWidthMd.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthLg {
  max-width: 1280px;
}
@media (max-width:1343.95px) {
  .MuiDialog-paperWidthLg.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthXl {
  max-width: 1920px;
}
@media (max-width:1983.95px) {
  .MuiDialog-paperWidthXl.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperFullWidth {
  width: calc(100% - 64px);
}
.MuiDialog-paperFullScreen {
  width: 100%;
  height: 100%;
  margin: 0;
  max-width: 100%;
  max-height: none;
  border-radius: 0;
}
.MuiDialog-paperFullScreen.MuiDialog-paperScrollBody {
  margin: 0;
  max-width: 100%;
}
</style><script async="" src="./TryHackMe _ The Lay of the Land_files/modules.5957fbf26d1b525b5a12.js" charset="utf-8"></script><style></style></head>


<body><div role="dialog" aria-live="polite" aria-label="cookieconsent" aria-describedby="cookieconsent:desc" class="cc-window cc-floating cc-type-info cc-theme-classic cc-bottom cc-right cc-color-override-382972913 cc-invisible" style="display: none;"><!--googleoff: all--><span id="cookieconsent:desc" class="cc-message">We use cookies to ensure you get the best user experience. For more information contact us. <a aria-label="learn more about cookies" role="button" tabindex="0" class="cc-link" href="https://tryhackme.com/legal/terms-of-use" target="_blank">Read more</a></span><div class="cc-compliance"><a aria-label="dismiss cookie message" role="button" tabindex="0" class="cc-btn cc-dismiss">Got it!</a></div><!--googleon: all--></div>
<link href="./TryHackMe _ The Lay of the Land_files/scoreboard.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ The Lay of the Land_files/introjs.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ The Lay of the Land_files/slideout.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ The Lay of the Land_files/public-rooms.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ The Lay of the Land_files/asciinema-player.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ The Lay of the Land_files/prism.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ The Lay of the Land_files/magnific-popup.css" rel="stylesheet" type="text/css"> 
<script src="./TryHackMe _ The Lay of the Land_files/lottie-player.js"></script>

<div id="room-content">
<div id="room-content-main">
<nav class="navbar navbar-expand-md navbar-dark navbar-color-loggedin navbar-main">
<div class="container">
<button id="thm-mobile-nav-open" class="thm-nav__hamburger-btn" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Open mobile navigation">
<span class="thm-nav__hamburger-lines"></span>
</button>
<div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
<div class="navbar-brand" href="/">
<a href="https://tryhackme.com/dashboard">
<img width="115px" src="./TryHackMe _ The Lay of the Land_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
</div>
<ul class="navbar-nav mr-auto mt-2 mt-lg-0 navbar-pagelinks">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="navbar-item-icon far fa-browser"></i>
<div class="navbar-item-text">Dashboard</div>
</a>
</li>
<li class="nav-item active" id="nav-learn">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="navbar-item-icon far fa-book-open"></i>
<div class="navbar-item-text">Learn</div>
</a>
</li>
<li class="nav-item  dropdown lite-removable">
<a id="nav-other" class="nav-link" href="https://tryhackme.com/room/thelayoftheland#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-trophy"></i>
<div class="navbar-item-text">Compete</div>
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdown">
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/leaderboards">
<div class="dropdown-menu-icon">
<i class="fas fa-trophy"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/games/koth">
<div class="dropdown-menu-icon">
<i class="fas fa-crown"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/workspace">
<div class="dropdown-menu-icon">
<i class="fas fa-user-friends"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item dropdown">
<a data-cy="nav-other-menu-button" id="nav-other" class="nav-link" href="https://tryhackme.com/room/thelayoftheland#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-ellipsis-h-alt"></i>
<div class="navbar-item-text">Other</div>
</a>
<div data-cy="nav-other-menu" class="dropdown-menu dropdown-menu-center large-dropdown" aria-labelledby="navbarDropdown">
<span class="dropdown-menu-arrow"></span>
<a class="dropdown-item" href="https://tryhackme.com/resources">Resources</a>
<a class="dropdown-item" href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a class="dropdown-item" href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/business">For Business</a>
<a class="dropdown-item" href="https://tryhackme.com/classrooms">For Education</a>
<a class="dropdown-item" target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
<a class="dropdown-item" href="https://tryhackme.com/glossary">Glossary</a>
</div>
</li>
</ul>
<ul class="navbar-nav navbar-right options vertical-align-custom">
<li class="nav-item" data-toggle="modal" data-target="#navConnModal">
<div id="thm-connection-status" class="thm-unconnected">
<div id="thm-connection-status-dot" class="dot-small"></div> <span id="thm-connection-status-txt" class="ml-2 size-18 text-white"></span>
</div>
</li>
<li class="nav-item">
<div class="nav-item-streak">
<span id="streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="">
<span id="user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>
<script>
                            let usersStreak = { // Global variable, used in rooms logic
                                streakFirstAnswered: new Date('Mon Jul 10 2023 03:13:45 GMT+0100 (British Summer Time)'),
                                streakLastAnswered: new Date('Sun Jul 16 2023 18:47:44 GMT+0100 (British Summer Time)'),
                                usersTimezone: 'Asia/Kolkata',
                                streakFreeze: 1
                            };
                            setSidebarStreaks(usersStreak.streakFirstAnswered, usersStreak.streakLastAnswered, usersStreak.usersTimezone, usersStreak.streakFreeze)
                        </script>
</div>
</li>
<li class="nav-item dropdown" id="notification-navitem">
<a class="nav-link vertical-align-custom size-22 pl-0" href="https://tryhackme.com/room/thelayoftheland#" id="notification-btn" role="button" data-toggle="dropdown">
<i id="notification-icon" class="fal fa-bell"></i>
<div id="notification-dot"></div>
</a>
<div id="nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="notification-header">Notifications</div>
<div id="nav-notifications">
<div class="text-center mt-2 mb-2"><i>Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle remove-arrow p-0" href="https://tryhackme.com/room/thelayoftheland#" id="navbarAvatarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
<img src="./TryHackMe _ The Lay of the Land_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarAvatarDropdown">
<a class="dropdown-item" href="https://tryhackme.com/profile">Profile</a>
<a class="dropdown-item" href="https://tryhackme.com/referrals">Refer a friend</a>
<a class="dropdown-item" href="https://tryhackme.com/badges">Badges</a>
<a class="dropdown-item" href="https://tryhackme.com/rooms">My Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/access">Access</a>
<a class="dropdown-item" href="https://tryhackme.com/feedback">Give Feedback</a>
<a class="dropdown-item" href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</div>
</div>
</nav>
<link rel="stylesheet" href="./TryHackMe _ The Lay of the Land_files/streak-freeze.css">
<div class="modal fade modal-streak-freeze" id="unlocked-streak-freeze" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<button type="button" class="close close-streak" id="close-streak-freeze-popup" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<div class="modal-body">
<figure>
<img class="img-streak" width="400px" alt="streak freeze unlocked" src="./TryHackMe _ The Lay of the Land_files/streak-freeze.svg">
</figure>
<h2>You've unlocked a streak freeze!</h2>
<p>With these one-time streak freezes, you can miss one day of hacking without losing your streak.</p>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ The Lay of the Land_files/streak-freeze.js"></script>
<nav id="thm-mobile-nav-menu" class="thm-mobile-nav" aria-label="Mobile secondary navigation menu.">
<header>
<a href="https://tryhackme.com/" aria-label="Go to the home page">
<img width="140" src="./TryHackMe _ The Lay of the Land_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
<button id="thm-mobile-nav-close" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Close mobile navigation">
<i class="fal fa-times"></i>
</button>
</header>
<ul class="thm-mobile-nav-items mb-0">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="nav-title-icon far fa-browser"></i>
<div class="nav-title">Dashboard</div>
</a>
</li>
<li class="nav-item active">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="nav-title-icon far fa-book-open"></i>
<div class="nav-title">Learn</div>
</a>
</li>
<li class="nav-item ">
<a aria-expanded="false" aria-controls="mobile-nav-compete" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-compete" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-trophy"></i>
<div class="nav-title">Compete</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-compete" class="dropdown-wrapper">
<a href="https://tryhackme.com/leaderboards">
<div>
<i class="fas fa-trophy"></i>
</div>
<div>
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a href="https://tryhackme.com/games/koth">
<div>
<i class="fas fa-crown"></i>
</div>
<div>
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a href="https://tryhackme.com/workspace">
<div>
<i class="fas fa-user-friends"></i>
</div>
<div>
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item">
<a aria-expanded="false" aria-controls="mobile-nav-other" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-other" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-ellipsis-h-alt"></i>
<div class="nav-title">Other</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-other" class="dropdown-wrapper">
<a href="https://tryhackme.com/resources">Resources</a>
<a href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a href="https://tryhackme.com/business">For Business</a>
<a href="https://tryhackme.com/classrooms">For Education</a>
<a target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
</div>
</li>
<li class="nav-item text-center">
<div class="nav-item-streak">
<span id="mobile-streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="">
<span id="mobile-user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>
</div>
</li>
<li class="nav-item text-center">
<a class="nav-link size-22 d-inline-block" href="https://tryhackme.com/room/thelayoftheland#" id="mobile-notification-btn" role="button" data-toggle="dropdown">
<i id="mobile-notification-icon" class="fal fa-bell"></i>
<div id="mobile-notification-dot"></div>
</a>
<div id="mobile-nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="mobile-notification-header">Notifications</div>
<div id="mobile-nav-notifications">
<div class="text-center mt-2 mb-2"><i>Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item text-center">
<a aria-expanded="false" aria-controls="mobile-nav-auth" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-auth" class="sublinks-toggle nav-link d-inline-block">
<img src="./TryHackMe _ The Lay of the Land_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div id="mobile-nav-auth" class="dropdown-wrapper">
<a href="https://tryhackme.com/profile">Profile</a>
<a href="https://tryhackme.com/referrals">Refer a friend</a>
<a href="https://tryhackme.com/badges">Badges</a>
<a href="https://tryhackme.com/rooms">My Rooms</a>
<a href="https://tryhackme.com/access">Access</a>
<a href="https://tryhackme.com/feedback">Give Feedback</a>
<a href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</nav>
<script defer="" src="./TryHackMe _ The Lay of the Land_files/mobile-nav.js"></script>
<script>
  const userSignedUpLessThanSevenDaysAgo = Math.floor(
    (new Date() - new Date('Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)')) / (1000 * 60 * 60 * 24) < 7
  );

  const userHasFirst4RoomsBadge = !!``;
  const isBeginner = `advanced` === 'complete-beginner';
</script>
<script src="./TryHackMe _ The Lay of the Land_files/notifications.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/streak-freeze(1).js"></script>
<div id="wrapper">
<div id="room-banner" class="shadow-light">
<img id="room-image-large" src="./TryHackMe _ The Lay of the Land_files/bf86c057f58b26f95802c5499c18ae2a.png">
<div>
<div id="room-details">
<div class="container">
<div class="page-header">
<div class="room-header">
<div id="room-voting" class="text-center vertical-align-custom">
<div class="voting-buttons">
<i class="fas fa-thumbs-up display-block" onclick="makeVote(true)" id="vote-up" style="color: rgb(136, 204, 20);"></i>
<div class="display-block" id="vote-number">510</div>
<i class="fas fa-thumbs-down display-block" onclick="makeVote(false)" id="vote-down" style="color: rgb(185, 185, 185);"></i>
</div>
</div>
<div id="room-logo" class="vertical-align-custom">
<div id="logo"><img class="room-avatar" src="./TryHackMe _ The Lay of the Land_files/8e5ab636b0b3a8087ed0b3e02a6bf765.png" onerror="replaceImg(this)"></div>
</div>
<div class="vertical-align-custom">
<div id="room-basic-data">
<div class="d-flex justify-content-between">
<h1 id="title" class="bold-head">The Lay of the Land</h1>
<div id="room-title-options">

<div class="btn-group" id="browser-machine-options" role="group" aria-label="Start AttackBox or Kali Linux" style="display: none;">
<button id="browser-machine-start" type="button" class="btn btn-secondary"><i class="far fa-laptop"></i> Start AttackBox</button>
<div class="btn-group" id="browser-machines" role="group">
<button id="btnGroupDrop1" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
<div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
<a class="dropdown-item  preventDefault" href="https://tryhackme.com/room/thelayoftheland#" onclick="changeMyMachine(&quot;kali-linux&quot;)">
<span class="mb-0">Use Kali Linux</span>
<div class="text-lgray size-12">Web-based Kali Machine</div>
</a>
<a class="dropdown-item preventDefault" href="https://tryhackme.com/room/thelayoftheland#" onclick="changeMyMachine(&quot;attackbox&quot;)">
<span class="mb-0">Use AttackBox</span>
<div class="text-lgray size-12">Recommended</div>
</a>
</div>
</div>
</div>
<button id="browser-machine-split-view" type="button" class="btn btn-secondary">Show Split View</button>
<button id="cloud-details" type="button" class="btn btn-info"><i class="far fa-clouds mr-1"></i>Cloud Details</button>
<span id="awards-model-btn" data-toggle="modal" data-target="#award-modal" class="badge badge-warning ml-1 noselect">Awards</span>
<span id="room-faq-slideout" type="button" class="badge badge-info ml-1 noselect d-inline-flex" onclick="openHelpMenu()">
Help
</span>
<div class="dropright room-dropright noselect ml-1" id="room-options" style="display: inline-block;">
<span class="badge badge-secondary" data-toggle="dropdown">
<i class="fas fa-cog"></i>
</span>
<div class="dropdown-menu">
<a class="dropdown-item" href="https://tryhackme.com/api/room/manage/clone/thelayoftheland" id="clone-room" style="display: none;"><i class="far fa-clone faded"></i> Clone Room</a>
<a class="dropdown-item preventDefault" id="writeups-simple" style="display: inline-block;"><i class="fas fa-pen-alt faded"></i> Writeups</a>
<a class="dropdown-item preventDefault" data-toggle="modal" data-target="#resetUserProgressModal"><i class="fas fa-eraser faded"></i> Reset Progress</a>
<a class="dropdown-item preventDefault" id="leave-room"><i class="fas fa-sign-out-alt faded"></i> Leave</a>
</div>
</div>
<span id="bookmark" class="badge badge-secondary badge-bookmark ">
<img class="bookmark" src="./TryHackMe _ The Lay of the Land_files/bookmark.svg">
<span class="bookmark-popover" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="top" data-content="&lt;p class=&#39;mb-0&#39;&gt;Save room &lt;/p&gt;
" data-original-title="" title="">
</span>
</span>
</div>
</div>
<p class="mb0 faded" id="description">Learn about and get hands-on with common technologies and security products used in corporate environments; both host and network-based security solutions are covered.</p>
</div>
</div>
</div>
</div>

</div>
</div>
<div id="room-banner-stats">
<div class="creators"></div>
<div class="numbers"></div>
</div>
</div>
</div>
<div class="container main pb">
<div id="room-message"></div>
<section id="sponsor">
<i id="sponsor-close" class="fas fa-times"></i>
<div id="sponsor-data"></div>
</section>
<div id="top-panel">
<ul class="nav nav-tabs" id="task-navs">
<li class="nav-item">
<a class="nav-link  active " data-toggle="tab" href="https://tryhackme.com/room/thelayoftheland#chart">
<i class="fas fa-chart-line icon-right"></i> Chart
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/thelayoftheland#scoreboard">
<i class="fas fa-trophy icon-right"></i> Scoreboard
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/thelayoftheland#chat">
<i class="fas fa-comments-alt icon-right chat-icon"></i> Discuss
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/thelayoftheland#writeups">
<i class="fas fa-pen-alt icon-right"></i> Writeups
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/thelayoftheland#about">
<i class="fas fa-info-circle icon-right"></i> More
</a>
</li>
</ul>
<div class="card cd-2 nav-above-con" id="room-main">
<div class="card-body">
<span id="room-tabs">
<div class="tab-content">
<div id="chart" class="tab-pane  active ">
<span id="difficulty-bar">
    <span class="room-difficulty diff-text">
      Difficulty: 
        <span class="difficulty-easy">Easy</span>
    </span></span>
<br><div id="chart-data"></div>
</div>
<div id="scoreboard" class="tab-pane fade">
<table class="table table-striped table-bordered table-condensed table-header-rotated mb-0" id="scoreboard_table">
<thead>
<tr id="scoreboard_header">
<th>Rank</th>
<th>Username</th>
<th>Total Score</th>
</tr>
</thead>
<tbody id="scoreboard_body"></tbody>
</table>
</div>
<div id="chat" class="tab-pane fade">

<div class="row">
<div class="col-sm-6 text-center">
<h3 class="mb-2">Discord</h3>
<p>Come join our <a target="_blank" href="https://discord.gg/QgC6Tdk">Discord</a> server for support or further discussions</p>
</div>
<div class="col-sm-6 text-center">
<h3 class="mb-2">Forum</h3>
<div id="forum-text">Read or post on the dedicated forum <a href="https://tryhackme.com/forum/thread/61f93b3bab7344005d816870">post</a></div>
</div>
</div>
</div>
<div id="writeups" class="tab-pane text-center">
<div id="writeups-data">There are no writeups submitted.</div>
<button onclick="showWriteupForm(this)" type="button" class="btn btn-xs btn-secondary mt-3 mb-2">Add Writeup</button>
<div id="writeup-form">
<div class="form-row">
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-title" placeholder="Writeup Title">
</div>
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-link" placeholder="Writeup URL">
</div>
<div class="col-auto">
<button id="submit-writeup" type="submit" class="btn btn-success mb-2">Submit</button>
</div>
</div>
<p class="faded mb-0 size-14"><i class="fas fa-exclamation-triangle text-warning"></i> Writeups should have a link to TryHackMe and not include any passwords/cracked hashes/flags</p>
</div>
</div>
<div id="about" class="tab-pane text-center">
<p id="about-freeRoom"><p class="mb-0">Only subscribers can deploy virtual machines in this room! 
        Go to your <a href="https://tryhackme.com/profile">profile</a> page to subscribe (if you have not already). 13474 users are in here and this room is 531 days old.</p></p>
<p id="about-owner"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ The Lay of the Land_files/af7feb2c43a2c7d5f111b98ccbd15048.png"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme">tryhackme</a></p></p>
</div>
</div>
</span>
</div>
</div>
</div>
<div id="room-simple-video" class="card card-body cd-2"></div>
<div class="card mt-3 mb-3 cd-2 text-center" id="instance-info">
<div class="card-header card-header-red">Active Machine Information</div>
<div class="card-body">
<div class="row vertical-align-custom">
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3" id="table-machine-ip">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
</div>
</div>
</div>
<div id="task-list">
<div id="room-task-detail" class="mb-3"><span id="progress-bar" style="display: block;"><div class="progress"><div class="progress-bar bg-success" role="progressbar" style="width: 100%; aria-valuemin=" 0"="" aria-valuemax="100"> 100%</div></div></span></div>
<div id="taskContent"><div class="card" id="task-1">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse1" aria-expanded="true">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 1                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Introduction
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse1" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">It is essential to be familiar with the environment where you have initial access to a compromised machine during a red team engagement. Therefore, performing reconnaissance and enumeration is a significant part, and the primary goal is to gather as much information as possible to be used in the next stage.&nbsp;</span></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">With an initial foothold established, the post-exploitation process begins!&nbsp;</span></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><br></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">This room introduces commonly-used concepts, technologies, and security products that we need to be aware of.</span></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">In this room, the assumption is that we have already gained access to the machine, and we are ready to expand our knowledge more about the environment by performing enumerating for the following:</span></p><p></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"></p><p></p><ul style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Network infrastrucutre</span></li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Active Directory Environment</span></li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Users and Groups</span></li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Host-based security solutions</span></li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Network-based security solutions</span></li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Applications and services</span></li></ul></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Let's start learning!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="1">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-2">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse2">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 2                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Deploy the VM
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-server text-lgreen" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a deployable machine"></i></span>
                        </a>
                    </div>
                    <div id="collapse2" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><div class="btn-group mb-3 ml-3 float-right">
            <button type="button" class="btn btn-success" value="61e54f96c6f022004bda4e39" onclick="deploy(this)"><i class="fas fa-play mr-2"></i> Start Machine</button>
        </div> <div>In order to follow along with the task content and apply what is given in this room,&nbsp;<u>you need to</u><u>&nbsp;start the attached machine by using the green Start Machine button in this task, and wait a few minutes for it to boot up.</u><span style="font-size:1rem"><span>&nbsp;To access the attached machine, you can either use the split in browser view or connect through the <a class="vCBLoxE7 glossary-term" onclick="initPopOver(&#39;RDP&#39;, &#39;vCBLoxE7&#39;)">RDP</a>.</span></span></div><div><span style="font-size:1rem"><br></span></div><div><span style="font-size:1rem"><span>If you prefer to connect via <a class="BPX7hXl6 glossary-term" onclick="initPopOver(&#39;RDP&#39;, &#39;BPX7hXl6&#39;)">RDP</a>, make sure you deploy the AttackBox or connect</span></span><u>&nbsp;to the VPN</u><span style="font-size:1rem">.</span><span style="font-size:1rem"><br></span></div><div><span style="font-size:1rem">Use the following credentials:&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">kkidd:Pass123321@</span><span style="font-size:1rem">.</span></div><div><span style="font-size:1rem"><br></span></div>
<div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top">Terminal</div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@machine</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">xfreerdp /v:MACHINE_IP /u:kkidd</span></span></code>
	    </pre></div></div></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Let's discuss the common network infrastructure in the next task!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-3">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse3">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 3                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Network Infrastructure
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse3" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p>Once arriving onto an unknown network, our first goal is to identify where we are and what we can get to. During the red team engagement, we need to understand what target system we are dealing with, what service the machine provides, what kind of network we are in. Thus, the enumeration of the compromised machine after getting initial access is the key to answering these questions.&nbsp;<span style="font-size:1rem">This task will discuss the common types of networks we may face during the engagement.</span></p><p>Network segmentation is an extra layer of network security divided into multiple subnets. It is used to improve the security and management of the network. For example, it is used for preventing unauthorized access to corporate most valuable assets such as customer data, financial records, etc.</p><p>The Virtual Local Area Networks (VLANs) is a network technique used in network segmentation to control networking issues, such as broadcasting issues in the local network, and improve security.&nbsp;Hosts within the VLAN can only communicate with other hosts in the same VLAN network.&nbsp;</p><p>If you want to learn more about network fundamentals, we suggest trying the following TryHackMe module:&nbsp;<a href="https://tryhackme.com/module/network-fundamentals" target="_blank">Network Fundamentals</a><span style="font-size:1rem">.</span></p><p style="line-height:1"><span style="font-size:24px">Internal Networks</span></p><p>Internal Networks are subnetworks that are segmented and separated based on the importance of the internal device or the importance of the accessibility of its data.&nbsp;The main purpose of the internal network(s) is to share information, faster and easier communications, collaboration tools, operational systems, and network services within an organization.&nbsp;<span style="font-size:1rem">In a corporate network, the network administrators intend to use network segmentation for various reasons, including controlling network traffic, optimizing network performance, and improving security posture.&nbsp;</span></p><p style="text-align:center"><img src="./TryHackMe _ The Lay of the Land_files/f86b9cce1276f4c317bcb4bae7686891.png" style="width:762px;height:473.733px"><br></p><p><span>The previous diagram is an example of the simple concept of network segmentation as the network is divided into two networks. The first one is for employee workstations and personal devices. The second is for private and internal network devices that provide internal services such as <a class="ZCDpfesF glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;ZCDpfesF&#39;)">DNS</a>, internal web, email services, etc.</span></p><div><p style="line-height:1"><span style="font-size:18px"><span style="font-size:24px"><span>A Demilitarized Zone (<a class="LFHT8SRS glossary-term" onclick="initPopOver(&#39;DMZ&#39;, &#39;LFHT8SRS&#39;)">DMZ</a>)</span></span></span></p><p><span>A <a class="jNEk7hPF glossary-term" onclick="initPopOver(&#39;DMZ&#39;, &#39;jNEk7hPF&#39;)">DMZ</a> Network is an edge network that protects and adds an extra security layer to a corporation's internal local-area network from untrusted traffic. A common design for DMZ is a subnetwork that sits between the public internet and internal networks.</span><br></p><p><span>Designing a network within the company depends on its requirements and need. For example, suppose a company provides public services such as a website, <a class="DfQRPAvh glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;DfQRPAvh&#39;)">DNS</a>, FTP, Proxy, VPN, etc. In that case, they may design a DMZ network to isolate and enable access control on the public network traffic, untrusted traffic.</span></p></div><p style="text-align:center"><img src="./TryHackMe _ The Lay of the Land_files/df4d771470f80491ece99e42ee574ebf.png" style="width:654px;height:518.578px"><br></p><p><span>In the previous diagram, we represent the network traffic to the <a class="5AwzuWkP glossary-term" onclick="initPopOver(&#39;DMZ&#39;, &#39;5AwzuWkP&#39;)">DMZ</a> network in red color, which is untrusted ( comes directly from the internet). The green network traffic between the internal network is the controlled traffic that may go through one or more than one network security device(s).</span></p><p><span>Enumerating the system and the internal network is the discovering stage, which allows the attacker to learn about the system and the internal network. Based on the gained information, we use it to process lateral movement or privilege escalation to gain more privilege on the system or the <a class="fRl7Y3Og glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;fRl7Y3Og&#39;)">AD</a> environment.</span></p><p style="line-height:1"><span style="font-size:1rem"><span style="font-size:24px">Network Enumeration</span></span></p><p><span>There are various things to check related to networking aspects such as <a class="5q6iKrM7 glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;5q6iKrM7&#39;)">TCP</a> and UDP ports and established connections, routing tables, ARP tables, etc.</span></p><p><span>Let's start checking the target machine's <a class="AlVKG1tz glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;AlVKG1tz&#39;)">TCP</a> and UDP open ports. This can be done using the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">netstat</span><span style="font-size:1rem">&nbsp;</span>command as shown below.

</p><div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top">Command Prompt</div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output"><span>PS C:\Users\thm&gt; netstat -na

Active Connections

  Proto  Local Address          Foreign Address        State
  TCP    0.0.0.0:80             0.0.0.0:0              LISTENING
  TCP    0.0.0.0:88             0.0.0.0:0              LISTENING
  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING
  TCP    0.0.0.0:389            0.0.0.0:0              LISTENING</span></span></code>
	    </pre>
	</div>
</div>
<p><span>The output reveals the open ports as well as the established connections. Next, let's list the <a class="oQrblk28 glossary-term" onclick="initPopOver(&#39;ARP&#39;, &#39;oQrblk28&#39;)">ARP</a> table, which contains the IP address and the physical address of the computers that communicated with the target machines within the network. This could be helpful to see the communications within the network to scan the other machines for open ports and vulnerabilities.</span></p>
<div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top">Command Prompt</div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">PS C:\Users\thm&gt; arp -a

Interface: 10.10.141.51 --- 0xa
  Internet Address      Physical Address      Type
  10.10.0.1             02-c8-85-b5-5a-aa     dynamic
  10.10.255.255         ff-ff-ff-ff-ff-ff     static</span></code>
	    </pre>
	</div>
</div>
<p><span style="font-size:1rem"><span style="font-size:24px">Internal Network Services</span></span><br></p><p><span>It provides private and internal network communication access for internal network devices. An example of network services is an internal <a class="Dt7bfzo7 glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;Dt7bfzo7&#39;)">DNS</a>, web servers, custom applications, etc. It is important to note that the internal network services are not accessible outside the network. However, once we have initial access to one of the networks that access these network services, they will be reachable and available for communications.&nbsp;</span></p><p><span>We will discuss more Windows applications and services in Task 9, including <a class="vqxcCeMX glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;vqxcCeMX&#39;)">DNS</a> and custom web applications.</span></p>
</div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Read the above!<br>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-4">
                    <div class="card-header task-header collapsed" data-toggle="collapse" href="#collapse4" aria-expanded="false">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 4                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Active Directory (AD) environment
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse4" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="line-height:1"><span style="font-size:24px"><span>What is the Active Directory (<a class="Zh4icJ40 glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;Zh4icJ40&#39;)">AD</a>) environment?</span></span></p><p style="text-align:center;line-height:1"><img src="./TryHackMe _ The Lay of the Land_files/a8e30315a65f3451771a2e038864fdee.png" style="width:305.297px;height:305.297px" alt=" "><span style="font-size:24px"><br></span></p><div style="text-align:center"></div><p>It is a Windows-based directory service that stores and provides data objects to the internal network environment. It allows for centralized management of authentication and authorization.&nbsp;<span style="font-size:1rem"><span>The <a class="kfrsadi3 glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;kfrsadi3&#39;)">AD</a> contains essential information about the network and the environment, including users, computers, printers, etc. For example, AD might have users' details such as job title, phone number, address, passwords, groups, permission, etc.</span></span></p><p style="text-align:center"><img src="./TryHackMe _ The Lay of the Land_files/59664b98a3a0b01cf6b7e83e039ddb84.png" style="width:638.141px;height:565.953px"><span style="font-size:1rem"><br></span></p><p><span>The diagram is one possible example of how Active Directory can be designed. The <a class="j2zZnLa7 glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;j2zZnLa7&#39;)">AD</a> controller is placed in a subnet for servers (shown above as server network), and then the AD clients are on a separate network where they can join the domain and use the AD services via the firewall.</span></p><p><span style="font-size:1rem">The following is a list of Active Directory components that we need to be familiar with:</span></p><ul><li>Domain Controllers</li><li>Organizational Units</li><li><span><a class="IsiUyG3f glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;IsiUyG3f&#39;)">AD</a> objects</span></li><li><span><a class="iqlGWfDm glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;iqlGWfDm&#39;)">AD</a> Domains</span></li><li>Forest</li><li><span><a class="ivqTjWTP glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;ivqTjWTP&#39;)">AD</a> Service Accounts: Built-in local users, Domain users, Managed service accounts</span></li><li><span style="font-size:1rem">Domain Administrators</span></li></ul><p><span style="font-size:1rem">A </span><b style="font-size:1rem">Domain Controller</b><span style="font-size:1rem"> is a Windows server that provides Active Directory services and controls the entire domain. </span>It is a form of centralized user management that provides<span style="font-size:1rem">&nbsp;encryption of user data as well as controlling access to a network, including users, groups, policies, and computers. </span>It also enables resource access and sharing.<span style="font-size:1rem">&nbsp;</span>These are all reasons why attackers target a domain controller in a domain because it contains a lot of high-value information.<br></p><p style="text-align:center"><img src="./TryHackMe _ The Lay of the Land_files/c982e300552d540f0fc456cc05be21cd.png" style="width:901px;height:486.101px"><br></p><p><b>Organizational Units (OU's)</b><span> are containers within the <a class="5fo7yDYm glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;5fo7yDYm&#39;)">AD</a> domain with a hierarchical structure.</span></p><p><b>Active Directory Objects&nbsp;</b><span style="font-size:1rem">can be a single user or a group, or a hardware component, such as a computer or printer.&nbsp;</span><span>Each domain holds a database that contains object identity information that creates an <a class="A9stF2UD glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;A9stF2UD&#39;)">AD</a> environment, including:</span></p><ul><li>Users - A security principal that is allowed to authenticate to machines in the domain</li><li>Computers - A special type of user accounts</li><li><span>GPOs - Collections of policies that are applied to other <a class="fmVjlCjO glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;fmVjlCjO&#39;)">AD</a> objects</span></li></ul><p><span style="font-weight:bolder"><span><a class="SdMyfLPm glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;SdMyfLPm&#39;)">AD</a> domains</span></span><span>&nbsp;are a collection of Microsoft components within an <a class="FzZDXvml glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;FzZDXvml&#39;)">AD</a> network.&nbsp;</span></p><p><span style="font-weight:bolder"><span><a class="Js222myG glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;Js222myG&#39;)">AD</a> Forest</span></span>&nbsp;is a collection of domains that trust each other.&nbsp;</p><p style="text-align:center"><br><img src="./TryHackMe _ The Lay of the Land_files/bb4bec81a78f745e8cbc38f7879002dd.png" style="width:825.76px;height:492.969px"></p><p><span style="background-color:transparent;font-size:1rem">For more information about the basics of Active Directory, we suggest trying the following TryHackMe room:&nbsp;</span><a href="https://tryhackme.com/room/winadbasics" target="_blank">Active Directory Basics</a><span style="background-color:transparent;font-size:1rem">.</span><br></p><p style="margin-top:0pt;margin-bottom:0pt;color:rgb(14, 16, 26);background:transparent;list-style-type:disc"><span style="font-size:1rem;color:rgb(33, 37, 41)"><br></span><i><br></i></p><p style="margin-top:0pt;margin-bottom:0pt;background:transparent;list-style-type:disc"><span>Once Initial Access has been achieved, finding an <a class="ibcMlbkq glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;ibcMlbkq&#39;)">AD</a> environment in a corporate network is significant as the Active Directory environment provides a lot of information to joined users about the environment.</span><span style="color:rgb(33, 37, 41)"><span>&nbsp;As a red teamer, we take advantage of this by enumerating the <a class="8DhrHDhR glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;8DhrHDhR&#39;)">AD</a> environment and gaining access to&nbsp;</span></span>various details, which can then be used in the lateral movement stage.<br><br></p><p> </p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span>In order to check whether the Windows machine is part of the <a class="0UeGsNS3 glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;0UeGsNS3&#39;)">AD</a> environment or not, one way, we can use the command prompt&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">systeminfo</span><span style="font-size:1rem">&nbsp;</span>command. The output of the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">systeminfo</span><span style="font-size:1rem">&nbsp;</span><span>provides information about the machine, including the operating system name and version, hostname, and other hardware information as well as the <a class="Y1M1TUHF glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;Y1M1TUHF&#39;)">AD</a> domain.</span></p>
<div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Powershell</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">PS C:\Users\thm&gt; systeminfo | findstr Domain
OS Configuration:          Primary Domain Controller
Domain:                    thmdomain.com</span></code>
	    </pre></div></div>
<p>From the above output, we can see that the computer name is an&nbsp;AD&nbsp;with&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">thmdomain.com</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem"><span>as a&nbsp;domain name which confirms that it is a part of the <a class="HbwWZvVU glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;HbwWZvVU&#39;)">AD</a> environment.&nbsp;</span></span></p><p><span style="font-size:1rem">Note that if we get&nbsp;WORKGROUP&nbsp;in the domain section, then it means that this machine is part of a local workgroup.</span></p><p>Before going any further, ensure the attached machine is deployed and try what we discussed.<b><span> Is the attached machine part of the <a class="RWlK2uRA glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;RWlK2uRA&#39;)">AD</a> environment? (Y|N)</span></b><br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *" value="Y" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span>If it is part of an <a class="v8nc8ShG glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;v8nc8ShG&#39;)">AD</a> environment, </span><b>what is the domain name of the AD?</b></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: **********.***" value="thmredteam.com" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-5">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse5">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 5                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Users and Groups Management
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse5" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p></p><p></p><p><span style="font-size:1rem">In t</span><span style="font-size:1rem">his task, we will learn more about users and groups, especially within the Active Directory. Gathering information about the compromised machine is essential</span><span style="font-size:1rem">&nbsp;that could be used in the next stage. Account discovery is the first step once we have gained initial access to the compromised machine to understand what we have and what other accounts are in the system.&nbsp;</span></p><p style="text-align:center"><img src="./TryHackMe _ The Lay of the Land_files/d981e1c73997b17ace78454c87b8a8c1.png" style="width:291.747px;height:272.297px" alt=" "></p><p>An Active Directory environment contains various accounts with the necessary permissions, access, and roles for different purposes. Common Active Directory service accounts include built-in local user accounts, domain user accounts, managed service accounts, and virtual accounts.&nbsp;</p><ul><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span>The built-in local users' accounts are used to manage the system locally, which is not part of the <a class="Gebim3Ks glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;Gebim3Ks&#39;)">AD</a> environment.</span></span></li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span>Domain user accounts with access to an active directory environment can use the <a class="RADuIF0T glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;RADuIF0T&#39;)">AD</a> services (managed by AD).</span></span></li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span><a class="qtVsmXIj glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;qtVsmXIj&#39;)">AD</a> managed service accounts are limited domain user account with higher privileges to manage AD services.</span></span></li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span>Domain Administrators are user accounts that can manage information in an Active Directory environment, including <a class="TM1c26Rn glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;TM1c26Rn&#39;)">AD</a> configurations, users, groups, permissions, roles, services, etc. One of the red team goals in engagement is to hunt for information that leads to a domain administrator having complete control over the AD environment.</span></span></li></ul><p style="margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26);list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">The following are Active Directory Administrators accounts:</span></p><p style="margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26);list-style-type:disc"><span style="color:rgb(33, 37, 41);font-size:1rem"><br></span></p><table class="table table-bordered" style="width:1076px"><tbody><tr><td>BUILTIN\Administrator</td><td>Local admin access on a domain controller</td></tr><tr><td>Domain Admins</td><td>Administrative access to all resources in the domain</td></tr><tr><td>Enterprise Admins</td><td>Available only in the forest root</td></tr><tr><td>Schema Admins</td><td>Capable of modifying domain/forest; useful for red teamers</td></tr><tr><td>Server Operators</td><td>Can manage domain servers</td></tr><tr><td>Account Operators</td><td>Can manage users that are not in privileged groups</td></tr></tbody></table><p style="margin-top:0pt;margin-bottom:0pt;background:transparent;list-style-type:disc"><span style="font-size:1rem"><span>Now that we learn about various account types within the <a class="9rkKcrd9 glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;9rkKcrd9&#39;)">AD</a> environment. </span></span>Let's enumerate the Windows machine<span style="font-size:1rem"><span>&nbsp;that we have access to during the initial access stage. As a current user, we have specific permissions to view or manage things within the machine and the <a class="rzxonKH5 glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;rzxonKH5&#39;)">AD</a> environment.&nbsp;</span></span></p><b>
</b><p></p><p><span style="font-size:24px"><span>Active Directory (<a class="9TQEvxis glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;9TQEvxis&#39;)">AD</a>) Enum</span></span></p><p></p><p><span>Now, enumerating in the <a class="DJL93SL3 glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;DJL93SL3&#39;)">AD</a> environment requires different tools and techniques.</span><span style="font-size:18px"><span style="font-size:16px"><span>&nbsp;Once we confirm that the machine is part of the <a class="J39TtWsV glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;J39TtWsV&#39;)">AD</a> environment, we can start hunting for any variable info that may be used later. In this stage, we are using PowerShell to enumerate for users and groups.</span></span></span></p><p><span style="font-size:18px"><span style="font-size:16px"><span>The following <a class="chun93AJ glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;chun93AJ&#39;)">PowerShell</a> command is to get all active directory user accounts. Note that we need to use &nbsp;</span></span></span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-top-left-radius:3px;border-top-right-radius:3px;border-bottom-right-radius:3px;border-bottom-left-radius:3px;font-size:13.6px;padding:0.2em 0.4em">-Filter</span><span style="font-size:1rem">&nbsp;</span>argument.</p>
<div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top"><span><a class="GecCiSd1 glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;GecCiSd1&#39;)">PowerShell</a></span></div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">PS C:\Users\thm&gt; Get-ADUser  -Filter *
DistinguishedName : CN=Administrator,CN=Users,DC=thmredteam,DC=com
Enabled           : True
GivenName         :
Name              : Administrator
ObjectClass       : user
ObjectGUID        : 4094d220-fb71-4de1-b5b2-ba18f6583c65
SamAccountName    : Administrator
SID               : S-1-5-21-1966530601-3185510712-10604624-500
Surname           :
UserPrincipalName :
PS C:\Users\thm&gt;</span></code>
	    </pre>
	</div>
</div>
<p><span style="font-size:1rem">We can also use the </span><a href="http://www.ietf.org/rfc/rfc2253.txt" target="_blank">LDAP hierarchical tree structure</a><span style="font-size:1rem"><span> to find a user within the <a class="1xgd899V glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;1xgd899V&#39;)">AD</a> environment. The Distinguished Name (DN) is a collection of comma-separated key and value pairs used to identify unique records within the directory. The DN consists of Domain Component (DC), OrganizationalUnitName (OU), Common Name (CN), and others. The following&nbsp;</span></span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">"CN=User1,CN=Users,DC=thmredteam,DC=com"</span><span style="font-size:1rem">&nbsp;is an example of DN, which can be visualized as follow:</span><br></p><p style="text-align:center"><img src="./TryHackMe _ The Lay of the Land_files/764c72d40ec3d823b05d6473702e00f5.png" style="width:347.5px;height:261.265px"></p><p><span style="font-size:1rem">Using the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">SearchBase</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">option, we specify a specific Common-Name&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">CN</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">in the active directory. For example, we can specify to list any user(s) that part of&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Users</span><span style="font-size:1rem">.</span><br></p><p></p>
<div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top"><span><a class="cSvQnCR1 glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;cSvQnCR1&#39;)">PowerShell</a></span></div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">PS C:\Users\thm&gt; Get-ADUser -Filter * -SearchBase "CN=Users,DC=THMREDTEAM,DC=COM"


DistinguishedName : CN=Administrator,CN=Users,DC=thmredteam,DC=com
Enabled           : True
GivenName         :
Name              : Administrator
ObjectClass       : user
ObjectGUID        : 4094d220-fb71-4de1-b5b2-ba18f6583c65
SamAccountName    : Administrator
SID               : S-1-5-21-1966530601-3185510712-10604624-500
Surname           :
UserPrincipalName :</span></code>
	    </pre>
	</div>
</div>
<p>Note that the result may contain more than one user depending on the configuration of the CN. Try the command to find all users within the THM&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em"><span><a class="ZErlrPpF glossary-term" onclick="initPopOver(&#39;OU&#39;, &#39;ZErlrPpF&#39;)">OU</a></span></span><span style="font-size:1rem">&nbsp;</span>and answer question 1 below.</p><p></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Use the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Get-ADUser -Filter * -SearchBase</span><span style="font-size:1rem">&nbsp;command to list the available user accounts within&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">THM</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem"><span><a class="hoSEEr8Y glossary-term" onclick="initPopOver(&#39;OU&#39;, &#39;hoSEEr8Y&#39;)">OU</a> in the&nbsp;</span></span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">thmredteam.com</span><span style="font-size:1rem">&nbsp;domain. How many users are available?</span>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *" value="6" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Once you run the previous command, what is the&nbsp;UserPrincipalName (email) of the admin account?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *******************.***" value="thmadmin@thmredteam.com" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-6">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse6">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 6                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Host Security Solution #1
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse6" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p>Before performing further actions, we need to obtain general knowledge about the security solutions in place. Remember, it is important to enumerate antivirus and security detection methods on an endpoint in order to stay as undetected as possible and reduce the chance of getting caught.</p><p>This task will discuss the common security solution used in corporate networks, divided into&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Host</span><span style="font-size:1rem">&nbsp;</span>and&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Network</span><span style="font-size:1rem">&nbsp;</span>security solutions.</p><p><span style="font-size:24px">Host Security Solutions</span></p><p style="text-align:center"><img src="./TryHackMe _ The Lay of the Land_files/0e69d6b953d1c9c11d8581d31ea246d8.png" style="width:50%" alt=" "><span style="font-size:24px"><br></span></p><p style="text-align:center"></p><p>It is a set of software applications used to monitor and detect abnormal and malicious activities within the host, including:</p><ol><li><span style="font-size:1rem">Antivirus software</span><br></li><li>Microsoft Windows Defender</li><li>Host-based Firewall</li><li>Security Event Logging and Monitoring&nbsp;<br></li><li><span>Host-based Intrusion Detection System (<a class="0kKK29cs glossary-term" onclick="initPopOver(&#39;HIDS&#39;, &#39;0kKK29cs&#39;)">HIDS</a>)/ Host-based Intrusion Prevention System (HIPS)</span></li><li><span>Endpoint Detection and Response (<a class="UMmOgded glossary-term" onclick="initPopOver(&#39;EDR&#39;, &#39;UMmOgded&#39;)">EDR</a>)</span></li></ol>

<p>Let's go more detail through the host-based security solutions that we may encounter during the red team engagement.</p><p><span style="font-size:24px"><span>Antivirus Software (<a class="s9ui8FP2 glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;s9ui8FP2&#39;)">AV</a>)</span></span><br></p><p>Antivirus software also known as anti-malware, is mainly used to monitor, detect, and prevent malicious software from being executed within the host.&nbsp;<span style="font-size:1rem">&nbsp;Most antivirus software applications use well-known features, including Background scanning, Full system scans, Virus definitions. In the background scanning, the antivirus software works in real-time and scans all open and used files in the background. The full system scan is essential when you first install the antivirus. The most interesting part is the virus definitions, where antivirus software replies to the pre-defined virus. That's why antivirus software needs to update from time to time.</span></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">There are various detection techniques that the antivirus uses, including</span></p><ul style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Signature-based detection</span></li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Heuristic-based detection</span></li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Behavior-based detection</span></li></ul><p></p>
<p><strong>Signature-based detection</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span>&nbsp;is one of the common and traditional techniques used in antivirus software to identify malicious files. Often, researchers or users submit their infected files into an antivirus engine platform for further analysis by <a class="aWvPLxbU glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;aWvPLxbU&#39;)">AV</a> vendors, and if it confirms as malicious, then the signature gets registered in their database. The antivirus software</span></span><span style="background-color:transparent;color:rgb(14, 16, 26);font-size:1rem">&nbsp;compares the scanned file with a database of known signatures for possible attacks and malware on the client-side. If we have a match, then it considers a threat.</span></p>
<p><strong>Heuristic-based detection</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">&nbsp;uses machine learning to decide whether we have the malicious file or not. It scans and statically analyses in real-time in order to find suspicious properties in the application's code or check whether it uses uncommon Windows or system APIs. It does not rely on the signature-based attack in making the decisions, or sometimes it does. This depends on the implementation of the antivirus software.</span><br></p>
<p><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Finally,&nbsp;</span><strong>Behavior-based detection</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">&nbsp;relies on monitoring and examining the execution of applications to find abnormal behaviors and uncommon activities, such as creating/updating values in registry keys, killing/creating processes, etc.</span></p>





<p></p><p><span>As a red teamer, it is essential to be aware of whether antivirus exists or not. It prevents us from doing what we are attempting to do. We can enumerate <a class="x9eOZ30E glossary-term" onclick="initPopOver(&#39;AV&#39;, &#39;x9eOZ30E&#39;)">AV</a> software using Windows built-in tools, such as&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">wmic</span><span style="font-size:1rem">.</span></p>
<div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span><a class="QRCpgOiw glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;QRCpgOiw&#39;)">PowerShell</a></span><br></div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">PS C:\Users\thm&gt; wmic /namespace:\\root\securitycenter2 path antivirusproduct</span></code>
	    </pre></div></div>
<p><span>This also can be done using <a class="lwhwAbHg glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;lwhwAbHg&#39;)">PowerShell</a>, which gives the same result.</span></p>
<div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span><a class="99DaEYWa glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;99DaEYWa&#39;)">PowerShell</a></span></div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">PS C:\Users\thm&gt; Get-CimInstance -Namespace root/SecurityCenter2 -ClassName AntivirusProduct


displayName              : Bitdefender Antivirus
instanceGuid             : {BAF124F4-FA00-8560-3FDE-6C380446AEFB}
pathToSignedProductExe   : C:\Program Files\Bitdefender\Bitdefender Security\wscfix.exe
pathToSignedReportingExe : C:\Program Files\Bitdefender\Bitdefender Security\bdservicehost.exe
productState             : 266240
timestamp                : Wed, 15 Dec 2021 12:40:10 GMT
PSComputerName           :

displayName              : Windows Defender
instanceGuid             : {D58FFC3A-813B-4fae-9E44-DA132C9FAA36}
pathToSignedProductExe   : windowsdefender://
pathToSignedReportingExe : %ProgramFiles%\Windows Defender\MsMpeng.exe
productState             : 393472
timestamp                : Fri, 15 Oct 2021 22:32:01 GMT
PSComputerName           :</span></code>
	    </pre></div></div>



<p>As a result, there is a third-party antivirus (Bitdefender Antivirus) and Windows Defender installed on the computer.&nbsp;<strong>Note&nbsp;</strong><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">that Windows servers may not have&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">SecurityCenter2</span><span style="color:rgb(33, 37, 41);font-size:1rem">&nbsp;</span><span>namespace, which may not work on the attached <a class="jQgrVFiJ glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;jQgrVFiJ&#39;)">VM</a>. Instead, it works for Windows workstations!</span></span></p><p><span style="box-sizing:border-box;color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;orphans:2;text-align:left;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial"></span></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:1rem;orphans:2;text-align:left;text-indent:0px;widows:2;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial"><span style="color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:24px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;-webkit-text-stroke-width:0px;box-sizing:border-box">Microsoft Windows Defender</span></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:1rem;orphans:2;text-align:left;text-indent:0px;widows:2;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial">Microsoft Windows Defender is a pre-installed antivirus security tool that runs on endpoints. It uses various algorithms in the detection, including machine learning, big-data analysis, in-depth threat resistance research, and Microsoft cloud infrastructure in protection against malware and viruses. MS Defender works in three protection modes: Active, Passive, Disable modes.&nbsp;</p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:1rem;orphans:2;text-align:left;text-indent:0px;widows:2;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial"><span style="font-size:1rem"><b>Active</b> mode is used where the MS Defender runs as the primary antivirus software on the machine where provides protection and remediation. <b>Passive </b>mode is run when a 3rd party antivirus software is installed. Therefore, it works as secondary antivirus software where it scans files and detects threats but does not provide remediation. Finally, <b>Disable </b>mode is when the MS Defender is disabled or uninstalled from the system.</span></p><p><span style="caret-color:rgb(64, 64, 64);color:rgb(64, 64, 64);font-family:Ubuntu, arial, helvetica, sans-serif;font-size:16px"><span>&nbsp;We can use the following <a class="tW5rdsFg glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;tW5rdsFg&#39;)">PowerShell</a> command to&nbsp;</span></span><span style="box-sizing:inherit;caret-color:rgb(0, 0, 0);color:var(--link-color);font-size:16px">check</span><span style="caret-color:rgb(64, 64, 64);color:rgb(64, 64, 64);font-family:Ubuntu, arial, helvetica, sans-serif;font-size:16px">&nbsp;the service state of Windows Defender:</span></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span><a class="0rShgUd0 glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;0rShgUd0&#39;)">PowerShell</a></span></div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">PS C:\Users\thm&gt; Get-Service WinDefend

Status   Name               DisplayName
------   ----               -----------
Running  WinDefend          Windows Defender Antivirus Service</span></code>
	    </pre></div></div><p>Next, we can start using the<span style="font-size:1rem">&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Get-MpComputerStatus</span><span style="font-size:1rem">&nbsp;</span>cmdlet to get the current Windows Defender status. However, it&nbsp;<span style="font-size:1rem">provides the current status of security solution elements</span><span style="font-size:1rem">, including&nbsp;</span><span style="font-size:1rem">Anti-Spyware, Antivirus, LoavProtection, Real-time protection, etc</span><span style="font-size:1rem">. We can use&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">select</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">to specify what we need for as follows,</span></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span><a class="yb9vY9sq glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;yb9vY9sq&#39;)">PowerShell</a></span></div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">PS C:\Users\thm&gt; Get-MpComputerStatus | select RealTimeProtectionEnabled

RealTimeProtectionEnabled
-------------------------
                    False</span></code>
	    </pre></div></div><p><span style="font-size:1rem">As a result,&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">MpComputerStatus</span><span style="font-size:1rem">&nbsp;highlights whether Windows Defender is enabled or not.</span><br></p><p><span style="font-size:1rem">3.&nbsp;</span><span style="font-size:1rem;font-weight:bolder">Host-based Firewall</span><span style="font-size:1rem">: It is a security tool installed and run on a host machine that can prevent and block attacker or red teamers' attack attempts. Thus, it is essential to enumerate and gather details about the firewall and its rules within the machine we have initial access to.&nbsp;&nbsp;</span></p><p style="text-align:center"><img src="./TryHackMe _ The Lay of the Land_files/397c848fb415b72ce235915dea420900.png" style="width:50%" alt=" "><span style="font-size:1rem"><br></span></p><p style="text-align:center"></p><div style="text-align:center"><p></p></div>
<p>The main purpose of the host-based firewall is to control the inbound and outbound traffic that goes through the device's interface. It protects the host from untrusted devices that are on the same network. A modern host-based firewall uses multiple levels of analyzing traffic, including packet analysis, while establishing the connection.</p><p>A firewall acts as control access at the network layer. It is capable of allowing and denying network packets. For example, a firewall can be configured to block ICMP packets sent through the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">ping</span><span style="font-size:1rem">&nbsp;</span>command from other machines in the same network. Next-generation firewalls also can inspect other OSI layers, such as application layers. Therefore, it can detect and block SQL injection and other application-layer attacks.</p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span><a class="zdIAFUG5 glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;zdIAFUG5&#39;)">PowerShell</a></span></div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">PS C:\Users\thm&gt; Get-NetFirewallProfile | Format-Table Name, Enabled

Name    Enabled
----    -------
Domain     True
Private    True
Public     True</span></code>
	    </pre></div></div><p>If we have admin privileges on the current user we logged in with, then we try to disable one or more than one firewall profile using the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Set-NetFirewallProfile</span><span style="font-size:1rem">&nbsp;cmdlet</span><span style="font-size:1rem">.</span></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span><a class="BZ85FqZ3 glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;BZ85FqZ3&#39;)">PowerShell</a></span></div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">PS C:\Windows\system32&gt; Set-NetFirewallProfile -Profile Domain, Public, Private -Enabled False
PS C:\Windows\system32&gt; Get-NetFirewallProfile | Format-Table Name, Enabled
---- -------
Domain False
Private False
Public False</span></code>
	    </pre><div><span style="font-size:1rem">We can also learn and check the current&nbsp;</span><span style="font-size:1rem">Firewall rules, whether allowing or denying by the firewall.<p></p></span></div></div></div><div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span><a class="LiUEIQQe glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;LiUEIQQe&#39;)">PowerShell</a></span></div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output"><span>PS C:\Users\thm&gt; Get-NetFirewallRule | select DisplayName, Enabled, Description

DisplayName                                                                  Enabled
-----------                                                                  -------
Virtual Machine Monitoring (DCOM-In)                                           False
Virtual Machine Monitoring (Echo Request - ICMPv4-In)                          False
Virtual Machine Monitoring (Echo Request - ICMPv6-In)                          False
Virtual Machine Monitoring (NB-Session-In)                                     False
Virtual Machine Monitoring (RPC)                                               False
SNMP Trap Service (UDP In)                                                     False
SNMP Trap Service (UDP In)                                                     False
Connected User Experiences and Telemetry                                        True
Delivery Optimization (TCP-In)                                                  True</span></span></code>
	    </pre></div></div>
<p><span>During the red team engagement, we have no clue what the firewall blocks. However, we can take advantage of some <a class="835NXReX glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;835NXReX&#39;)">PowerShell</a> cmdlets such as </span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Test-NetConnection</span>&nbsp;and&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">TcpClient</span>. Assume we know that a firewall is in place, and we need to test inbound connection without extra tools, then we can do the following:&nbsp;</p>

<div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span><a class="lpUrvOun glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;lpUrvOun&#39;)">PowerShell</a></span></div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">PS C:\Users\thm&gt; Test-NetConnection -ComputerName 127.0.0.1 -Port 80


ComputerName     : 127.0.0.1
RemoteAddress    : 127.0.0.1
RemotePort       : 80
InterfaceAlias   : Loopback Pseudo-Interface 1
SourceAddress    : 127.0.0.1
TcpTestSucceeded : True

PS C:\Users\thm&gt; (New-Object System.Net.Sockets.TcpClient("127.0.0.1", "80")).Connected
True</span></code>
	    </pre></div></div>

<p>As a result, we can confirm the inbound connection on port 80 is open and allowed in the firewall. Note that we can also test for remote targets in the same network or domain names by specifying in the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">-ComputerName</span>&nbsp;argument for the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Test-NetConnection</span><span style="font-size:1rem">.&nbsp;</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Enumerate the attached Windows machine and check whether the host-based firewall is enabled or not! (Y|N)</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *" value="N" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span>Using <a class="5NeVrcrW glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;5NeVrcrW&#39;)">PowerShell</a> cmdlets such&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Get-MpThreat</span><span style="font-size:1rem">&nbsp;can provide us with threats details that have been detected using MS Defender. Run it and answer the following: What is the file name that causes this alert to record?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *********.***" value="PowerView.ps1" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Enumerate the firewall rules of the attached Windows machine. What is the port that is allowed under the <b>THM-Connection</b> rule?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *****" value="17337" disabled="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>In the next task, we will keep discussing the host security solution. I'm ready!<br></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="4">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-7">
                    <div class="card-header task-header collapsed" data-toggle="collapse" href="#collapse7" aria-expanded="false">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 7                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Host Security Solution #2
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse7" class="collapse show" data-parent="#taskContent" style="">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p>In this task, we will keep discussing host security solutions.</p><p><span style="font-size:24px">Security Event Logging and Monitoring&nbsp;</span></p><p style="text-align:center"><img src="./TryHackMe _ The Lay of the Land_files/980c1573a3ec3d309d0f2360c16b019a.png" style="width:50%" alt=" "></p><p>By default, Operating systems log various activity events in the system using log files. The event logging feature is available to the IT system and network administrators to monitor and analyze important events, whether on the host or the network side. In cooperating networks, security teams utilize the logging event technique to track and investigate security incidents.&nbsp;</p><p>There are various categories where the Windows operating system logs event information, including the application, system, security, services, etc. In addition, security and network devices store event information into log files to allow the system administrators to get an insight into what is going on.</p>
<p>We can get a list of available event logs on the local machine using the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Get-EventLog</span><span style="font-size:1rem">&nbsp;</span>cmdlet.</p>
<div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span><a class="HPVYv73I glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;HPVYv73I&#39;)">PowerShell</a></span></div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output"><span>PS C:\Users\thm&gt; Get-EventLog -List

  Max(K) Retain OverflowAction        Entries Log
  ------ ------ --------------        ------- ---
     512      7 OverwriteOlder             59 Active Directory Web Services
  20,480      0 OverwriteAsNeeded         512 Application
     512      0 OverwriteAsNeeded         170 Directory Service
 102,400      0 OverwriteAsNeeded          67 DNS Server
  20,480      0 OverwriteAsNeeded       4,345 System
  15,360      0 OverwriteAsNeeded       1,692 Windows PowerShell</span></span></code>
	    </pre></div></div>

<p> </p><p><span>Sometimes, the list of available event logs gives you an insight into what applications and services are installed on the machine! For example, we can see that the local machine has Active Directory, <a class="qqI07guv glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;qqI07guv&#39;)">DNS</a> server, etc. For more information about the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Get-EventLog</span><span style="font-size:1rem">&nbsp;</span>cmdlet with examples, visit the&nbsp;<a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-eventlog?view=powershell-5.1" target="_blank">Microsoft documents website</a>.</p><p>In corporate networks, log agent software is installed on clients to collect and gather logs from different sensors to analyze and monitor activities within the network. We will discuss them more in the Network Security Solution task.</p><p><span style="font-size:24px">System Monitor (Sysmon)</span></p><p style="text-align:center"><img src="./TryHackMe _ The Lay of the Land_files/8c77acd6d831c3b9f4c5b5f0cdc0d08c.png" style="width:345.5px;height:187.929px" alt=" "><span style="font-size:1rem"><br></span></p><p><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">Windows System Monitor&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">sysmon</span><span style="font-size:1rem">&nbsp;</span>is a service and device driver. It is one of the Microsoft Sysinternals suites. The&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">sysmon</span><span style="font-size:1rem">&nbsp;</span>tool is not an essential tool (not installed by default), but it starts gathering and logging events once installed. These logs indicators can significantly help system administrators and blue teamers to track and investigate malicious activity and help with general troubleshooting.</p><p>One of the great features of the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">sysmon</span><span style="font-size:1rem">&nbsp; tool is that it can log many important events, and you can also create your own rule(s) and configuration to monitor:</span></p><ul><li><span style="font-size:1rem">Process creation and termination</span></li><li><span style="font-size:1rem">Network connections</span></li><li>Modification on file</li><li>Remote threats</li><li>Process and memory access</li><li>and many others</li></ul><p>For learning more about&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">sysmon</span>, visit the Windows document page <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon" target="_blank">here</a>.</p><p>As a red teamer, one of the primary goals is to stay undetectable, so it is essential to be aware of these tools and avoid causing generating and alerting events. The following are some of the tricks that can be used to detect whether the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">sysmon</span><span style="font-size:1rem">&nbsp;</span>is available in the victim machine or not.&nbsp;</p><p>We can look for a process or service that has been named "Sysmon" within the current process or services as follows,</p>

<div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span><a class="wNJfw9x8 glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;wNJfw9x8&#39;)">PowerShell</a></span></div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">PS C:\Users\thm&gt; Get-Process | Where-Object { $_.ProcessName -eq "Sysmon" }

Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName
-------  ------    -----      -----     ------     --  -- -----------
    373      15    20212      31716              3316   0 Sysmon</span></code>
	    </pre></div></div>
<p>or look for services as follows,</p>
<div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span><a class="jYWXwm5L glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;jYWXwm5L&#39;)">PowerShell</a></span></div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">PS C:\Users\thm&gt; Get-CimInstance win32_service -Filter "Description = 'System Monitor service'"
</span><span class="token command"><span class="token shell-symbol important">#</span> <span class="token bash language-bash">or</span></span>
<span class="token output">Get-Service | where-object {$_.DisplayName -like "*sysm*"}</span></code>
	    </pre></div></div>
<p>It also can be done by checking the Windows registry&nbsp;</p>
<div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span><a class="ns2i1jmm glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;ns2i1jmm&#39;)">PowerShell</a></span></div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">PS C:\Users\thm&gt; reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-Sysmon/Operational</span></code>
	    </pre></div></div>
<p>All these commands confirm if the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">sysmon</span><span style="font-size:1rem">&nbsp;</span>tool is installed. Once we detect it, we can try to find the sysmon configuration file if we have readable permission to understand what system administrators are monitoring.<br></p>
<div class="terminal-container"><div class="terminal-content"><div class="terminal-top"><span><a class="yoT3ECZV glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;yoT3ECZV&#39;)">PowerShell</a></span></div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">PS C:\Users\thm&gt; findstr /si '&lt;ProcessCreate onmatch="exclude"&gt;' C:\tools\*
C:\tools\Sysmon\sysmonconfig.xml:      
C:\tools\Sysmon\sysmonconfig.xml:      </span></code>
	    </pre></div></div>
<p>For more detail about the Windows&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">sysmon</span><span style="font-size:1rem">&nbsp;</span>tool and how to utilize it within endpoints, we suggest trying the TryHackMe room: <a href="https://tryhackme.com/room/sysmon" target="_blank">Sysmon</a>.</p><p><span style="font-size:24px">Host-based Intrusion Detection/Prevention System (HIDS/HIPS)</span></p><p style="text-align:center"><img src="./TryHackMe _ The Lay of the Land_files/933d57959af6b3ac9396e688698bb358.png" style="width:50%" alt=" "></p><div><b><span><a class="gTLIdDN3 glossary-term" onclick="initPopOver(&#39;HIDS&#39;, &#39;gTLIdDN3&#39;)">HIDS</a> </span></b><span>stands for Host-based Intrusion Detection System. It is software that has the ability to monitor and detect abnormal and malicious activities in a host. The primary purpose of <a class="hY8AZgYB glossary-term" onclick="initPopOver(&#39;HIDS&#39;, &#39;hY8AZgYB&#39;)">HIDS</a> is to detect suspicious activities and not to prevent them. There are two methods that the host-based or network intrusion detection system works, including: </span></div><ul><li><span>Signature-based <a class="T42YKxSm glossary-term" onclick="initPopOver(&#39;IDS&#39;, &#39;T42YKxSm&#39;)">IDS</a> - it&nbsp;looks at checksums and message authentication.</span></li><li><span>Anomaly-based <a class="n7EJq4UU glossary-term" onclick="initPopOver(&#39;IDS&#39;, &#39;n7EJq4UU&#39;)">IDS</a> looks for unexpected activities, including abnormal bandwidth usage, protocols, and ports.</span></li></ul><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Host-based Intrusion Prevention Systems (</span><strong><span><a class="6QiVKSjj glossary-term" onclick="initPopOver(&#39;HIPS&#39;, &#39;6QiVKSjj&#39;)">HIPS</a></span></strong><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span>) works by securing the operating system activities which where is installed. It is a detecting and prevention solution against well-known attacks and abnormal behaviors. <a class="U9pUfHZI glossary-term" onclick="initPopOver(&#39;HIPS&#39;, &#39;U9pUfHZI&#39;)">HIPS</a> is capable of auditing log files of the host, monitoring processes, and protecting system resources. HIPS is a mixture of best product features such as antivirus, behavior analysis, network, application firewall, etc.</span></span></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><br></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">There is also a network-based IDS/IPS, which we will be covering in the next task.&nbsp;</span></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><br></span></p><p><span style="font-size:24px"><span>Endpoint Detection and Response (<a class="qqBaMJtN glossary-term" onclick="initPopOver(&#39;EDR&#39;, &#39;qqBaMJtN&#39;)">EDR</a>)</span></span></p><p style="text-align:center"><img src="./TryHackMe _ The Lay of the Land_files/92a60622a80d64cc6dbedaa6c207662b.png" style="width:515px;height:221.138px" alt=" "><span style="font-size:1rem"><b><br></b></span></p><p><span>It is also known as Endpoint Detection and Threat Response (EDTR). The <a class="q9mSFqUA glossary-term" onclick="initPopOver(&#39;EDR&#39;, &#39;q9mSFqUA&#39;)">EDR</a> is a cybersecurity solution that defends against malware and other threats. EDRs can look for malicious files, monitor endpoint, system, and network events, and record them in a database for further analysis, detection, and investigation. EDRs are the next generation of antivirus and detect malicious activities on the host in real-time.</span></p><p><span><a class="e0NRlZCI glossary-term" onclick="initPopOver(&#39;EDR&#39;, &#39;e0NRlZCI&#39;)">EDR</a> analyze system data and behavior for making section threats, including</span></p><ul><li>Malware, including viruses, trojans, adware, keyloggers</li><li>Exploit chains</li><li>Ransomware</li></ul><p><span>Below are some common <a class="i6Xixvsk glossary-term" onclick="initPopOver(&#39;EDR&#39;, &#39;i6Xixvsk&#39;)">EDR</a> software for endpoints</span></p><ul><li>Cylance</li><li>Crowdstrike</li><li>Symantec</li><li>SentinelOne</li><li>Many others</li></ul><p><span>Even though an attacker successfully delivered their payload and bypassed <a class="VgM7g2RU glossary-term" onclick="initPopOver(&#39;EDR&#39;, &#39;VgM7g2RU&#39;)">EDR</a> in receiving reverse shell, EDR is still running and monitors the system. It may block us from doing something else if it flags an alert.</span></p><p>We can use scripts for enumerating security products within the machine, such as&nbsp;<a href="https://github.com/PwnDexter/Invoke-EDRChecker" target="_blank">Invoke-EDRChecker</a>&nbsp;and<span style="font-size:1rem">&nbsp;</span><a href="https://github.com/PwnDexter/SharpEDRChecker" target="_blank">SharpEDRChecker</a><span style="font-size:1rem">. They c</span><span style="font-size:1rem"><span>heck for commonly used Antivirus, <a class="1wl9RfQ2 glossary-term" onclick="initPopOver(&#39;EDR&#39;, &#39;1wl9RfQ2&#39;)">EDR</a>, logging monitor products by</span></span><span style="font-size:1rem"><span>&nbsp;checking file metadata, processes, <a class="f5I30kPT glossary-term" onclick="initPopOver(&#39;DLL&#39;, &#39;f5I30kPT&#39;)">DLL</a> loaded into current processes, Services, and drivers, directories.</span></span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                We covered some of the common security endpoints we may encounter during the red team engagement. Let's discuss the network-based security solutions in the next task!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="7">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-8">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse8">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 8                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Network Security Solutions
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse8" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="text-align:center">This task will discuss network security solutions commonly seen and used in enterprises networks.</p><p><span style="font-size:24px">Network Security Solutions</span></p><p style="text-align:center"><img src="./TryHackMe _ The Lay of the Land_files/e11f81fc50e049855849e20d7f34e453.png" style="width:50%" alt=" "><span style="font-size:24px"><br></span></p><p style="text-align:center"></p><p>Network security solutions could be software or hardware appliances used to monitor, detect and prevent malicious activities within the network. It focuses on protecting clients and devices connected to the cooperation network. The network security solution includes but is not limited to:</p><ul><li>Network Firewall</li><li><span><a class="4woRiCmO glossary-term" onclick="initPopOver(&#39;SIEM&#39;, &#39;4woRiCmO&#39;)">SIEM</a></span></li><li>IDS/IPS</li></ul><p><span style="font-size:24px">Network Firewall</span></p><p style="text-align:center"><img src="./TryHackMe _ The Lay of the Land_files/e4a1c6568d8f21c9f0fb0ea8c193a880.png" style="width:50%" alt=" "><span style="font-size:24px"><br></span></p><p style="text-align:center"></p><p>A firewall is the first checkpoint for untrusted traffic that arrives at a network. The firewall filters the untrusted traffic before passing it into the network based on rules and policies. In addition, Firewalls can be used to separate networks from external traffic sources, internal traffic sources, or even specific applications.&nbsp;<span style="font-size:1rem">Nowadays, firewall products are built-in network routers or other security products that provide various security features. The following are some firewall types that enterprises may use.</span></p><ul><li>Packet-filtering firewalls </li><li>Proxy firewalls </li><li>NAT firewalls </li><li>Web application firewalls</li></ul><p><span style="font-size:24px"><span>Security Information and Event Management (<a class="hdfrLxrN glossary-term" onclick="initPopOver(&#39;SIEM&#39;, &#39;hdfrLxrN&#39;)">SIEM</a>)</span></span></p><p style="text-align:center"><img src="./TryHackMe _ The Lay of the Land_files/4a5624e396e6075fc18eae92f9d3d84e.png" style="width:50%" alt=" "><span style="font-size:24px"><br></span></p><p style="text-align:center"></p><p><span><a class="r11hQ6dL glossary-term" onclick="initPopOver(&#39;SIEM&#39;, &#39;r11hQ6dL&#39;)">SIEM</a> combines Security Information Management (SIM) and Security Event Management (SEM) to monitor and analyze events and track and log data in real-time. SIEM helps system administrators and blue teamers to monitor and track potential security threats and vulnerabilities before causing damage to an organization.&nbsp;</span></p><p><span><a class="dAMCdYDJ glossary-term" onclick="initPopOver(&#39;SIEM&#39;, &#39;dAMCdYDJ&#39;)">SIEM</a> solutions work as log data aggregation center, where it collects log files from sensors and perform functions on the gathered data to identify and detect security threats or attacks. The following are some of the functions that a SIEM may offer:</span></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"></p><p></p><ul style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Log management: It captures and gathers data for the entire enterprise network in real-time.</span></li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Event analytics: It applies advanced analytics to detect abnormal patterns or behaviors,&nbsp;</span>available in the dashboard with charts and statistics.</li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Incident monitoring and security alerts: It monitors the entire network, including connected users, devices, applications, etcetera, and&nbsp;as soon as attacks are detected, it alerts administrators immediately to take appropriate action to mitigate.</span></li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Compliance management and reporting: It generates real-time reports at any time.</span></li></ul><p></p>
<p><span><a class="xtMQY4xy glossary-term" onclick="initPopOver(&#39;SIEM&#39;, &#39;xtMQY4xy&#39;)">SIEM</a> is capable of detecting advanced and unknown threats using integrated threat intelligence and AI technologies, including Insider threats, security vulnerabilities, phishing attacks, Web attacks, DDoS attacks, data exfiltration, etc.</span></p><p><span>The following are some of the <a class="pyoYxYfP glossary-term" onclick="initPopOver(&#39;SIEM&#39;, &#39;pyoYxYfP&#39;)">SIEM</a> products that are commonly seen in many enterprises:</span></p><ul><li>Splunk</li><li><span>LogRhythm NextGen <a class="qEb5ibVw glossary-term" onclick="initPopOver(&#39;SIEM&#39;, &#39;qEb5ibVw&#39;)">SIEM</a> Platform</span></li><li>SolarWinds Security Event Manager</li><li>Datadog Security Monitoring</li><li>many others</li></ul><p><span style="font-size:24px">Intrusion Detection System and Intrusion Prevention System (NIDS/NIPS)</span></p><p style="text-align:center"><img src="./TryHackMe _ The Lay of the Land_files/4158d8d7b3d4e71f725fbc876e4a6ca8.png" style="width:50%" alt=" "></p><p style="text-align:justify"><span style="font-size:1rem;text-align:left"><span>Network-based <a class="m1QVmvlL glossary-term" onclick="initPopOver(&#39;IDS&#39;, &#39;m1QVmvlL&#39;)">IDS</a>/IPS have a similar concept to the host-based IDS/IPS. The main difference is that the network-based products focus on the security of a network instead of a host. The network-based solution will be based on sensors and agents distributed in the network devices and hosts to collect data. IDS and IPS are both detection and monitoring cybersecurity solutions that an enterprise uses to secure its internal systems. They both read network packets looking for abnormal behaviors and known threats pre-loaded into a previous database. The significant difference between both solutions is that the IDS requires human interaction or 3rd party software to analyze the data to take action. The IPS is a control system that accepts or rejects packets based on policies and rules.</span></span></p><p style="text-align:justify">The following are common enterprise IDS/IPS products&nbsp;</p><ul><li>Palo Alto Networks</li><li>Cisco's Next-Generation&nbsp;</li><li>McAfee Network Security Platform (NSP)</li><li>Trend Micro TippingPoint</li><li>Suricata</li></ul><p>For more information about IDS/IPS, visit the reference <a href="https://geekflare.com/ids-vs-ips-network-security-solutions/" target="_blank">link</a>.</p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Read the above!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="8">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-9">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse9">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 9                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Applications and Services
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse9" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p>This task will expand our knowledge needed to learn more about the system. We discussed account discovery and security products within the system in previous tasks.   We will continue learning more about the system, including:</p>

<ul><li><span style="font-size:1rem">Installed applications</span><br></li><li>Services and processes</li><li><span style="font-size:1rem">Sharing files and printers</span><br></li><li><span>Internal services: <a class="xx68bAFn glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;xx68bAFn&#39;)">DNS</a> and local web applications</span></li></ul><p>It is necessary to understand what the system provides in order to get the benefit of the information.</p><p><span style="font-size:24px">Installed Applications</span></p><p>First, we start enumerating the system for installed applications by checking the application's name and version. As a red teamer, this information will benefit us. We may find vulnerable software installed to exploit and escalate our system privileges. Also, we may find some information, such as plain-text credentials, is left on the system that belongs to other systems or services.</p><p>&nbsp;We will be using the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">wmic</span>&nbsp;Windows command to list all installed applications and their version.</p>
<div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top"><span><a class="Q1uD2kVv glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;Q1uD2kVv&#39;)">PowerShell</a></span></div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">PS C:\Users\thm&gt; wmic product get name,version
Name                                                            Version
Microsoft Visual C++ 2019 X64 Minimum Runtime - 14.28.29910     14.28.29910
AWS Tools for Windows                                           3.15.1248
Amazon SSM Agent                                                3.0.529.0
aws-cfn-bootstrap                                               2.0.5
AWS PV Drivers                                                  8.3.4
Microsoft Visual C++ 2019 X64 Additional Runtime - 14.28.29910  14.28.29910</span></code></pre></div></div>
<p><span>Another interesting thing is to look for particular text strings, hidden directories, backup files. Then we can use the <a class="zz5lJffR glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;zz5lJffR&#39;)">PowerShell</a> cmdlets,&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Get-ChildItem</span><span style="font-size:1rem">, as follow:</span></p>

<div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top"><span><a class="z84JFp78 glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;z84JFp78&#39;)">PowerShell</a></span></div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">PS C:\Users\thm&gt; Get-ChildItem -Hidden -Path C:\Users\kkidd\Desktop\</span></code></pre></div></div>

<p><span style="font-size:24px">Services and Process</span><br></p><p>Windows services enable the system administrator to create long-running executable applications in our own Windows sessions. Sometimes Windows services have misconfiguration permissions, which escalates the current user access level of permissions. Therefore, we must look at running services and perform services and processes reconnaissance.&nbsp; For more details, you can read about process discovery on <a href="https://attack.mitre.org/techniques/T1057/" target="_blank">Attack MITRE</a>.</p><p>Process discovery is an enumeration step to understand what the system provides. The red team should get information and details about running services and processes on a system. We need to understand as much as possible about our targets. This information could help us understand common software running on other systems in the network.&nbsp;<span style="font-size:1rem">For example, the compromised system may have a custom client application used for internal purposes.&nbsp;</span>Custom internally developed software is the most common root cause of escalation vectors.<span style="font-size:1rem">&nbsp;Thus, it is worth digging more to get details about the current process.&nbsp;&nbsp;</span></p><p>For more details about core Windows processes from the blue team perspective, check out the TryHackMe room: <a href="https://tryhackme.com/room/btwindowsinternals" target="_blank">Core Windows Process</a>.</p><p><span style="font-size:24px">Sharing files and Printers</span></p><p style="text-align:center"><img src="./TryHackMe _ The Lay of the Land_files/3ff0f1652898c0985f220d47a2feb1c1.png" style="width:50%" alt=" "></p><p>Sharing files and network resources is commonly used in personal and enterprise environments. System administrators misconfigure access permissions, and they may have useful information about other accounts and systems. For more information on printer hacking, we suggest trying out the following TryHackMe room: <a href="https://tryhackme.com/room/printerhacking101" target="_blank">Printer Hacking 101</a>.</p><p><span style="font-size:24px"><span>Internal services: <a class="5EyHPFcm glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;5EyHPFcm&#39;)">DNS</a>, local web applications, etc</span></span></p><p>Internal network services are another source of information to expand our knowledge about other systems and the entire environment. To get more details about network services that are used for external and internal network services, we suggest trying out the following rooms: <a href="https://tryhackme.com/room/networkservices" target="_blank">Network Service</a>, <a href="https://tryhackme.com/room/networkservices2" target="_blank">Network Service2</a>.</p><p>The following are some of the internal services that are commonly used that we are interested in:</p><ul><li><span><a class="lv9MbqN8 glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;lv9MbqN8&#39;)">DNS</a> Services</span></li><li>Email Services</li><li>Network File Share</li><li>Web application</li><li>Database service</li></ul></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Let's try listing the running services using the Windows command prompt&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">net start</span>&nbsp;to check if there are any interesting running services.</p>
<div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top"><span><a class="WRRBbzrp glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;WRRBbzrp&#39;)">PowerShell</a></span></div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">PS C:\Users\thm&gt; net start
These Windows services are started:

Active Directory Web Services
Amazon SSM Agent
Application Host Helper Service
Cryptographic Services
DCOM Server Process Launcher
DFS Namespace
DFS Replication
DHCP Client
Diagnostic Policy Service
THM Demo
DNS Client</span></code></pre></div></div>
<p><span style="font-size:1rem">We can see a service with the name&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">THM Demo</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">which we want to know more about.</span><br></p><p>Now let's look for the exact service name, which we need to find more information.<br></p>
<div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top"><span><a class="Lqq8rlaC glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;Lqq8rlaC&#39;)">PowerShell</a></span></div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">PS C:\Users\thm&gt; wmic service where "name like 'THM Demo'" get Name,PathName
Name         PathName
THM Service  c:\Windows\thm-demo.exe</span></code></pre></div></div>
<p>We find the file name and its path; now let's find more details using the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Get-Process</span>&nbsp;cmdlet.&nbsp;</p>
<div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top"><span><a class="zZ9s1KPE glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;zZ9s1KPE&#39;)">PowerShell</a></span></div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">PS C:\Users\thm&gt; Get-Process -Name thm-demo

Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName
-------  ------    -----      -----     ------     --  -- -----------
     82       9    13128       6200              3212   0 thm-service</span></code></pre></div></div>
<p>Once we find its process ID, let's check if providing a network service by listing the listening ports within the system.</p>
<div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top"><span><a class="VQl8EFRr glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;VQl8EFRr&#39;)">PowerShell</a></span></div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output"><span>PS C:\Users\thm&gt; netstat -noa |findstr "LISTENING" |findstr "3212"
  TCP    0.0.0.0:8080          0.0.0.0:0              LISTENING       3212
  TCP    [::]:8080             [::]:0                 LISTENING       3212</span></span></code></pre></div></div>
<p>Finally, we can see it is listening on port 8080. Now try to apply what we discussed and find the port number for&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">THM Service</span><span style="font-size:1rem">. What is the port number?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *****" value="13337" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="9">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Visit the localhost on the port you found in Question #1. What is the flag?</p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{***********************}" value="THM{S3rv1cs_1s_3numerat37ed}" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="9">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span>We mentioned that <a class="zff6qVBn glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;zff6qVBn&#39;)">DNS</a> service is a commonly used protocol in any active directory environment and network. The attached machine provides DNS services for AD. Let's enumerate the DNS by performing a zone transfer DNS and see if we can list all records.</span></p><p><span>We will perform <a class="rvWiwRUt glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;rvWiwRUt&#39;)">DNS</a> zone transfer using the Microsoft tool is&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">nslookup.exe</span><span style="font-size:1rem">.</span></p>
<div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top"><span><a class="GLuCOepA glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;GLuCOepA&#39;)">PowerShell</a></span></div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">PS C:\Users\thm&gt; nslookup.exe
Default Server:  UnKnown
Address:  ::1</span></code></pre></div></div>
<p><span>Once we execute it, we provide the <a class="BE8jS7VL glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;BE8jS7VL&#39;)">DNS</a> server that we need to ask, which in this case is the target machine</span></p>
<div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top">NSlookup</div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">&gt; server MACHINE_IP
Default Server:  [MACHINE_IP]
Address:  MACHINE_IP</span></code></pre></div></div>
<p><span>Now let's try the <a class="blatnyZ3 glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;blatnyZ3&#39;)">DNS</a> zone transfer on the domain we find in the AD environment.</span></p>
<div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top">NSlookup</div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">&gt; ls -d thmredteam.com
[[MACHINE_IP]]
 thmredteam.com.                SOA    ad.thmredteam.com hostmaster.thmredteam.com. (732 900 600 86400 3600)
 thmredteam.com.                A      MACHINE_IP
 thmredteam.com.                NS     ad.thmredteam.com
***
 ad                             A      MACHINE_IP</span></code></pre></div></div>
<p><span>The previous output is an example of successfully performing the <a class="PQnxOE2E glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;PQnxOE2E&#39;)">DNS</a> zone transfer.</span></p>
<p>Now enumerate the domain name of the domain controller,&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">thmredteam.com</span><span style="font-size:1rem">,&nbsp;</span><span style="font-size:1rem"><span>using the nslookup.exe, and perform a <a class="ta38t5v7 glossary-term" onclick="initPopOver(&#39;DNS&#39;, &#39;ta38t5v7&#39;)">DNS</a> zone transfer. </span><b>What is the flag for one of the records?</b></span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{******************}" value="THM{DNS-15-Enumerated!}" disabled="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="9">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-10">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse10">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 10                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Conclusion
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse10" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p>This room is an introduction to client systems in corporate environments. The student should have a better understanding of how clients are used in a corporate network including:</p><ul><li>Network Infrastructure</li><li><span><a class="qU6K72b6 glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;qU6K72b6&#39;)">AD</a> environment</span></li><li><span>security measures (<a class="XYoKYpfP glossary-term" onclick="initPopOver(&#39;HIPS&#39;, &#39;XYoKYpfP&#39;)">HIPS</a>, AV, etc.) </span></li><li>Internal applications and services</li></ul></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Hope you enjoyed the room and keep learning!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="10">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div></div>
</div>
<div id="room-simple-details"><div class="card cd-2 text-center mt-3"><div class="card-body"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ The Lay of the Land_files/af7feb2c43a2c7d5f111b98ccbd15048.png"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme">tryhackme</a></p><p class="mb-0">Only subscribers can deploy virtual machines in this room! 
        Go to your <a href="https://tryhackme.com/profile">profile</a> page to subscribe (if you have not already). 13474 users are in here and this room is 531 days old.</p></div></div></div>

</div>
</div>
</div>
<div id="room-content-attackbox">
<div id="room-attackbox">
<div id="attackbox-machine-instance">
<div id="room-attackbox-loading"></div>
<div id="room-attackbox-vm-view"></div>
</div>
<div id="attackbox-machine-options">
<div class="d-flex">
<a target="_blank" id="room-attackbox-url" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="View in full screen"></a>
<div onclick="extendHourWebBasedVM(null)" class="hover-pointer" id="room-attackbox-extend" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Extend machines timer"><i class="fas fa-plus"></i></div>
<div onclick="terminateWebBasedVM(null)" class="hover-pointer" id="room-attackbox-terminate" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Terminate Machine"><i class="far fa-power-off"></i></div>
<div onclick="exitViewAttackBox()" class="hover-pointer" id="room-attackbox-exitview" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Exit split view"><i class="fas fa-minus"></i></div>
<div onclick="infoAttackBox()" class="hover-pointer faded" id="room-attackbox-info" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Machine Information"><i class="fas fa-info"></i></div>
<div class="d-flex" id="room-attackbox-tabs"></div>
</div>
<div id="room-attackbox-expire-text" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Time left until your AttackBox expires"></div>
</div>
</div>
<div class="modal fade" id="attackBoxInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-light-gray">
<h5 class="modal-title m-auto">Web-Based Machine Information</h5>
</div>
<div class="modal-body">
<p>Use the web-based machine to attack other target machines you start on TryHackMe.</p>
<ul class="normalList text-gray mt-3 mb-4">
<li>Public IP: <code id="browser-machine-pubip" class="dark size-14"></code></li>
<li class="mt-1">Private IP: <code id="browser-machine-privip" class="dark size-14"></code> <span class="size-14">(Use this for your reverse shells)</span></li>
<li class="mt-1">Username: <code id="browser-username" class="dark size-14"></code></li>
<li class="mt-1">Password: <code id="browser-password" class="dark size-14"></code></li>
<li class="mt-1">Protocol: <code id="browser-protocol" class="dark size-14"></code></li>
</ul>
<hr class="hr-min">
<ul class="text-lgray mb-0">
<li class="mt-2">To copy to and from the browser-based machine, highlight the text and press <b>CTRL+SHIFT+C</b> <details><summary>or use the clipboard</summary><img src="./TryHackMe _ The Lay of the Land_files/clipboard.gif"></details></li>
<li class="mt-2">When accessing target machines you start on TryHackMe tasks, make sure you're using the correct IP (it <b>should not be</b> the IP of your AttackBox)</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="award-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<button type="button" class="close size-30 text-lgray" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<div id="award-modal-badges"></div>
<p class="mb-0 text-lgray size-18">Complete the room to earn this badge</p>
</div>
</div>
</div>
</div>
<div class="modal fade" id="hint-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title"><i class="fal fa-lightbulb-on"></i> Question Hint</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body"></div>
</div>
</div>
</div>
<div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">...</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center"></div>
<div class="modal-footer"></div>
</div>
</div>
</div>
<link rel="stylesheet" href="./TryHackMe _ The Lay of the Land_files/modal.css">
<div class="modal-design-green modal fade" id="roomCompleted" tabindex="-1" role="dialog" data-backdrop="static" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content" id="roomCompletedModalContent">
<div class="modal-body text-center">
<button type="button" class="close" id="closeRoomComplete" aria-label="Close">
<i class="fad fa-times-circle"></i>
</button>
<div class="icon-box">
<i class="fad fa-badge-check"></i>
</div>
<h3 class="text-accent mt-5">Congratulations</h3>
<p class="faded mt-1">You've completed the room! Share this with your friends: </p>
<h2 id="roomCompleted-share"></h2>
<div id="ticket-info"></div> 
<p class="faded mt-1" id="roomFeedbackBtn">
<small>
<button class="bg-white border-0">Leave
feedback</button>
</small>
</p>
<form method="post" action="https://tryhackme.com/feedback" id="roomFeedbackForm" class="d-none mt-3">
<input type="hidden" name="_csrf" value="JQC6U52V--6bYxJuee65x9AwMcMVDwo12kIk">
<input type="hidden" name="roomCode" value="thelayoftheland">
<input type="hidden" name="type" value="rooms">
<input type="hidden" name="redirect" value="json">
<div class="form-group">
<label class="mb-0" for="like">What do you like about the room?</label>
<textarea type="text" name="like" id="like" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="dislike">What don't you like about the room?</label>
<textarea type="text" name="dislike" id="dislike" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="details">Please send your suggestions, ideas and comments!</label>
<textarea id="details" type="text" name="details" class="form-control" style="padding: 5px;"></textarea>
</div>
<button type="submit" id="submitBtn" class="btn btn-success">Send Feedback</button>
</form>
<p class="mt-2 mb-0" id="formMessage"></p>
</div>
</div>
</div>
<script>
    function dismissRoomCompleteModal() {
      $('#roomCompleted').modal('hide');

      const shouldSeeReferralModal = ""
      if (shouldSeeReferralModal) {
        $('#unlockCreditModal').modal('show');

        referralModalEvent('view');
      }
    }

    document.getElementById('closeRoomComplete').addEventListener('click', dismissRoomCompleteModal)
  </script>
</div>
<script src="./TryHackMe _ The Lay of the Land_files/roomFeedback.js"></script>
<div class="modal fade" id="roomStartAttackboxModal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static" data-keyboard="false">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title m-auto">To access this machine, you need to either</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close" style="position: absolute; right: 10px; top: 0; font-size: 30px;">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center">
<div class="row vertical-align-custom mb-0">
<div class="col-sm-5 pr-0">
<p class="size-18 bold">Use a VPN</p>
<p>Connect to our network via a VPN</p>
<a target="_blank" href="https://tryhackme.com/access"><button type="button" class="btn btn-light">See Instructions</button></a>
</div>
<div class="col-sm-2 size-24">
or
</div>
<div class="col-sm-5 pl-0">
<p class="size-18 bold">Use the AttackBox</p>
<p>Use a web-based attack machine <span class="size-12">(recommended)</span></p>
<button type="button" onclick="$(&#39;#roomStartAttackboxModal&#39;).modal(&#39;toggle&#39;); startAttackBox({startingMsg: false, tutorial: true})" class="btn btn-hgreen">Start AttackBox</button>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="expireSoon" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-warning fad fa-exclamation-triangle"></i></h1>
<h3 class="text-warning">Expiring Soon</h3>
<p class="faded mt-3 mb-0">Your machine is going to expire soon. Close this and add an hour to stop it from terminating!</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="terminatedMachine" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-danger fad fa-exclamation-triangle"></i></h1>
<h3 class="text-danger">Expired Machine</h3>
<p class="faded mt-3 mb-0">Your machine has expired and terminated.</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="machineDeployModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue text-center p-3">
<h4 class="mb-0 m-auto">How to access machines</h4>
<button type="button" class="close modal-close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center">
<p class="size-18 faded">Now you've started your machine, to access it you need to either</p>
<div class="row mb-0">
<div class="col-sm-6">
<img src="./TryHackMe _ The Lay of the Land_files/connect_openvpn_short.png">
<p class="mt-2 mb-0 faded">Download your VPN configuration file and import it into a OpenVPN client</p>
</div>
<div class="col-sm-6">
<img src="./TryHackMe _ The Lay of the Land_files/connect_kali_short.png">
<p class="mt-2 mb-0 faded">Control a web-based machine with everything you need, all from inside your browser</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="roomAlertModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title" id="roomAlertModalTitle"></h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body" id="roomAlertModalBody"></div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="resetUserProgressModal" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">Reset Your Progress</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<div><span class="text-danger"><i class="fas fa-exclamation-triangle"></i> Warning</span> You will keep your points but all your answers in this room will be erased.</div>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-danger" onclick="resetProgress()">Yes, please!</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="cloudEnvInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header  modal-dark-blue">
<h5 class="modal-title">Cloud Information</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<ul class="nav nav-tabs">
<li class="nav-item pr-2">
<a class="nav-link active" data-toggle="tab" href="https://tryhackme.com/room/thelayoftheland#env-tab">Environment</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/thelayoftheland#creds-tab">Credentials</a>
</li>
</ul>
<div class="tab-content">
<div class="tab-pane active" id="env-tab"></div>
<div class="tab-pane" id="creds-tab"></div>
</div>
</div>
<div class="modal-footer" id="cloudEnvModalFooter">
</div>
</div>
</div>
</div>
<div class="modal fade" id="setNameModal" role="dialog">
<div class="modal-dialog modal-lg modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title">Generating Your Certificate</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body container">
<div class="row">
<div class="col-6">
<h5 class="bold">Hey there, what's your name?</h5>
<p class="text-secondary">
If you want your name to appear on your certificate, please fill the field below.
</p>
<div class="form-group">
<label>Full Name </label>
<input id="modal-cert-field-name" type="text" placeholder="John Wick" class="mb-4 form-control">
<input id="modal-cert-field-email" type="hidden" value="giftonpaul@karunya.edu.in">
</div>
</div>
<div class="col-6">
<h5 class="bold">You're here incognito? It's ok!</h5>
<p class="text-secondary">If you chose skip, your username will be used instead!</p>
</div>
</div>
<div class="row">
<div class="col-6">
<button type="button" class="btn btn-success float-right" id="modal-cert-generate" onclick="gen_cert(true)" disabled="">
Generate with my full name
</button>
</div>
<div class="col-6">
<button type="button" class="btn btn-primary float-right" id="modal-cert-skip" onclick="gen_cert(false)">
Generate with my username
</button>
</div>
</div>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ The Lay of the Land_files/certificateName.js"></script>
<div class="modal fade slideout-faq" id="roomSlideoutUnstuck" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-links">
<div id="unstuck-video" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-play"></i></div>
<div class="unstuck-icon-text">Video Solution</div>
</div>
<div id="unstuck-writeups" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-pen-alt"></i></div>
<div class="unstuck-icon-text">Writeups</div>
</div>
<a id="unstuck-forum" target="_blank" class="clear-link unstuck-group" href="https://tryhackme.com/forum/thread/61f93b3bab7344005d816870">
<div class="unstuck-icon"><i class="fas fa-comments-alt"></i></div>
<div class="unstuck-icon-text">Forum Post</div>
</a>
<a href="https://help.tryhackme.com/en/collections/3601905-getting-started-with-tryhackme" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-books"></i></div>
<div class="unstuck-icon-text">Knowledge Base</div>
</a>
<a href="https://discord.gg/DpBZz8y" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-users"></i></div>
<div class="unstuck-icon-text">Ask Community</div>
</a>
</div>
</div>
</div>
</div>
</div>
<style>

    #navConnModal .modal-body{
        position: relative;
    }

    #nav-openvpn,
    #nav-attackbox {
        display: none;
    }

    #nav-openvpn .nav-pills .nav-link.active,
    #nav-openvpn .nav-pills .show>.nav-link {
        background-color: #ec8e3d;
        color: white;
    }
    #nav-openvpn .nav-link {
        color: #909090;
    }
    #nav-openvpn a,
    #nav-attackbox a {
        color: #ec8e3d;
    }

    #nav-openvpn code.dark {
        background-color: #7d400a;
        color: #fff;
    }

    #slideout-bk {
        display: none;
        padding: 10px 15px;
        opacity: 0.8;
        cursor: pointer;
    }

    #slideout-bk:hover {
        opacity: 1;
    }

    #slideout-conn-hideip {
        display: none;
        position: absolute;
        bottom: 8px;
        right: 8px;
        opacity: 0.7;
        cursor: pointer;
    }

    #slideout-conn-hideip:hover {
        opacity: 1;
    }

</style>
<div class="modal fade slideout-faq" id="navConnModal" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-bk" class="noselect" onclick="showSlideoutConnOptions()"><i class="far fa-arrow-left mr-2"></i> Show Connection Options</div>
<div id="slideout-conn-options">
<div id="slideout-conn-header" class="text-center">
<img class="slideout-connect-img" src="./TryHackMe _ The Lay of the Land_files/tryhackme_connect.png">
<div id="slideout-conn-status" class="size-22"></div>
</div>
<div class="m-3 text-center">
<p>To access target machines you need to either:</p>
<div class="row mb-3 faq-quicklinks text-left vertical-align-custom">
<div class="col-md-12 mb-3">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/thelayoftheland#" onclick="showAttackBoxSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-laptop"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">AttackBox</div>
<p class="faded mb-0">Use a browser-based attack machine</p>
</div>
</div>
</div>
</a>
</div>
<div class="col-md-12">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/thelayoftheland#" onclick="showVPNSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-key"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">OpenVPN</div>
<p class="faded mb-0">Connect to our network via a VPN</p>
</div>
</div>
</div>
</a>
</div>
</div>
</div>
</div>
<div id="faqCards" class="p-3">
<div id="nav-openvpn">
<div class="mb-3">
<a target="_blank" href="https://tryhackme.com/access"><i>View the dedicated OpenVPN access page for more information</i></a>
</div>
<div class="text-center">
<h4>What Operating System are you using?</h4>
<ul class="nav nav-pills mb-3 text-center" id="vpn-guide" style="display: flex; justify-content: center;">
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/thelayoftheland#pills-windows" role="tab" aria-controls="pills-windows" aria-selected="true"><i class="fab fa-windows mr-2"></i> Windows</a>
</li>
<li class="nav-item m-3">
<a class="nav-link active" data-toggle="pill" href="https://tryhackme.com/room/thelayoftheland#pills-linux" role="tab" aria-controls="pills-linux" aria-selected="false"><i class="fab fa-linux mr-2"></i> Linux</a>
</li>
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/thelayoftheland#pills-macos" role="tab" aria-controls="pills-macos" aria-selected="false"><i class="fab fa-apple mr-2"></i> MacOS</a>
</li>
</ul>
<div class="tab-content text-left">
<div class="tab-pane fade" id="pills-windows" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a target="_blank" href="https://openvpn.net/client-connect-vpn-for-windows/">Download</a> the OpenVPN GUI application.</li>
<li class="mt-2">Install the OpenVPN GUI application. Then open the installer file and follow the setup wizard.</li>
<li class="mt-2">Open and run the OpenVPN GUI application as Administrator.<br><img class="mt-2 mb-3" src="./TryHackMe _ The Lay of the Land_files/win_ran_admin.png"></li>
<li class="mt-2">The application will start running in the system tray. It's at the bottom of your screen, near the clock. Right click on the application and click <b>Import File</b>. <br><img class="mt-2 mb-3" src="./TryHackMe _ The Lay of the Land_files/win_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Now right click on the application again, select your file and click Connect <br><img class="mt-2 mb-3" src="./TryHackMe _ The Lay of the Land_files/win_connect.png"></li>
</ol>
</div>
<div class="tab-pane fade show active" id="pills-linux" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2">Run the following command in your terminal: <code class="dark">sudo apt install openvpn</code></li>
<li class="mt-2">Locate the full path to your VPN configuration file (normally in your ~/Downloads folder).</li>
<li class="mt-2">Use your OpenVPN file with the following command: <code class="dark">sudo openvpn /path/to/file.ovpn</code></li>
</ol>
</div>
<div class="tab-pane fade" id="pills-macos" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a href="https://openvpn.net/downloads/openvpn-connect-v2-macos.dmg">Download</a> OpenVPN for MacOS.</li>
<li class="mt-2">Install the OpenVPN GUI application, by opening the dmg file and following the setup wizard.<br><img width="250" class="mt-2 mb-3" src="./TryHackMe _ The Lay of the Land_files/mac_installer.png"></li>
<li class="mt-2">Open and run the OpenVPN GUI application.</li>
<li class="mt-2">The application will start running and appear in your top bar. Right click on the application and click <b>Import File -&gt; Local file</b>.<br><img class="mt-2 mb-3" src="./TryHackMe _ The Lay of the Land_files/mac_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Right click on the application again, select your file and click connect.<br><img class="mt-2 mb-3" src="./TryHackMe _ The Lay of the Land_files/mac_connect.png"></li>
</ol>
</div>
</div>
<section class="text-left">
<a class="remove-underline" data-toggle="collapse" href="https://tryhackme.com/room/thelayoftheland#havingProblems" role="button" aria-expanded="false" aria-controls="havingProblems">
<h5 class="mb-0 text-openvpn">Having Problems?</h5>
</a>
<div class="collapse" id="havingProblems">
<ul class="mt-2 mb-0">
<li>If you can access <a target="_blank" href="http://10.10.10.10/">10.10.10.10</a>, you're connected.</li>
<li>Downloading and getting a 404? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>Getting inline cert error? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>If you are using a virtual machine, you will need to run the VPN inside that machine.</li>
<li>Is the OpenVPN client running as root? <span class="size-14 faded">(On Windows, run OpenVPN GUI as administrator. On Linux, run with sudo)</span></li>
<li>Have you restarted your VM?</li>
<li>Is your OpenVPN up-to-date?</li>
<li>Only 1 OpenVPN connection is allowed. <span class="size-14 faded">(Run <code class="dark">ps aux | grep openvpn</code> - are there 2 VPN sessions running?)</span></li>
<li>Still having issues? Check our <a href="https://help.tryhackme.com/en/articles/6496029-openvpn-general-troubleshooting-detailed/">docs</a> out.</li>
</ul>
</div>
</section>
</div>
</div>
<div id="nav-attackbox">
<div class="text-center">
<h4>AttackBox</h4>
<p class="faded">Use your own web-based linux machine to access machines on TryHackMe</p>
</div>
<p>To start your AttackBox in the room, click the <a class="preventDefault" onclick="showAttackBoxBtnFromSlideout()" href="https://tryhackme.com/room/thelayoftheland#">Start AttackBox</a> button. Your private machine will take 2 minutes to start.</p>
<p>Free users get 1 free AttackBox hour. <a class="hacker-green" href="https://tryhackme.com/why-subscribe">Subscribed</a> users get more powerful machines with unlimited deploys.</p>
</div>
</div>
<span id="slideout-conn-hideip" onclick="hideNavConnIP()">Hide IP</span>
</div>
</div>
</div>
</div>
<script>

    const navConnVPNEl = document.querySelector('#nav-openvpn')
    const navConnAttackBoxEl = document.querySelector('#nav-attackbox')
    const navConnOptions = document.querySelector('#slideout-conn-options')

    const navConnBkBtn = document.querySelector('#slideout-bk')

    function showVPNSteps() {
        navConnOptions.style.display = 'none'
        navConnVPNEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showAttackBoxSteps() {
        navConnOptions.style.display = 'none'
        navConnAttackBoxEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showSlideoutConnOptions() {
        navConnVPNEl.style.display = 'none'
        navConnAttackBoxEl.style.display = 'none'
        navConnBkBtn.style.display = 'none'
        navConnOptions.style.display = 'block'
    }

    function showAttackBoxBtnFromSlideout() {
        $('#navConnModal').modal('toggle')
        setTimeout(function() {
            showAttackBoxBtnIntro()
        }, 100)   
    }

  </script>
</div>
<script src="./TryHackMe _ The Lay of the Land_files/notify.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/api-requests.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/events.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/underscore-min.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/apexcharts.min.js"></script> 
<script src="./TryHackMe _ The Lay of the Land_files/chart.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/expire.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/sockets.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/faqSearch.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/certificate.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/utils.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/roomSpecific.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/confetti.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/videos.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/intro.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/prism.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/asciinema-player.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/magnific-popup.min.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/introjsLogic.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/logic.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/tasks.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/connection-status.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/glossary.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/room-mymachine.js"></script>
<script src="./TryHackMe _ The Lay of the Land_files/heartbeat.js" defer=""></script>
<script>

    let height
    $(window).scroll(function () { /* Function to make IP information sticky. */
      if (height == undefined || height < 30) {
        height = ($('#instance-info').offset().top)
      }
      let scroll = $(window).scrollTop()
      if (((scroll >= (height + 150))) && height > 30) {
        $("#instance-info").addClass('instance-sticky')
      } else if ((scroll <= (height))) {
        $("#instance-info").removeClass("instance-sticky")
      }
    })

    const csrfToken = "JQC6U52V--6bYxJuee65x9AwMcMVDwo12kIk"
    $.ajaxSetup({ headers: { 'CSRF-Token': csrfToken } }) // all $.post headers include token (needs csrfProtection middleware)

    const roomCode = "thelayoftheland"
    const simpleRoom = true 
    const events = {"tickets":false}

    let userObj = { 
      subscribed: 1,
      splitScreen: true,
      path: "redteaming",
      tutorial: {
        rooms: true,
        attackbox: true,
        staticsite: true
      },
      experiments:  JSON.parse(`{"onboardingAchievement":{},"scheduler":{"startDate":"2023-06-14T13:38:51.108Z"},"showEasyPath":true}`),
    }

    const roomSettings = {
      remAttackBoxBtn : true
    };

    const heartbeatInterval = 30;

    const cloudEnabled = false 
    let cloudObj

    initRoom()
    checkVideoTab()
    if(!simpleRoom) showChart(roomCode)

    checkRoomAwards(roomCode)

    getRoomVotes()

    displayStreakFreezeAwardedFromMemory();
    
    window.addEventListener('load', function () {
      introjsInit(roomCode)
    })

  </script>


<svg id="SvgjsSvg1001" width="2" height="0" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.dev" style="overflow: hidden; top: -100%; left: -100%; position: absolute; opacity: 0;"><defs id="SvgjsDefs1002"></defs><polyline id="SvgjsPolyline1003" points="0,0"></polyline><path id="SvgjsPath1004" d="M0 0 "></path></svg><div id="6B08EF07-4877-0FF6-557E-A6022685E6BB"></div><iframe id="_hjSafeContext_23825719" title="_hjSafeContext" tabindex="-1" aria-hidden="true" src="./TryHackMe _ The Lay of the Land_files/saved_resource.html" style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;"></iframe><iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" aria-hidden="true" tabindex="-1" title="Intercom" src="./TryHackMe _ The Lay of the Land_files/saved_resource(1).html"></iframe><div class="intercom-lightweight-app"><div class="intercom-lightweight-app-launcher intercom-launcher" role="button" tabindex="0" aria-label="Open Intercom Messenger" aria-live="polite"><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-open"><img src="./TryHackMe _ The Lay of the Land_files/9e0f012f15b6fc981dde2f1f5198d728.png" alt="" class="intercom-lightweight-app-launcher-custom-icon-open"></div><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-minimize"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M18.601 8.39897C18.269 8.06702 17.7309 8.06702 17.3989 8.39897L12 13.7979L6.60099 8.39897C6.26904 8.06702 5.73086 8.06702 5.39891 8.39897C5.06696 8.73091 5.06696 9.2691 5.39891 9.60105L11.3989 15.601C11.7309 15.933 12.269 15.933 12.601 15.601L18.601 9.60105C18.9329 9.2691 18.9329 8.73091 18.601 8.39897Z" fill="white"></path>
</svg>
</div></div><style id="intercom-lightweight-app-style" type="text/css">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    0% {
      opacity: 0;
      transform: scale(0);
    }
    40% {
      opacity: 1;
    }
    100% {
      transform: scale(1);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji", Helvetica, Arial, sans-serif;
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    padding: 0 !important;
    margin: 0 !important;
    border: none;
    bottom: 20px;
    right: 20px;
    max-width: 48px;
    width: 48px;
    max-height: 48px;
    height: 48px;
    border-radius: 50%;
    background: #1C2538;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    transition: transform 167ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    box-sizing: content-box;
  }


  .intercom-lightweight-app-launcher:hover {
    transition: transform 250ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    transform: scale(1.1)
  }

  .intercom-lightweight-app-launcher:active {
    transform: scale(0.85);
    transition: transform 134ms cubic-bezier(0.45, 0, 0.2, 1);
  }


  .intercom-lightweight-app-launcher:focus {
    outline: none;

    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 48px;
    height: 48px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 24px;
    height: 24px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 44px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 24px;
    max-width: 24px;

    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: white;
    animation: intercom-lightweight-app-messenger 250ms cubic-bezier(0, 1, 1, 1);
    transform-origin: bottom right;
    
        width: 400px;
        height: calc(100% - 104px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 84px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
      

    border-radius: 16px;
  }

  .intercom-lightweight-app-messenger-header {
    height: 64px;
    border-bottom: none;
    background: #1c2538

    
  }

  .intercom-lightweight-app-messenger-footer{
    position:absolute;
    bottom:0;
    width: 100%;
    height: 80px;
    background: #fff;
    font-size: 14px;
    line-height: 21px;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0px 0px 25px rgba(0, 0, 0, 0.05);
    
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div></body></html>